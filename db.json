{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"themes/hexo-theme-volantis/source/css/Readme.md","path":"css/Readme.md","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/css/first.styl","path":"css/first.styl","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/app.js","path":"js/app.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/click_show_text.js","path":"js/click_show_text.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/fireworks.js","path":"js/fireworks.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/love.js","path":"js/love.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/snow.js","path":"js/snow.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/aplayer.js","path":"js/plugins/aplayer.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/rightMenus.js","path":"js/plugins/rightMenus.js","modified":1,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/parallax.js","path":"js/plugins/parallax.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/search/hexo.js","path":"js/search/hexo.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/search/meilisearch.js","path":"js/search/meilisearch.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/contributors.js","path":"js/plugins/tags/contributors.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/friends.js","path":"js/plugins/tags/friends.js","modified":0,"renderable":1},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/sites.js","path":"js/plugins/tags/sites.js","modified":0,"renderable":1},{"_id":"source/images/antd.jpeg","path":"images/antd.jpeg","modified":0,"renderable":0},{"_id":"source/images/ava.jpeg","path":"images/ava.jpeg","modified":0,"renderable":0},{"_id":"source/images/avatar-circle.png","path":"images/avatar-circle.png","modified":0,"renderable":0},{"_id":"source/images/avatar.png","path":"images/avatar.png","modified":0,"renderable":0},{"_id":"source/images/bg.jpeg","path":"images/bg.jpeg","modified":0,"renderable":0},{"_id":"source/images/git.jpeg","path":"images/git.jpeg","modified":0,"renderable":0},{"_id":"source/images/nav.png","path":"images/nav.png","modified":0,"renderable":0},{"_id":"source/images/node.jpeg","path":"images/node.jpeg","modified":0,"renderable":0},{"_id":"source/images/pay.jpeg","path":"images/pay.jpeg","modified":0,"renderable":0},{"_id":"source/images/promise.jpeg","path":"images/promise.jpeg","modified":0,"renderable":0},{"_id":"source/images/react.jpeg","path":"images/react.jpeg","modified":0,"renderable":0},{"_id":"source/images/redux.jpeg","path":"images/redux.jpeg","modified":0,"renderable":0},{"_id":"source/images/vue.png","path":"images/vue.png","modified":0,"renderable":0},{"_id":"source/images/webpack.jpeg","path":"images/webpack.jpeg","modified":0,"renderable":0}],"Cache":[{"_id":"source/404.md","hash":"dfc54a2d545d2e10d8038cc53a51bfee8f29c7c8","modified":1678525373710},{"_id":"source/_data/friends.yml","hash":"494b772d570091bd986d37c5a1481c1ae1849cd3","modified":1678276151786},{"_id":"source/.DS_Store","hash":"cc75fbdb977a72e3c33a32b977ec965c1597d5c5","modified":1677757693468},{"_id":"source/_posts/PromiseOne.md","hash":"bcce8e95ba6b807c0beb99ce155f76a655088020","modified":1678794100489},{"_id":"source/_posts/React-redux.md","hash":"69320d3192d048f0907f0a4a7b79946ff22ba038","modified":1678613869988},{"_id":"source/_posts/Promiseall.md","hash":"2e5120be2100b7e1694dfc734d8d1b1231a594eb","modified":1678794104644},{"_id":"source/_posts/PromiseTo.md","hash":"b54de15ec12c8f4a0c624d85d2ca8efdfb70a833","modified":1678794096240},{"_id":"source/_posts/React报错.md","hash":"6a7aa102c8a3b5c577e80b4b79cb926beab6eef0","modified":1678613384820},{"_id":"source/_posts/React组件的状态下移和内容提升.md","hash":"ee18fee1e703054a814e5640abc18aca10d7cc00","modified":1678613873236},{"_id":"source/_posts/dataPick组件日期在浏览器兼容性问题.md","hash":"2906d77cd756c3f01abecb25a2514d8a5c77bf31","modified":1678792463891},{"_id":"source/_posts/gitOne.md","hash":"b6567da988e4f5905fdc07d1f51d1d3e0f3f9b50","modified":1678880513396},{"_id":"source/_posts/gitRebase.md","hash":"f216c205ae7b4fe13dc3f4b214f1b0575dd4c55f","modified":1678879007426},{"_id":"source/_posts/gitTo.md","hash":"8ead5cabcdd320396e61d3e048d649c897e6de87","modified":1678882380208},{"_id":"source/_posts/nodebody.md","hash":"c52c75461095a764642178d0ab944f0109117aa2","modified":1679569003671},{"_id":"source/_posts/nodeheader.md","hash":"0300e70aa7dc46ce3882b62e5ce633a8d705b2d5","modified":1679569015301},{"_id":"source/_posts/nodejoi.md","hash":"05c510ec6751d9f0d1c383c0bf39ca3f3b085c92","modified":1679568518110},{"_id":"source/_posts/nodenotfound.md","hash":"ec5d6c417f8f1687220ca702aadc2aafda6fb0d9","modified":1679567335765},{"_id":"source/_posts/noderes-cc.md","hash":"3f173bb23d7d33219e2a2de87f523280f60c3315","modified":1679566710601},{"_id":"source/_posts/npminstall.md","hash":"e13d345859c263adcf04972f03bbfbc554823412","modified":1679568940815},{"_id":"source/_posts/profile.md","hash":"04fae1def4c0fb5ce112dec0c257b737a1489ad1","modified":1678614497499},{"_id":"source/_posts/prop的单向数据流.md","hash":"c84f82698d1cecc083ac4184e7e4726028291d22","modified":1678795592024},{"_id":"source/_posts/useMemo使用误区.md","hash":"eee042cae3e5b7f8a5681ec09704a7d6f44e38ee","modified":1687314495228},{"_id":"source/_posts/useMemo的使用.md","hash":"5de82bcd5207b67986d62824f7f869fe7f9948c1","modified":1678613863956},{"_id":"source/_posts/react-fiber.md","hash":"c9d8fee268a02ed1d0bb22c13098c0567cebed7a","modified":1678613685620},{"_id":"source/_posts/table-scroll.md","hash":"500b068a8df00748d86b540399cdc6b77ae36abb","modified":1678613866848},{"_id":"source/_posts/vue响应式原理.md","hash":"62442a864c6464746a9483b5622c8ee6d59aefd5","modified":1678794804816},{"_id":"source/_posts/vue报错one.md","hash":"9a7193c1eea9da19f45fbb400957edef550945fd","modified":1678795977149},{"_id":"source/_posts/vue数据代理的原理.md","hash":"d50ec82f852c8f223d1cb98904150dece714e892","modified":1678795131988},{"_id":"source/_posts/vux.md","hash":"7b2b478511c52ffba77409c532c6e38171b21e5f","modified":1678796665432},{"_id":"source/_posts/watch和computed的区别.md","hash":"9cd4380af1a7035833e59905bf91c919c497abac","modified":1678795311268},{"_id":"source/_posts/webpack-opt.md","hash":"4ecc8a4712a0dd2f69b6904d967723550cbd7a9e","modified":1678883178114},{"_id":"source/_posts/前端图片压缩解决办法.md","hash":"c539f42a06923b74418e581c2b2ccd210856bdaa","modified":1678613587778},{"_id":"source/_posts/webpackConfig.md","hash":"10623683d163bba17728689a059bb287ca5331c5","modified":1678883170944},{"_id":"source/_posts/过滤文本框表情符号.md","hash":"17fd8e7819e600af6486be4a62ec9b43d07b1441","modified":1678613850374},{"_id":"source/about/index.md","hash":"3f94f1c3fee045486e235fce1f5665e33becdfc4","modified":1678539328738},{"_id":"source/categories/index.md","hash":"424e1aeaa514894cc5c2dcf3033f245c54a92581","modified":1678539199961},{"_id":"source/friends/index.md","hash":"51737a00dcbe12a4eac9700bc4edff5cbccf82d9","modified":1678275990009},{"_id":"source/images/antd.jpeg","hash":"2baef76d38d0a447ad880d0d6e61a03b0e4a552b","modified":1678610925955},{"_id":"source/images/ava.jpeg","hash":"17563468ef5bb66e2e27790e85810ab3f1365379","modified":1678187481930},{"_id":"source/images/node.jpeg","hash":"b2f437b8e463ad1b1e6e124b8e4f4cc2622fe41a","modified":1679566534370},{"_id":"source/images/git.jpeg","hash":"8fae7e8c851f11ab0624720d60fd5bfced8c5625","modified":1678797026001},{"_id":"source/images/react.jpeg","hash":"22996b85f1bfb96b5ed904e2c602228c2325b907","modified":1678609386028},{"_id":"source/images/redux.jpeg","hash":"c60a9c11b00af5090492fbe68f4868e3043b9fcb","modified":1678612723054},{"_id":"source/tags/index.md","hash":"d614693c37d6e20b374a102c07b830c673e74439","modified":1678539938463},{"_id":"source/images/webpack.jpeg","hash":"7e458c6e5e644bbfba81be663bca79ff32c6d393","modified":1678882858480},{"_id":"source/_posts/PromiseOne/promise4.png","hash":"713d787431a8482d8ed18ab193f7ab18166b991d","modified":1678793681658},{"_id":"source/_posts/PromiseOne/promise2.png","hash":"2cfe57ebb6368182e3c275c164d3bfc81bac141f","modified":1678793681581},{"_id":"source/_posts/PromiseTo/promiseto2.png","hash":"28a30df9f01a7b860ae40749f0e03f89a24c6771","modified":1678794049911},{"_id":"source/_posts/PromiseTo/promiseto3.png","hash":"2c2f7e63cca74233ae53f7acaca8167d491ae53b","modified":1678794049935},{"_id":"source/_posts/React报错/reacterror1.png","hash":"b9512f7f6efb66590d4f2a0a8d2e9c72165bf29f","modified":1678613171337},{"_id":"source/_posts/React报错/reacterror2.png","hash":"c8b0a0e467af4544e90c7ee2018362bee649a53c","modified":1678613171367},{"_id":"source/_posts/gitOne/gitOne10.png","hash":"9a950437cbc6dc4d2fdcec82f1aaf86dda8eeb1f","modified":1678880559235},{"_id":"source/_posts/gitOne/gitOne12.png","hash":"5a5d492d3fb92545d6be1c4669b06ab3dba8921b","modified":1678880559369},{"_id":"source/_posts/gitOne/gitOne11.png","hash":"7fa8261b107ab8344e9101aed10a3f9c787c69b1","modified":1678880559311},{"_id":"source/_posts/gitOne/gitOne13.png","hash":"cfcd9a85d17a9e3404b55547d97bf5afcd96e762","modified":1678880559435},{"_id":"source/_posts/gitOne/gitOne16.png","hash":"b2bc414407ee58fbb1de725c2851de95fdd3d8e9","modified":1678880559618},{"_id":"source/_posts/gitOne/gitOne18.png","hash":"fa594d48cfe13f7e6a2ac47a32c9b0d48f1e1978","modified":1678880559721},{"_id":"source/_posts/gitOne/gitOne17.png","hash":"a485025c9a7fb3ae4a89696902b3d1530e24148c","modified":1678880559670},{"_id":"source/_posts/gitOne/gitOne19.png","hash":"29fcd6e662a926599e6e727aef81a89088fe5c03","modified":1678880559779},{"_id":"source/_posts/gitOne/gitOne20.png","hash":"479d27f520b65ba1ab05c9214d028235e5d66dfa","modified":1678880559900},{"_id":"source/_posts/gitOne/gitOne2.png","hash":"f147c31f9412934c3e4e59b863a2c685ff70cf6b","modified":1678879736424},{"_id":"source/_posts/gitOne/gitOne21.png","hash":"fce452610b10d313023f848f791d4150a00194fb","modified":1678880559980},{"_id":"source/_posts/gitOne/gitOne22.png","hash":"68e5658e1f82db768548572cd682de9b613aef0a","modified":1678880560091},{"_id":"source/_posts/gitOne/gitOne23.png","hash":"745ef0d547f21fea70244fe81623dd476ec0eca1","modified":1678880560172},{"_id":"source/_posts/gitOne/gitOne24.png","hash":"20e06205531397ae2d021331f424a21051a59b1b","modified":1678880560195},{"_id":"source/_posts/gitOne/gitOne3.png","hash":"b367e39da7c48a10ee634b352e1ae837b347ba56","modified":1678879736502},{"_id":"source/_posts/gitOne/gitOne6.png","hash":"bc5712b3e09a0595d86af299ddff5a522a5fcb67","modified":1678880558637},{"_id":"source/_posts/gitOne/gitOne7.png","hash":"b126828903c3b05f0eabce754f6e9f3d3decc1ef","modified":1678880558683},{"_id":"source/_posts/gitOne/gitOne8.png","hash":"1411eeee8a6ec62330764d38bfa047feed213794","modified":1678880559136},{"_id":"source/_posts/gitOne/gitOne9.png","hash":"0bc762a2bdf1516bae49522218c378604599b62f","modified":1678880559184},{"_id":"source/_posts/gitRebase/rebase4.png","hash":"5f8e039abbb2d00355e40a822df9a43396bdb28b","modified":1678796964557},{"_id":"source/_posts/gitTo/to10.png","hash":"96d89f12b309f990764c0a8e03a6fdefe6510717","modified":1678882316029},{"_id":"source/_posts/gitTo/to12.png","hash":"8a275e45d71d69b3cd0c1ca602192807cfec89ca","modified":1678882316184},{"_id":"source/_posts/gitTo/to17.png","hash":"f53cc706cde0e80104d1ffa14bbe549074321fc1","modified":1678882316381},{"_id":"source/_posts/gitTo/to18.png","hash":"6ff6e9c7501b36c064c8cb2b1073aca09b5072de","modified":1678882316488},{"_id":"source/_posts/gitTo/to19.png","hash":"f517dc5deee5581f052ed32ee7ab01d49f50af72","modified":1678882316596},{"_id":"source/_posts/gitTo/to21.png","hash":"c6301da84556cc3e9d233dce306d64276a062911","modified":1678882316732},{"_id":"source/_posts/gitTo/to2.png","hash":"d74da7bae937f9cfa4c014236008eccfd840dd8f","modified":1678882315700},{"_id":"source/_posts/gitTo/to23.png","hash":"f3864b54f322a1f94596d9d2911e7b5ae41b2306","modified":1678882316812},{"_id":"source/_posts/gitTo/to25.png","hash":"f99fa94319af015e68006e180bb6073fa59086fb","modified":1678882316911},{"_id":"source/_posts/gitTo/to27.png","hash":"28def0d3cf5d09e12d6685a70a22b4991df4da8f","modified":1678882317012},{"_id":"source/_posts/gitTo/to29.png","hash":"d1f8409d18c9263d82caed48a99c744109970945","modified":1678882317104},{"_id":"source/_posts/gitTo/to30.png","hash":"c3d37ae74fbaa7aba59b1c15aa70d1f61713c293","modified":1678882317157},{"_id":"source/_posts/gitTo/to32.png","hash":"06d64419a6924d19f3026fc899d7bc8158d2f958","modified":1678882317399},{"_id":"source/_posts/gitTo/to31.png","hash":"27e0cc6f38b1e3a6dafb69c3f0d35d817a0bb260","modified":1678882317298},{"_id":"source/_posts/gitTo/to33.png","hash":"9255ba95f88717b2b8268f94207bb4bbdf8f991c","modified":1678882317442},{"_id":"source/_posts/gitTo/to8.png","hash":"5cf7377ef9315ba29caffc8bc57283c61cdaecb4","modified":1678882315974},{"_id":"source/_posts/gitTo/to9.png","hash":"14dd90d4b14e89c75f3aa21210cb8a9ba6cbfb92","modified":1678882315999},{"_id":"source/_posts/nodenotfound/notfound1.png","hash":"85bd0d36c01fd4a8f55d194385f4809014e53f56","modified":1679567112626},{"_id":"source/_posts/nodenotfound/notfound3.png","hash":"24aed423b1963abf5d735b60ccf709e499c2cf10","modified":1679567112677},{"_id":"source/_posts/nodenotfound/notfound2.png","hash":"dd03788645d25270a18ca8fbd1c42b8f7cf3bda4","modified":1679567112660},{"_id":"source/_posts/profile/profile1.png","hash":"0af26f242d034238b16ded68f1bada221db27f48","modified":1678614372905},{"_id":"source/_posts/profile/profile4.png","hash":"da0343a854a3251efac5d3fd50fca02fb4138b93","modified":1678614255197},{"_id":"source/_posts/profile/profile3.png","hash":"4a5abce397af0901ea557666e642077fff770026","modified":1678614255142},{"_id":"source/_posts/profile/profile5.png","hash":"2588bcfd02541396b1cbaeb90b44174b2a19216c","modified":1678614255118},{"_id":"source/_posts/prop的单向数据流/data2.png","hash":"34d5372722b2da8a10fbdda157c91fa2d10f2b05","modified":1678795613721},{"_id":"source/_posts/react-fiber/fiber1.png","hash":"19f8bfcd0894175ba5ebfbb0f36af4f73b8a52c3","modified":1678610509748},{"_id":"source/_posts/react-fiber/fiber2.png","hash":"3599a86e726f6c2b2c48dd2b3174122425ed9811","modified":1678610460411},{"_id":"source/_posts/react-fiber/fiber3.png","hash":"da385caa9a1c2ce4d7b520d48bf8116fcaf37aa2","modified":1678610469851},{"_id":"source/_posts/react-fiber/fiber4.png","hash":"00ed50d60b8369d7a881a6c59b20a3e62392a9d4","modified":1678610498879},{"_id":"source/_posts/vue数据代理的原理/vueproxy3.png","hash":"0d3080aff6a89289c7c7335f755793d95bc9d112","modified":1678795750936},{"_id":"source/_posts/vue数据代理的原理/vueproxy2.png","hash":"f4acd2bae6b10e7ef3d3d6c424ae3683a4df05c1","modified":1678795750893},{"_id":"source/_posts/vue数据代理的原理/vueproxy1.jpeg","hash":"d3c72b3574bd8f2eac837171bc63a123c3be3c8a","modified":1678795768540},{"_id":"source/_posts/vue数据代理的原理/vueproxy4.png","hash":"df723d7f4a21e25fd397e1a18c768ca735018b8d","modified":1678795750973},{"_id":"source/_posts/vux/vue2.png","hash":"ea7e71e9ce55a17f9fb098d5522b31d33f1f2d64","modified":1678796400675},{"_id":"source/_posts/vux/vuex3.png","hash":"80a8711cdde6d3803bf3eb5f256f7ec2ef52be05","modified":1678796400733},{"_id":"source/images/avatar-circle.png","hash":"011d87dabdc3583ddd75b8a48958fee27f20caf6","modified":1678542167967},{"_id":"source/images/pay.jpeg","hash":"d145033694dc626ec2af0d3d10f71bbb7a425331","modified":1678273739022},{"_id":"source/images/promise.jpeg","hash":"fb9ba59a45b04cdfe4241dff0ae4b2942830297a","modified":1678793173622},{"_id":"source/_posts/PromiseOne/promise3.png","hash":"8eb0a1dc654f56a5197897154e94bed6db942090","modified":1678793681617},{"_id":"source/_posts/React-redux/reduxdata1.gif","hash":"d5da4e7782c51efa3bc105d3e1f78e58aaf913b2","modified":1678612472597},{"_id":"source/_posts/gitOne/gitOne14.png","hash":"cc604ebfa34f7025318a3b110ac6e55ea944f6cb","modified":1678880559507},{"_id":"source/_posts/gitOne/gitOne15.png","hash":"81ddc7397d2170f42a697b41767c5558bcca876a","modified":1678880559570},{"_id":"source/_posts/gitTo/to13.png","hash":"018f01150f170b3d3d8cc5f3e9f6d6b78e7c5b31","modified":1678882316241},{"_id":"source/_posts/gitTo/to20.png","hash":"aebdae0cf048163b56b61290dae24e8a4eba6420","modified":1678882316642},{"_id":"source/_posts/gitTo/to24.png","hash":"88846f846792972ea2d51a95d1d156114dee46f5","modified":1678882316834},{"_id":"source/_posts/gitTo/to28.png","hash":"d54fd09caece9b2224544a550f0b7078831be624","modified":1678882317067},{"_id":"source/_posts/gitTo/to3.png","hash":"7859990fee59eb2b5cc2e1702fa18d8d844fbe8e","modified":1678882315731},{"_id":"source/_posts/gitTo/to34.png","hash":"321bca30f8137cf007a9ce13b53f69b01fd40f98","modified":1678882317501},{"_id":"source/_posts/nodeheader/hea2.png","hash":"d8cf632529d6949e3fa57683f50e56523559e076","modified":1679568393372},{"_id":"source/_posts/nodebody/body1.png","hash":"3ecb837b412fa13e1a0680ea9330678a5307163f","modified":1679567434002},{"_id":"source/_posts/nodejoi/joi1.png","hash":"8fd48f30851c43bba9541876602b27d016266325","modified":1679567698851},{"_id":"source/_posts/nodenotfound/notfound4.png","hash":"4ab52115bb809c4f253ea3bdfda582ab13f45d19","modified":1679567112712},{"_id":"source/_posts/noderes-cc/cc2.png","hash":"9488d8bc43a9a682cd2d339f504a79aee2301287","modified":1679567138579},{"_id":"source/_posts/profile/profile6.png","hash":"2f043c2b5351e6f0e122cca92070d5cbf2572984","modified":1678614255093},{"_id":"source/_posts/profile/profile2.png","hash":"419e67c6a552471c06eddf2219a46c77e43bbe5c","modified":1678614255160},{"_id":"source/_posts/profile/profile7.png","hash":"c9deed17b28675d7ca10c30e08e34c8d459dd904","modified":1678614313042},{"_id":"source/_posts/prop的单向数据流/data3.png","hash":"5b58d3e83449768d2d1c38e481515c5aa45d3aa2","modified":1678795613744},{"_id":"source/_posts/useMemo使用误区/memo2.png","hash":"5effa78982a1d97d95a2d9cf55068a34061c4df3","modified":1678609618630},{"_id":"source/_posts/useMemo使用误区/memo1.png","hash":"aa9652296973fb8ab971ef6fe6dbb96a2b8e8e6e","modified":1678609612388},{"_id":"source/_posts/useMemo使用误区/memo3.png","hash":"9b40b91d547d5da70c928039e4f8bc7cac39ef53","modified":1678609625361},{"_id":"source/_posts/useMemo使用误区/memo4.png","hash":"a5f49bf0fb25b5ffdd2585d906d841246bf56c81","modified":1678609645308},{"_id":"source/_posts/useMemo的使用/memoopt4.png","hash":"2eccce730e07afdb1f66f3e73931f958c0a7ab0f","modified":1678611744232},{"_id":"source/_posts/过滤文本框表情符号/emo1.png","hash":"d6fb288e9667fb06685c62c5ad39c091bf046e9f","modified":1678613763013},{"_id":"source/_posts/PromiseOne/promise1.png","hash":"84b659aea2a750499dfeda107d87536d6aff8859","modified":1678793681547},{"_id":"source/_posts/PromiseTo/promiseto1.png","hash":"84b659aea2a750499dfeda107d87536d6aff8859","modified":1678794049890},{"_id":"source/_posts/gitRebase/rebase2.png","hash":"6cc342bd036b86a2517a20e78db03270ea8c57a8","modified":1678796964468},{"_id":"source/_posts/gitRebase/rebase3.png","hash":"a069fd8c6c285affd4e9e836662ce422424b3c99","modified":1678796964512},{"_id":"source/_posts/gitTo/to11.png","hash":"3a192e38b5dbb572f6b76a601ef178aa955372f0","modified":1678882316057},{"_id":"source/_posts/gitTo/to26.png","hash":"a1049ea0442abcfd26684ab82371919fc886ce7e","modified":1678882316954},{"_id":"source/_posts/gitTo/to6.png","hash":"6c4707af30edc9cab40f401500aaed46b3b5015b","modified":1678882315910},{"_id":"source/_posts/nodeheader/hea3.png","hash":"53a2007cb3b0e072a2ad13f64350f1505ada2c34","modified":1679568393479},{"_id":"source/_posts/noderes-cc/cc1.png","hash":"7bcb649a8a1fc18ac28ce355ca052ef1776216a9","modified":1679567138520},{"_id":"source/_posts/profile/profile8.png","hash":"99471a14c625d49ffbf693d54d17789fc40916b8","modified":1678614255212},{"_id":"source/_posts/table-scroll/scroll1.png","hash":"1a55e70b705e83d03dbd05d4199a886f4c7a04c5","modified":1678362767876},{"_id":"source/_posts/useMemo的使用/memoopt1.png","hash":"429142095157fc3da99537c32fe12ff5bbaaa95d","modified":1678611763777},{"_id":"source/_posts/useMemo的使用/memoopt2.png","hash":"b402e08671173414e9ee2ae8882099a4a2e666ac","modified":1678611780934},{"_id":"source/images/bg.jpeg","hash":"58a8194ac297375485e77fabea35b5cceb726d25","modified":1678102708349},{"_id":"source/images/vue.png","hash":"a0f2ac4e058f5d591466ca4abd812a1d16f203ce","modified":1678794642812},{"_id":"source/_posts/dataPick组件日期在浏览器兼容性问题/datePick.png","hash":"ba3aebb7824649f721c4e6dfcaa999be47ba08f1","modified":1678792303063},{"_id":"source/_posts/gitRebase/rebase1.png","hash":"130b996a68081195171f2ce76c066c44382d24a1","modified":1678796964419},{"_id":"source/_posts/gitRebase/rebase5.png","hash":"2ddf52b3f89041b0a10635df89ec8fff40181442","modified":1678796964610},{"_id":"source/_posts/gitTo/to5.png","hash":"cbd2a06aef1fffc9cdc15b8f924afeeab5fa494c","modified":1678882315846},{"_id":"source/_posts/nodeheader/hea1.png","hash":"58ca621f067ccd74e22d9fe8941f754d44a4e4ce","modified":1679568393151},{"_id":"source/_posts/useMemo的使用/memoopt3.png","hash":"af967091d0564a9f76362071156950d59eb5cb27","modified":1678611735377},{"_id":"source/_posts/vux/vuex1.png","hash":"3c36e9bbc6835f95243dbadc7a99e3cbe1d002e2","modified":1678796400631},{"_id":"source/_posts/gitTo/to7.png","hash":"ae91b4a8e09b3d3ad4b9e9c0c22b27c033cf6de0","modified":1678882315955},{"_id":"source/_posts/table-scroll/scroll2.png","hash":"117cfb5a795464d8d5c06e0485c8cf9611818f40","modified":1678364003002},{"_id":"source/_posts/gitTo/to14.png","hash":"1be57d2c25a77e6fafa17cc747b0133d0980a2a9","modified":1678882316273},{"_id":"source/_posts/gitTo/to15.png","hash":"72780090d4d08888a50438540233869d0770d254","modified":1678882316307},{"_id":"source/_posts/gitTo/to16.png","hash":"1062fe3b8434c2ad06a948763208185125324dcf","modified":1678882316346},{"_id":"source/_posts/React-redux/reduxdata2.gif","hash":"2b004790ceb65c1dd60fa789bfc8eb9afbc38b26","modified":1678612472636},{"_id":"source/images/nav.png","hash":"8472786a3e6ee5fd682088fe737c198f22f1534e","modified":1678188587132},{"_id":"source/_posts/gitTo/to4.png","hash":"64a890465f657c78a92c2b437a00bf803992cdf3","modified":1678882315773},{"_id":"source/_posts/gitOne/gitOne5.gif","hash":"7767171a2f563c53915930443a8831539b2c189c","modified":1678879832283},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/blank.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1677759068560},{"_id":"themes/hexo-theme-volantis/.gitignore","hash":"634017e600d424f2f08082d7f521b73f1089d95f","modified":1677759068555},{"_id":"themes/hexo-theme-volantis/.npmignore","hash":"517c3c4cc55122fb3958764c539e94fb2f23bb04","modified":1677759068555},{"_id":"themes/hexo-theme-volantis/CHANGELOG.md","hash":"602612b2aad8c74059adc705a589cc71defd7e6a","modified":1677759068555},{"_id":"themes/hexo-theme-volantis/LICENSE","hash":"13b0862f4ed1914abe887a47df2c3ca5adfa8f3f","modified":1677759068555},{"_id":"themes/hexo-theme-volantis/_cdn.yml","hash":"1b038fdcebe11bdb58a74748beff4840c8099d66","modified":1689751015092},{"_id":"themes/hexo-theme-volantis/README.md","hash":"7c43923ced74698b0dfffb0ff1c53a70ad16e6fb","modified":1677759068555},{"_id":"themes/hexo-theme-volantis/package.json","hash":"9d96a1bf6cf39fe98961bb7df257f03716568c21","modified":1689751015094},{"_id":"themes/hexo-theme-volantis/languages/en.yml","hash":"9e595dcdc39242f19f0635f5f13490769d2eb878","modified":1677759068556},{"_id":"themes/hexo-theme-volantis/_config.yml","hash":"93a411d210b32a10d67ebb7c8752ea1a8c732ea7","modified":1689751015112},{"_id":"themes/hexo-theme-volantis/languages/zh-CN.yml","hash":"71a503cd9af4a9645a9db7a60897de1433600c74","modified":1677759068557},{"_id":"themes/hexo-theme-volantis/languages/zh-TW.yml","hash":"55ecd5f710c23964a3de62cc55a85dc46274915a","modified":1677759068557},{"_id":"themes/hexo-theme-volantis/layout/404.ejs","hash":"48e160ad704be637cafc433d2365fc0eb8bab8cb","modified":1677759068557},{"_id":"themes/hexo-theme-volantis/layout/_pre.ejs","hash":"3ac804505c282ff8b16858037c1d2bf9305c3063","modified":1677759068590},{"_id":"themes/hexo-theme-volantis/layout/archive.ejs","hash":"f99913b253f8ab22f81280a6ce5145bec3cd3de6","modified":1677759068595},{"_id":"themes/hexo-theme-volantis/layout/category.ejs","hash":"9ee883e5f73c05b3963770b74b63d7bb7e4e1ed5","modified":1677759068595},{"_id":"themes/hexo-theme-volantis/layout/docs.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1677759068595},{"_id":"themes/hexo-theme-volantis/layout/friends.ejs","hash":"4d7b154da92a9a7d9a2d1d9b40a5620585b0fd90","modified":1677759068596},{"_id":"themes/hexo-theme-volantis/layout/index.ejs","hash":"8ea7d49272b068cd1a4037846c72eb37e9823512","modified":1678529681268},{"_id":"themes/hexo-theme-volantis/layout/layout.ejs","hash":"ff5eae125358ab94b8303c2dd6863055aa387074","modified":1678543445580},{"_id":"themes/hexo-theme-volantis/layout/list.ejs","hash":"a85b2984717ee6d5058ec5635f3f287f45c3d4ba","modified":1677759068597},{"_id":"themes/hexo-theme-volantis/layout/page.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1677759068597},{"_id":"themes/hexo-theme-volantis/scripts/events/index.js","hash":"af7aaa4431393889671853db03c8b684265eaa50","modified":1677759068598},{"_id":"themes/hexo-theme-volantis/layout/post.ejs","hash":"16917af05431c049aa103744a5fb2595d5848d4c","modified":1677759068597},{"_id":"themes/hexo-theme-volantis/scripts/filters/content-visibility.js","hash":"048a8f1b80e8999d5f7a37bb8c4dabdebbebabdc","modified":1677759068601},{"_id":"themes/hexo-theme-volantis/layout/tag.ejs","hash":"696e7b1c70b4438e6a8d925f99cbc4222dd4035d","modified":1677759068598},{"_id":"themes/hexo-theme-volantis/scripts/filters/img.js","hash":"160732831bec5baf89fa07a85fec5229c3cb9cd7","modified":1677759068601},{"_id":"themes/hexo-theme-volantis/scripts/filters/replace.js","hash":"aa6fe807d7b24a60475ce8126a1be7b314cd26ba","modified":1677759068601},{"_id":"themes/hexo-theme-volantis/scripts/filters/z-lazyload.js","hash":"df6c5b0a6eff5e655d2b8de85c646ba1e5a16535","modified":1677759068602},{"_id":"themes/hexo-theme-volantis/scripts/helpers/custom-files.js","hash":"8483fcdc7dbbfde40276dc3daa1ddc5e40380360","modified":1677759068602},{"_id":"themes/hexo-theme-volantis/scripts/helpers/first-style.js","hash":"ba2e2325a365704abae3f1d204b058731e21bfbf","modified":1677759068602},{"_id":"themes/hexo-theme-volantis/scripts/helpers/getList.js","hash":"595400c37b79599f779876808e0308ead7de0a32","modified":1677759068603},{"_id":"themes/hexo-theme-volantis/scripts/helpers/related-posts.js","hash":"cab8c291a8ff460b29b3248ac86827c143aca9ee","modified":1677759068604},{"_id":"themes/hexo-theme-volantis/scripts/helpers/文章推荐.js","hash":"c1e0466407c487ddfbaf72e54291103af64530e6","modified":1677759068607},{"_id":"themes/hexo-theme-volantis/scripts/tags/btns.js","hash":"648671420faa0ac00076a8c7bb011c908b83fd5a","modified":1677759068607},{"_id":"themes/hexo-theme-volantis/scripts/tags/checkbox.js","hash":"0798edc6833d5978709ca5ed56aed33cea46e694","modified":1677759068607},{"_id":"themes/hexo-theme-volantis/scripts/tags/btn.js","hash":"e9b6e26f106505cf14a72524ab5e8b5bc85f362a","modified":1677759068607},{"_id":"themes/hexo-theme-volantis/scripts/tags/contributors.js","hash":"ce3fb8ea5407237a2a080fb7e4ed6dd4a8ee8114","modified":1677759068608},{"_id":"themes/hexo-theme-volantis/scripts/tags/fancybox.js","hash":"9b7a33c40cd322798afd2925c28078a01fdc9108","modified":1677759068608},{"_id":"themes/hexo-theme-volantis/scripts/tags/dropmenu.js","hash":"19176a6edf7acc6ad31c96961e59da526f200980","modified":1677759068608},{"_id":"themes/hexo-theme-volantis/scripts/tags/folding.js","hash":"a809988c63f358e2ae903d905dc81ed80860bacd","modified":1677759068608},{"_id":"themes/hexo-theme-volantis/scripts/tags/frame.js","hash":"e78834c005bda8f80ba86c78911b9db7566b878b","modified":1677759068609},{"_id":"themes/hexo-theme-volantis/scripts/tags/friends.js","hash":"ab78df7349252f036355ef5182ca0658a19eb6ad","modified":1677759068609},{"_id":"themes/hexo-theme-volantis/scripts/tags/ghcard.js","hash":"8a6e80141c789cc0df3809ac64dbf28e6a1254fd","modified":1677759068609},{"_id":"themes/hexo-theme-volantis/scripts/tags/image.js","hash":"63a4b3e1e3d661b6ab2b3fcfcfb657e3b632b9cb","modified":1677759068609},{"_id":"themes/hexo-theme-volantis/scripts/tags/inline-labels.js","hash":"08fbdc0ea622270e1236a28778f875c8ad2e5516","modified":1677759068610},{"_id":"themes/hexo-theme-volantis/scripts/tags/link.js","hash":"9dec9c65819d1135a7a248adaa26acbf24427cd0","modified":1677759068610},{"_id":"themes/hexo-theme-volantis/scripts/tags/md.js","hash":"355d78589b045b9b128a9d100e0ba41e3bce84b9","modified":1677759068610},{"_id":"themes/hexo-theme-volantis/scripts/tags/media.js","hash":"fb8d031b48cb3f6174948c2be0bd15fa92d8a6df","modified":1677759068611},{"_id":"themes/hexo-theme-volantis/scripts/tags/note.js","hash":"ac86ba50da98d9546522feaca672259620b053d8","modified":1677759068611},{"_id":"themes/hexo-theme-volantis/scripts/tags/pandown.js","hash":"4d6f6dab955106ade379d6c55603e1e7eb97a107","modified":1677759068611},{"_id":"themes/hexo-theme-volantis/scripts/tags/site.js","hash":"461d24b71dd1a6ff643372c05718121f516a9237","modified":1677759068612},{"_id":"themes/hexo-theme-volantis/scripts/tags/span.js","hash":"b825115f037386797efa1b0aee3a1df21629f243","modified":1677759068612},{"_id":"themes/hexo-theme-volantis/scripts/tags/swiper.js","hash":"f0171f07f494c0b0f3f8af265344add15813a676","modified":1677759068613},{"_id":"themes/hexo-theme-volantis/scripts/tags/table.js","hash":"ad82046fc64f932019d8a7b3e9a8ff07973a6c3b","modified":1677759068613},{"_id":"themes/hexo-theme-volantis/scripts/tags/tabs.js","hash":"f0054f1c970cac728b3ad289a3c531c070c06896","modified":1677759068613},{"_id":"themes/hexo-theme-volantis/scripts/tags/timeline.js","hash":"9b6b88ada712a8f3a04a825cf73a409f072ed045","modified":1677759068613},{"_id":"themes/hexo-theme-volantis/source/css/first.styl","hash":"55fe35847a1d1d831eb71288c0233efb1dd8a630","modified":1677759068636},{"_id":"themes/hexo-theme-volantis/source/css/Readme.md","hash":"cf408308dcbc62f4fc2bd5aa38303b368cc88a7e","modified":1677759068614},{"_id":"themes/hexo-theme-volantis/source/css/style.styl","hash":"00892839230a1b05a5f9d9350baacd67d894fc85","modified":1677759068637},{"_id":"themes/hexo-theme-volantis/source/js/app.js","hash":"3bf50c7fcd705d2912d5fadcca2d42a0e374efa0","modified":1677759068637},{"_id":"themes/hexo-theme-volantis/source/js/click_show_text.js","hash":"484ef52db7a7953be92093051d1a57ee4b9d26d0","modified":1678537628706},{"_id":"themes/hexo-theme-volantis/source/js/fireworks.js","hash":"fc6a166ec85191bfdc60f19f2c1905a316435414","modified":1678529030713},{"_id":"themes/hexo-theme-volantis/source/js/love.js","hash":"0d412b497424f388fd57a38be048bda81870fcc5","modified":1678528194315},{"_id":"themes/hexo-theme-volantis/source/js/snow.js","hash":"3583103eef0aa7f09274665452dc7b2d2a526600","modified":1678537339676},{"_id":"themes/hexo-theme-volantis/layout/_meta/artalkcount.ejs","hash":"94c9e591e38ac00d6beafa44de4d29e70680c673","modified":1677759068557},{"_id":"themes/hexo-theme-volantis/layout/_meta/category.ejs","hash":"bbf3ca01ebb7bf1e58f32307f8b669af10a36c51","modified":1677759068558},{"_id":"themes/hexo-theme-volantis/layout/_meta/author.ejs","hash":"68e8f198c406b6946fbf0a0f756e8a334982ba84","modified":1677759068558},{"_id":"themes/hexo-theme-volantis/layout/_meta/counter.ejs","hash":"2fbd81d196526059e1a4d43614d4c433ae697bf7","modified":1677759068558},{"_id":"themes/hexo-theme-volantis/layout/_meta/date.ejs","hash":"ba6c554dbc6c1870debb2b87c5fa25caa089be8f","modified":1677759068558},{"_id":"themes/hexo-theme-volantis/layout/_meta/music.ejs","hash":"2c1884e59131d47a82d2556ac28ef784b4ddaa10","modified":1677759068558},{"_id":"themes/hexo-theme-volantis/layout/_meta/share.ejs","hash":"0f3b1db92319734baa8da1636340839ed2d37a7b","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_meta/tags.ejs","hash":"3d6812e845b2ec82e43dd4b4563298c19cb48097","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_meta/thumbnail.ejs","hash":"60045f2bf695b4be5ad3fd19db46890f1cdee68a","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_meta/updated.ejs","hash":"edf445ad8153419a5dc7c4ec4c8490967cd9d33d","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_meta/walinecount.ejs","hash":"038b1c17a316f4611812c3e1056d7aef91de6910","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_meta/wordcount.ejs","hash":"eebaab3821af95ee64d8d56f33ca6c9c60b9b6f0","modified":1677759068559},{"_id":"themes/hexo-theme-volantis/layout/_partial/archive.ejs","hash":"d5f776437c108c72c002b11f1d23d30b50e0079a","modified":1677759068561},{"_id":"themes/hexo-theme-volantis/layout/_partial/article.ejs","hash":"44f3466ca0ffaabe9cdc51e2e5ca7f5891a989de","modified":1687326172803},{"_id":"themes/hexo-theme-volantis/layout/_partial/categories.ejs","hash":"c2bc61780cab948ef8ab5076511ebccacab1cd79","modified":1677759068562},{"_id":"themes/hexo-theme-volantis/layout/_partial/cover.ejs","hash":"53cb6c2b2af0386c1d2fe4a7d1cf67a6d0457393","modified":1677759068563},{"_id":"themes/hexo-theme-volantis/layout/_partial/footer.ejs","hash":"fd48b63b60dc8aa69280e6d4fec3ebdc70a495f4","modified":1677759068563},{"_id":"themes/hexo-theme-volantis/layout/_partial/head.ejs","hash":"577c937231054c265f6cf2c54539e4626962c68f","modified":1677759068563},{"_id":"themes/hexo-theme-volantis/layout/_partial/header.ejs","hash":"2201789620e181b205c90f2907de0c47e0390ae5","modified":1677759068563},{"_id":"themes/hexo-theme-volantis/layout/_partial/meta.ejs","hash":"ced9c966a9f4d84e485c325ef3551be218ddd033","modified":1677759068564},{"_id":"themes/hexo-theme-volantis/layout/_partial/post.ejs","hash":"7d144c80f2980efaab6198512746c0c5d77f03db","modified":1677759068564},{"_id":"themes/hexo-theme-volantis/layout/_partial/side.ejs","hash":"27f9df84585ffb24e2ba2423761f90f690c65787","modified":1677759068571},{"_id":"themes/hexo-theme-volantis/layout/_widget/_pre.ejs","hash":"2a738e0a4f93339b6a51fc124400fa5a8b2640bc","modified":1677759068591},{"_id":"themes/hexo-theme-volantis/layout/_widget/blogger.ejs","hash":"d68c203ff6d3c4024a7d946c3fc3b65aa276a95b","modified":1677759068591},{"_id":"themes/hexo-theme-volantis/layout/_widget/copyright.ejs","hash":"a93a1f181e9f2dfe01556b0b101b0f8d85e7769f","modified":1677759068591},{"_id":"themes/hexo-theme-volantis/layout/_widget/category.ejs","hash":"d423a2b15a8e267454c7521d6203b7188e5f5e75","modified":1677759068591},{"_id":"themes/hexo-theme-volantis/layout/_widget/grid.ejs","hash":"ce6caf29104ed62efccdcb5bc23aa4a50f6c1286","modified":1677759068592},{"_id":"themes/hexo-theme-volantis/layout/_widget/group.ejs","hash":"2eed9614049441b51e6819f393f80faf5441870b","modified":1677759068592},{"_id":"themes/hexo-theme-volantis/layout/_widget/header.ejs","hash":"b132e332ddf12d1bb1d99480200561d8c38edd04","modified":1677759068592},{"_id":"themes/hexo-theme-volantis/layout/_widget/lastupdate.ejs","hash":"4668b511f660da0c8e76181c8aa840092c540483","modified":1677759068592},{"_id":"themes/hexo-theme-volantis/layout/_widget/list.ejs","hash":"18a352d9d84d9abec51644d1e89829b1aa0c9f49","modified":1677759068593},{"_id":"themes/hexo-theme-volantis/layout/_widget/music.ejs","hash":"47c578384a870d32adf3969d9bebf0c3f5766682","modified":1677759068593},{"_id":"themes/hexo-theme-volantis/layout/_widget/page.ejs","hash":"264fc908e7b8972310396f1cf03186d1d71a5a8b","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/load.ejs","hash":"c4746b7f538d08df034a39dbf94ad2432b6bf845","modified":1677759068593},{"_id":"themes/hexo-theme-volantis/layout/_widget/qrcode.ejs","hash":"6b9e27bd3a88e9d8ae69b746e042bf9e3aa19ba5","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/references.ejs","hash":"08f2dbd23fc9835f4c24bdda4cf288593d61c25a","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/related_posts.ejs","hash":"ec750915735bdf88ad258c3450d41fce148c89c8","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/tagcloud.ejs","hash":"1a44b7b317871193becb1a7bc2132192c00f0b98","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/text.ejs","hash":"7c37bb1a302cc4fb75ac51451cdd15acad603993","modified":1677759068594},{"_id":"themes/hexo-theme-volantis/layout/_widget/toc.ejs","hash":"a89e47426e2abf79c695661f56963caaccb9a954","modified":1677759068595},{"_id":"themes/hexo-theme-volantis/layout/_widget/webinfo.ejs","hash":"ab83ae57a679d7da724924328adf25f0ef1533ae","modified":1677759068595},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/cdn.js","hash":"adf2a07d3adef7b79ffa33291b843410fe4371fe","modified":1677759068598},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/check-environment.js","hash":"9d29a3f34ea715a0dc7cb5c2f76b5713d718e6e6","modified":1677759068599},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/check-configuration.js","hash":"92798f82a1947f3d2ff3413fe4bf2b7be0dfe904","modified":1689751015095},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/config.js","hash":"501968a736d73e6a34e8ef833c54bfa89d0190e2","modified":1677759068599},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/render-stylus.js","hash":"36c2f32d2101eaa84041daf70393df6f3a3fa331","modified":1677759068599},{"_id":"themes/hexo-theme-volantis/scripts/events/lib/stellar-tag-utils.js","hash":"8d62893faf26d15d2833f8090bd6257a7282f5e2","modified":1677759068600},{"_id":"themes/hexo-theme-volantis/scripts/helpers/head/autoCanonical.js","hash":"f3ea74759129c71041371a1d77c687eb6aa88d3a","modified":1677759068603},{"_id":"themes/hexo-theme-volantis/scripts/helpers/head/generate_preload_fontfamily.js","hash":"d37dbe38fa9125fdce99b2ef9e92582ed08eea82","modified":1677759068604},{"_id":"themes/hexo-theme-volantis/scripts/helpers/head/generate_seo.js","hash":"e0059a60cc5978be6792dcf795a2ece3a509f41a","modified":1677759068604},{"_id":"themes/hexo-theme-volantis/scripts/helpers/head/generate_title__keywords__description.js","hash":"179a07b7b2270398216a34d79595d98e30962b22","modified":1677759068604},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/index.js","hash":"bcb770787c77e39cdc156b7fd58cde8e00b79153","modified":1677759068605},{"_id":"themes/hexo-theme-volantis/source/css/_defines/AutoPrefixCSS.styl","hash":"c76f624d332c59b73c1d6b95b30b2afb560976eb","modified":1677759068615},{"_id":"themes/hexo-theme-volantis/source/css/_defines/effect.styl","hash":"47db4f84182194a8a233931424c9bc79c6cf0117","modified":1677759068616},{"_id":"themes/hexo-theme-volantis/source/css/_defines/Readme.md","hash":"77d9e986d24898b98eba2010185951fd1fb8b95c","modified":1677759068615},{"_id":"themes/hexo-theme-volantis/source/css/_defines/fonts.styl","hash":"fa199b11b568a6b0d6fc4e87ef12ab36ac254966","modified":1677759068616},{"_id":"themes/hexo-theme-volantis/source/css/_defines/func.styl","hash":"430adedc7e6f57013e54d15e6f8dce21e9ea2579","modified":1677759068617},{"_id":"themes/hexo-theme-volantis/source/css/_defines/layout.styl","hash":"d1bdce2e7974b1feb585adcdf95e36a054a36ec4","modified":1677759068617},{"_id":"themes/hexo-theme-volantis/source/css/_defines/color.styl","hash":"02d9bbe630f33ec2c604cb8acdddbe28431fcb05","modified":1677759068616},{"_id":"themes/hexo-theme-volantis/source/css/_first/base_first.styl","hash":"2db7ec30d52473fa40bca89dcd29854498e8ca3e","modified":1677759068617},{"_id":"themes/hexo-theme-volantis/source/css/_first/cover_first.styl","hash":"32f0e09eba832607165096c68f70698a75d685b5","modified":1677759068617},{"_id":"themes/hexo-theme-volantis/source/css/_first/fontfamily_first.styl","hash":"5024a9162f4787ac4234d5b8549fad40dbecf865","modified":1677759068618},{"_id":"themes/hexo-theme-volantis/source/css/_first/navbar_first.styl","hash":"e268d81dc78fdf9758d314cdc5cc087aec1c70e6","modified":1677759068619},{"_id":"themes/hexo-theme-volantis/source/css/_first/dark_first.styl","hash":"bcb419588c1972bd47869309dea43ff319440d33","modified":1677759068618},{"_id":"themes/hexo-theme-volantis/source/css/_first/search_first.styl","hash":"955c9eb68b90b97dba0bd27909347cfc91ce68c5","modified":1677759068619},{"_id":"themes/hexo-theme-volantis/source/css/_style/index.styl","hash":"835b3640c257cd229b20c088536b053b92c9796c","modified":1677759068636},{"_id":"themes/hexo-theme-volantis/source/js/plugins/aplayer.js","hash":"95f2e47535c8d37e90cab7726d25845cf01ca477","modified":1677759068637},{"_id":"themes/hexo-theme-volantis/source/js/plugins/rightMenus.js","hash":"259af60ccfcdd06c97f7d540bed5359abeb2a650","modified":1689751015099},{"_id":"themes/hexo-theme-volantis/source/js/plugins/parallax.js","hash":"3c3210bde6e86d7d157c34c14796abe98cb1bbd0","modified":1677759068638},{"_id":"themes/hexo-theme-volantis/source/js/search/hexo.js","hash":"bed5846e373244ab851b50f21337f8d12270d638","modified":1677759068639},{"_id":"themes/hexo-theme-volantis/source/js/search/meilisearch.js","hash":"833816876a74646bfdd395c05985c8b64c0856a2","modified":1677759068640},{"_id":"themes/hexo-theme-volantis/source/js/search/algolia.js","hash":"97591a9f07c6d235cb8df01bbd699bfec67c321e","modified":1677759068639},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/featured.ejs","hash":"7abe0c7080dfcec063b4f52e4ca569bf0510c7c1","modified":1677759068560},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/focus.ejs","hash":"dc3be6ba920a8332e4a20bc07c599e79dae10818","modified":1678608485529},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/layout.ejs","hash":"39a463ce33ce6138d40055e72118941515ba2f63","modified":1677759068561},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/search.ejs","hash":"2f536370d1b51fa7c33798be21e690638f0df74e","modified":1677759068561},{"_id":"themes/hexo-theme-volantis/layout/_partial/_cover/dock.ejs","hash":"7abe0c7080dfcec063b4f52e4ca569bf0510c7c1","modified":1677759068560},{"_id":"themes/hexo-theme-volantis/layout/_partial/scripts/_ctrl.ejs","hash":"ccd73af4ac2cacf5d484d36374e17c263b1a5a13","modified":1677759068564},{"_id":"themes/hexo-theme-volantis/layout/_partial/scripts/config.ejs","hash":"0d07aac1b6e02714cb76284eb156e278b533b128","modified":1677759068565},{"_id":"themes/hexo-theme-volantis/layout/_partial/scripts/index.ejs","hash":"1e882f43af4c9bda658fd1825775924e5c38b725","modified":1689751015092},{"_id":"themes/hexo-theme-volantis/layout/_partial/scripts/global.ejs","hash":"69bb5fae2bdc6f391ff36e3c29ee067a63717d83","modified":1677759068570},{"_id":"themes/hexo-theme-volantis/layout/_plugins/analytics/script.ejs","hash":"84d80907189e66730772984fca426fbb487c7709","modified":1677759068576},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/index.ejs","hash":"462334ae298659214464f3a8af3da1c514cf76e1","modified":1677759068573},{"_id":"themes/hexo-theme-volantis/layout/_plugins/aplayer/script.ejs","hash":"51d49a076c30e57efe14ce3575018d3c226a2741","modified":1677759068576},{"_id":"themes/hexo-theme-volantis/layout/_plugins/aplayer/layout.ejs","hash":"822212208fbbb4fa189abc503cd14b9b6e385901","modified":1677759068576},{"_id":"themes/hexo-theme-volantis/layout/_plugins/chat/index.ejs","hash":"56d2e577fbd08859e118cfb1d1b8d230850a3675","modified":1677759068577},{"_id":"themes/hexo-theme-volantis/layout/_plugins/content-visibility/script.ejs","hash":"837f89fa589ad74ad28a1436a90f5283ee4fcb92","modified":1677759068584},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/index.ejs","hash":"3d781c01f494b89d1d31d3210c100c822787c9b7","modified":1677759068581},{"_id":"themes/hexo-theme-volantis/layout/_plugins/darkmode/script.ejs","hash":"4b492f244d69a36ec8c01353648b45bd3bd2664c","modified":1677759068585},{"_id":"themes/hexo-theme-volantis/layout/_plugins/github-api/script.ejs","hash":"230071963d5f599a8e2fd55bf13f9c40a53851d3","modified":1677759068586},{"_id":"themes/hexo-theme-volantis/layout/_plugins/end-of-support/script.ejs","hash":"b415d8e5dfca4a47c199b1adeb220ff57eaec219","modified":1677759068585},{"_id":"themes/hexo-theme-volantis/layout/_plugins/highlight/script.ejs","hash":"06befe70f47454fbfaa95245fe4cdb8d4f6f9f3c","modified":1677759068586},{"_id":"themes/hexo-theme-volantis/layout/_plugins/lazyload/script.ejs","hash":"072020c969763742de5b78ae8653a71d753232eb","modified":1677759068586},{"_id":"themes/hexo-theme-volantis/layout/_plugins/nodewaves/script.ejs","hash":"72c937530f0a6bef00e225377266752a60f4e083","modified":1677759068587},{"_id":"themes/hexo-theme-volantis/layout/_plugins/pace/script.ejs","hash":"571cc2d9cd15cc4df21d34394a75dec083c6256f","modified":1677759068587},{"_id":"themes/hexo-theme-volantis/layout/_plugins/parallax/script.ejs","hash":"8465663815c089a367cdd35862d5bad68d0545f7","modified":1677759068587},{"_id":"themes/hexo-theme-volantis/layout/_plugins/preload/script.ejs","hash":"f35821683c3bac5e898face2f74135a52bec5254","modified":1677759068588},{"_id":"themes/hexo-theme-volantis/layout/_plugins/rightmenus/layout.ejs","hash":"de6d7f3d274617edfb8f9f71b652d5dbdaba9bad","modified":1677759068588},{"_id":"themes/hexo-theme-volantis/layout/_plugins/search/script.ejs","hash":"a9e0939ae1c58fc7419eaf2c5e5664be8da6dccb","modified":1677759068589},{"_id":"themes/hexo-theme-volantis/layout/_plugins/slow-network/script.ejs","hash":"5a2f3eaadb6dbe4350e6d32094a0bad62ba240bc","modified":1677759068589},{"_id":"themes/hexo-theme-volantis/layout/_plugins/swiper/script.ejs","hash":"1c1ca7640311d176123260642ca9fca3242b220f","modified":1677759068590},{"_id":"themes/hexo-theme-volantis/layout/_plugins/share/layout.ejs","hash":"017e6315b814bfdfd230ac681b83231f7b8867b7","modified":1677759068589},{"_id":"themes/hexo-theme-volantis/layout/_plugins/scrollreveal/script.ejs","hash":"09ca33499a24acf08af6e619e16354e2d13000a2","modified":1677759068588},{"_id":"themes/hexo-theme-volantis/layout/_plugins/toc/script.ejs","hash":"a51b1e0c57301a77857c2b1b334b172050494a5f","modified":1677759068590},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/blogposting.js","hash":"f8543b0460c9a5b23ee43d8ed49e018c1c627439","modified":1677759068605},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/breadcrumblist.js","hash":"df6316082af2df061f16bb01d5b5d3478f98c662","modified":1677759068605},{"_id":"themes/hexo-theme-volantis/source/css/_style/_base/base.styl","hash":"712eb4803dc595eb111ebd89546e6ed3fb1ec7ce","modified":1677759068619},{"_id":"themes/hexo-theme-volantis/source/css/_style/_base/fontfamily_async.styl","hash":"48c006682b8f44681662e4b0f8d3ebfdf85add69","modified":1677759068619},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/config.js","hash":"e4c3c23e58f0bac72010f962d92da641445e748a","modified":1677759068606},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/index.js","hash":"41e4af773dfb4755752cb74a6d70e4b5b0c1ce4d","modified":1677759068606},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/organization.js","hash":"02c08f0362aec5d310b8c7e69823cd88ed49ea5e","modified":1677759068606},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/person.js","hash":"afca448311d62a44566d9471594a43495a6be6db","modified":1677759068606},{"_id":"themes/hexo-theme-volantis/scripts/helpers/structured-data/lib/website.js","hash":"556f28164d31b3898d06cb8f76472bc6547bb1db","modified":1677759068606},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/archive.styl","hash":"a96709230abbc8d4fc40361b8fc02d4249abb4a1","modified":1677759068620},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/article.styl","hash":"de23aac33b178c59531ef45168e98a0d98ad6151","modified":1677759068621},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/footer.styl","hash":"bb850b4707ee025e267e079fcf85484849cf4f41","modified":1677759068621},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/friends-simpleuser.styl","hash":"07c477e15bf75615faff5587cc82dbc6004a901a","modified":1677759068621},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/friends-traditional.styl","hash":"2da0419cd5874d03d7d5bafdb081beb6cb786608","modified":1677759068622},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/img.styl","hash":"55d79f07b717d3e28515b41401f656d1593be624","modified":1677759068622},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/loading.styl","hash":"56a2b9f46edd5b87e49d11647dc9396b0d833d54","modified":1677759068622},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/main.styl","hash":"92f948df742f3de6d69a180b7653827c7242f1d3","modified":1677759068623},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/md.styl","hash":"d9b25d8199d3d5260c89e8ad84f1a17531b85588","modified":1677759068623},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/pagination.styl","hash":"65dacf95771fc518a06cbf301f4c0b06201d7321","modified":1677759068623},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/posts.styl","hash":"31cf7bdbb44caa173f3dfd49d98157cb6be85c6f","modified":1677759068624},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/search.styl","hash":"fdabe3b9a14040f86c0a715ab48f26bfb8a3f7bc","modified":1677759068624},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/snackbar.styl","hash":"752a7fea5284a61fd9305d3b0fcaa43f2e64862f","modified":1677759068625},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/sidebar.styl","hash":"5ef848e92b890ac33f7cd82a5e36d73b6e08b241","modified":1689751015096},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/toc.styl","hash":"3346fbcbcbc2533997a8bf1fbbf801d9120b03ab","modified":1677759068625},{"_id":"themes/hexo-theme-volantis/source/css/_style/_layout/video.styl","hash":"680e8cf8fc5d62913dad4ccd06135caad2bb3e92","modified":1677759068625},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/contributors.js","hash":"d9f6a153494fe5ff78382322f8f236a4d81ec482","modified":1677759068638},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/friends.js","hash":"d9fa94b4e54bd739bf8d32e2be313a750386a639","modified":1677759068638},{"_id":"themes/hexo-theme-volantis/source/js/plugins/tags/sites.js","hash":"e29b1908689477f3ef19987b0cc65505c7d514ac","modified":1677759068639},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/cursor.styl","hash":"bc055048c7d017be8cf25a3385f516656c96cf66","modified":1677759068630},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/fontcolor.styl","hash":"fa13f91f8be68b62210048d1481c3b23e23f939b","modified":1677759068630},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/aplayer.styl","hash":"da809e1dde8adb9d1c98f0daeb52a2d920d497f7","modified":1677759068630},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/gitalk.styl","hash":"c4c9950fd6654f87ca4f481cf3065ca4069fac48","modified":1677759068631},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/index.styl","hash":"7e7ff90914f36e60e837c71a3435659499fb52d9","modified":1689751015097},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/mathjax.styl","hash":"11ee86571f31f9aa61dcc48b40977dcd974d76a4","modified":1677759068632},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/message.styl","hash":"995b46084664f2ed2cf025c1a208089ecfe1147e","modified":1677759068632},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/Readme.md","hash":"51986550e80990e1db23e2ee4165e5e4800e4b9f","modified":1677759068632},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/btns.styl","hash":"bf592cd78c146bb671217f106632b9e5bcc7c145","modified":1677759068632},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/checkbox.styl","hash":"8c62dd38914d939069d9222c54787a24cb5c31f7","modified":1677759068632},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/dropmenu.styl","hash":"a136ebb90bedef15c1d8b8d75e09b37c3873f5e8","modified":1677759068633},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/fancybox.styl","hash":"1b4709787f9bda8ce565aa9a4aaf7f1f58751b44","modified":1677759068633},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/folding.styl","hash":"253f13e60218e0d014a1df99933f5cdba507f3b1","modified":1677759068633},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/frame.styl","hash":"6ffbb29514781aa4fa7d7653706554ce33f4525b","modified":1677759068633},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/friends.styl","hash":"8f9e60b94c02197e4555f923d357017742bf8d7b","modified":1677759068633},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/ghcard.styl","hash":"58adb206695a704b1f40df42e2dc10e9e9055aeb","modified":1677759068634},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/image.styl","hash":"bb4b07841602592e421597ba8dd7110edec789d8","modified":1677759068634},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/link.styl","hash":"82cdcc537612eec3e1af40d00edf80b14116c191","modified":1677759068634},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/media.styl","hash":"576c9eede3a8f9ec2ba1a970e92a49154ec3acb3","modified":1677759068634},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/note.styl","hash":"005d3c55c2216d7c88661f79ad466ad89fad4784","modified":1677759068634},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/sites.styl","hash":"01593f3b8a233bc2c3193796707e4ed77df217bb","modified":1677759068635},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/swiper.styl","hash":"819385594f1825e26074ade900835a3f4031fe42","modified":1677759068635},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/span.styl","hash":"6e9f8b453244d9241d3fceed0a56e12c86a4b446","modified":1677759068635},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/table.styl","hash":"ef07ab4fe8a391ea9039fbe53333aaf58e3ce033","modified":1677759068635},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/tabs.styl","hash":"a2366f4fe1d9f06e47a7a994cfc80a1edbf6c535","modified":1677759068635},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/tag.json","hash":"506f87e397f258b097ba24ce16c33b5353bab462","modified":1677759068636},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/text.styl","hash":"b2c2f3946fb611ad052c61d7309098edbf494c86","modified":1677759068636},{"_id":"themes/hexo-theme-volantis/source/css/_style/_tag-plugins/timeline.styl","hash":"f84f411a3b7dcdbfd4fb19ac4e0f91300c5e19be","modified":1677759068636},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/artitalk/index.ejs","hash":"0e716837d0febab52d3783832eda893b4785c776","modified":1677759068572},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/fcircle/index.ejs","hash":"b588fae12a89c9a0078c39f301a106460ee7e7a0","modified":1677759068573},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/bbtalk/index.ejs","hash":"458661a5d1b4e549e6564d38d9df1d276a917002","modified":1677759068572},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/gitter/index.ejs","hash":"85baf33f1c90eca55ee91eb8d0955b2770909443","modified":1677759068573},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/indent/index.ejs","hash":"7d112cde9b8d1785d8c541cde94361e0bfc60f30","modified":1677759068573},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/katex/index.ejs","hash":"c42b9d80ae66e804d0c37b29a04ce643ea78f005","modified":1677759068575},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/mathjax/index.ejs","hash":"917593e8966621a9d4c1e739f9b0b1e175d2687f","modified":1677759068575},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/snackbar/index.ejs","hash":"bddb75f7112d2b438f462a6ebef79810ef5ac291","modified":1677759068576},{"_id":"themes/hexo-theme-volantis/layout/_plugins/chat/gitter/script.ejs","hash":"e4f06c50c23d433a0e63fc703a35704c336ba090","modified":1677759068577},{"_id":"themes/hexo-theme-volantis/layout/_plugins/chat/tidio/script.ejs","hash":"bb678b5e8a9fb87fc1c1e48914da3a1a052a8e02","modified":1677759068577},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/artalk/script.ejs","hash":"f365c321a12c27e8796f0713b4cf69636f90b4b8","modified":1689751015093},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/discuss/script.ejs","hash":"f088f02c8ca9ae9eb434f906320ad54145c7d5f5","modified":1677759068578},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/disqus/script.ejs","hash":"42073427f301403c885f21168f804127583d7c16","modified":1677759068579},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/disqusjs/script.ejs","hash":"1c031f73e28faa8a72aab3d0272dc09981c19cb6","modified":1677759068579},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/gitalk/script.ejs","hash":"576841484dca739aeb41d4763a3c0b71dce02683","modified":1677759068580},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/giscus/script.ejs","hash":"472a5267d8b557699e062723b189ce4d7949e71a","modified":1677759068580},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/hashover/script.ejs","hash":"1852d00413991ad1968b43232eefd48e50fba861","modified":1677759068580},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/isso/script.ejs","hash":"27608c396eb8b0d54a87e0dc58bf675ad5711549","modified":1677759068581},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/livere/script.ejs","hash":"c7f7dfbfc5d51f5c6eeb7d562acb6c5222e4e950","modified":1687326412477},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/twikoo/script.ejs","hash":"8532298f430cd2a032f14359541816b1809dbc3c","modified":1677759068582},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/beaudar/script.ejs","hash":"ac577e21ec4872738f197d63a0a4e21704e042dc","modified":1677759068578},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/utterances/script.ejs","hash":"d1bc3bc83d554158f943e9a3755595242cd7fd11","modified":1677759068583},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/vssue/script.ejs","hash":"7bc0f788a3039a1dcf3a78438466b4b8cb97f811","modified":1677759068583},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/waline/script.ejs","hash":"810ee7bd496485b69e0d61d7fb8e2615960b57c0","modified":1677759068583},{"_id":"themes/hexo-theme-volantis/layout/_plugins/comments/z-custom/script.ejs","hash":"e5cfe25fb88b7a3dd0c68e20b2e17d44eb2a1f04","modified":1677759068584},{"_id":"themes/hexo-theme-volantis/layout/_plugins/highlight/highlightjs/script.ejs","hash":"1624bee754dbc9d3a227563e61180b6c34579917","modified":1677759068586},{"_id":"themes/hexo-theme-volantis/layout/_plugins/highlight/prismjs/script.ejs","hash":"46b987c826a9fa1bfa92976188d28b8a33bfa2c4","modified":1677759068586},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/index.styl","hash":"6c681c760fa63425e7564c0d68532bb5ac95690a","modified":1677759068628},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_dark/dark_async.styl","hash":"a5da6f0b232a767057321fa51e382fd2d86bd98d","modified":1677759068626},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_rightmenu/rightmenu.styl","hash":"ef456a92173c303b61015f3581450aa14f0d2b41","modified":1677759068629},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_dark/dark_plugins.styl","hash":"b6db5d55fc6d7118d3c75a770fbd60edcc47f85a","modified":1689751015096},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_rightmenu/reading.styl","hash":"cb01065424dbd32c79b973b06fcdbc1c72917bc6","modified":1677759068629},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/clipboard.styl","hash":"6818ba853fd6a319ff4eb50d228b1d625db9a0fd","modified":1677759068627},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/index.styl","hash":"38089b686a0cfdde555539c1c0c5b3fe402afada","modified":1677759068628},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/color.styl","hash":"319ccc46d5d387ee14a22e0de1a518288331629b","modified":1677759068627},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/highlightjs/language.styl","hash":"4fade2fe067f557d3b420d0b9a9d88d18feb9a72","modified":1677759068628},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/clipboard.styl","hash":"0f92935e3bb9732b6e1cc7f305577144f1fe99a8","modified":1677759068628},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/index.styl","hash":"215face68fab1c31cfa8d4c21941c72efe54cb78","modified":1677759068628},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/_highlight/prismjs/language.styl","hash":"3af7fae25a0e2c54f0aacb1d8cbe383d5c1e60a5","modified":1677759068629},{"_id":"source/_posts/prop的单向数据流/data1.png","hash":"d8cbb62ee1ba3df95de417baa6dbca4213de4e30","modified":1678795613690},{"_id":"source/_posts/gitOne/gitOne4.gif","hash":"8281db543e5302ada098b898a2005befc011e1d8","modified":1678879758360},{"_id":"source/images/avatar.png","hash":"9358c57042e1357a321bfd10b9a27762053f67bf","modified":1678104809007},{"_id":"source/_posts/gitOne/gitOne1.gif","hash":"699468200cba94b7b5d66c2fd0b4a7d3b5fe0c05","modified":1678879526029},{"_id":"public/404.html","hash":"7211c42eee0c8b32fae2c70cb76f9dd00fa19573","modified":1687314506620},{"_id":"public/about/index.html","hash":"02e46c508689ad0dd350d490e22aed4eb3217d26","modified":1687314506620},{"_id":"public/categories/index.html","hash":"3ccbf7dccf248bdee3fdd0fcd972f6ee50545198","modified":1687314506620},{"_id":"public/friends/index.html","hash":"29421e391f5dbb52d23f5572d44dd1fcfe5391a2","modified":1687314506620},{"_id":"public/tags/index.html","hash":"7a2be33e2567660db993de8052d2fd90e0900a2a","modified":1687314506620},{"_id":"public/2022/05/20/npminstall/index.html","hash":"e82e9240a22d362710210b9d88dc1d694fdc3054","modified":1687314506620},{"_id":"public/2022/05/16/nodejoi/index.html","hash":"17a479cbed51c5261cab63b1e56032181f290cca","modified":1687314506620},{"_id":"public/2022/04/22/webpack-opt/index.html","hash":"c4e5d0619192a25528ae09ad6ea563017ed78041","modified":1687314506620},{"_id":"public/2022/04/20/nodeheader/index.html","hash":"d244df1ecfeb71f5b36d48d3bf2e2c33faa9922b","modified":1687314506620},{"_id":"public/2022/04/16/nodebody/index.html","hash":"dced522364162469fce196232b0bee8bfd5fbb50","modified":1687314506620},{"_id":"public/2022/04/10/nodenotfound/index.html","hash":"8985c3472de8cd89264d9690f88496211f0319e5","modified":1687314506620},{"_id":"public/2022/03/22/noderes-cc/index.html","hash":"800c0496ca32a38c33104e16fd906ad6463f4953","modified":1687314506620},{"_id":"public/2022/03/22/webpackConfig/index.html","hash":"d7d4beb4b2cea642f65a010d3587af4566aa17a9","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/index.html","hash":"0c04c7640a818ddb3326cd1e2b4338b635900d57","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/index.html","hash":"b9d772ae88871c3afad1e440a61b8c0d889ed5c2","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/index.html","hash":"3da66dc4cc819d29464641cee4ad1044d360c831","modified":1687314506620},{"_id":"public/2021/11/16/vux/index.html","hash":"720693c8802971126ef7f89a2473459930b831d3","modified":1687314506620},{"_id":"public/2021/10/14/vue报错one/index.html","hash":"717448af5c42cfd74344fae0aefa8684a0fcdb79","modified":1687314506620},{"_id":"public/2021/09/04/prop的单向数据流/index.html","hash":"f766cc6c8ef61dca6c54e65d2810a2d3f0851be1","modified":1687314506620},{"_id":"public/2021/08/16/watch和computed的区别/index.html","hash":"da32a95b23327631e4b0b1ce00fd0d0a3361edea","modified":1687314506620},{"_id":"public/2021/08/04/vue数据代理的原理/index.html","hash":"77bef598d06cc651c87b50a63f5dd95f43625d3c","modified":1687314506620},{"_id":"public/2021/07/04/vue响应式原理/index.html","hash":"fa93ed6fd6a7d20c67e4ef469f219af490416f7d","modified":1687314506620},{"_id":"public/2021/06/04/PromiseTo/index.html","hash":"57b15c29c030f039cfcd2fd1efa15858831ffb90","modified":1687314506620},{"_id":"public/2021/06/01/PromiseOne/index.html","hash":"226215b773824f657eced481a20c6b58e719b5b3","modified":1687314506620},{"_id":"public/2021/05/29/Promiseall/index.html","hash":"e4c72b45a49a8ac2260bb4e09bd15471931678b4","modified":1687314506620},{"_id":"public/2021/05/28/过滤文本框表情符号/index.html","hash":"2f1ab3c73729ec5fd092357223d9a65ff7dbf1a9","modified":1687314506620},{"_id":"public/2021/05/25/dataPick组件日期在浏览器兼容性问题/index.html","hash":"10f53d9e74326303ba8bc025cb48ec9fae051e62","modified":1687314506620},{"_id":"public/2021/05/21/前端图片压缩解决办法/index.html","hash":"d3200a5eb62ba0215fd7f1fdeb9ceb5f898dcf0d","modified":1687314506620},{"_id":"public/2021/04/28/React报错/index.html","hash":"a1cb5c52291c578ed70290dda226ac9ab1a2381e","modified":1687314506620},{"_id":"public/2021/04/28/React组件的状态下移和内容提升/index.html","hash":"3dbc4bd43cc87d521a5e405491da40378a25058d","modified":1687314506620},{"_id":"public/2021/04/25/react-fiber/index.html","hash":"3e14bc6b558a2835f4bb4aaa9ea7c4a8eea76c37","modified":1687314506620},{"_id":"public/2021/04/21/useMemo使用误区/index.html","hash":"eedee4605b33fec57121a7694dc7b710a2f1b53a","modified":1687314506620},{"_id":"public/2021/03/21/table-scroll/index.html","hash":"be6ddb977db035615fcefa2b1f9fd48296aad8d3","modified":1687314506620},{"_id":"public/2021/03/15/useMemo的使用/index.html","hash":"5f441a2dd149adb9dc6e2584c924145110074563","modified":1687314506620},{"_id":"public/2021/03/14/React-redux/index.html","hash":"296c9345f9d35e4c44fae76f0535fd23c86e8ec0","modified":1687314506620},{"_id":"public/2021/02/21/profile/index.html","hash":"509aa7563f1366e2b3b06de14b8963113eb25a87","modified":1687314506620},{"_id":"public/archives/index.html","hash":"aa2e9ac802c3a569a86ebcf9130dfb4f8ed23d7b","modified":1687314506620},{"_id":"public/archives/page/2/index.html","hash":"28a7c4d842cf8c3bb6b38e7354074cfc6c4dfe0b","modified":1687314506620},{"_id":"public/archives/page/3/index.html","hash":"57aa1ef19463431f181d36a870fd169b8e777065","modified":1687314506620},{"_id":"public/archives/page/4/index.html","hash":"0acee4173450fc03f496943ab125082530f24392","modified":1687314506620},{"_id":"public/archives/2021/index.html","hash":"e6e981b4c53696a3d5aaa67d02b5a6b25b531bf6","modified":1687314506620},{"_id":"public/archives/2021/page/2/index.html","hash":"c93f32e78e9dd82a8d456924cb8e2703898c5cb2","modified":1687314506620},{"_id":"public/archives/2021/page/3/index.html","hash":"741b6897f037b9c5b800156d43d1c6c428fff93e","modified":1687314506620},{"_id":"public/archives/2021/02/index.html","hash":"55faa59b7b51ab339af997f36f971cee69beb7f9","modified":1687314506620},{"_id":"public/archives/2021/03/index.html","hash":"26784aca9e2a913ce7f3cf1f09487f71fdab03b6","modified":1687314506620},{"_id":"public/archives/2021/04/index.html","hash":"8dafb1ea85348fd7af8f8f822c63af52b9ff1101","modified":1687314506620},{"_id":"public/archives/2021/05/index.html","hash":"64c81d19624c80ef6df09fe2cbc29a515a738774","modified":1687314506620},{"_id":"public/archives/2021/06/index.html","hash":"9732867267de8a50f122f7b80a381d0abda666f7","modified":1687314506620},{"_id":"public/archives/2021/07/index.html","hash":"db2b697b39630bf25083f1595ca37bc725cbe776","modified":1687314506620},{"_id":"public/archives/2021/08/index.html","hash":"ebd0e4e673ddbebb2312af4effee404d45658868","modified":1687314506620},{"_id":"public/archives/2021/09/index.html","hash":"156dbedbd29b792d49df04be366e2f7bb77c007a","modified":1687314506620},{"_id":"public/archives/2021/10/index.html","hash":"f6755f06de982caa8b45d0cab2a048fc36f434e5","modified":1687314506620},{"_id":"public/archives/2021/11/index.html","hash":"eb4bbd1849d4da87380189f66465634dafe8ef76","modified":1687314506620},{"_id":"public/archives/2021/12/index.html","hash":"908dce15d78770cb96aa9d108bf40c60ce5ee630","modified":1687314506620},{"_id":"public/archives/2022/index.html","hash":"1b91764fb5d7219d53580296a994c3cadaeefc9f","modified":1687314506620},{"_id":"public/archives/2022/01/index.html","hash":"0dee291c4ce6c50d942dc11104771b3bc12f637a","modified":1687314506620},{"_id":"public/archives/2022/02/index.html","hash":"d149a48ccbd39d1301f8f105ca853c9bc0a10849","modified":1687314506620},{"_id":"public/archives/2022/03/index.html","hash":"db8dff603460cd63a9520a2df538f1944ffada72","modified":1687314506620},{"_id":"public/archives/2022/04/index.html","hash":"37239013952464976448cc1450ec7ac3b13b85ae","modified":1687314506620},{"_id":"public/archives/2022/05/index.html","hash":"b1237cbee250bfa153431a3d0a5ec78e8e34a76d","modified":1687314506620},{"_id":"public/categories/Promise/index.html","hash":"c0cafb6b3c7f167a8d6c372fdef90cedf8fe021e","modified":1687314506620},{"_id":"public/categories/Redux/index.html","hash":"def613fe1eb04dcd95419dc6d97598618fc951c2","modified":1687314506620},{"_id":"public/categories/React/index.html","hash":"dda873bbd6097085e022c107313220187c5cab99","modified":1687314506620},{"_id":"public/categories/AntDesign/index.html","hash":"a143a7b12f5b553109dc85ddb45eae3aee31b75e","modified":1687314506620},{"_id":"public/categories/Git/index.html","hash":"c106fbe267918af33f1154ebed0bf6eda9c6368d","modified":1687314506620},{"_id":"public/categories/Node/index.html","hash":"206398632a89f808790c4a97a5a2ca348e033e59","modified":1687314506620},{"_id":"public/categories/Vue/index.html","hash":"b35e26f65bf1a11a4e44d0df2d88c703f227c292","modified":1687314506620},{"_id":"public/categories/Vuex/index.html","hash":"fc168658c32e93e18ed0ac71ea4ac4257ce168a6","modified":1687314506620},{"_id":"public/categories/Webpack/index.html","hash":"c2137c6859a8cf65f89262d5d06a68cc74139e99","modified":1687314506620},{"_id":"public/index.html","hash":"ec842870de80919ab5ba0f7173cd88e0543bd97a","modified":1687314506620},{"_id":"public/page/2/index.html","hash":"2b30d01e2d632f2af30e12339221b2f5018afc29","modified":1687314506620},{"_id":"public/page/3/index.html","hash":"989c5e336bd8c3c9de8e0103a767f764a2fba0f7","modified":1687314506620},{"_id":"public/page/4/index.html","hash":"558ed7a51ba9ffe724f3a46af39b093b95d06e5e","modified":1687314506620},{"_id":"public/tags/Promise/index.html","hash":"38607bb605f76e09c1ab3665a69ab9a2030d3360","modified":1687314506620},{"_id":"public/tags/Redux/index.html","hash":"9a88481b83f526af46a872ff927f0d4823dc800f","modified":1687314506620},{"_id":"public/tags/React/index.html","hash":"31679fa5c7cccfc4acf89017c1603f53063bcf11","modified":1687314506620},{"_id":"public/tags/antDesign/index.html","hash":"c6054b07c1cff11b666ea085c1fc7d762a2fa3bf","modified":1687314506620},{"_id":"public/tags/Git/index.html","hash":"46825fac257fe0e33ea47f4646838967992acd2a","modified":1687314506620},{"_id":"public/tags/Node/index.html","hash":"7b79c73b910c6078bc73e082514bf4a0894037f0","modified":1687314506620},{"_id":"public/tags/Profile/index.html","hash":"5095e7027ee58d8ca7bfceb68ccd4a12d44217f8","modified":1687314506620},{"_id":"public/tags/Vue/index.html","hash":"2c14cf6b191f0698f2069e148cbfa802bd2ced43","modified":1687314506620},{"_id":"public/tags/fiber/index.html","hash":"e9335c55f969267787d3113e6c0dd21978b5dfa5","modified":1687314506620},{"_id":"public/tags/hooks/index.html","hash":"125032238620582368e93eb828b74dbde692a3c8","modified":1687314506620},{"_id":"public/tags/Vuex/index.html","hash":"c70f913dfdd73e744ec02d4023c60801532a4815","modified":1687314506620},{"_id":"public/tags/Webpack/index.html","hash":"2ebf2354b2bbe33843d21d84b15d20339cb6c84d","modified":1687314506620},{"_id":"public/images/antd.jpeg","hash":"2baef76d38d0a447ad880d0d6e61a03b0e4a552b","modified":1687314506620},{"_id":"public/images/ava.jpeg","hash":"17563468ef5bb66e2e27790e85810ab3f1365379","modified":1687314506620},{"_id":"public/images/git.jpeg","hash":"8fae7e8c851f11ab0624720d60fd5bfced8c5625","modified":1687314506620},{"_id":"public/images/node.jpeg","hash":"b2f437b8e463ad1b1e6e124b8e4f4cc2622fe41a","modified":1687314506620},{"_id":"public/images/react.jpeg","hash":"22996b85f1bfb96b5ed904e2c602228c2325b907","modified":1687314506620},{"_id":"public/images/redux.jpeg","hash":"c60a9c11b00af5090492fbe68f4868e3043b9fcb","modified":1687314506620},{"_id":"public/images/webpack.jpeg","hash":"7e458c6e5e644bbfba81be663bca79ff32c6d393","modified":1687314506620},{"_id":"public/2021/06/01/PromiseOne/promise2.png","hash":"2cfe57ebb6368182e3c275c164d3bfc81bac141f","modified":1687314506620},{"_id":"public/2021/06/01/PromiseOne/promise4.png","hash":"713d787431a8482d8ed18ab193f7ab18166b991d","modified":1687314506620},{"_id":"public/2021/06/04/PromiseTo/promiseto2.png","hash":"28a30df9f01a7b860ae40749f0e03f89a24c6771","modified":1687314506620},{"_id":"public/2021/06/04/PromiseTo/promiseto3.png","hash":"2c2f7e63cca74233ae53f7acaca8167d491ae53b","modified":1687314506620},{"_id":"public/2021/04/28/React报错/reacterror1.png","hash":"b9512f7f6efb66590d4f2a0a8d2e9c72165bf29f","modified":1687314506620},{"_id":"public/2021/04/28/React报错/reacterror2.png","hash":"c8b0a0e467af4544e90c7ee2018362bee649a53c","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne10.png","hash":"9a950437cbc6dc4d2fdcec82f1aaf86dda8eeb1f","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne11.png","hash":"7fa8261b107ab8344e9101aed10a3f9c787c69b1","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne12.png","hash":"5a5d492d3fb92545d6be1c4669b06ab3dba8921b","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne13.png","hash":"cfcd9a85d17a9e3404b55547d97bf5afcd96e762","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne16.png","hash":"b2bc414407ee58fbb1de725c2851de95fdd3d8e9","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne17.png","hash":"a485025c9a7fb3ae4a89696902b3d1530e24148c","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne18.png","hash":"fa594d48cfe13f7e6a2ac47a32c9b0d48f1e1978","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne19.png","hash":"29fcd6e662a926599e6e727aef81a89088fe5c03","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne2.png","hash":"f147c31f9412934c3e4e59b863a2c685ff70cf6b","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne20.png","hash":"479d27f520b65ba1ab05c9214d028235e5d66dfa","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne21.png","hash":"fce452610b10d313023f848f791d4150a00194fb","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne22.png","hash":"68e5658e1f82db768548572cd682de9b613aef0a","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne23.png","hash":"745ef0d547f21fea70244fe81623dd476ec0eca1","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne24.png","hash":"20e06205531397ae2d021331f424a21051a59b1b","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne3.png","hash":"b367e39da7c48a10ee634b352e1ae837b347ba56","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne6.png","hash":"bc5712b3e09a0595d86af299ddff5a522a5fcb67","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne7.png","hash":"b126828903c3b05f0eabce754f6e9f3d3decc1ef","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne8.png","hash":"1411eeee8a6ec62330764d38bfa047feed213794","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne9.png","hash":"0bc762a2bdf1516bae49522218c378604599b62f","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/rebase4.png","hash":"5f8e039abbb2d00355e40a822df9a43396bdb28b","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to10.png","hash":"96d89f12b309f990764c0a8e03a6fdefe6510717","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to12.png","hash":"8a275e45d71d69b3cd0c1ca602192807cfec89ca","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to17.png","hash":"f53cc706cde0e80104d1ffa14bbe549074321fc1","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to18.png","hash":"6ff6e9c7501b36c064c8cb2b1073aca09b5072de","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to19.png","hash":"f517dc5deee5581f052ed32ee7ab01d49f50af72","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to2.png","hash":"d74da7bae937f9cfa4c014236008eccfd840dd8f","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to21.png","hash":"c6301da84556cc3e9d233dce306d64276a062911","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to23.png","hash":"f3864b54f322a1f94596d9d2911e7b5ae41b2306","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to25.png","hash":"f99fa94319af015e68006e180bb6073fa59086fb","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to27.png","hash":"28def0d3cf5d09e12d6685a70a22b4991df4da8f","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to29.png","hash":"d1f8409d18c9263d82caed48a99c744109970945","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to30.png","hash":"c3d37ae74fbaa7aba59b1c15aa70d1f61713c293","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to31.png","hash":"27e0cc6f38b1e3a6dafb69c3f0d35d817a0bb260","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to32.png","hash":"06d64419a6924d19f3026fc899d7bc8158d2f958","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to33.png","hash":"9255ba95f88717b2b8268f94207bb4bbdf8f991c","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to8.png","hash":"5cf7377ef9315ba29caffc8bc57283c61cdaecb4","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to9.png","hash":"14dd90d4b14e89c75f3aa21210cb8a9ba6cbfb92","modified":1687314506620},{"_id":"public/2022/04/10/nodenotfound/notfound1.png","hash":"85bd0d36c01fd4a8f55d194385f4809014e53f56","modified":1687314506620},{"_id":"public/2022/04/10/nodenotfound/notfound2.png","hash":"dd03788645d25270a18ca8fbd1c42b8f7cf3bda4","modified":1687314506620},{"_id":"public/2022/04/10/nodenotfound/notfound3.png","hash":"24aed423b1963abf5d735b60ccf709e499c2cf10","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile1.png","hash":"0af26f242d034238b16ded68f1bada221db27f48","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile3.png","hash":"4a5abce397af0901ea557666e642077fff770026","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile4.png","hash":"da0343a854a3251efac5d3fd50fca02fb4138b93","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile5.png","hash":"2588bcfd02541396b1cbaeb90b44174b2a19216c","modified":1687314506620},{"_id":"public/2021/09/04/prop的单向数据流/data2.png","hash":"34d5372722b2da8a10fbdda157c91fa2d10f2b05","modified":1687314506620},{"_id":"public/2021/04/25/react-fiber/fiber1.png","hash":"19f8bfcd0894175ba5ebfbb0f36af4f73b8a52c3","modified":1687314506620},{"_id":"public/2021/04/25/react-fiber/fiber2.png","hash":"3599a86e726f6c2b2c48dd2b3174122425ed9811","modified":1687314506620},{"_id":"public/2021/04/25/react-fiber/fiber3.png","hash":"da385caa9a1c2ce4d7b520d48bf8116fcaf37aa2","modified":1687314506620},{"_id":"public/2021/04/25/react-fiber/fiber4.png","hash":"00ed50d60b8369d7a881a6c59b20a3e62392a9d4","modified":1687314506620},{"_id":"public/2021/08/04/vue数据代理的原理/vueproxy1.jpeg","hash":"d3c72b3574bd8f2eac837171bc63a123c3be3c8a","modified":1687314506620},{"_id":"public/2021/08/04/vue数据代理的原理/vueproxy2.png","hash":"f4acd2bae6b10e7ef3d3d6c424ae3683a4df05c1","modified":1687314506620},{"_id":"public/2021/08/04/vue数据代理的原理/vueproxy3.png","hash":"0d3080aff6a89289c7c7335f755793d95bc9d112","modified":1687314506620},{"_id":"public/2021/08/04/vue数据代理的原理/vueproxy4.png","hash":"df723d7f4a21e25fd397e1a18c768ca735018b8d","modified":1687314506620},{"_id":"public/2021/11/16/vux/vue2.png","hash":"ea7e71e9ce55a17f9fb098d5522b31d33f1f2d64","modified":1687314506620},{"_id":"public/2021/11/16/vux/vuex3.png","hash":"80a8711cdde6d3803bf3eb5f256f7ec2ef52be05","modified":1687314506620},{"_id":"public/live2dw/lib/L2Dwidget.min.js","hash":"5f1a807437cc723bcadc3791d37add5ceed566a2","modified":1687314506620},{"_id":"public/images/avatar-circle.png","hash":"011d87dabdc3583ddd75b8a48958fee27f20caf6","modified":1687314506620},{"_id":"public/images/pay.jpeg","hash":"d145033694dc626ec2af0d3d10f71bbb7a425331","modified":1687314506620},{"_id":"public/images/promise.jpeg","hash":"fb9ba59a45b04cdfe4241dff0ae4b2942830297a","modified":1687314506620},{"_id":"public/2021/06/01/PromiseOne/promise3.png","hash":"8eb0a1dc654f56a5197897154e94bed6db942090","modified":1687314506620},{"_id":"public/2021/03/14/React-redux/reduxdata1.gif","hash":"d5da4e7782c51efa3bc105d3e1f78e58aaf913b2","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne14.png","hash":"cc604ebfa34f7025318a3b110ac6e55ea944f6cb","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne15.png","hash":"81ddc7397d2170f42a697b41767c5558bcca876a","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to13.png","hash":"018f01150f170b3d3d8cc5f3e9f6d6b78e7c5b31","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to20.png","hash":"aebdae0cf048163b56b61290dae24e8a4eba6420","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to24.png","hash":"88846f846792972ea2d51a95d1d156114dee46f5","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to28.png","hash":"d54fd09caece9b2224544a550f0b7078831be624","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to3.png","hash":"7859990fee59eb2b5cc2e1702fa18d8d844fbe8e","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to34.png","hash":"321bca30f8137cf007a9ce13b53f69b01fd40f98","modified":1687314506620},{"_id":"public/2022/04/16/nodebody/body1.png","hash":"3ecb837b412fa13e1a0680ea9330678a5307163f","modified":1687314506620},{"_id":"public/2022/04/20/nodeheader/hea2.png","hash":"d8cf632529d6949e3fa57683f50e56523559e076","modified":1687314506620},{"_id":"public/2022/05/16/nodejoi/joi1.png","hash":"8fd48f30851c43bba9541876602b27d016266325","modified":1687314506620},{"_id":"public/2022/04/10/nodenotfound/notfound4.png","hash":"4ab52115bb809c4f253ea3bdfda582ab13f45d19","modified":1687314506620},{"_id":"public/2022/03/22/noderes-cc/cc2.png","hash":"9488d8bc43a9a682cd2d339f504a79aee2301287","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile2.png","hash":"419e67c6a552471c06eddf2219a46c77e43bbe5c","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile6.png","hash":"2f043c2b5351e6f0e122cca92070d5cbf2572984","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile7.png","hash":"c9deed17b28675d7ca10c30e08e34c8d459dd904","modified":1687314506620},{"_id":"public/2021/09/04/prop的单向数据流/data3.png","hash":"5b58d3e83449768d2d1c38e481515c5aa45d3aa2","modified":1687314506620},{"_id":"public/2021/04/21/useMemo使用误区/memo1.png","hash":"aa9652296973fb8ab971ef6fe6dbb96a2b8e8e6e","modified":1687314506620},{"_id":"public/2021/04/21/useMemo使用误区/memo2.png","hash":"5effa78982a1d97d95a2d9cf55068a34061c4df3","modified":1687314506620},{"_id":"public/2021/04/21/useMemo使用误区/memo3.png","hash":"9b40b91d547d5da70c928039e4f8bc7cac39ef53","modified":1687314506620},{"_id":"public/2021/04/21/useMemo使用误区/memo4.png","hash":"a5f49bf0fb25b5ffdd2585d906d841246bf56c81","modified":1687314506620},{"_id":"public/2021/03/15/useMemo的使用/memoopt4.png","hash":"2eccce730e07afdb1f66f3e73931f958c0a7ab0f","modified":1687314506620},{"_id":"public/2021/05/28/过滤文本框表情符号/emo1.png","hash":"d6fb288e9667fb06685c62c5ad39c091bf046e9f","modified":1687314506620},{"_id":"public/live2dw/lib/L2Dwidget.min.js.map","hash":"3290fe2df45f065b51a1cd7b24ec325cbf9bb5ce","modified":1687314506620},{"_id":"public/css/Readme.html","hash":"c9912722e1c7a72fbc45b4087424f819fa47013a","modified":1687314506620},{"_id":"public/js/click_show_text.js","hash":"484ef52db7a7953be92093051d1a57ee4b9d26d0","modified":1687314506620},{"_id":"public/js/fireworks.js","hash":"fc6a166ec85191bfdc60f19f2c1905a316435414","modified":1687314506620},{"_id":"public/js/love.js","hash":"0d412b497424f388fd57a38be048bda81870fcc5","modified":1687314506620},{"_id":"public/js/snow.js","hash":"3583103eef0aa7f09274665452dc7b2d2a526600","modified":1687314506620},{"_id":"public/js/plugins/aplayer.js","hash":"95f2e47535c8d37e90cab7726d25845cf01ca477","modified":1687314506620},{"_id":"public/js/plugins/parallax.js","hash":"3c3210bde6e86d7d157c34c14796abe98cb1bbd0","modified":1687314506620},{"_id":"public/js/search/hexo.js","hash":"bed5846e373244ab851b50f21337f8d12270d638","modified":1687314506620},{"_id":"public/js/search/meilisearch.js","hash":"3738a3436c92d569e4883f0c2688414fdc4b0399","modified":1687314506620},{"_id":"public/js/search/algolia.js","hash":"7a00ea2e53fa7148449ffa58a6707f0b82243a1b","modified":1687314506620},{"_id":"public/js/plugins/tags/contributors.js","hash":"d9f6a153494fe5ff78382322f8f236a4d81ec482","modified":1687314506620},{"_id":"public/js/plugins/tags/friends.js","hash":"d9fa94b4e54bd739bf8d32e2be313a750386a639","modified":1687314506620},{"_id":"public/js/plugins/tags/sites.js","hash":"e29b1908689477f3ef19987b0cc65505c7d514ac","modified":1687314506620},{"_id":"public/css/first.css","hash":"ea03e1c4ba82d0d4996f0c5d359171fb248b8211","modified":1687314506620},{"_id":"public/css/style.css","hash":"d9e74be5cc772e581412bcc1df5312307783dfa2","modified":1687314506620},{"_id":"public/js/app.js","hash":"3bf50c7fcd705d2912d5fadcca2d42a0e374efa0","modified":1687314506620},{"_id":"public/js/plugins/rightMenus.js","hash":"ac38377646954046fa9ced47d5c9e0dada7dd5bb","modified":1687314506620},{"_id":"public/2021/06/01/PromiseOne/promise1.png","hash":"84b659aea2a750499dfeda107d87536d6aff8859","modified":1687314506620},{"_id":"public/2021/06/04/PromiseTo/promiseto1.png","hash":"84b659aea2a750499dfeda107d87536d6aff8859","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/rebase2.png","hash":"6cc342bd036b86a2517a20e78db03270ea8c57a8","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/rebase3.png","hash":"a069fd8c6c285affd4e9e836662ce422424b3c99","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to11.png","hash":"3a192e38b5dbb572f6b76a601ef178aa955372f0","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to26.png","hash":"a1049ea0442abcfd26684ab82371919fc886ce7e","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to6.png","hash":"6c4707af30edc9cab40f401500aaed46b3b5015b","modified":1687314506620},{"_id":"public/2022/04/20/nodeheader/hea3.png","hash":"53a2007cb3b0e072a2ad13f64350f1505ada2c34","modified":1687314506620},{"_id":"public/2022/03/22/noderes-cc/cc1.png","hash":"7bcb649a8a1fc18ac28ce355ca052ef1776216a9","modified":1687314506620},{"_id":"public/2021/02/21/profile/profile8.png","hash":"99471a14c625d49ffbf693d54d17789fc40916b8","modified":1687314506620},{"_id":"public/2021/03/21/table-scroll/scroll1.png","hash":"1a55e70b705e83d03dbd05d4199a886f4c7a04c5","modified":1687314506620},{"_id":"public/2021/03/15/useMemo的使用/memoopt1.png","hash":"429142095157fc3da99537c32fe12ff5bbaaa95d","modified":1687314506620},{"_id":"public/2021/03/15/useMemo的使用/memoopt2.png","hash":"b402e08671173414e9ee2ae8882099a4a2e666ac","modified":1687314506620},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js","hash":"35bb5b588b6de25c9be2dd51d3fd331feafac02d","modified":1687314506620},{"_id":"public/images/bg.jpeg","hash":"58a8194ac297375485e77fabea35b5cceb726d25","modified":1687314506620},{"_id":"public/images/vue.png","hash":"a0f2ac4e058f5d591466ca4abd812a1d16f203ce","modified":1687314506620},{"_id":"public/2021/05/25/dataPick组件日期在浏览器兼容性问题/datePick.png","hash":"ba3aebb7824649f721c4e6dfcaa999be47ba08f1","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/rebase1.png","hash":"130b996a68081195171f2ce76c066c44382d24a1","modified":1687314506620},{"_id":"public/2021/12/09/gitRebase/rebase5.png","hash":"2ddf52b3f89041b0a10635df89ec8fff40181442","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to5.png","hash":"cbd2a06aef1fffc9cdc15b8f924afeeab5fa494c","modified":1687314506620},{"_id":"public/2022/04/20/nodeheader/hea1.png","hash":"58ca621f067ccd74e22d9fe8941f754d44a4e4ce","modified":1687314506620},{"_id":"public/2021/03/15/useMemo的使用/memoopt3.png","hash":"af967091d0564a9f76362071156950d59eb5cb27","modified":1687314506620},{"_id":"public/2021/11/16/vux/vuex1.png","hash":"3c36e9bbc6835f95243dbadc7a99e3cbe1d002e2","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to7.png","hash":"ae91b4a8e09b3d3ad4b9e9c0c22b27c033cf6de0","modified":1687314506620},{"_id":"public/2021/03/21/table-scroll/scroll2.png","hash":"117cfb5a795464d8d5c06e0485c8cf9611818f40","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to14.png","hash":"1be57d2c25a77e6fafa17cc747b0133d0980a2a9","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to15.png","hash":"72780090d4d08888a50438540233869d0770d254","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to16.png","hash":"1062fe3b8434c2ad06a948763208185125324dcf","modified":1687314506620},{"_id":"public/2021/03/14/React-redux/reduxdata2.gif","hash":"2b004790ceb65c1dd60fa789bfc8eb9afbc38b26","modified":1687314506620},{"_id":"public/live2dw/lib/L2Dwidget.0.min.js.map","hash":"35e71cc2a130199efb167b9a06939576602f0d75","modified":1687314506620},{"_id":"public/images/nav.png","hash":"8472786a3e6ee5fd682088fe737c198f22f1534e","modified":1687314506620},{"_id":"public/2022/02/22/gitTo/to4.png","hash":"64a890465f657c78a92c2b437a00bf803992cdf3","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne5.gif","hash":"7767171a2f563c53915930443a8831539b2c189c","modified":1687314506620},{"_id":"public/2021/09/04/prop的单向数据流/data1.png","hash":"d8cbb62ee1ba3df95de417baa6dbca4213de4e30","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne4.gif","hash":"8281db543e5302ada098b898a2005befc011e1d8","modified":1687314506620},{"_id":"public/images/avatar.png","hash":"9358c57042e1357a321bfd10b9a27762053f67bf","modified":1687314506620},{"_id":"public/2022/01/11/gitOne/gitOne1.gif","hash":"699468200cba94b7b5d66c2fd0b4a7d3b5fe0c05","modified":1687314506620},{"_id":"themes/hexo-theme-volantis/.github/labeler.yml","hash":"bc34e81eb7488e8ad5f5e9fd6a471a576d0b2338","modified":1689751015115},{"_id":"themes/hexo-theme-volantis/.github/workflows/label-commenter.yml","hash":"0cace0421e3681e7bbafea4390eee2f9b16caa03","modified":1689751015114},{"_id":"themes/hexo-theme-volantis/.github/workflows/release-please.yml","hash":"2daa5c6ce7e17ec4366fc22835c11add6f1fb739","modified":1689751015114},{"_id":"themes/hexo-theme-volantis/source/css/_style/_plugins/tianliGPT.styl","hash":"baaff78b573d49d59c8471ff54f4a941262cc930","modified":1689751015098},{"_id":"themes/hexo-theme-volantis/layout/_widget/memos_carousel.ejs","hash":"b7e81904625fcd63bc6272173913e51f2980f3a3","modified":1689751015094},{"_id":"themes/hexo-theme-volantis/layout/_plugins/tianligpt/script.ejs","hash":"a72cfbb36307b5a1d53061f8239a5d9c7f70efdb","modified":1689751015094},{"_id":"themes/hexo-theme-volantis/layout/_plugins/_page_plugins/memos/index.ejs","hash":"041a8e69051fc09008436a079a5bc7bd5c7aab3d","modified":1689751015093}],"Category":[{"name":"Promise","_id":"clj53hqef0004p5o1epvkcsfm"},{"name":"Redux","_id":"clj53hqex000np5o1bife3chp"},{"name":"React","_id":"clj53hqf0000up5o13y6l08vd"},{"name":"AntDesign","_id":"clj53hqf40015p5o19kabhbs5"},{"name":"Git","_id":"clj53hqf7001cp5o1612wep7j"},{"name":"Node","_id":"clj53hqfi001zp5o1f4w219ss"},{"name":"Vue","_id":"clj53hqfz0030p5o19k9t17ea"},{"name":"Vuex","_id":"clj53hqg2003gp5o1a5ot1m3q"},{"name":"Webpack","_id":"clj53hqg3003op5o11k8nd8vz"}],"Data":[{"_id":"friends","data":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}],"Page":[{"cover":true,"robots":"noindex,nofollow","sitemap":false,"seo_title":"404 Not Found","bottom_meta":false,"sidebar":[],"twikoo":{"path":"/404.html","placeholder":"请留言告诉我您要访问哪个页面找不到了"},"_content":"\n{% p logo center huge, 404 %}\n{% p center bold, 很抱歉，您访问的页面不存在 %}\n{% p center small, 可能是输入地址有误或该地址已被删除 %}\n","source":"404.md","raw":"---\ncover: true\nrobots: noindex,nofollow\nsitemap: false\nseo_title: 404 Not Found\nbottom_meta: false\nsidebar: []\ntwikoo:\n  path: /404.html\n  placeholder: 请留言告诉我您要访问哪个页面找不到了\n---\n\n{% p logo center huge, 404 %}\n{% p center bold, 很抱歉，您访问的页面不存在 %}\n{% p center small, 可能是输入地址有误或该地址已被删除 %}\n","date":"2023-03-11T09:02:53.710Z","updated":"2023-03-11T09:02:53.710Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"clj53hqe50000p5o1g7sp98yw","content":"<p class='p logo center huge'>404</p>\n<p class='p center bold'>很抱歉，您访问的页面不存在</p>\n<p class='p center small'>可能是输入地址有误或该地址已被删除</p>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<p class='p logo center huge'>404</p>\n<p class='p center bold'>很抱歉，您访问的页面不存在</p>\n<p class='p center small'>可能是输入地址有误或该地址已被删除</p>\n"},{"layout":"docs","seo_title":"关于","bottom_meta":false,"sidebar":["blogger","category","tagcloud","webinfo"],"twikoo":{"placeholder":"有什么想对我说的呢？"},"_content":"\n下面写关于自己的内容\n","source":"about/index.md","raw":"---\nlayout: docs\nseo_title: 关于\nbottom_meta: false\nsidebar: [blogger, category, tagcloud, webinfo]\ntwikoo:\n  placeholder: 有什么想对我说的呢？\n---\n\n下面写关于自己的内容\n","date":"2023-03-11T12:55:28.738Z","updated":"2023-03-11T12:55:28.738Z","path":"about/index.html","title":"","comments":1,"_id":"clj53hqec0002p5o187tsfk22","content":"<p>下面写关于自己的内容</p>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<p>下面写关于自己的内容</p>\n"},{"layout":"category","index":true,"title":"所有分类","sidebar":["blogger","category","tagcloud","webinfo"],"_content":"","source":"categories/index.md","raw":"---\nlayout: category\nindex: true\ntitle: 所有分类\nsidebar: [blogger, category, tagcloud, webinfo]\n---\n","date":"2023-03-11T12:53:19.961Z","updated":"2023-03-11T12:53:19.961Z","path":"categories/index.html","comments":1,"_id":"clj53hqei0006p5o1hnqm3t2f","content":"","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":""},{"layout":"friends","title":"我的朋友们","_content":"\n这里写友链上方的内容。\n\n<!-- more -->\n\n这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。\n","source":"friends/index.md","raw":"---\nlayout: friends # 必须\ntitle: 我的朋友们 # 可选，这是友链页的标题\n---\n\n这里写友链上方的内容。\n\n<!-- more -->\n\n这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。\n","date":"2023-03-08T11:46:30.009Z","updated":"2023-03-08T11:46:30.009Z","path":"friends/index.html","comments":1,"_id":"clj53hqek0008p5o16vkph8k3","content":"<p>这里写友链上方的内容。</p>\n<span id=\"more\"></span>\n\n<p>这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。</p>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"<p>这里写友链上方的内容。</p>","more":"<p>这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。</p>"},{"layout":"tag","index":true,"title":"所有标签","sidebar":["blogger","category","tagcloud","webinfo"],"_content":"","source":"tags/index.md","raw":"---\nlayout: tag\nindex: true\ntitle: 所有标签\nsidebar: [blogger, category, tagcloud, webinfo]\n---\n","date":"2023-03-11T13:05:38.463Z","updated":"2023-03-11T13:05:38.463Z","path":"tags/index.html","comments":1,"_id":"clj53hqem000ap5o1a6r80qd6","content":"","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":""}],"Post":[{"title":"手写 Promise (一)","description":"本篇文章将带领大家一步步封装自己的Promise；","headimg":"/images/promise.jpeg","date":"2021-05-31T16:00:00.000Z","_content":"\n## 前言\n\n众所周知由于多层回调函数相互嵌套，代码耦合性太强，牵一发而动全身，导致代码难以维护，可读性差，所以为了解决回调地狱问题，ES6 新增了 Promise 的概念。相信内置的 Promise 大家都会使用了，但是 Promise 实现的原理，大家一定还很陌生，本篇文章将带领大家一步步封装自己的 Promise；\n\n{% asset_img promise1.png %}\n\n## 手写 Promise 前必读\n\n在手写 Promise 之前我们需要了解 Promise 的三个状态，Promise 是一个有状态的对象，可能处于如下 3 种状态之一：\n ==待定（pending）==\n ==兑现（fulfilled，有时候也称为“解决”，resolved）==\n ==拒绝（rejected）==\n待定（pending）是 Promise 的最初始状态。在待定状态下，Promise 可以落定（settled）为代表成功的兑现（fulfilled）状态，或者代表失败的拒绝（rejected）状态。无论落定为哪种状态都是==不可逆==的。只要从待定转换为兑现或拒绝，Promise 的状态就不再改变。而且，也不能保证期约必然会脱离待定状态。因此，组织合理的代码无论 Promise 解决（resolve）还是拒绝（reject），甚至永远处于待定（pending）状态，都应该具有恰当的行为。重要的是，Promise 的状态是私有的，不能直接通过 JavaScript 检测到。这主要是为了避免根据读取到的期约状态，以同步方式处理 Promise 对象。另外，Promise 的状态也不能被外部 JavaScript 代码修改。这与不能读取该状态的原因是一样的：Promise 故意将异步行为封装起来，从而隔离外部的同步代码。\n📣 注意：在 Promise 的状态发生改变后就会发生状态凝固，即状态不能再次改变；\n\n## 🥇 实现 Promise 的基本功能\n\n首先我们先用内置 Promises 创建一个实例对象，传入一个函数，内部打印 11，运行后发现控制台输出了 11，说明传入 Promise 的函数在 new 一个 Promise 实例时，会立即调用；\n{% asset_img promise2.png %}\n那么我们如何实现此功能呢？\n实际上在创建 Promise 实例对象时传入的参数叫做执行器函数（executor），若想 new 一个 Promise 的同时调用函数，执行器的函数的调用必须写在 Promise 类的 constructor 函数内部，这样每次创建 Promise 实例时，都会执行 constructor 函数，即可调用 executor 函数；在调用执行器函数的同时我们需要传入 resolve、reject 函数用来处理 Promise 的状态，状态即为前面提到的三种状态；\n代码示例如下所示：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    //调用执行器函数\n    executor(resolve, reject)\n  }\n}\n```\n\n我们将此 js 代码引入一个 html 页面覆盖内置的 Promise 测试此功能；如果能正常打印 11 即为成功；\n{% asset_img promise3.png %}\n实现以上功能以后我们接着定义构造器函数(executor)内部的两个处理 Promise 状态的函数 resolve 和 reject，在定义两个状态处理函数前我们要先初始化 Promise 的初始状态为 pending(待定),而且要先定义 resolve 和 reject 函数执行成功的结果和执行失败的原因；\n代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n    //调用执行器函数\n    executor(resolve, reject)\n  }\n}\n```\n\n在定义 Promise 的两个改变状态的函数前我们需要了解 Promise/A+规范的关于状态凝固的概念，即 resolve 和 reject 函数处理 Promise 状态是不可逆的，即执行完函数改变 Promise 状态后不能再次改变 Promise 的状态即状态凝固了；\n基于规范的状态改变的不可逆性，我们需要在函数内部加上判断条件，即当 Promise 的状态为 pending 时才能进入代码块执行代码；代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n      }\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n}\n```\n\n实现以上功能后，我们需要对代码进行优化，即执行器函数调用时，可能发生一些未知的错误，为了避免程序因为抛出错误导致程序崩溃，我们将执行器函数调用放到 try-catch 语句中；\n优化后代码如下：\n\n```javascript\n//捕获Promise状态发生错误的第三种方式\ntry {\n  //调用执行器函数\n  executor(resolve, reject)\n} catch (err) {\n  reject(err)\n}\n```\n\n## 🥇 then()方法的实现\n\n在 Promise 状态发生改变后，无论成功后者失败，都会触发 then 内部的回调函数；然后根据 Promise 改变后的状态，去判断是执行成功的回调函数还是失败的回调函数；代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n      }\n\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n\n  then(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n  }\n}\n```\n\n定义完 then()方法后进行测试，发现在执行 resolve 或者执行 reject 函数改变 Promise 状态时，如果函数的调用是异步的，就会导致在调用 then 方法时，异步的代码还未执行，Promise 状态还是 pending，就无法执行 then 方法内部的成功和失败的回调函数；\n测试失败的 demo 如下：\n\n```javascript\nvar myP = new Promise(function (resolve, reject) {\n  console.log('执行')\n  setTimeout(function () {\n    reject(3)\n  }, 1000)\n})\n\nmyP.then(\n  function (res) {\n    console.log(res)\n  },\n  function (err) {\n    console.log(err)\n  }\n)\n```\n\n因为以上 reject(3) ，在定时器里面是异步的，而 then()方法是同步的，所以控制台并未打印出 3；执行流程如下图所示；\n{% asset_img promise4.png %}\n解决此问题思路，在 then 方法内若判断 Promise 状态是 pending，说明改变 Promise 状态的函数是异步的，还未执行，此时我们直接将失败和成功后调用的回调函数存到一个数组中，当执行完异步队列中的改变 Promise 状态的函数时再进行调用；优化后的 then()\n\n```javascript\nthen(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n\n    // 如果状态为pending，将回调函数存如数组\n    if (this.state === 'pending') {\n      //将执行成功的回调函数存入数组\n      this.resolvedCallback.push(() => {\n        onResolved(this.value)\n      })\n    }\n    //将执行失败的回调函数存入数组\n    this.rejectedCallback.push(() => {\n      onRejected(this.reason)\n    })\n  }\n```\n\n以上的 resolvedCallback、rejectedCallback 为定义的两个空数组；将回调函数存入数组后，在执行异步队列中的函数时，遍历数组，然后再执行数组中存的成功或失败的回调函数；\n优化 resolve 和 reject 函数后的完整代码如下所示；\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n    //定义数组用来存放回调函数\n    this.resolvedCallback = []\n    this.rejectedCallback = []\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n        //  改变完状态执行数组中的回调函数\n        this.resolvedCallback.forEach((item) => item())\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n        // 改变完状态执行数组中的回调函数\n        this.rejectedCallback.forEach((item) => item())\n      }\n\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n\n  then(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n\n    // 如果状态为pending，将回调函数存如数组\n    if (this.state === 'pending') {\n      //将执行成功的回调函数存入数组\n      this.resolvedCallback.push(() => {\n        onResolved(this.value)\n      })\n    }\n    //将执行失败的回调函数存入数组\n    this.rejectedCallback.push(() => {\n      onRejected(this.reason)\n    })\n  }\n}\n```\n\n此时就完成了 then()方法的包括支持异步的功能；本片文章就讲到这里，下篇文章将接着带领大家实现 then 方法的链式调用功能；\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/PromiseOne.md","raw":"---\ntitle: 手写 Promise (一)\ndescription: 本篇文章将带领大家一步步封装自己的Promise；\nheadimg: /images/promise.jpeg\ndate: 2021-06-01\ntags:\n  - Promise\ncategories:\n  - Promise\n---\n\n## 前言\n\n众所周知由于多层回调函数相互嵌套，代码耦合性太强，牵一发而动全身，导致代码难以维护，可读性差，所以为了解决回调地狱问题，ES6 新增了 Promise 的概念。相信内置的 Promise 大家都会使用了，但是 Promise 实现的原理，大家一定还很陌生，本篇文章将带领大家一步步封装自己的 Promise；\n\n{% asset_img promise1.png %}\n\n## 手写 Promise 前必读\n\n在手写 Promise 之前我们需要了解 Promise 的三个状态，Promise 是一个有状态的对象，可能处于如下 3 种状态之一：\n ==待定（pending）==\n ==兑现（fulfilled，有时候也称为“解决”，resolved）==\n ==拒绝（rejected）==\n待定（pending）是 Promise 的最初始状态。在待定状态下，Promise 可以落定（settled）为代表成功的兑现（fulfilled）状态，或者代表失败的拒绝（rejected）状态。无论落定为哪种状态都是==不可逆==的。只要从待定转换为兑现或拒绝，Promise 的状态就不再改变。而且，也不能保证期约必然会脱离待定状态。因此，组织合理的代码无论 Promise 解决（resolve）还是拒绝（reject），甚至永远处于待定（pending）状态，都应该具有恰当的行为。重要的是，Promise 的状态是私有的，不能直接通过 JavaScript 检测到。这主要是为了避免根据读取到的期约状态，以同步方式处理 Promise 对象。另外，Promise 的状态也不能被外部 JavaScript 代码修改。这与不能读取该状态的原因是一样的：Promise 故意将异步行为封装起来，从而隔离外部的同步代码。\n📣 注意：在 Promise 的状态发生改变后就会发生状态凝固，即状态不能再次改变；\n\n## 🥇 实现 Promise 的基本功能\n\n首先我们先用内置 Promises 创建一个实例对象，传入一个函数，内部打印 11，运行后发现控制台输出了 11，说明传入 Promise 的函数在 new 一个 Promise 实例时，会立即调用；\n{% asset_img promise2.png %}\n那么我们如何实现此功能呢？\n实际上在创建 Promise 实例对象时传入的参数叫做执行器函数（executor），若想 new 一个 Promise 的同时调用函数，执行器的函数的调用必须写在 Promise 类的 constructor 函数内部，这样每次创建 Promise 实例时，都会执行 constructor 函数，即可调用 executor 函数；在调用执行器函数的同时我们需要传入 resolve、reject 函数用来处理 Promise 的状态，状态即为前面提到的三种状态；\n代码示例如下所示：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    //调用执行器函数\n    executor(resolve, reject)\n  }\n}\n```\n\n我们将此 js 代码引入一个 html 页面覆盖内置的 Promise 测试此功能；如果能正常打印 11 即为成功；\n{% asset_img promise3.png %}\n实现以上功能以后我们接着定义构造器函数(executor)内部的两个处理 Promise 状态的函数 resolve 和 reject，在定义两个状态处理函数前我们要先初始化 Promise 的初始状态为 pending(待定),而且要先定义 resolve 和 reject 函数执行成功的结果和执行失败的原因；\n代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n    //调用执行器函数\n    executor(resolve, reject)\n  }\n}\n```\n\n在定义 Promise 的两个改变状态的函数前我们需要了解 Promise/A+规范的关于状态凝固的概念，即 resolve 和 reject 函数处理 Promise 状态是不可逆的，即执行完函数改变 Promise 状态后不能再次改变 Promise 的状态即状态凝固了；\n基于规范的状态改变的不可逆性，我们需要在函数内部加上判断条件，即当 Promise 的状态为 pending 时才能进入代码块执行代码；代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n      }\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n}\n```\n\n实现以上功能后，我们需要对代码进行优化，即执行器函数调用时，可能发生一些未知的错误，为了避免程序因为抛出错误导致程序崩溃，我们将执行器函数调用放到 try-catch 语句中；\n优化后代码如下：\n\n```javascript\n//捕获Promise状态发生错误的第三种方式\ntry {\n  //调用执行器函数\n  executor(resolve, reject)\n} catch (err) {\n  reject(err)\n}\n```\n\n## 🥇 then()方法的实现\n\n在 Promise 状态发生改变后，无论成功后者失败，都会触发 then 内部的回调函数；然后根据 Promise 改变后的状态，去判断是执行成功的回调函数还是失败的回调函数；代码示例如下：\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n      }\n\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n\n  then(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n  }\n}\n```\n\n定义完 then()方法后进行测试，发现在执行 resolve 或者执行 reject 函数改变 Promise 状态时，如果函数的调用是异步的，就会导致在调用 then 方法时，异步的代码还未执行，Promise 状态还是 pending，就无法执行 then 方法内部的成功和失败的回调函数；\n测试失败的 demo 如下：\n\n```javascript\nvar myP = new Promise(function (resolve, reject) {\n  console.log('执行')\n  setTimeout(function () {\n    reject(3)\n  }, 1000)\n})\n\nmyP.then(\n  function (res) {\n    console.log(res)\n  },\n  function (err) {\n    console.log(err)\n  }\n)\n```\n\n因为以上 reject(3) ，在定时器里面是异步的，而 then()方法是同步的，所以控制台并未打印出 3；执行流程如下图所示；\n{% asset_img promise4.png %}\n解决此问题思路，在 then 方法内若判断 Promise 状态是 pending，说明改变 Promise 状态的函数是异步的，还未执行，此时我们直接将失败和成功后调用的回调函数存到一个数组中，当执行完异步队列中的改变 Promise 状态的函数时再进行调用；优化后的 then()\n\n```javascript\nthen(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n\n    // 如果状态为pending，将回调函数存如数组\n    if (this.state === 'pending') {\n      //将执行成功的回调函数存入数组\n      this.resolvedCallback.push(() => {\n        onResolved(this.value)\n      })\n    }\n    //将执行失败的回调函数存入数组\n    this.rejectedCallback.push(() => {\n      onRejected(this.reason)\n    })\n  }\n```\n\n以上的 resolvedCallback、rejectedCallback 为定义的两个空数组；将回调函数存入数组后，在执行异步队列中的函数时，遍历数组，然后再执行数组中存的成功或失败的回调函数；\n优化 resolve 和 reject 函数后的完整代码如下所示；\n\n```javascript\nclass Promise {\n  constructor(executor) {\n    this.state = 'pending' //Promise初始状态\n    this.value = undefined //执行成功的结果\n    this.reason = undefine //执行失败的结果\n    //定义数组用来存放回调函数\n    this.resolvedCallback = []\n    this.rejectedCallback = []\n    // 定义resolve函数\n    const resolve = (value) => {\n      if (this.state === 'pending') {\n        this.state = 'fulfiled'\n        this.value = value\n        //  改变完状态执行数组中的回调函数\n        this.resolvedCallback.forEach((item) => item())\n      }\n    }\n    //定义reject函数\n    const reject = (reason) => {\n      if (this.state === 'pending') {\n        this.state = 'rejected'\n        this.reason = reason\n        // 改变完状态执行数组中的回调函数\n        this.rejectedCallback.forEach((item) => item())\n      }\n\n      //调用执行器函数\n      executor(resolve, reject)\n    }\n  }\n\n  then(onResolved, onRejected) {\n    //Promise状态为resolved时\n    if (this.state === 'resolved') {\n      onResolved(this.value)\n    }\n\n    //Promise状态为rejected时\n    if (this.state === 'rejected') {\n      onRejected(this.reason)\n    }\n\n    // 如果状态为pending，将回调函数存如数组\n    if (this.state === 'pending') {\n      //将执行成功的回调函数存入数组\n      this.resolvedCallback.push(() => {\n        onResolved(this.value)\n      })\n    }\n    //将执行失败的回调函数存入数组\n    this.rejectedCallback.push(() => {\n      onRejected(this.reason)\n    })\n  }\n}\n```\n\n此时就完成了 then()方法的包括支持异步的功能；本片文章就讲到这里，下篇文章将接着带领大家实现 then 方法的链式调用功能；\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"PromiseOne","published":1,"updated":"2023-03-14T11:41:40.489Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqe80001p5o13gip641w","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>众所周知由于多层回调函数相互嵌套，代码耦合性太强，牵一发而动全身，导致代码难以维护，可读性差，所以为了解决回调地狱问题，ES6 新增了 Promise 的概念。相信内置的 Promise 大家都会使用了，但是 Promise 实现的原理，大家一定还很陌生，本篇文章将带领大家一步步封装自己的 Promise；</p>\n<img src=\"/2021/06/01/PromiseOne/promise1.png\" class=\"lazyload\" data-srcset=\"/2021/06/01/PromiseOne/promise1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"手写-Promise-前必读\"><a href=\"#手写-Promise-前必读\" class=\"headerlink\" title=\"手写 Promise 前必读\"></a>手写 Promise 前必读</h2><p>在手写 Promise 之前我们需要了解 Promise 的三个状态，Promise 是一个有状态的对象，可能处于如下 3 种状态之一：<br> ==待定（pending）==<br> ==兑现（fulfilled，有时候也称为“解决”，resolved）==<br> ==拒绝（rejected）==<br>待定（pending）是 Promise 的最初始状态。在待定状态下，Promise 可以落定（settled）为代表成功的兑现（fulfilled）状态，或者代表失败的拒绝（rejected）状态。无论落定为哪种状态都是==不可逆==的。只要从待定转换为兑现或拒绝，Promise 的状态就不再改变。而且，也不能保证期约必然会脱离待定状态。因此，组织合理的代码无论 Promise 解决（resolve）还是拒绝（reject），甚至永远处于待定（pending）状态，都应该具有恰当的行为。重要的是，Promise 的状态是私有的，不能直接通过 JavaScript 检测到。这主要是为了避免根据读取到的期约状态，以同步方式处理 Promise 对象。另外，Promise 的状态也不能被外部 JavaScript 代码修改。这与不能读取该状态的原因是一样的：Promise 故意将异步行为封装起来，从而隔离外部的同步代码。<br>📣 注意：在 Promise 的状态发生改变后就会发生状态凝固，即状态不能再次改变；</p>\n<h2 id=\"🥇-实现-Promise-的基本功能\"><a href=\"#🥇-实现-Promise-的基本功能\" class=\"headerlink\" title=\"🥇 实现 Promise 的基本功能\"></a>🥇 实现 Promise 的基本功能</h2><p>首先我们先用内置 Promises 创建一个实例对象，传入一个函数，内部打印 11，运行后发现控制台输出了 11，说明传入 Promise 的函数在 new 一个 Promise 实例时，会立即调用；</p>\n<img src=\"/2021/06/01/PromiseOne/promise2.png\" class=\"lazyload\" data-srcset=\"/2021/06/01/PromiseOne/promise2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>那么我们如何实现此功能呢？<br>实际上在创建 Promise 实例对象时传入的参数叫做执行器函数（executor），若想 new 一个 Promise 的同时调用函数，执行器的函数的调用必须写在 Promise 类的 constructor 函数内部，这样每次创建 Promise 实例时，都会执行 constructor 函数，即可调用 executor 函数；在调用执行器函数的同时我们需要传入 resolve、reject 函数用来处理 Promise 的状态，状态即为前面提到的三种状态；<br>代码示例如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">    <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们将此 js 代码引入一个 html 页面覆盖内置的 Promise 测试此功能；如果能正常打印 11 即为成功；</p>\n<img src=\"/2021/06/01/PromiseOne/promise3.png\" class=\"lazyload\" data-srcset=\"/2021/06/01/PromiseOne/promise3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>实现以上功能以后我们接着定义构造器函数(executor)内部的两个处理 Promise 状态的函数 resolve 和 reject，在定义两个状态处理函数前我们要先初始化 Promise 的初始状态为 pending(待定),而且要先定义 resolve 和 reject 函数执行成功的结果和执行失败的原因；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\">    <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">    <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在定义 Promise 的两个改变状态的函数前我们需要了解 Promise/A+规范的关于状态凝固的概念，即 resolve 和 reject 函数处理 Promise 状态是不可逆的，即执行完函数改变 Promise 状态后不能再次改变 Promise 的状态即状态凝固了；<br>基于规范的状态改变的不可逆性，我们需要在函数内部加上判断条件，即当 Promise 的状态为 pending 时才能进入代码块执行代码；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>实现以上功能后，我们需要对代码进行优化，即执行器函数调用时，可能发生一些未知的错误，为了避免程序因为抛出错误导致程序崩溃，我们将执行器函数调用放到 try-catch 语句中；<br>优化后代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//捕获Promise状态发生错误的第三种方式</span></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">  <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-then-方法的实现\"><a href=\"#🥇-then-方法的实现\" class=\"headerlink\" title=\"🥇 then()方法的实现\"></a>🥇 then()方法的实现</h2><p>在 Promise 状态发生改变后，无论成功后者失败，都会触发 then 内部的回调函数；然后根据 Promise 改变后的状态，去判断是执行成功的回调函数还是失败的回调函数；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>定义完 then()方法后进行测试，发现在执行 resolve 或者执行 reject 函数改变 Promise 状态时，如果函数的调用是异步的，就会导致在调用 then 方法时，异步的代码还未执行，Promise 状态还是 pending，就无法执行 then 方法内部的成功和失败的回调函数；<br>测试失败的 demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> myP = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;执行&#x27;</span>)</span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">reject</span>(<span class=\"number\">3</span>)</span><br><span class=\"line\">  &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">myP.<span class=\"title function_\">then</span>(</span><br><span class=\"line\">  <span class=\"keyword\">function</span> (<span class=\"params\">res</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"keyword\">function</span> (<span class=\"params\">err</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>因为以上 reject(3) ，在定时器里面是异步的，而 then()方法是同步的，所以控制台并未打印出 3；执行流程如下图所示；</p>\n<img src=\"/2021/06/01/PromiseOne/promise4.png\" class=\"lazyload\" data-srcset=\"/2021/06/01/PromiseOne/promise4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>解决此问题思路，在 then 方法内若判断 Promise 状态是 pending，说明改变 Promise 状态的函数是异步的，还未执行，此时我们直接将失败和成功后调用的回调函数存到一个数组中，当执行完异步队列中的改变 Promise 状态的函数时再进行调用；优化后的 then()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上的 resolvedCallback、rejectedCallback 为定义的两个空数组；将回调函数存入数组后，在执行异步队列中的函数时，遍历数组，然后再执行数组中存的成功或失败的回调函数；<br>优化 resolve 和 reject 函数后的完整代码如下所示；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\">    <span class=\"comment\">//定义数组用来存放回调函数</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span> = []</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span> = []</span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">        <span class=\"comment\">//  改变完状态执行数组中的回调函数</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> <span class=\"title function_\">item</span>())</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">        <span class=\"comment\">// 改变完状态执行数组中的回调函数</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> <span class=\"title function_\">item</span>())</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时就完成了 then()方法的包括支持异步的功能；本片文章就讲到这里，下篇文章将接着带领大家实现 then 方法的链式调用功能；</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>众所周知由于多层回调函数相互嵌套，代码耦合性太强，牵一发而动全身，导致代码难以维护，可读性差，所以为了解决回调地狱问题，ES6 新增了 Promise 的概念。相信内置的 Promise 大家都会使用了，但是 Promise 实现的原理，大家一定还很陌生，本篇文章将带领大家一步步封装自己的 Promise；</p>\n<img src=\"/2021/06/01/PromiseOne/promise1.png\" class=\"\">\n\n<h2 id=\"手写-Promise-前必读\"><a href=\"#手写-Promise-前必读\" class=\"headerlink\" title=\"手写 Promise 前必读\"></a>手写 Promise 前必读</h2><p>在手写 Promise 之前我们需要了解 Promise 的三个状态，Promise 是一个有状态的对象，可能处于如下 3 种状态之一：<br> ==待定（pending）==<br> ==兑现（fulfilled，有时候也称为“解决”，resolved）==<br> ==拒绝（rejected）==<br>待定（pending）是 Promise 的最初始状态。在待定状态下，Promise 可以落定（settled）为代表成功的兑现（fulfilled）状态，或者代表失败的拒绝（rejected）状态。无论落定为哪种状态都是==不可逆==的。只要从待定转换为兑现或拒绝，Promise 的状态就不再改变。而且，也不能保证期约必然会脱离待定状态。因此，组织合理的代码无论 Promise 解决（resolve）还是拒绝（reject），甚至永远处于待定（pending）状态，都应该具有恰当的行为。重要的是，Promise 的状态是私有的，不能直接通过 JavaScript 检测到。这主要是为了避免根据读取到的期约状态，以同步方式处理 Promise 对象。另外，Promise 的状态也不能被外部 JavaScript 代码修改。这与不能读取该状态的原因是一样的：Promise 故意将异步行为封装起来，从而隔离外部的同步代码。<br>📣 注意：在 Promise 的状态发生改变后就会发生状态凝固，即状态不能再次改变；</p>\n<h2 id=\"🥇-实现-Promise-的基本功能\"><a href=\"#🥇-实现-Promise-的基本功能\" class=\"headerlink\" title=\"🥇 实现 Promise 的基本功能\"></a>🥇 实现 Promise 的基本功能</h2><p>首先我们先用内置 Promises 创建一个实例对象，传入一个函数，内部打印 11，运行后发现控制台输出了 11，说明传入 Promise 的函数在 new 一个 Promise 实例时，会立即调用；</p>\n<img src=\"/2021/06/01/PromiseOne/promise2.png\" class=\"\">\n<p>那么我们如何实现此功能呢？<br>实际上在创建 Promise 实例对象时传入的参数叫做执行器函数（executor），若想 new 一个 Promise 的同时调用函数，执行器的函数的调用必须写在 Promise 类的 constructor 函数内部，这样每次创建 Promise 实例时，都会执行 constructor 函数，即可调用 executor 函数；在调用执行器函数的同时我们需要传入 resolve、reject 函数用来处理 Promise 的状态，状态即为前面提到的三种状态；<br>代码示例如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">    <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们将此 js 代码引入一个 html 页面覆盖内置的 Promise 测试此功能；如果能正常打印 11 即为成功；</p>\n<img src=\"/2021/06/01/PromiseOne/promise3.png\" class=\"\">\n<p>实现以上功能以后我们接着定义构造器函数(executor)内部的两个处理 Promise 状态的函数 resolve 和 reject，在定义两个状态处理函数前我们要先初始化 Promise 的初始状态为 pending(待定),而且要先定义 resolve 和 reject 函数执行成功的结果和执行失败的原因；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\">    <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">    <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在定义 Promise 的两个改变状态的函数前我们需要了解 Promise/A+规范的关于状态凝固的概念，即 resolve 和 reject 函数处理 Promise 状态是不可逆的，即执行完函数改变 Promise 状态后不能再次改变 Promise 的状态即状态凝固了；<br>基于规范的状态改变的不可逆性，我们需要在函数内部加上判断条件，即当 Promise 的状态为 pending 时才能进入代码块执行代码；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>实现以上功能后，我们需要对代码进行优化，即执行器函数调用时，可能发生一些未知的错误，为了避免程序因为抛出错误导致程序崩溃，我们将执行器函数调用放到 try-catch 语句中；<br>优化后代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//捕获Promise状态发生错误的第三种方式</span></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">  <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-then-方法的实现\"><a href=\"#🥇-then-方法的实现\" class=\"headerlink\" title=\"🥇 then()方法的实现\"></a>🥇 then()方法的实现</h2><p>在 Promise 状态发生改变后，无论成功后者失败，都会触发 then 内部的回调函数；然后根据 Promise 改变后的状态，去判断是执行成功的回调函数还是失败的回调函数；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>定义完 then()方法后进行测试，发现在执行 resolve 或者执行 reject 函数改变 Promise 状态时，如果函数的调用是异步的，就会导致在调用 then 方法时，异步的代码还未执行，Promise 状态还是 pending，就无法执行 then 方法内部的成功和失败的回调函数；<br>测试失败的 demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> myP = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"keyword\">function</span> (<span class=\"params\">resolve, reject</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;执行&#x27;</span>)</span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">reject</span>(<span class=\"number\">3</span>)</span><br><span class=\"line\">  &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">myP.<span class=\"title function_\">then</span>(</span><br><span class=\"line\">  <span class=\"keyword\">function</span> (<span class=\"params\">res</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"keyword\">function</span> (<span class=\"params\">err</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>因为以上 reject(3) ，在定时器里面是异步的，而 then()方法是同步的，所以控制台并未打印出 3；执行流程如下图所示；</p>\n<img src=\"/2021/06/01/PromiseOne/promise4.png\" class=\"\">\n<p>解决此问题思路，在 then 方法内若判断 Promise 状态是 pending，说明改变 Promise 状态的函数是异步的，还未执行，此时我们直接将失败和成功后调用的回调函数存到一个数组中，当执行完异步队列中的改变 Promise 状态的函数时再进行调用；优化后的 then()</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上的 resolvedCallback、rejectedCallback 为定义的两个空数组；将回调函数存入数组后，在执行异步队列中的函数时，遍历数组，然后再执行数组中存的成功或失败的回调函数；<br>优化 resolve 和 reject 函数后的完整代码如下所示；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Promise</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">constructor</span>(<span class=\"params\">executor</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;pending&#x27;</span> <span class=\"comment\">//Promise初始状态</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"literal\">undefined</span> <span class=\"comment\">//执行成功的结果</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = undefine <span class=\"comment\">//执行失败的结果</span></span><br><span class=\"line\">    <span class=\"comment\">//定义数组用来存放回调函数</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span> = []</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span> = []</span><br><span class=\"line\">    <span class=\"comment\">// 定义resolve函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">resolve</span> = (<span class=\"params\">value</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;fulfiled&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">        <span class=\"comment\">//  改变完状态执行数组中的回调函数</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> <span class=\"title function_\">item</span>())</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//定义reject函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"title function_\">reject</span> = (<span class=\"params\">reason</span>) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">state</span> = <span class=\"string\">&#x27;rejected&#x27;</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">reason</span> = reason</span><br><span class=\"line\">        <span class=\"comment\">// 改变完状态执行数组中的回调函数</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> <span class=\"title function_\">item</span>())</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//调用执行器函数</span></span><br><span class=\"line\">      <span class=\"title function_\">executor</span>(resolve, reject)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为resolved时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;resolved&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Promise状态为rejected时</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时就完成了 then()方法的包括支持异步的功能；本片文章就讲到这里，下篇文章将接着带领大家实现 then 方法的链式调用功能；</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"手写 Promise (二)","description":"本篇文章将继续带领大家一步步封装自己的Promise；","headimg":"/images/promise.jpeg","date":"2021-06-03T16:00:00.000Z","_content":"\n## 前言\n\n上一篇文章，我们已经实现 Promise 的基本功能和 then 方法的封装，解决了 then 方法中存在的异步问题；本篇文章我将带领大家实现 then 方法的链式调用，若想实现链式调用，首先我们要想到的是，then 方法必须要返回一个新的 Promise，这样 then 就能不断的调用，其次前一个 then 返回的值能够传给后一个 then；很显然上一篇文章封装的 then 方法实现不了, 这两个功能；这篇文章我将带领大家一步步完善 then 方法，实现 then 方法的链式调用；\n{% asset_img promiseto1.png %}\n\n## then 的链式调用\n\n前言中已经描述了，要想实现链式调用分为两步， 首先 then 方法内部要返回一个新的 Promise，其次后一个 then 能接收前一个 then 的返回值；\n\n**实现 then 方法内部返回一个 Promise**\n在调用 then 方法时，立即 new 一个新的 Promise 实例，然后将实例返回出去，即直接在 then 方法内部 new 一个 Promise 对象，将上一篇文章封装的 then 方法剪切到新的 Promise 的处理器函数内部；\n代码示例如下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        onResolved(this.value)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        onRejected(this.reason)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          onResolved(this.value)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          onRejected(this.reason)\n        })\n      }\n    })\n    return promise2\n  }\n}\n```\n\n此时已经实现了每次调用 then 方法都能返回一个 Promise 实例，但是上一个 then 返回的结果和下一个 then 并没有产生联系，下面带大家继续完善；\n\n**then 方法内部返回值传给下一个 then**\n实现思路很简单就是将上一个 then 返回的值作为一个参数传入 resolve 或 reject 函数中并调用一下，这样下一个 then 就能接收上一个 then 返回的值；代码实例如下：\n\n```javascript\n\n  then(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        const x = onResolved(this.value)\n        resolve(x)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        const x = onRejected(this.reason)\n        reject(x)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          const x = onResolved(this.value)\n          resolve(x)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          const x = onRejected(this.reason)\n          reject(x)\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n以上便实现了 then 链式 调用的基本功能；\n\n## x 的类型判断、循环引用的处理\n\n以上已经实现了 then 链式的基本功能，但是仅支持返回数值的情况，在实际项目中往往前一个 then 返回的是一个 Promise 实例，此时下一个 then 接收的是一个 Promise 实例，demo 如下：\n\n```javascript\nvar p = new Promise((resolve, reject) => {\n  setTimeout(() => {\n    resolve(4)\n  }, 0)\n})\np.then((res) => {\n  return new Promise(() => {\n    resolve('ok')\n  })\n}).then((data) => {\n  console.log(data)\n})\n```\n\n以上的 demo 中第一个 then()中 resolve 在 Promise 实例的执行器函数中，在第二个 then 的函数中接收的是 Promise 实例对象；因此我们需要对上一个 then 返回的值的类型进行判断，如果返回的是 Promise 对象再调用一下 then 方法，如果返回的是普通值，直接 resolve 出去就行了，因为对第一个 then 返回的值的类型需要判断很多次，因此我们在外部封装一个函数，需要的时候调用就行了；代码示例如下所示：\n\n```javascript\nconst resolvePromise = (x, resolve, reject) => {\n  //x是Promise实例对象\n  if (x instanceof Promise) {\n    x.then(resolve, reject)\n  } else {\n    //x是普通值\n    resolve(x)\n  }\n}\n```\n\n封装好函数后，我们将 then 方法内部的内部优化一下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        const x = onResolved(this.value)\n        resolvePromise(x, resolve, reject)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        const x = onRejected(this.reason)\n        resolvePromise(x, resolve, reject)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          const x = onResolved(this.value)\n          resolvePromise(x, resolve, reject)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          const x = onRejected(this.reason)\n          resolvePromise(x, resolve, reject)\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n此时你一定以为 then 的链式调用已经完成，实际上还存在一个很棘手的问题，即==循环引用==，循环引用的 demo 如下图所示\n{% asset_img promiseto2.png %}\n如上图的 then 方法返回的值是它本身，这样会导致 p2 一值等待 then 方法的返回，造成了==循环引用==，下面我们将对循环引用进行处理；\n\n**循环引用的处理**\n此时需要 我们在外部封装的函数中对上一个 then 方法返回的值 x 进行判断，如果返回的值 x 全等于新 new 的 promise2，就直接抛出一个循环引用的错误 reject 出去，代码示例如下：\n\n```javascript\nconst resolvePromise = (x, resolve, reject, promise2) => {\n  // 处理循环调用问题\n  if (x === promise2) {\n    console.log(reject)\n    return reject(reject(new TypeError('chaining cycle')))\n  }\n  //x是Promise\n  if (x instanceof Promise) {\n    x.then(resolve, reject)\n  } else {\n    //x是普通值\n    resolve(x)\n  }\n}\n```\n\n此时运行后仍然会报错,很显然是因为调用上面的函数是同步的，在调用上面的函数，传入参数时，还拿不到 promise2，此时我们需要将调用 resolvePromise 函数处理成异步的，就能传入 promise2 这个参数；\n代码示例如下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        //将内部代码处理异步，不然拿不到promise2\n        setTimeout(() => {\n          try {\n            let x = onResolved(this.value)\n            resolvePromise(x, resolve, reject, promise2)\n          } catch (err) {\n            reject(err)\n          }\n        }, 0)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        setTimeout(() => {\n          try {\n            const x = onRejected(this.reason)\n            resolvePromise(x, resolve, reject, promise2) //????????\n          } catch (err) {\n            reject(err)\n          }\n        }, 0)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          setTimeout(() => {\n            try {\n              const x = onResolved(this.value)\n              resolvePromise(x, resolve, reject, promise2)\n            } catch (err) {\n              reject(err)\n            }\n          })\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          setTimeout(() => {\n            try {\n              const x = onRejected(this.reason)\n              resolvePromise(x, resolve, reject, promise2)\n            } catch (err) {\n              reject(err)\n            }\n          })\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n以上代码就解决了循环引用问题，下面我们来测试一下测试 demo 如下：\n\n```javascript\nconst p = new Promise((resolve, reject) => {\n  resolve(22)\n})\nconst p2 = p.then((res) => {\n  console.log(res)\n  return p2\n})\n```\n\n运行代码后控制台打印 22 ， 并抛出循环引用的错误即成功\n{% asset_img promiseto3.png %}\n本篇文章只讲到这里，下一篇文章将带领大家对代码进行优化，以及封装 Promise 的静态方法；\n\n# 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/PromiseTo.md","raw":"---\ntitle: 手写 Promise (二)\ndescription: 本篇文章将继续带领大家一步步封装自己的Promise；\nheadimg: /images/promise.jpeg\ndate: 2021-06-04\ntags:\n  - Promise\ncategories:\n  - Promise\n---\n\n## 前言\n\n上一篇文章，我们已经实现 Promise 的基本功能和 then 方法的封装，解决了 then 方法中存在的异步问题；本篇文章我将带领大家实现 then 方法的链式调用，若想实现链式调用，首先我们要想到的是，then 方法必须要返回一个新的 Promise，这样 then 就能不断的调用，其次前一个 then 返回的值能够传给后一个 then；很显然上一篇文章封装的 then 方法实现不了, 这两个功能；这篇文章我将带领大家一步步完善 then 方法，实现 then 方法的链式调用；\n{% asset_img promiseto1.png %}\n\n## then 的链式调用\n\n前言中已经描述了，要想实现链式调用分为两步， 首先 then 方法内部要返回一个新的 Promise，其次后一个 then 能接收前一个 then 的返回值；\n\n**实现 then 方法内部返回一个 Promise**\n在调用 then 方法时，立即 new 一个新的 Promise 实例，然后将实例返回出去，即直接在 then 方法内部 new 一个 Promise 对象，将上一篇文章封装的 then 方法剪切到新的 Promise 的处理器函数内部；\n代码示例如下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        onResolved(this.value)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        onRejected(this.reason)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          onResolved(this.value)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          onRejected(this.reason)\n        })\n      }\n    })\n    return promise2\n  }\n}\n```\n\n此时已经实现了每次调用 then 方法都能返回一个 Promise 实例，但是上一个 then 返回的结果和下一个 then 并没有产生联系，下面带大家继续完善；\n\n**then 方法内部返回值传给下一个 then**\n实现思路很简单就是将上一个 then 返回的值作为一个参数传入 resolve 或 reject 函数中并调用一下，这样下一个 then 就能接收上一个 then 返回的值；代码实例如下：\n\n```javascript\n\n  then(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        const x = onResolved(this.value)\n        resolve(x)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        const x = onRejected(this.reason)\n        reject(x)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          const x = onResolved(this.value)\n          resolve(x)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          const x = onRejected(this.reason)\n          reject(x)\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n以上便实现了 then 链式 调用的基本功能；\n\n## x 的类型判断、循环引用的处理\n\n以上已经实现了 then 链式的基本功能，但是仅支持返回数值的情况，在实际项目中往往前一个 then 返回的是一个 Promise 实例，此时下一个 then 接收的是一个 Promise 实例，demo 如下：\n\n```javascript\nvar p = new Promise((resolve, reject) => {\n  setTimeout(() => {\n    resolve(4)\n  }, 0)\n})\np.then((res) => {\n  return new Promise(() => {\n    resolve('ok')\n  })\n}).then((data) => {\n  console.log(data)\n})\n```\n\n以上的 demo 中第一个 then()中 resolve 在 Promise 实例的执行器函数中，在第二个 then 的函数中接收的是 Promise 实例对象；因此我们需要对上一个 then 返回的值的类型进行判断，如果返回的是 Promise 对象再调用一下 then 方法，如果返回的是普通值，直接 resolve 出去就行了，因为对第一个 then 返回的值的类型需要判断很多次，因此我们在外部封装一个函数，需要的时候调用就行了；代码示例如下所示：\n\n```javascript\nconst resolvePromise = (x, resolve, reject) => {\n  //x是Promise实例对象\n  if (x instanceof Promise) {\n    x.then(resolve, reject)\n  } else {\n    //x是普通值\n    resolve(x)\n  }\n}\n```\n\n封装好函数后，我们将 then 方法内部的内部优化一下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        const x = onResolved(this.value)\n        resolvePromise(x, resolve, reject)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        const x = onRejected(this.reason)\n        resolvePromise(x, resolve, reject)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          const x = onResolved(this.value)\n          resolvePromise(x, resolve, reject)\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          const x = onRejected(this.reason)\n          resolvePromise(x, resolve, reject)\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n此时你一定以为 then 的链式调用已经完成，实际上还存在一个很棘手的问题，即==循环引用==，循环引用的 demo 如下图所示\n{% asset_img promiseto2.png %}\n如上图的 then 方法返回的值是它本身，这样会导致 p2 一值等待 then 方法的返回，造成了==循环引用==，下面我们将对循环引用进行处理；\n\n**循环引用的处理**\n此时需要 我们在外部封装的函数中对上一个 then 方法返回的值 x 进行判断，如果返回的值 x 全等于新 new 的 promise2，就直接抛出一个循环引用的错误 reject 出去，代码示例如下：\n\n```javascript\nconst resolvePromise = (x, resolve, reject, promise2) => {\n  // 处理循环调用问题\n  if (x === promise2) {\n    console.log(reject)\n    return reject(reject(new TypeError('chaining cycle')))\n  }\n  //x是Promise\n  if (x instanceof Promise) {\n    x.then(resolve, reject)\n  } else {\n    //x是普通值\n    resolve(x)\n  }\n}\n```\n\n此时运行后仍然会报错,很显然是因为调用上面的函数是同步的，在调用上面的函数，传入参数时，还拿不到 promise2，此时我们需要将调用 resolvePromise 函数处理成异步的，就能传入 promise2 这个参数；\n代码示例如下：\n\n```javascript\nthen(onResolved, onRejected) {\n    let promise2 = new Promise((resolve, reject) => {\n      // 如果状态为成功， 执行onResolved函数\n      if (this.state === 'fulfiled') {\n        //将内部代码处理异步，不然拿不到promise2\n        setTimeout(() => {\n          try {\n            let x = onResolved(this.value)\n            resolvePromise(x, resolve, reject, promise2)\n          } catch (err) {\n            reject(err)\n          }\n        }, 0)\n      }\n      //如果状态为失败，执行onRejected函数\n      if (this.state === 'rejected') {\n        setTimeout(() => {\n          try {\n            const x = onRejected(this.reason)\n            resolvePromise(x, resolve, reject, promise2) //????????\n          } catch (err) {\n            reject(err)\n          }\n        }, 0)\n      }\n\n      //如果状态为pending，将回调函数存如数组\n      if (this.state === 'pending') {\n        //将执行成功的回调函数存入数组\n        this.resolvedCallback.push(() => {\n          setTimeout(() => {\n            try {\n              const x = onResolved(this.value)\n              resolvePromise(x, resolve, reject, promise2)\n            } catch (err) {\n              reject(err)\n            }\n          })\n        })\n        //将执行失败的回调函数存入数组\n        this.rejectedCallback.push(() => {\n          setTimeout(() => {\n            try {\n              const x = onRejected(this.reason)\n              resolvePromise(x, resolve, reject, promise2)\n            } catch (err) {\n              reject(err)\n            }\n          })\n        })\n      }\n    })\n    return promise2\n  }\n```\n\n以上代码就解决了循环引用问题，下面我们来测试一下测试 demo 如下：\n\n```javascript\nconst p = new Promise((resolve, reject) => {\n  resolve(22)\n})\nconst p2 = p.then((res) => {\n  console.log(res)\n  return p2\n})\n```\n\n运行代码后控制台打印 22 ， 并抛出循环引用的错误即成功\n{% asset_img promiseto3.png %}\n本篇文章只讲到这里，下一篇文章将带领大家对代码进行优化，以及封装 Promise 的静态方法；\n\n# 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"PromiseTo","published":1,"updated":"2023-03-14T11:41:36.240Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqed0003p5o107le0kck","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上一篇文章，我们已经实现 Promise 的基本功能和 then 方法的封装，解决了 then 方法中存在的异步问题；本篇文章我将带领大家实现 then 方法的链式调用，若想实现链式调用，首先我们要想到的是，then 方法必须要返回一个新的 Promise，这样 then 就能不断的调用，其次前一个 then 返回的值能够传给后一个 then；很显然上一篇文章封装的 then 方法实现不了, 这两个功能；这篇文章我将带领大家一步步完善 then 方法，实现 then 方法的链式调用；</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto1.png\" class=\"lazyload\" data-srcset=\"/2021/06/04/PromiseTo/promiseto1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"then-的链式调用\"><a href=\"#then-的链式调用\" class=\"headerlink\" title=\"then 的链式调用\"></a>then 的链式调用</h2><p>前言中已经描述了，要想实现链式调用分为两步， 首先 then 方法内部要返回一个新的 Promise，其次后一个 then 能接收前一个 then 的返回值；</p>\n<p><strong>实现 then 方法内部返回一个 Promise</strong><br>在调用 then 方法时，立即 new 一个新的 Promise 实例，然后将实例返回出去，即直接在 then 方法内部 new 一个 Promise 对象，将上一篇文章封装的 then 方法剪切到新的 Promise 的处理器函数内部；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时已经实现了每次调用 then 方法都能返回一个 Promise 实例，但是上一个 then 返回的结果和下一个 then 并没有产生联系，下面带大家继续完善；</p>\n<p><strong>then 方法内部返回值传给下一个 then</strong><br>实现思路很简单就是将上一个 then 返回的值作为一个参数传入 resolve 或 reject 函数中并调用一下，这样下一个 then 就能接收上一个 then 返回的值；代码实例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">      <span class=\"title function_\">reject</span>(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        <span class=\"title function_\">reject</span>(x)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上便实现了 then 链式 调用的基本功能；</p>\n<h2 id=\"x-的类型判断、循环引用的处理\"><a href=\"#x-的类型判断、循环引用的处理\" class=\"headerlink\" title=\"x 的类型判断、循环引用的处理\"></a>x 的类型判断、循环引用的处理</h2><p>以上已经实现了 then 链式的基本功能，但是仅支持返回数值的情况，在实际项目中往往前一个 then 返回的是一个 Promise 实例，此时下一个 then 接收的是一个 Promise 实例，demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(<span class=\"number\">4</span>)</span><br><span class=\"line\">  &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">p.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;ok&#x27;</span>)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>以上的 demo 中第一个 then()中 resolve 在 Promise 实例的执行器函数中，在第二个 then 的函数中接收的是 Promise 实例对象；因此我们需要对上一个 then 返回的值的类型进行判断，如果返回的是 Promise 对象再调用一下 then 方法，如果返回的是普通值，直接 resolve 出去就行了，因为对第一个 then 返回的值的类型需要判断很多次，因此我们在外部封装一个函数，需要的时候调用就行了；代码示例如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">resolvePromise</span> = (<span class=\"params\">x, resolve, reject</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">//x是Promise实例对象</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) &#123;</span><br><span class=\"line\">    x.<span class=\"title function_\">then</span>(resolve, reject)</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//x是普通值</span></span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>封装好函数后，我们将 then 方法内部的内部优化一下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时你一定以为 then 的链式调用已经完成，实际上还存在一个很棘手的问题，即==循环引用==，循环引用的 demo 如下图所示</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto2.png\" class=\"lazyload\" data-srcset=\"/2021/06/04/PromiseTo/promiseto2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>如上图的 then 方法返回的值是它本身，这样会导致 p2 一值等待 then 方法的返回，造成了==循环引用==，下面我们将对循环引用进行处理；</p>\n<p><strong>循环引用的处理</strong><br>此时需要 我们在外部封装的函数中对上一个 then 方法返回的值 x 进行判断，如果返回的值 x 全等于新 new 的 promise2，就直接抛出一个循环引用的错误 reject 出去，代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">resolvePromise</span> = (<span class=\"params\">x, resolve, reject, promise2</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 处理循环调用问题</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x === promise2) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(reject)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(<span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">TypeError</span>(<span class=\"string\">&#x27;chaining cycle&#x27;</span>)))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//x是Promise</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) &#123;</span><br><span class=\"line\">    x.<span class=\"title function_\">then</span>(resolve, reject)</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//x是普通值</span></span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时运行后仍然会报错,很显然是因为调用上面的函数是同步的，在调用上面的函数，传入参数时，还拿不到 promise2，此时我们需要将调用 resolvePromise 函数处理成异步的，就能传入 promise2 这个参数；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将内部代码处理异步，不然拿不到promise2</span></span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">            <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">          &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">            <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2) <span class=\"comment\">//????????</span></span><br><span class=\"line\">          &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">              <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">              <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">              <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">              <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">              <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">              <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码就解决了循环引用问题，下面我们来测试一下测试 demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> p = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">resolve</span>(<span class=\"number\">22</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">const</span> p2 = p.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> p2</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>运行代码后控制台打印 22 ， 并抛出循环引用的错误即成功</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto3.png\" class=\"lazyload\" data-srcset=\"/2021/06/04/PromiseTo/promiseto3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>本篇文章只讲到这里，下一篇文章将带领大家对代码进行优化，以及封装 Promise 的静态方法；</p>\n<h1 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h1><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上一篇文章，我们已经实现 Promise 的基本功能和 then 方法的封装，解决了 then 方法中存在的异步问题；本篇文章我将带领大家实现 then 方法的链式调用，若想实现链式调用，首先我们要想到的是，then 方法必须要返回一个新的 Promise，这样 then 就能不断的调用，其次前一个 then 返回的值能够传给后一个 then；很显然上一篇文章封装的 then 方法实现不了, 这两个功能；这篇文章我将带领大家一步步完善 then 方法，实现 then 方法的链式调用；</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto1.png\" class=\"\">\n\n<h2 id=\"then-的链式调用\"><a href=\"#then-的链式调用\" class=\"headerlink\" title=\"then 的链式调用\"></a>then 的链式调用</h2><p>前言中已经描述了，要想实现链式调用分为两步， 首先 then 方法内部要返回一个新的 Promise，其次后一个 then 能接收前一个 then 的返回值；</p>\n<p><strong>实现 then 方法内部返回一个 Promise</strong><br>在调用 then 方法时，立即 new 一个新的 Promise 实例，然后将实例返回出去，即直接在 then 方法内部 new 一个 Promise 对象，将上一篇文章封装的 then 方法剪切到新的 Promise 的处理器函数内部；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时已经实现了每次调用 then 方法都能返回一个 Promise 实例，但是上一个 then 返回的结果和下一个 then 并没有产生联系，下面带大家继续完善；</p>\n<p><strong>then 方法内部返回值传给下一个 then</strong><br>实现思路很简单就是将上一个 then 返回的值作为一个参数传入 resolve 或 reject 函数中并调用一下，这样下一个 then 就能接收上一个 then 返回的值；代码实例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">      <span class=\"title function_\">reject</span>(x)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        <span class=\"title function_\">reject</span>(x)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上便实现了 then 链式 调用的基本功能；</p>\n<h2 id=\"x-的类型判断、循环引用的处理\"><a href=\"#x-的类型判断、循环引用的处理\" class=\"headerlink\" title=\"x 的类型判断、循环引用的处理\"></a>x 的类型判断、循环引用的处理</h2><p>以上已经实现了 then 链式的基本功能，但是仅支持返回数值的情况，在实际项目中往往前一个 then 返回的是一个 Promise 实例，此时下一个 then 接收的是一个 Promise 实例，demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> p = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(<span class=\"number\">4</span>)</span><br><span class=\"line\">  &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">p.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(<span class=\"string\">&#x27;ok&#x27;</span>)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(data)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>以上的 demo 中第一个 then()中 resolve 在 Promise 实例的执行器函数中，在第二个 then 的函数中接收的是 Promise 实例对象；因此我们需要对上一个 then 返回的值的类型进行判断，如果返回的是 Promise 对象再调用一下 then 方法，如果返回的是普通值，直接 resolve 出去就行了，因为对第一个 then 返回的值的类型需要判断很多次，因此我们在外部封装一个函数，需要的时候调用就行了；代码示例如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">resolvePromise</span> = (<span class=\"params\">x, resolve, reject</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">//x是Promise实例对象</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) &#123;</span><br><span class=\"line\">    x.<span class=\"title function_\">then</span>(resolve, reject)</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//x是普通值</span></span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>封装好函数后，我们将 then 方法内部的内部优化一下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">        <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">          <span class=\"title function_\">resolvePromise</span>(x, resolve, reject)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时你一定以为 then 的链式调用已经完成，实际上还存在一个很棘手的问题，即==循环引用==，循环引用的 demo 如下图所示</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto2.png\" class=\"\">\n<p>如上图的 then 方法返回的值是它本身，这样会导致 p2 一值等待 then 方法的返回，造成了==循环引用==，下面我们将对循环引用进行处理；</p>\n<p><strong>循环引用的处理</strong><br>此时需要 我们在外部封装的函数中对上一个 then 方法返回的值 x 进行判断，如果返回的值 x 全等于新 new 的 promise2，就直接抛出一个循环引用的错误 reject 出去，代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">resolvePromise</span> = (<span class=\"params\">x, resolve, reject, promise2</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 处理循环调用问题</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x === promise2) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(reject)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(<span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">TypeError</span>(<span class=\"string\">&#x27;chaining cycle&#x27;</span>)))</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//x是Promise</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (x <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) &#123;</span><br><span class=\"line\">    x.<span class=\"title function_\">then</span>(resolve, reject)</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//x是普通值</span></span><br><span class=\"line\">    <span class=\"title function_\">resolve</span>(x)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时运行后仍然会报错,很显然是因为调用上面的函数是同步的，在调用上面的函数，传入参数时，还拿不到 promise2，此时我们需要将调用 resolvePromise 函数处理成异步的，就能传入 promise2 这个参数；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">then</span>(<span class=\"params\">onResolved, onRejected</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 如果状态为成功， 执行onResolved函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;fulfiled&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将内部代码处理异步，不然拿不到promise2</span></span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">            <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">          &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//如果状态为失败，执行onRejected函数</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;rejected&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">            <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2) <span class=\"comment\">//????????</span></span><br><span class=\"line\">          &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;, <span class=\"number\">0</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//如果状态为pending，将回调函数存如数组</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;pending&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//将执行成功的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">resolvedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">              <span class=\"keyword\">const</span> x = <span class=\"title function_\">onResolved</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">              <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">              <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        <span class=\"comment\">//将执行失败的回调函数存入数组</span></span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"property\">rejectedCallback</span>.<span class=\"title function_\">push</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">              <span class=\"keyword\">const</span> x = <span class=\"title function_\">onRejected</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">reason</span>)</span><br><span class=\"line\">              <span class=\"title function_\">resolvePromise</span>(x, resolve, reject, promise2)</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">              <span class=\"title function_\">reject</span>(err)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码就解决了循环引用问题，下面我们来测试一下测试 demo 如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> p = <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">resolve</span>(<span class=\"number\">22</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">const</span> p2 = p.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(res)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> p2</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>运行代码后控制台打印 22 ， 并抛出循环引用的错误即成功</p>\n<img src=\"/2021/06/04/PromiseTo/promiseto3.png\" class=\"\">\n<p>本篇文章只讲到这里，下一篇文章将带领大家对代码进行优化，以及封装 Promise 的静态方法；</p>\n<h1 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h1><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"Promise 如何控制并发","description":"某一个项目页面十分复杂，进入页面初始化时，产生了很多的http请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；","headimg":"/images/promise.jpeg","date":"2021-05-28T16:00:00.000Z","_content":"\n## 问题产生背景\n\n某一个项目页面十分复杂，进入页面初始化时，产生了很多的 http 请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；\n\n## 实现方式\n\n### 方式一\n\n```javascript\n//自定义请求函数\nconst request = (url) => {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(`请求${url}完成`)\n    }, 1000)\n  }).then((res) => {\n    console.log('外部逻辑', res)\n  })\n}\n\n//添加请求\nconst addRequest = (url) => {\n  let requestTask = request(url)\n  container.push(requestTask)\n  requestTask.then((res) => {\n    //请求结束后将该 Promise 任务从并发池中移除\n    pool.splice(container.indexOf(requestTask), 1)\n    console.log(`${url} 结束，当前并发数：${container.length}`)\n    url = urls.shift()\n    //每当并发池完成一个任务，同时添加一个任务\n    if (url !== undefined) {\n      addRequest(url)\n    }\n  })\n}\n\nlet requestUrls = ['xxx1.com', 'xxx2.com', 'xxx3.com', 'xxx4.com', 'xxx5.com', 'xxx6.com', 'xxx7.com'] // 请求地址\nlet container = [] //并发请求容器\nlet max = 3 //最大并发请求数量\n//先循环把并发池塞满\nwhile (container.length < max) {\n  let requestUrl = requestUrls.shift()\n  addTask(requestUrl)\n}\n```\n\n### 方式二\n\n```javascript\n//自定义请求函数\nconst request = (url) => {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(`请求${url}完成`)\n    }, 1000)\n  }).then((res) => {\n    console.log('外部逻辑', res)\n  })\n}\n\n//添加请求任务\nconst addTask = (url) => {\n  let task = request(url)\n  pool.push(task)\n  task.then((res) => {\n    //请求结束后将该 Promise 任务从并发池中移除\n    pool.splice(pool.indexOf(task), 1)\n    console.log(`${url} 结束，当前并发数：${pool.length}`)\n  })\n}\n////每当并发池完成一个任务，同时添加一个任务\nconst run = (hasFinishTask) => {\n  hasFinishTask.then((res) => {\n    let url = requestUrls.shift()\n    if (url !== undefined) {\n      addTask(url)\n      run(Promise.race(container))\n    }\n  })\n}\n\nlet requestUrls = ['xxx1.com', 'xxx2.com', 'xxx3.com', 'xxx4.com', 'xxx5.com', 'xxx6.com', 'xxx7.com'] // 请求地址\nlet container = [] //并发请求容器\nlet max = 3 //最大并发请求数量\n//先循环把并发池塞满\nwhile (container.length < max) {\n  let requestUrl = requestUrls.shift()\n  addTask(requestUrl)\n}\n//利用 Promise.race 方法来获得并发池中某任务完成的信号\nlet hasFinishTask = Promise.race(container)\nrun(hasFinishTask)\n```\n\n## 写在最后\n\n以上提供的两种方式，区别在于方式二使用了 Promise.race() 方法获取并发池中完成任务的信号，并删除任务，重新添加任务；两种方式的统一思路为：\n• 初始化一个数组存放并发请求\n• 初始化一个最大并发数变量\n• 循环将并发请求的数组塞满\n• 在每发起一次请求后删除本次请求并添加新的请求到并发请求的数组中\n以上就是实 Promise 并发请求的思路，大家有其他实现方法欢迎留言交流\n\n```\n\n```\n","source":"_posts/Promiseall.md","raw":"---\ntitle: Promise 如何控制并发\ndescription: 某一个项目页面十分复杂，进入页面初始化时，产生了很多的http请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；\nheadimg: /images/promise.jpeg\ndate: 2021-05-29\ntags:\n  - Promise\ncategories:\n  - Promise\n---\n\n## 问题产生背景\n\n某一个项目页面十分复杂，进入页面初始化时，产生了很多的 http 请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；\n\n## 实现方式\n\n### 方式一\n\n```javascript\n//自定义请求函数\nconst request = (url) => {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(`请求${url}完成`)\n    }, 1000)\n  }).then((res) => {\n    console.log('外部逻辑', res)\n  })\n}\n\n//添加请求\nconst addRequest = (url) => {\n  let requestTask = request(url)\n  container.push(requestTask)\n  requestTask.then((res) => {\n    //请求结束后将该 Promise 任务从并发池中移除\n    pool.splice(container.indexOf(requestTask), 1)\n    console.log(`${url} 结束，当前并发数：${container.length}`)\n    url = urls.shift()\n    //每当并发池完成一个任务，同时添加一个任务\n    if (url !== undefined) {\n      addRequest(url)\n    }\n  })\n}\n\nlet requestUrls = ['xxx1.com', 'xxx2.com', 'xxx3.com', 'xxx4.com', 'xxx5.com', 'xxx6.com', 'xxx7.com'] // 请求地址\nlet container = [] //并发请求容器\nlet max = 3 //最大并发请求数量\n//先循环把并发池塞满\nwhile (container.length < max) {\n  let requestUrl = requestUrls.shift()\n  addTask(requestUrl)\n}\n```\n\n### 方式二\n\n```javascript\n//自定义请求函数\nconst request = (url) => {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve(`请求${url}完成`)\n    }, 1000)\n  }).then((res) => {\n    console.log('外部逻辑', res)\n  })\n}\n\n//添加请求任务\nconst addTask = (url) => {\n  let task = request(url)\n  pool.push(task)\n  task.then((res) => {\n    //请求结束后将该 Promise 任务从并发池中移除\n    pool.splice(pool.indexOf(task), 1)\n    console.log(`${url} 结束，当前并发数：${pool.length}`)\n  })\n}\n////每当并发池完成一个任务，同时添加一个任务\nconst run = (hasFinishTask) => {\n  hasFinishTask.then((res) => {\n    let url = requestUrls.shift()\n    if (url !== undefined) {\n      addTask(url)\n      run(Promise.race(container))\n    }\n  })\n}\n\nlet requestUrls = ['xxx1.com', 'xxx2.com', 'xxx3.com', 'xxx4.com', 'xxx5.com', 'xxx6.com', 'xxx7.com'] // 请求地址\nlet container = [] //并发请求容器\nlet max = 3 //最大并发请求数量\n//先循环把并发池塞满\nwhile (container.length < max) {\n  let requestUrl = requestUrls.shift()\n  addTask(requestUrl)\n}\n//利用 Promise.race 方法来获得并发池中某任务完成的信号\nlet hasFinishTask = Promise.race(container)\nrun(hasFinishTask)\n```\n\n## 写在最后\n\n以上提供的两种方式，区别在于方式二使用了 Promise.race() 方法获取并发池中完成任务的信号，并删除任务，重新添加任务；两种方式的统一思路为：\n• 初始化一个数组存放并发请求\n• 初始化一个最大并发数变量\n• 循环将并发请求的数组塞满\n• 在每发起一次请求后删除本次请求并添加新的请求到并发请求的数组中\n以上就是实 Promise 并发请求的思路，大家有其他实现方法欢迎留言交流\n\n```\n\n```\n","slug":"Promiseall","published":1,"updated":"2023-03-14T11:41:44.644Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqej0007p5o1dqi20ix6","content":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>某一个项目页面十分复杂，进入页面初始化时，产生了很多的 http 请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；</p>\n<h2 id=\"实现方式\"><a href=\"#实现方式\" class=\"headerlink\" title=\"实现方式\"></a>实现方式</h2><h3 id=\"方式一\"><a href=\"#方式一\" class=\"headerlink\" title=\"方式一\"></a>方式一</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//自定义请求函数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">request</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(<span class=\"string\">`请求<span class=\"subst\">$&#123;url&#125;</span>完成`</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;外部逻辑&#x27;</span>, res)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//添加请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">addRequest</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestTask = <span class=\"title function_\">request</span>(url)</span><br><span class=\"line\">  container.<span class=\"title function_\">push</span>(requestTask)</span><br><span class=\"line\">  requestTask.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//请求结束后将该 Promise 任务从并发池中移除</span></span><br><span class=\"line\">    pool.<span class=\"title function_\">splice</span>(container.<span class=\"title function_\">indexOf</span>(requestTask), <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;url&#125;</span> 结束，当前并发数：<span class=\"subst\">$&#123;container.length&#125;</span>`</span>)</span><br><span class=\"line\">    url = urls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">    <span class=\"comment\">//每当并发池完成一个任务，同时添加一个任务</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (url !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">addRequest</span>(url)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> requestUrls = [<span class=\"string\">&#x27;xxx1.com&#x27;</span>, <span class=\"string\">&#x27;xxx2.com&#x27;</span>, <span class=\"string\">&#x27;xxx3.com&#x27;</span>, <span class=\"string\">&#x27;xxx4.com&#x27;</span>, <span class=\"string\">&#x27;xxx5.com&#x27;</span>, <span class=\"string\">&#x27;xxx6.com&#x27;</span>, <span class=\"string\">&#x27;xxx7.com&#x27;</span>] <span class=\"comment\">// 请求地址</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> container = [] <span class=\"comment\">//并发请求容器</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> max = <span class=\"number\">3</span> <span class=\"comment\">//最大并发请求数量</span></span><br><span class=\"line\"><span class=\"comment\">//先循环把并发池塞满</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (container.<span class=\"property\">length</span> &lt; max) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestUrl = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">  <span class=\"title function_\">addTask</span>(requestUrl)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"方式二\"><a href=\"#方式二\" class=\"headerlink\" title=\"方式二\"></a>方式二</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//自定义请求函数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">request</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(<span class=\"string\">`请求<span class=\"subst\">$&#123;url&#125;</span>完成`</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;外部逻辑&#x27;</span>, res)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//添加请求任务</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">addTask</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> task = <span class=\"title function_\">request</span>(url)</span><br><span class=\"line\">  pool.<span class=\"title function_\">push</span>(task)</span><br><span class=\"line\">  task.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//请求结束后将该 Promise 任务从并发池中移除</span></span><br><span class=\"line\">    pool.<span class=\"title function_\">splice</span>(pool.<span class=\"title function_\">indexOf</span>(task), <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;url&#125;</span> 结束，当前并发数：<span class=\"subst\">$&#123;pool.length&#125;</span>`</span>)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">////每当并发池完成一个任务，同时添加一个任务</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">run</span> = (<span class=\"params\">hasFinishTask</span>) =&gt; &#123;</span><br><span class=\"line\">  hasFinishTask.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> url = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (url !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">addTask</span>(url)</span><br><span class=\"line\">      <span class=\"title function_\">run</span>(<span class=\"title class_\">Promise</span>.<span class=\"title function_\">race</span>(container))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> requestUrls = [<span class=\"string\">&#x27;xxx1.com&#x27;</span>, <span class=\"string\">&#x27;xxx2.com&#x27;</span>, <span class=\"string\">&#x27;xxx3.com&#x27;</span>, <span class=\"string\">&#x27;xxx4.com&#x27;</span>, <span class=\"string\">&#x27;xxx5.com&#x27;</span>, <span class=\"string\">&#x27;xxx6.com&#x27;</span>, <span class=\"string\">&#x27;xxx7.com&#x27;</span>] <span class=\"comment\">// 请求地址</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> container = [] <span class=\"comment\">//并发请求容器</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> max = <span class=\"number\">3</span> <span class=\"comment\">//最大并发请求数量</span></span><br><span class=\"line\"><span class=\"comment\">//先循环把并发池塞满</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (container.<span class=\"property\">length</span> &lt; max) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestUrl = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">  <span class=\"title function_\">addTask</span>(requestUrl)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//利用 Promise.race 方法来获得并发池中某任务完成的信号</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> hasFinishTask = <span class=\"title class_\">Promise</span>.<span class=\"title function_\">race</span>(container)</span><br><span class=\"line\"><span class=\"title function_\">run</span>(hasFinishTask)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上提供的两种方式，区别在于方式二使用了 Promise.race() 方法获取并发池中完成任务的信号，并删除任务，重新添加任务；两种方式的统一思路为：<br>• 初始化一个数组存放并发请求<br>• 初始化一个最大并发数变量<br>• 循环将并发请求的数组塞满<br>• 在每发起一次请求后删除本次请求并添加新的请求到并发请求的数组中<br>以上就是实 Promise 并发请求的思路，大家有其他实现方法欢迎留言交流</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>某一个项目页面十分复杂，进入页面初始化时，产生了很多的 http 请求，造成了并发请求数量过多，可能会造成调用栈的内存溢出，导致页面崩溃，因此需要对请求数量做并发限制；</p>\n<h2 id=\"实现方式\"><a href=\"#实现方式\" class=\"headerlink\" title=\"实现方式\"></a>实现方式</h2><h3 id=\"方式一\"><a href=\"#方式一\" class=\"headerlink\" title=\"方式一\"></a>方式一</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//自定义请求函数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">request</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(<span class=\"string\">`请求<span class=\"subst\">$&#123;url&#125;</span>完成`</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;外部逻辑&#x27;</span>, res)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//添加请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">addRequest</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestTask = <span class=\"title function_\">request</span>(url)</span><br><span class=\"line\">  container.<span class=\"title function_\">push</span>(requestTask)</span><br><span class=\"line\">  requestTask.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//请求结束后将该 Promise 任务从并发池中移除</span></span><br><span class=\"line\">    pool.<span class=\"title function_\">splice</span>(container.<span class=\"title function_\">indexOf</span>(requestTask), <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;url&#125;</span> 结束，当前并发数：<span class=\"subst\">$&#123;container.length&#125;</span>`</span>)</span><br><span class=\"line\">    url = urls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">    <span class=\"comment\">//每当并发池完成一个任务，同时添加一个任务</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (url !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">addRequest</span>(url)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> requestUrls = [<span class=\"string\">&#x27;xxx1.com&#x27;</span>, <span class=\"string\">&#x27;xxx2.com&#x27;</span>, <span class=\"string\">&#x27;xxx3.com&#x27;</span>, <span class=\"string\">&#x27;xxx4.com&#x27;</span>, <span class=\"string\">&#x27;xxx5.com&#x27;</span>, <span class=\"string\">&#x27;xxx6.com&#x27;</span>, <span class=\"string\">&#x27;xxx7.com&#x27;</span>] <span class=\"comment\">// 请求地址</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> container = [] <span class=\"comment\">//并发请求容器</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> max = <span class=\"number\">3</span> <span class=\"comment\">//最大并发请求数量</span></span><br><span class=\"line\"><span class=\"comment\">//先循环把并发池塞满</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (container.<span class=\"property\">length</span> &lt; max) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestUrl = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">  <span class=\"title function_\">addTask</span>(requestUrl)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"方式二\"><a href=\"#方式二\" class=\"headerlink\" title=\"方式二\"></a>方式二</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//自定义请求函数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">request</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(<span class=\"string\">`请求<span class=\"subst\">$&#123;url&#125;</span>完成`</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;外部逻辑&#x27;</span>, res)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//添加请求任务</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">addTask</span> = (<span class=\"params\">url</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> task = <span class=\"title function_\">request</span>(url)</span><br><span class=\"line\">  pool.<span class=\"title function_\">push</span>(task)</span><br><span class=\"line\">  task.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//请求结束后将该 Promise 任务从并发池中移除</span></span><br><span class=\"line\">    pool.<span class=\"title function_\">splice</span>(pool.<span class=\"title function_\">indexOf</span>(task), <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;url&#125;</span> 结束，当前并发数：<span class=\"subst\">$&#123;pool.length&#125;</span>`</span>)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">////每当并发池完成一个任务，同时添加一个任务</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">run</span> = (<span class=\"params\">hasFinishTask</span>) =&gt; &#123;</span><br><span class=\"line\">  hasFinishTask.<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> url = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (url !== <span class=\"literal\">undefined</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">addTask</span>(url)</span><br><span class=\"line\">      <span class=\"title function_\">run</span>(<span class=\"title class_\">Promise</span>.<span class=\"title function_\">race</span>(container))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> requestUrls = [<span class=\"string\">&#x27;xxx1.com&#x27;</span>, <span class=\"string\">&#x27;xxx2.com&#x27;</span>, <span class=\"string\">&#x27;xxx3.com&#x27;</span>, <span class=\"string\">&#x27;xxx4.com&#x27;</span>, <span class=\"string\">&#x27;xxx5.com&#x27;</span>, <span class=\"string\">&#x27;xxx6.com&#x27;</span>, <span class=\"string\">&#x27;xxx7.com&#x27;</span>] <span class=\"comment\">// 请求地址</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> container = [] <span class=\"comment\">//并发请求容器</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> max = <span class=\"number\">3</span> <span class=\"comment\">//最大并发请求数量</span></span><br><span class=\"line\"><span class=\"comment\">//先循环把并发池塞满</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (container.<span class=\"property\">length</span> &lt; max) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> requestUrl = requestUrls.<span class=\"title function_\">shift</span>()</span><br><span class=\"line\">  <span class=\"title function_\">addTask</span>(requestUrl)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//利用 Promise.race 方法来获得并发池中某任务完成的信号</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> hasFinishTask = <span class=\"title class_\">Promise</span>.<span class=\"title function_\">race</span>(container)</span><br><span class=\"line\"><span class=\"title function_\">run</span>(hasFinishTask)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上提供的两种方式，区别在于方式二使用了 Promise.race() 方法获取并发池中完成任务的信号，并删除任务，重新添加任务；两种方式的统一思路为：<br>• 初始化一个数组存放并发请求<br>• 初始化一个最大并发数变量<br>• 循环将并发请求的数组塞满<br>• 在每发起一次请求后删除本次请求并添加新的请求到并发请求的数组中<br>以上就是实 Promise 并发请求的思路，大家有其他实现方法欢迎留言交流</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n"},{"title":"React-redux-dom 刷新页面数据丢失问题","description":"对于React-redux-dom的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是react-redux-dom存在的一个特点是当我们刷新页面重新渲染界面时，reducer返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；","headimg":"/images/redux.jpeg","date":"2021-03-13T16:00:00.000Z","_content":"\n## 前言\n\n对于 React-redux-dom 的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是 react-redux-dom 存在的一个特点是当我们刷新页面重新渲染界面时，reducer 返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；\n\n## 数据丢失问题导致的 401 错误\n\n**控制报错**\n{% asset_img reduxdata1.gif %}\nredux 开发者工具中显示一刷新数据就丢失，如下图所示\n{% asset_img reduxdata2.gif %}\n\n## 问题分析及解决\n\n上述刷新后 redux 开发者工具中显示数据丢失，显然是我在前言中所描述的，当刷新页面时，reducer 会初始化状态，导致数据丢失，若想解决此问题我们显然需要和本地存储一起做个持久化，即 redux 管理的数据存储到 locationStorage 中，当刷新页面时，reducer 初始化的数据先从本地存储中找，若找到了就返回，到 redux 中，找不到再返回空字符串或者对象；代码示例如下：\n\n```javascript\nimport {getToken} from '@/utils/token'\n/**\n * 处理用户登录和退出的action\n * @param {string} preState\n * @param {object} action\n * @returns\n */\nconst initState = getToken() || ''\nconst userlogin = (preState = initState, action) => {\n  switch (action.type) {\n    case 'login/setToken':\n      return action.payload\n    case 'user/logout':\n      return ''\n    default:\n      return preState\n  }\n}\nexport default userlogin\n```\n\n以上的 getToken || \"\" ,就是先从本地存储中拿初始化数据(getToken 是封装好的从本地存储中拿数据的函数)，若没有 getToken()，直接给初始化的状态一个空字符串就会导致每次刷新，redux 中的数据丢失；\n对 redux 不是很熟的同学可以先到 redux 官方文档学习 redux，其链接如下：\n[redux 中文文档](https://www.redux.org.cn/)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/React-redux.md","raw":"---\ntitle: React-redux-dom 刷新页面数据丢失问题\ndescription: 对于React-redux-dom的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是react-redux-dom存在的一个特点是当我们刷新页面重新渲染界面时，reducer返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；\nheadimg: /images/redux.jpeg\ndate: 2021-03-14\ntags:\n  - Redux\ncategories:\n  - Redux\n---\n\n## 前言\n\n对于 React-redux-dom 的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是 react-redux-dom 存在的一个特点是当我们刷新页面重新渲染界面时，reducer 返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；\n\n## 数据丢失问题导致的 401 错误\n\n**控制报错**\n{% asset_img reduxdata1.gif %}\nredux 开发者工具中显示一刷新数据就丢失，如下图所示\n{% asset_img reduxdata2.gif %}\n\n## 问题分析及解决\n\n上述刷新后 redux 开发者工具中显示数据丢失，显然是我在前言中所描述的，当刷新页面时，reducer 会初始化状态，导致数据丢失，若想解决此问题我们显然需要和本地存储一起做个持久化，即 redux 管理的数据存储到 locationStorage 中，当刷新页面时，reducer 初始化的数据先从本地存储中找，若找到了就返回，到 redux 中，找不到再返回空字符串或者对象；代码示例如下：\n\n```javascript\nimport {getToken} from '@/utils/token'\n/**\n * 处理用户登录和退出的action\n * @param {string} preState\n * @param {object} action\n * @returns\n */\nconst initState = getToken() || ''\nconst userlogin = (preState = initState, action) => {\n  switch (action.type) {\n    case 'login/setToken':\n      return action.payload\n    case 'user/logout':\n      return ''\n    default:\n      return preState\n  }\n}\nexport default userlogin\n```\n\n以上的 getToken || \"\" ,就是先从本地存储中拿初始化数据(getToken 是封装好的从本地存储中拿数据的函数)，若没有 getToken()，直接给初始化的状态一个空字符串就会导致每次刷新，redux 中的数据丢失；\n对 redux 不是很熟的同学可以先到 redux 官方文档学习 redux，其链接如下：\n[redux 中文文档](https://www.redux.org.cn/)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"React-redux","published":1,"updated":"2023-03-12T09:37:49.988Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqel0009p5o17a8u3oyc","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>对于 React-redux-dom 的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是 react-redux-dom 存在的一个特点是当我们刷新页面重新渲染界面时，reducer 返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；</p>\n<h2 id=\"数据丢失问题导致的-401-错误\"><a href=\"#数据丢失问题导致的-401-错误\" class=\"headerlink\" title=\"数据丢失问题导致的 401 错误\"></a>数据丢失问题导致的 401 错误</h2><p><strong>控制报错</strong></p>\n<img src=\"/2021/03/14/React-redux/reduxdata1.gif\" class=\"lazyload\" data-srcset=\"/2021/03/14/React-redux/reduxdata1.gif\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>redux 开发者工具中显示一刷新数据就丢失，如下图所示</p>\n<img src=\"/2021/03/14/React-redux/reduxdata2.gif\" class=\"lazyload\" data-srcset=\"/2021/03/14/React-redux/reduxdata2.gif\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"问题分析及解决\"><a href=\"#问题分析及解决\" class=\"headerlink\" title=\"问题分析及解决\"></a>问题分析及解决</h2><p>上述刷新后 redux 开发者工具中显示数据丢失，显然是我在前言中所描述的，当刷新页面时，reducer 会初始化状态，导致数据丢失，若想解决此问题我们显然需要和本地存储一起做个持久化，即 redux 管理的数据存储到 locationStorage 中，当刷新页面时，reducer 初始化的数据先从本地存储中找，若找到了就返回，到 redux 中，找不到再返回空字符串或者对象；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;getToken&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@/utils/token&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 处理用户登录和退出的action</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; <span class=\"variable\">preState</span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">object</span>&#125; <span class=\"variable\">action</span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@returns</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> initState = <span class=\"title function_\">getToken</span>() || <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">userlogin</span> = (<span class=\"params\">preState = initState, action</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span> (action.<span class=\"property\">type</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&#x27;login/setToken&#x27;</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> action.<span class=\"property\">payload</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&#x27;user/logout&#x27;</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">default</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> preState</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> userlogin</span><br></pre></td></tr></table></figure>\n\n<p>以上的 getToken || “” ,就是先从本地存储中拿初始化数据(getToken 是封装好的从本地存储中拿数据的函数)，若没有 getToken()，直接给初始化的状态一个空字符串就会导致每次刷新，redux 中的数据丢失；<br>对 redux 不是很熟的同学可以先到 redux 官方文档学习 redux，其链接如下：<br><a href=\"https://www.redux.org.cn/\">redux 中文文档</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>对于 React-redux-dom 的使用，大家一定是赞赏有加，它的集中式状态管理，使得共享的数据形成一个状态树，任何一个组件需要数据时都可以随时从状态树上访问数据，但是 react-redux-dom 存在的一个特点是当我们刷新页面重新渲染界面时，reducer 返回的初始化状态会将现有的状态树覆盖，导致数据丢失的问题；下面我将结合实例为大家提供解决这个问题的思路；</p>\n<h2 id=\"数据丢失问题导致的-401-错误\"><a href=\"#数据丢失问题导致的-401-错误\" class=\"headerlink\" title=\"数据丢失问题导致的 401 错误\"></a>数据丢失问题导致的 401 错误</h2><p><strong>控制报错</strong></p>\n<img src=\"/2021/03/14/React-redux/reduxdata1.gif\" class=\"\">\n<p>redux 开发者工具中显示一刷新数据就丢失，如下图所示</p>\n<img src=\"/2021/03/14/React-redux/reduxdata2.gif\" class=\"\">\n\n<h2 id=\"问题分析及解决\"><a href=\"#问题分析及解决\" class=\"headerlink\" title=\"问题分析及解决\"></a>问题分析及解决</h2><p>上述刷新后 redux 开发者工具中显示数据丢失，显然是我在前言中所描述的，当刷新页面时，reducer 会初始化状态，导致数据丢失，若想解决此问题我们显然需要和本地存储一起做个持久化，即 redux 管理的数据存储到 locationStorage 中，当刷新页面时，reducer 初始化的数据先从本地存储中找，若找到了就返回，到 redux 中，找不到再返回空字符串或者对象；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;getToken&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@/utils/token&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 处理用户登录和退出的action</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; <span class=\"variable\">preState</span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">object</span>&#125; <span class=\"variable\">action</span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@returns</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> initState = <span class=\"title function_\">getToken</span>() || <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">userlogin</span> = (<span class=\"params\">preState = initState, action</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span> (action.<span class=\"property\">type</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&#x27;login/setToken&#x27;</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> action.<span class=\"property\">payload</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">&#x27;user/logout&#x27;</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">default</span>:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> preState</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> userlogin</span><br></pre></td></tr></table></figure>\n\n<p>以上的 getToken || “” ,就是先从本地存储中拿初始化数据(getToken 是封装好的从本地存储中拿数据的函数)，若没有 getToken()，直接给初始化的状态一个空字符串就会导致每次刷新，redux 中的数据丢失；<br>对 redux 不是很熟的同学可以先到 redux 官方文档学习 redux，其链接如下：<br><a href=\"https://www.redux.org.cn/\">redux 中文文档</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【React 报错】Failed to parse source map","description":"在react中的组件中要引入antd，当引入完运行后报错报错信息为：`Failed to parse source map`,那么如何解决的这个问题呢，下面我为大家提供解决办法；","headimg":"/images/react.jpeg","date":"2021-04-27T16:00:00.000Z","_content":"\n## 前言\n\n在 react 中的组件中要引入 antd，当引入完运行后报错报错信息为：`Failed to parse source map`,那么如何解决的这个问题呢，下面我为大家提供解决办法；\n{% asset_img reacterror1.png %}\n以上图片中的路径在 node_modules 中查找显然是可以查找到的，说明引入的路径没有问题，antd 也确认下载，大部分小伙伴一定和我一样纠结很久，实际的解决过程下面讲解\n\n## 解决报错过程\n\n首先我认为是 webpack 的配置没有配置好，我直接运行了==npm run eject== 调出了 webpack 的配置文件，在里面直接搜索 source map 配置项，并未发现什么问题，纠结许久，我直接将引入的 antd.css 换成 antd.min.css,问题解决；\n{% asset_img reacterror2.png %}\n对于为什么是必须引入压缩过的.min.css 文件，我很是纠结，欢迎大家评论区留言交流\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/React报错.md","raw":"---\ntitle: 【React 报错】Failed to parse source map\ndescription: 在react中的组件中要引入antd，当引入完运行后报错报错信息为：`Failed to parse source map`,那么如何解决的这个问题呢，下面我为大家提供解决办法；\nheadimg: /images/react.jpeg\ndate: 2021-04-28\ntags:\n  - React\ncategories:\n  - React\n---\n\n## 前言\n\n在 react 中的组件中要引入 antd，当引入完运行后报错报错信息为：`Failed to parse source map`,那么如何解决的这个问题呢，下面我为大家提供解决办法；\n{% asset_img reacterror1.png %}\n以上图片中的路径在 node_modules 中查找显然是可以查找到的，说明引入的路径没有问题，antd 也确认下载，大部分小伙伴一定和我一样纠结很久，实际的解决过程下面讲解\n\n## 解决报错过程\n\n首先我认为是 webpack 的配置没有配置好，我直接运行了==npm run eject== 调出了 webpack 的配置文件，在里面直接搜索 source map 配置项，并未发现什么问题，纠结许久，我直接将引入的 antd.css 换成 antd.min.css,问题解决；\n{% asset_img reacterror2.png %}\n对于为什么是必须引入压缩过的.min.css 文件，我很是纠结，欢迎大家评论区留言交流\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"React报错","published":1,"updated":"2023-03-12T09:29:44.820Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqem000bp5o186xcbpui","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在 react 中的组件中要引入 antd，当引入完运行后报错报错信息为：<code>Failed to parse source map</code>,那么如何解决的这个问题呢，下面我为大家提供解决办法；</p>\n<img src=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror1.png\" class=\"lazyload\" data-srcset=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>以上图片中的路径在 node_modules 中查找显然是可以查找到的，说明引入的路径没有问题，antd 也确认下载，大部分小伙伴一定和我一样纠结很久，实际的解决过程下面讲解</p>\n<h2 id=\"解决报错过程\"><a href=\"#解决报错过程\" class=\"headerlink\" title=\"解决报错过程\"></a>解决报错过程</h2><p>首先我认为是 webpack 的配置没有配置好，我直接运行了==npm run eject== 调出了 webpack 的配置文件，在里面直接搜索 source map 配置项，并未发现什么问题，纠结许久，我直接将引入的 antd.css 换成 antd.min.css,问题解决；</p>\n<img src=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror2.png\" class=\"lazyload\" data-srcset=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>对于为什么是必须引入压缩过的.min.css 文件，我很是纠结，欢迎大家评论区留言交流</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在 react 中的组件中要引入 antd，当引入完运行后报错报错信息为：<code>Failed to parse source map</code>,那么如何解决的这个问题呢，下面我为大家提供解决办法；</p>\n<img src=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror1.png\" class=\"\">\n<p>以上图片中的路径在 node_modules 中查找显然是可以查找到的，说明引入的路径没有问题，antd 也确认下载，大部分小伙伴一定和我一样纠结很久，实际的解决过程下面讲解</p>\n<h2 id=\"解决报错过程\"><a href=\"#解决报错过程\" class=\"headerlink\" title=\"解决报错过程\"></a>解决报错过程</h2><p>首先我认为是 webpack 的配置没有配置好，我直接运行了==npm run eject== 调出了 webpack 的配置文件，在里面直接搜索 source map 配置项，并未发现什么问题，纠结许久，我直接将引入的 antd.css 换成 antd.min.css,问题解决；</p>\n<img src=\"/2021/04/28/React%E6%8A%A5%E9%94%99/reacterror2.png\" class=\"\">\n<p>对于为什么是必须引入压缩过的.min.css 文件，我很是纠结，欢迎大家评论区留言交流</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"React 组件的状态下移和内容提升","description":"本篇文章讲解两个简单实用的优化组件渲染性能的方法：状态下移、内容提升","headimg":"/images/react.jpeg","date":"2021-04-27T16:00:00.000Z","_content":"\n## 前言\n\n本专栏的另一篇文章，讲到了 useMemo 有一定的开销，不能滥用，本篇文章讲解两个简单实用的优化组件渲染性能的方法：\n\n- 状态下移\n- 内容提升\n\n在讲解这两种方法之前，我们需要先手动创建一个有严重渲染性能的组件，如下所示：\n\n```javascript\nmport { useState } from 'react';\n\nexport default function App() {\n  let [color, setColor] = useState('red');\n  return (\n    <div>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{ color }}>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  );\n}\n\nfunction ExpensiveTree() {\n  let now = performance.now();\n  while (performance.now() - now < 100) {\n    // Artificial delay -- do nothing for 100ms\n  }\n  return <p>I am a very slow component tree.</p>;\n}\n```\n\n很显然，当 App 组件内的状态发生了改变，ExpensiveTree 组件会 re-render， 事实上 ExpensiveTree 组件的 props、state 并未发生改变，这并不是我们期望的结果，下面将提供两种简单的方法，提升组件渲染的性能；\n\n## 状态下移\n\n```javascript\nexport default function App() {\n  let [color, setColor] = useState('red')\n  return (\n    <div>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{color}}>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  )\n}\n```\n\n我们可以看到以上 ExpensiveTree 组件并不依赖 App 组件内部的状态，因此我们是否可以考虑，将依赖 color 的元素抽离到一个依赖 color 的组件中呢？\n下面是实践后的代码：\n\n```javascript\nexport default function App() {\n  return (\n    <>\n      <Form />\n      <ExpensiveTree />\n    </>\n  )\n}\n\nfunction Form() {\n  let [color, setColor] = useState('red')\n  return (\n    <>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{color}}>Hello, world!</p>\n    </>\n  )\n}\n```\n\n此时，将依赖 color 的元素提取到了 Form 组件中，Form 组件内部的状态不再影响 ExpensiveTree 组件的渲染，问题便得到了解决\n\n## 内容提升\n\n```javascript\nexport default function App() {\n  let [color, setColor] = useState('red')\n  return (\n    <div style={{color}}>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  )\n}\n```\n\n以上情况是高开销组件 ExpensiveTree 的父节点依赖 color，此时显然状态下移是行不通的，但是还有另外一种办法：\n\n```javascript\nexport default function App() {\n  return (\n    <ColorPicker>\n      <p>Hello, world!</p>\n      <ExpensiveTree />\n    </ColorPicker>\n  )\n}\n\nfunction ColorPicker({children}) {\n  let [color, setColor] = useState('red')\n  return (\n    <div style={{color}}>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      {children}\n    </div>\n  )\n}\n```\n\n此时和状态提升是完全相反的，将依赖 color 的元素提升到了 ColorPicker 组件中，而不依赖 color 的元素以 children prop 的形式传入了 ColorPicker ，当组件内部的状态改变时：\n\n- ColorPicker 会重新渲染但是它仍然保存着\n- ColorPicker 的 children 属性未变化 React 并不会访问那棵子树。 因此，ExpensiveTree 不会重新渲染。\n\n## 写在最后\n\n本文提供的方法并不是新的创意，大家一定都有所实践，但是我想表达的是，相比于滥用 useMemo，我们需要首先考虑使用这两种提高组件渲染性能的方法；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/React组件的状态下移和内容提升.md","raw":"---\ntitle: React 组件的状态下移和内容提升\ndescription: 本篇文章讲解两个简单实用的优化组件渲染性能的方法：状态下移、内容提升\nheadimg: /images/react.jpeg\ndate: 2021-04-28\ntags:\n  - React\ncategories:\n  - React\n---\n\n## 前言\n\n本专栏的另一篇文章，讲到了 useMemo 有一定的开销，不能滥用，本篇文章讲解两个简单实用的优化组件渲染性能的方法：\n\n- 状态下移\n- 内容提升\n\n在讲解这两种方法之前，我们需要先手动创建一个有严重渲染性能的组件，如下所示：\n\n```javascript\nmport { useState } from 'react';\n\nexport default function App() {\n  let [color, setColor] = useState('red');\n  return (\n    <div>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{ color }}>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  );\n}\n\nfunction ExpensiveTree() {\n  let now = performance.now();\n  while (performance.now() - now < 100) {\n    // Artificial delay -- do nothing for 100ms\n  }\n  return <p>I am a very slow component tree.</p>;\n}\n```\n\n很显然，当 App 组件内的状态发生了改变，ExpensiveTree 组件会 re-render， 事实上 ExpensiveTree 组件的 props、state 并未发生改变，这并不是我们期望的结果，下面将提供两种简单的方法，提升组件渲染的性能；\n\n## 状态下移\n\n```javascript\nexport default function App() {\n  let [color, setColor] = useState('red')\n  return (\n    <div>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{color}}>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  )\n}\n```\n\n我们可以看到以上 ExpensiveTree 组件并不依赖 App 组件内部的状态，因此我们是否可以考虑，将依赖 color 的元素抽离到一个依赖 color 的组件中呢？\n下面是实践后的代码：\n\n```javascript\nexport default function App() {\n  return (\n    <>\n      <Form />\n      <ExpensiveTree />\n    </>\n  )\n}\n\nfunction Form() {\n  let [color, setColor] = useState('red')\n  return (\n    <>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p style={{color}}>Hello, world!</p>\n    </>\n  )\n}\n```\n\n此时，将依赖 color 的元素提取到了 Form 组件中，Form 组件内部的状态不再影响 ExpensiveTree 组件的渲染，问题便得到了解决\n\n## 内容提升\n\n```javascript\nexport default function App() {\n  let [color, setColor] = useState('red')\n  return (\n    <div style={{color}}>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      <p>Hello, world!</p>\n      <ExpensiveTree />\n    </div>\n  )\n}\n```\n\n以上情况是高开销组件 ExpensiveTree 的父节点依赖 color，此时显然状态下移是行不通的，但是还有另外一种办法：\n\n```javascript\nexport default function App() {\n  return (\n    <ColorPicker>\n      <p>Hello, world!</p>\n      <ExpensiveTree />\n    </ColorPicker>\n  )\n}\n\nfunction ColorPicker({children}) {\n  let [color, setColor] = useState('red')\n  return (\n    <div style={{color}}>\n      <input value={color} onChange={(e) => setColor(e.target.value)} />\n      {children}\n    </div>\n  )\n}\n```\n\n此时和状态提升是完全相反的，将依赖 color 的元素提升到了 ColorPicker 组件中，而不依赖 color 的元素以 children prop 的形式传入了 ColorPicker ，当组件内部的状态改变时：\n\n- ColorPicker 会重新渲染但是它仍然保存着\n- ColorPicker 的 children 属性未变化 React 并不会访问那棵子树。 因此，ExpensiveTree 不会重新渲染。\n\n## 写在最后\n\n本文提供的方法并不是新的创意，大家一定都有所实践，但是我想表达的是，相比于滥用 useMemo，我们需要首先考虑使用这两种提高组件渲染性能的方法；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"React组件的状态下移和内容提升","published":1,"updated":"2023-03-12T09:37:53.236Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqeq000fp5o1b1a9aewm","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本专栏的另一篇文章，讲到了 useMemo 有一定的开销，不能滥用，本篇文章讲解两个简单实用的优化组件渲染性能的方法：</p>\n<ul>\n<li>状态下移</li>\n<li>内容提升</li>\n</ul>\n<p>在讲解这两种方法之前，我们需要先手动创建一个有严重渲染性能的组件，如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mport &#123; useState &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;</span> <span class=\"attr\">color</span> &#125;&#125;&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">ExpensiveTree</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> now = performance.<span class=\"title function_\">now</span>();</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (performance.<span class=\"title function_\">now</span>() - now &lt; <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Artificial delay -- do nothing for 100ms</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>I am a very slow component tree.<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>很显然，当 App 组件内的状态发生了改变，ExpensiveTree 组件会 re-render， 事实上 ExpensiveTree 组件的 props、state 并未发生改变，这并不是我们期望的结果，下面将提供两种简单的方法，提升组件渲染的性能；</p>\n<h2 id=\"状态下移\"><a href=\"#状态下移\" class=\"headerlink\" title=\"状态下移\"></a>状态下移</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们可以看到以上 ExpensiveTree 组件并不依赖 App 组件内部的状态，因此我们是否可以考虑，将依赖 color 的元素抽离到一个依赖 color 的组件中呢？<br>下面是实践后的代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">Form</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Form</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时，将依赖 color 的元素提取到了 Form 组件中，Form 组件内部的状态不再影响 ExpensiveTree 组件的渲染，问题便得到了解决</p>\n<h2 id=\"内容提升\"><a href=\"#内容提升\" class=\"headerlink\" title=\"内容提升\"></a>内容提升</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上情况是高开销组件 ExpensiveTree 的父节点依赖 color，此时显然状态下移是行不通的，但是还有另外一种办法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">ColorPicker</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">ColorPicker</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">ColorPicker</span>(<span class=\"params\">&#123;children&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      &#123;children&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时和状态提升是完全相反的，将依赖 color 的元素提升到了 ColorPicker 组件中，而不依赖 color 的元素以 children prop 的形式传入了 ColorPicker ，当组件内部的状态改变时：</p>\n<ul>\n<li>ColorPicker 会重新渲染但是它仍然保存着</li>\n<li>ColorPicker 的 children 属性未变化 React 并不会访问那棵子树。 因此，ExpensiveTree 不会重新渲染。</li>\n</ul>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>本文提供的方法并不是新的创意，大家一定都有所实践，但是我想表达的是，相比于滥用 useMemo，我们需要首先考虑使用这两种提高组件渲染性能的方法；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本专栏的另一篇文章，讲到了 useMemo 有一定的开销，不能滥用，本篇文章讲解两个简单实用的优化组件渲染性能的方法：</p>\n<ul>\n<li>状态下移</li>\n<li>内容提升</li>\n</ul>\n<p>在讲解这两种方法之前，我们需要先手动创建一个有严重渲染性能的组件，如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mport &#123; useState &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;</span> <span class=\"attr\">color</span> &#125;&#125;&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">ExpensiveTree</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> now = performance.<span class=\"title function_\">now</span>();</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (performance.<span class=\"title function_\">now</span>() - now &lt; <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Artificial delay -- do nothing for 100ms</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>I am a very slow component tree.<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>很显然，当 App 组件内的状态发生了改变，ExpensiveTree 组件会 re-render， 事实上 ExpensiveTree 组件的 props、state 并未发生改变，这并不是我们期望的结果，下面将提供两种简单的方法，提升组件渲染的性能；</p>\n<h2 id=\"状态下移\"><a href=\"#状态下移\" class=\"headerlink\" title=\"状态下移\"></a>状态下移</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们可以看到以上 ExpensiveTree 组件并不依赖 App 组件内部的状态，因此我们是否可以考虑，将依赖 color 的元素抽离到一个依赖 color 的组件中呢？<br>下面是实践后的代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">Form</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Form</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时，将依赖 color 的元素提取到了 Form 组件中，Form 组件内部的状态不再影响 ExpensiveTree 组件的渲染，问题便得到了解决</p>\n<h2 id=\"内容提升\"><a href=\"#内容提升\" class=\"headerlink\" title=\"内容提升\"></a>内容提升</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上情况是高开销组件 ExpensiveTree 的父节点依赖 color，此时显然状态下移是行不通的，但是还有另外一种办法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">ColorPicker</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>Hello, world!<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">ExpensiveTree</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">ColorPicker</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">ColorPicker</span>(<span class=\"params\">&#123;children&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> [color, setColor] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;color&#125;&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;color&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;(e)</span> =&gt;</span> setColor(e.target.value)&#125; /&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">      &#123;children&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此时和状态提升是完全相反的，将依赖 color 的元素提升到了 ColorPicker 组件中，而不依赖 color 的元素以 children prop 的形式传入了 ColorPicker ，当组件内部的状态改变时：</p>\n<ul>\n<li>ColorPicker 会重新渲染但是它仍然保存着</li>\n<li>ColorPicker 的 children 属性未变化 React 并不会访问那棵子树。 因此，ExpensiveTree 不会重新渲染。</li>\n</ul>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>本文提供的方法并不是新的创意，大家一定都有所实践，但是我想表达的是，相比于滥用 useMemo，我们需要首先考虑使用这两种提高组件渲染性能的方法；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"dataPick 组件日期格式在不同浏览器的兼容性","description":"此篇文章为作者在使用antd-mobile组件库的DatePicker组件时，遇到的日期格式在不同浏览器的兼容问题；","headimg":"/images/antd.jpeg","date":"2021-05-24T16:00:00.000Z","sidebar":["toc"],"_content":"\n## 前言\n\n此篇文章为作者在使用 antd-mobile 组件库的 DatePicker 组件时，遇到的问题，希望对大家有所帮助，问题如下图所示；\n{% asset_img dataPick.png %}\n\n## 问题描述\n\n如上图所示，在使用组件库的 DatePicker 组件，年份未显示出来，而月份和日是能够正常显示的，起初认为是因为年份太多，导致渲染不出来(年份到 2099)，后来发现`是因为使用new Date()获取日期实例时，必须写成new Date(2099/12/31)这种格式，才能显示出来，如果使用new Date(2099-12-31)格式，则年份显示不出来，这便是问题的直接原因；`\n代码如下：\n\n```javascript\n//起初：const now = new Date('2099-12-31')\nconst now = new Date('2099/12/31') //解决\n```\n\n## 写在最后\n\n本次问题的本质原因是兼容性问题，即 ios 只支持 new Date(xx/xx/xx)这种格式创建日期实例，而不支持 new Date(xx-xx-xx)这种格式创建日期实例，最终导致了日期组件的年份渲染不完全；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/dataPick组件日期在浏览器兼容性问题.md","raw":"---\ntitle: dataPick 组件日期格式在不同浏览器的兼容性\ndescription: 此篇文章为作者在使用antd-mobile组件库的DatePicker组件时，遇到的日期格式在不同浏览器的兼容问题；\nheadimg: /images/antd.jpeg\ncategories:\n  - AntDesign\ndate: 2021-05-25\ntags:\n  - antDesign\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n## 前言\n\n此篇文章为作者在使用 antd-mobile 组件库的 DatePicker 组件时，遇到的问题，希望对大家有所帮助，问题如下图所示；\n{% asset_img dataPick.png %}\n\n## 问题描述\n\n如上图所示，在使用组件库的 DatePicker 组件，年份未显示出来，而月份和日是能够正常显示的，起初认为是因为年份太多，导致渲染不出来(年份到 2099)，后来发现`是因为使用new Date()获取日期实例时，必须写成new Date(2099/12/31)这种格式，才能显示出来，如果使用new Date(2099-12-31)格式，则年份显示不出来，这便是问题的直接原因；`\n代码如下：\n\n```javascript\n//起初：const now = new Date('2099-12-31')\nconst now = new Date('2099/12/31') //解决\n```\n\n## 写在最后\n\n本次问题的本质原因是兼容性问题，即 ios 只支持 new Date(xx/xx/xx)这种格式创建日期实例，而不支持 new Date(xx-xx-xx)这种格式创建日期实例，最终导致了日期组件的年份渲染不完全；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"dataPick组件日期在浏览器兼容性问题","published":1,"updated":"2023-03-14T11:14:23.891Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqer000gp5o1bj5o7ezo","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>此篇文章为作者在使用 antd-mobile 组件库的 DatePicker 组件时，遇到的问题，希望对大家有所帮助，问题如下图所示；</p>\n\n\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>如上图所示，在使用组件库的 DatePicker 组件，年份未显示出来，而月份和日是能够正常显示的，起初认为是因为年份太多，导致渲染不出来(年份到 2099)，后来发现<code>是因为使用new Date()获取日期实例时，必须写成new Date(2099/12/31)这种格式，才能显示出来，如果使用new Date(2099-12-31)格式，则年份显示不出来，这便是问题的直接原因；</code><br>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//起初：const now = new Date(&#x27;2099-12-31&#x27;)</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"string\">&#x27;2099/12/31&#x27;</span>) <span class=\"comment\">//解决</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>本次问题的本质原因是兼容性问题，即 ios 只支持 new Date(xx/xx/xx)这种格式创建日期实例，而不支持 new Date(xx-xx-xx)这种格式创建日期实例，最终导致了日期组件的年份渲染不完全；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>此篇文章为作者在使用 antd-mobile 组件库的 DatePicker 组件时，遇到的问题，希望对大家有所帮助，问题如下图所示；</p>\n\n\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>如上图所示，在使用组件库的 DatePicker 组件，年份未显示出来，而月份和日是能够正常显示的，起初认为是因为年份太多，导致渲染不出来(年份到 2099)，后来发现<code>是因为使用new Date()获取日期实例时，必须写成new Date(2099/12/31)这种格式，才能显示出来，如果使用new Date(2099-12-31)格式，则年份显示不出来，这便是问题的直接原因；</code><br>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//起初：const now = new Date(&#x27;2099-12-31&#x27;)</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> now = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"string\">&#x27;2099/12/31&#x27;</span>) <span class=\"comment\">//解决</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>本次问题的本质原因是兼容性问题，即 ios 只支持 new Date(xx/xx/xx)这种格式创建日期实例，而不支持 new Date(xx-xx-xx)这种格式创建日期实例，最终导致了日期组件的年份渲染不完全；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"Git分布式版本控制系统(一)","description":"分布式版本控制系统git是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习；","headimg":"/images/git.jpeg","date":"2022-01-10T16:00:00.000Z","_content":"\n## 前言\n\n&nbsp;&nbsp;&nbsp;&nbsp;众所周知，分布式版本控制系统 git 是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，评论区有你们小二真是如虎添翼呀！！！\n{% asset_img git.jpeg %}\n\n@[TOC](文章の目录)\n\n## 🏆 学习の目标\n\n1.  能够掌握 Git 中基本命令的使用\n2.  能够使用 Github 创建和维护远程仓库\n3.  能够掌握 Git 分支及基本使用\n\n## 一、🏆 Git 基础\n\n### 1.1 安装并配置 Git\n\n#### 1.1.1 在 Windows 中下载并安装 Git\n\n{% asset_img gitOne1.gif %}\n&nbsp;&nbsp;&nbsp;&nbsp;在开始使用 Git 管理项目的版本之前，需要将它安装到计算机上。可以使用浏览器访问如下的网址，根据自己\n的操作系统，选择下载对应的 Git 安装包：\n\n[git 安装包下载](https://git-scm.com/downloads)\n\n#### 1.1.2 配置用户信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;安装完 Git 之后，要做的第一件事就是设置自己的用户名和邮件地址。因为通过 Git 对项目进行版本管理的时候，Git 需要使用这些基本信息，来记录是谁对项目进行了操作：\n{% asset_img gitOne2.png %}\n📣 注意：如果使用了--global 选项，那么该命令只能运行一次，即可永久生效。❗❗❗\n\n#### 1.1.3 Git 的全局配置文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;通过 git config --global user.name 和 git config --global user.email 配置的用户名和邮箱地址，会被写入到 C:/Users/用户名文件夹/.gitconfig 文件中。这个文件是 Git 的全局配置文件，配置一次即可永久生效。可以使用记事本打开此文件，从而查看自己曾经对 Git 做了哪些全局性的配置。\n{% asset_img gitOne3.png %}\n\n#### 1.1.4 Git 检查配置信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;除了使用记事本查看全局的配置信息之外，还可以运行如下的终端命令，快速的查看 Git 的全局配置信息：\n\n```javascript\n//查看所有的全局配置项\ngit config --list --global\n//查看指定的全局配置项\ngit config user.name\ngit config user.email\n```\n\n#### 1.1.5 Git 获取帮助信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;可以使用 git help <verb> 命令，无需联网即可在浏览器中打开帮助手册，例如：\n\n```javascript\n#打开git config帮助手册\ngit help config\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果不想查看完整的手册，那么可以用-h 选项获得更简明的“help”输出：\n\n```javascript\n#获取 git config 快速参考\ngit config -h\n```\n\n## 1.2 Git 的基本操作\n\n### 1.2.1 获取 Git 仓库的两种方式\n\n==① 将尚未进行版本控制的本地目录转换为 Git 仓库==\n\n==② 从其它服务器克隆一个已存在的 Git 仓库==\n\n以上两种方式都能够在自己的电脑上得到一个可用的 Git 仓库\n\n#### 1.2.2 在现有目录中初始化仓库\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果自己有一个尚未进行版本控制的项目目录，想要用 Git 来控制它，需要执行如下两个步骤：\n\n==① 在项目目录中，通过鼠标右键打开“Git Bash”==\n\n==② 执行 git init 命令将当前的目录转化为 Git 仓库==\n{% asset_img gitOne4.gif %}\ngit init 命令会创建一个名为.git 的隐藏目录，这个.git 目录就是当前项目的 Git 仓库，里面包含了初始的必要文件，这些文件是 Git 仓库的必要组成部分。\n\n#### 1.2.3 检查文件状态\n\n可以使用 git status 命令查看文件处于什么状态，例如：\n{% asset_img gitOne5.gif %}\n`在状态报告中可以看到新建的 文件出现在Untracked files（未跟踪的文件）下面。\n未跟踪的文件意味着Git 在之前的快照（提交）中没有这些文件；Git 不会自动将之纳入跟踪范围，除非明确地告诉它“我需要使用Git 跟踪管理该文件”。`\n\n#### 1.2.4 以精简的方式显示文件状态\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用 git status 输出的状态报告很详细，但有些繁琐。如果希望以精简的方式显示文件的状态，可以使用如下两条完全等价的命令，其中-s 是--short 的简写形式：\n{% asset_img gitOne6.png %}\n\n#### 1.2.5 跟踪新文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用命令 git add 开始跟踪一个文件。所以，要跟踪 index.html 文件，运行如下的命令即可：\n{% asset_img gitOne7.png %}\n此时再运行 git status 命令，会看到文件在 Changes to be committed 这行的下面，说明已被跟踪，并处于暂存状态：\n{% asset_img gitOne8.png %}\n以精简的方式获取状态：\n{% asset_img gitOne9.png %}\n\n#### 1.2.6 提交更新\n\n&nbsp;&nbsp;&nbsp;&nbsp;现在暂存区中有一个 index.html 文件等待被提交到 Git 仓库中进行保存。可以执行 git commit 命令进行提交,其中-m 选项后面是本次的提交消息，用来对提交的内容做进一步的描述：\n{% asset_img gitOne10.png %}\n**提交成功之后，会显示如下的信息：**\n{% asset_img gitOne11.png %}\n**再次检查文件状态**\n{% asset_img gitOne12.png %}\n\n#### 1.2.7 对已提交的文件进行修改\n\n&nbsp;&nbsp;&nbsp;&nbsp;目前，index.html 文件已经被 Git 跟踪，并且工作区和 Git 仓库中的 index.html 文件内容保持一致。当我们修改了工作区中 index.html 的内容之后，再次运行 git status 和 git status -s 命令，会看到如下的内容：\n{% asset_img gitOne13.png %}\n&nbsp;&nbsp;&nbsp;&nbsp;文件 index.html 出现 Changes not staged for commit 这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。\n`注意：修改过的、没有放入暂存区的文件前面有红色的M 标记。`\n\n#### 1.2.8 暂存已修改的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;目前，工作区中的 index.html 文件已被修改，如果要暂存这次修改，需要再次运行 git add 命令，这个命令是个多功能的命令，主要有如下 3 个功效：\n==① 可以用它开始跟踪新文件==\n==② 把已跟踪的、且已修改的文件放到暂存区==\n==③ 把有冲突的文件标记为已解决状态==\n{% asset_img gitOne14.png %}\n\n#### 1.2.9 提交暂存的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;再次运行 git commit -m \"提交消息\" 命令，即可将暂存区中记录的 index.html 的快照，提交到 Git 仓库中进行保存：\n{% asset_img gitOne15.png %}\n{% asset_img gitOne16.png %}\n\n#### 1.2.10 撤销文件的修改\n\n&nbsp;&nbsp;&nbsp;&nbsp;撤销对文件的修改指的是：把对工作区中对应文件的修改，还原成 Git 仓库中所保存的版本。\n`操作的结果：所有的修改会丢失，且无法恢复！危险性比较高，请慎重操作！`\n{% asset_img gitOne17.png %}\n`撤销操作的本质：用Git 仓库中保存的文件，覆盖工作区中指定的文件。`\n\n#### 1.2.11 向暂存区中一次性添加多个文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果需要被暂存的文件个数比较多，可以使用如下的命令，一次性将所有的新增和修改过的文件加入暂存区：\n{% asset_img gitOne18.png %}\n`注意：今后在项目开发中，会经常使用这个命令，将新增和修改过后的文件加入暂存区。`\n\n#### 1.2.12 取消暂存的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果需要从暂存区中移除对应的文件，可以使用如下的命令：\n{% asset_img gitOne19.png %}\n\n#### 1.2.13 跳过使用暂存区\n\n&nbsp;&nbsp;&nbsp;&nbsp;Git 标准的工作流程是==工作区==→ ==暂存区==→ ==Git 仓库==，但有时候这么做略显繁琐，此时可以跳过暂存区，直接将工作区中的修改提交到 Git 仓库，这时候 Git 工作的流程简化为了工作区 → Git 仓库。\nGit 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 git commit 加上-a 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 git add 步骤：\n{% asset_img gitOne20.png %}\n\n#### 1.2.14 移除文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;从 Git 仓库中移除文件的方式有两种：\n① 从 Git 仓库和工作区中同时移除对应的文件\n② 只从 Git 仓库中移除指定的文件，但保留工作区中对应的文件；\n{% asset_img gitOne21.png %}\n\n#### 1.2.15 忽略文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。在这种情况下，我们可以创建一个名为.gitignore 的配置文件，列出要忽略的文件的匹配模式。\n文件.gitignore 的格式规范如下：\n① 以# 开头的是注释\n② 以/结尾的是目录\n③ 以/开头防止递归\n④ 以!开头表示取反\n⑤ 可以使用 glob 模式进行文件和文件夹的匹配（glob 指简化了的正则表达式）\n\n#### 1.2.16 glob 模式\n\n所谓的 glob 模式是指简化了的正则表达式：\n① 星号\\* 匹配零个或多个任意字符\n②[abc] 匹配任何一个列在方括号中的字符（此案例匹配一个 a 或匹配一个 b 或匹配一个 c）\n③ 问号?只匹配一个任意字符\n④ 在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如[0-9] 表示匹配\n所有 0 到 9 的数字）\n⑤ 两个星号** 表示匹配任意中间目录（比如 a/**/z 可以匹配 a/z 、a/b/z 或 a/b/c/z 等）\n\n#### 1.2.17 .gitignore 文件的例子\n\n{% asset_img gitOne22.png %}\n\n#### 1.2.18 查看提交历史\n\n如果希望回顾项目的提交历史，可以使用 git log 这个简单且有效的命令。\n{% asset_img gitOne23.png %}\n\n#### 1.2.19 回退到指定版本\n\n{% asset_img gitOne24.png %}\n\n## 🥇 知识の总结\n\n总结：\n① 初始化 Git 仓库的命令\n<font color=red>git init </font>\n② 查看文件状态的命令\n<font color=red>git status 或 git status -s</font>\n③ 一次性将文件加入暂存区的命令\n<font color=red>git add .</font>\n④ 将暂存区的文件提交到 Git 仓库的命令\n$\\textcolor{red} {git commit -m \"提交消息\"}$\n📣 注意：项目中经常使用以上基本操作请小伙伴牢记哦 ❗❗❗\n\n## 🥇 推荐の内容\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n学会项目管理需还需要掌握 Github、git 分支相关知识，我会陆续为大家整理 Github 和 Git 分支相关知识，大家敬请期待哦！！！\n","source":"_posts/gitOne.md","raw":"---\ntitle: Git分布式版本控制系统(一)\ndescription: 分布式版本控制系统git是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习；\nheadimg: /images/git.jpeg\ndate: 2022-01-11\ntags:\n  - Git\ncategories:\n  - Git\n---\n\n## 前言\n\n&nbsp;&nbsp;&nbsp;&nbsp;众所周知，分布式版本控制系统 git 是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，评论区有你们小二真是如虎添翼呀！！！\n{% asset_img git.jpeg %}\n\n@[TOC](文章の目录)\n\n## 🏆 学习の目标\n\n1.  能够掌握 Git 中基本命令的使用\n2.  能够使用 Github 创建和维护远程仓库\n3.  能够掌握 Git 分支及基本使用\n\n## 一、🏆 Git 基础\n\n### 1.1 安装并配置 Git\n\n#### 1.1.1 在 Windows 中下载并安装 Git\n\n{% asset_img gitOne1.gif %}\n&nbsp;&nbsp;&nbsp;&nbsp;在开始使用 Git 管理项目的版本之前，需要将它安装到计算机上。可以使用浏览器访问如下的网址，根据自己\n的操作系统，选择下载对应的 Git 安装包：\n\n[git 安装包下载](https://git-scm.com/downloads)\n\n#### 1.1.2 配置用户信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;安装完 Git 之后，要做的第一件事就是设置自己的用户名和邮件地址。因为通过 Git 对项目进行版本管理的时候，Git 需要使用这些基本信息，来记录是谁对项目进行了操作：\n{% asset_img gitOne2.png %}\n📣 注意：如果使用了--global 选项，那么该命令只能运行一次，即可永久生效。❗❗❗\n\n#### 1.1.3 Git 的全局配置文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;通过 git config --global user.name 和 git config --global user.email 配置的用户名和邮箱地址，会被写入到 C:/Users/用户名文件夹/.gitconfig 文件中。这个文件是 Git 的全局配置文件，配置一次即可永久生效。可以使用记事本打开此文件，从而查看自己曾经对 Git 做了哪些全局性的配置。\n{% asset_img gitOne3.png %}\n\n#### 1.1.4 Git 检查配置信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;除了使用记事本查看全局的配置信息之外，还可以运行如下的终端命令，快速的查看 Git 的全局配置信息：\n\n```javascript\n//查看所有的全局配置项\ngit config --list --global\n//查看指定的全局配置项\ngit config user.name\ngit config user.email\n```\n\n#### 1.1.5 Git 获取帮助信息\n\n&nbsp;&nbsp;&nbsp;&nbsp;可以使用 git help <verb> 命令，无需联网即可在浏览器中打开帮助手册，例如：\n\n```javascript\n#打开git config帮助手册\ngit help config\n```\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果不想查看完整的手册，那么可以用-h 选项获得更简明的“help”输出：\n\n```javascript\n#获取 git config 快速参考\ngit config -h\n```\n\n## 1.2 Git 的基本操作\n\n### 1.2.1 获取 Git 仓库的两种方式\n\n==① 将尚未进行版本控制的本地目录转换为 Git 仓库==\n\n==② 从其它服务器克隆一个已存在的 Git 仓库==\n\n以上两种方式都能够在自己的电脑上得到一个可用的 Git 仓库\n\n#### 1.2.2 在现有目录中初始化仓库\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果自己有一个尚未进行版本控制的项目目录，想要用 Git 来控制它，需要执行如下两个步骤：\n\n==① 在项目目录中，通过鼠标右键打开“Git Bash”==\n\n==② 执行 git init 命令将当前的目录转化为 Git 仓库==\n{% asset_img gitOne4.gif %}\ngit init 命令会创建一个名为.git 的隐藏目录，这个.git 目录就是当前项目的 Git 仓库，里面包含了初始的必要文件，这些文件是 Git 仓库的必要组成部分。\n\n#### 1.2.3 检查文件状态\n\n可以使用 git status 命令查看文件处于什么状态，例如：\n{% asset_img gitOne5.gif %}\n`在状态报告中可以看到新建的 文件出现在Untracked files（未跟踪的文件）下面。\n未跟踪的文件意味着Git 在之前的快照（提交）中没有这些文件；Git 不会自动将之纳入跟踪范围，除非明确地告诉它“我需要使用Git 跟踪管理该文件”。`\n\n#### 1.2.4 以精简的方式显示文件状态\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用 git status 输出的状态报告很详细，但有些繁琐。如果希望以精简的方式显示文件的状态，可以使用如下两条完全等价的命令，其中-s 是--short 的简写形式：\n{% asset_img gitOne6.png %}\n\n#### 1.2.5 跟踪新文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用命令 git add 开始跟踪一个文件。所以，要跟踪 index.html 文件，运行如下的命令即可：\n{% asset_img gitOne7.png %}\n此时再运行 git status 命令，会看到文件在 Changes to be committed 这行的下面，说明已被跟踪，并处于暂存状态：\n{% asset_img gitOne8.png %}\n以精简的方式获取状态：\n{% asset_img gitOne9.png %}\n\n#### 1.2.6 提交更新\n\n&nbsp;&nbsp;&nbsp;&nbsp;现在暂存区中有一个 index.html 文件等待被提交到 Git 仓库中进行保存。可以执行 git commit 命令进行提交,其中-m 选项后面是本次的提交消息，用来对提交的内容做进一步的描述：\n{% asset_img gitOne10.png %}\n**提交成功之后，会显示如下的信息：**\n{% asset_img gitOne11.png %}\n**再次检查文件状态**\n{% asset_img gitOne12.png %}\n\n#### 1.2.7 对已提交的文件进行修改\n\n&nbsp;&nbsp;&nbsp;&nbsp;目前，index.html 文件已经被 Git 跟踪，并且工作区和 Git 仓库中的 index.html 文件内容保持一致。当我们修改了工作区中 index.html 的内容之后，再次运行 git status 和 git status -s 命令，会看到如下的内容：\n{% asset_img gitOne13.png %}\n&nbsp;&nbsp;&nbsp;&nbsp;文件 index.html 出现 Changes not staged for commit 这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。\n`注意：修改过的、没有放入暂存区的文件前面有红色的M 标记。`\n\n#### 1.2.8 暂存已修改的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;目前，工作区中的 index.html 文件已被修改，如果要暂存这次修改，需要再次运行 git add 命令，这个命令是个多功能的命令，主要有如下 3 个功效：\n==① 可以用它开始跟踪新文件==\n==② 把已跟踪的、且已修改的文件放到暂存区==\n==③ 把有冲突的文件标记为已解决状态==\n{% asset_img gitOne14.png %}\n\n#### 1.2.9 提交暂存的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;再次运行 git commit -m \"提交消息\" 命令，即可将暂存区中记录的 index.html 的快照，提交到 Git 仓库中进行保存：\n{% asset_img gitOne15.png %}\n{% asset_img gitOne16.png %}\n\n#### 1.2.10 撤销文件的修改\n\n&nbsp;&nbsp;&nbsp;&nbsp;撤销对文件的修改指的是：把对工作区中对应文件的修改，还原成 Git 仓库中所保存的版本。\n`操作的结果：所有的修改会丢失，且无法恢复！危险性比较高，请慎重操作！`\n{% asset_img gitOne17.png %}\n`撤销操作的本质：用Git 仓库中保存的文件，覆盖工作区中指定的文件。`\n\n#### 1.2.11 向暂存区中一次性添加多个文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果需要被暂存的文件个数比较多，可以使用如下的命令，一次性将所有的新增和修改过的文件加入暂存区：\n{% asset_img gitOne18.png %}\n`注意：今后在项目开发中，会经常使用这个命令，将新增和修改过后的文件加入暂存区。`\n\n#### 1.2.12 取消暂存的文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果需要从暂存区中移除对应的文件，可以使用如下的命令：\n{% asset_img gitOne19.png %}\n\n#### 1.2.13 跳过使用暂存区\n\n&nbsp;&nbsp;&nbsp;&nbsp;Git 标准的工作流程是==工作区==→ ==暂存区==→ ==Git 仓库==，但有时候这么做略显繁琐，此时可以跳过暂存区，直接将工作区中的修改提交到 Git 仓库，这时候 Git 工作的流程简化为了工作区 → Git 仓库。\nGit 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 git commit 加上-a 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 git add 步骤：\n{% asset_img gitOne20.png %}\n\n#### 1.2.14 移除文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;从 Git 仓库中移除文件的方式有两种：\n① 从 Git 仓库和工作区中同时移除对应的文件\n② 只从 Git 仓库中移除指定的文件，但保留工作区中对应的文件；\n{% asset_img gitOne21.png %}\n\n#### 1.2.15 忽略文件\n\n&nbsp;&nbsp;&nbsp;&nbsp;一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。在这种情况下，我们可以创建一个名为.gitignore 的配置文件，列出要忽略的文件的匹配模式。\n文件.gitignore 的格式规范如下：\n① 以# 开头的是注释\n② 以/结尾的是目录\n③ 以/开头防止递归\n④ 以!开头表示取反\n⑤ 可以使用 glob 模式进行文件和文件夹的匹配（glob 指简化了的正则表达式）\n\n#### 1.2.16 glob 模式\n\n所谓的 glob 模式是指简化了的正则表达式：\n① 星号\\* 匹配零个或多个任意字符\n②[abc] 匹配任何一个列在方括号中的字符（此案例匹配一个 a 或匹配一个 b 或匹配一个 c）\n③ 问号?只匹配一个任意字符\n④ 在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如[0-9] 表示匹配\n所有 0 到 9 的数字）\n⑤ 两个星号** 表示匹配任意中间目录（比如 a/**/z 可以匹配 a/z 、a/b/z 或 a/b/c/z 等）\n\n#### 1.2.17 .gitignore 文件的例子\n\n{% asset_img gitOne22.png %}\n\n#### 1.2.18 查看提交历史\n\n如果希望回顾项目的提交历史，可以使用 git log 这个简单且有效的命令。\n{% asset_img gitOne23.png %}\n\n#### 1.2.19 回退到指定版本\n\n{% asset_img gitOne24.png %}\n\n## 🥇 知识の总结\n\n总结：\n① 初始化 Git 仓库的命令\n<font color=red>git init </font>\n② 查看文件状态的命令\n<font color=red>git status 或 git status -s</font>\n③ 一次性将文件加入暂存区的命令\n<font color=red>git add .</font>\n④ 将暂存区的文件提交到 Git 仓库的命令\n$\\textcolor{red} {git commit -m \"提交消息\"}$\n📣 注意：项目中经常使用以上基本操作请小伙伴牢记哦 ❗❗❗\n\n## 🥇 推荐の内容\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n学会项目管理需还需要掌握 Github、git 分支相关知识，我会陆续为大家整理 Github 和 Git 分支相关知识，大家敬请期待哦！！！\n","slug":"gitOne","published":1,"updated":"2023-03-15T11:41:53.396Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqeu000lp5o149f3am8e","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;众所周知，分布式版本控制系统 git 是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，评论区有你们小二真是如虎添翼呀！！！</p>\n\n\n<p>@<a href=\"%E6%96%87%E7%AB%A0%E3%81%AE%E7%9B%AE%E5%BD%95\">TOC</a></p>\n<h2 id=\"🏆-学习の目标\"><a href=\"#🏆-学习の目标\" class=\"headerlink\" title=\"🏆 学习の目标\"></a>🏆 学习の目标</h2><ol>\n<li> 能够掌握 Git 中基本命令的使用</li>\n<li> 能够使用 Github 创建和维护远程仓库</li>\n<li> 能够掌握 Git 分支及基本使用</li>\n</ol>\n<h2 id=\"一、🏆-Git-基础\"><a href=\"#一、🏆-Git-基础\" class=\"headerlink\" title=\"一、🏆 Git 基础\"></a>一、🏆 Git 基础</h2><h3 id=\"1-1-安装并配置-Git\"><a href=\"#1-1-安装并配置-Git\" class=\"headerlink\" title=\"1.1 安装并配置 Git\"></a>1.1 安装并配置 Git</h3><h4 id=\"1-1-1-在-Windows-中下载并安装-Git\"><a href=\"#1-1-1-在-Windows-中下载并安装-Git\" class=\"headerlink\" title=\"1.1.1 在 Windows 中下载并安装 Git\"></a>1.1.1 在 Windows 中下载并安装 Git</h4><img src=\"/2022/01/11/gitOne/gitOne1.gif\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne1.gif\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>&nbsp;&nbsp;&nbsp;&nbsp;在开始使用 Git 管理项目的版本之前，需要将它安装到计算机上。可以使用浏览器访问如下的网址，根据自己<br>的操作系统，选择下载对应的 Git 安装包：</p>\n<p><a href=\"https://git-scm.com/downloads\">git 安装包下载</a></p>\n<h4 id=\"1-1-2-配置用户信息\"><a href=\"#1-1-2-配置用户信息\" class=\"headerlink\" title=\"1.1.2 配置用户信息\"></a>1.1.2 配置用户信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;安装完 Git 之后，要做的第一件事就是设置自己的用户名和邮件地址。因为通过 Git 对项目进行版本管理的时候，Git 需要使用这些基本信息，来记录是谁对项目进行了操作：</p>\n<img src=\"/2022/01/11/gitOne/gitOne2.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 注意：如果使用了–global 选项，那么该命令只能运行一次，即可永久生效。❗❗❗</p>\n<h4 id=\"1-1-3-Git-的全局配置文件\"><a href=\"#1-1-3-Git-的全局配置文件\" class=\"headerlink\" title=\"1.1.3 Git 的全局配置文件\"></a>1.1.3 Git 的全局配置文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;通过 git config –global user.name 和 git config –global user.email 配置的用户名和邮箱地址，会被写入到 C:/Users/用户名文件夹/.gitconfig 文件中。这个文件是 Git 的全局配置文件，配置一次即可永久生效。可以使用记事本打开此文件，从而查看自己曾经对 Git 做了哪些全局性的配置。</p>\n<img src=\"/2022/01/11/gitOne/gitOne3.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-1-4-Git-检查配置信息\"><a href=\"#1-1-4-Git-检查配置信息\" class=\"headerlink\" title=\"1.1.4 Git 检查配置信息\"></a>1.1.4 Git 检查配置信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;除了使用记事本查看全局的配置信息之外，还可以运行如下的终端命令，快速的查看 Git 的全局配置信息：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//查看所有的全局配置项</span></span><br><span class=\"line\">git config --list --<span class=\"variable language_\">global</span></span><br><span class=\"line\"><span class=\"comment\">//查看指定的全局配置项</span></span><br><span class=\"line\">git config user.<span class=\"property\">name</span></span><br><span class=\"line\">git config user.<span class=\"property\">email</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"1-1-5-Git-获取帮助信息\"><a href=\"#1-1-5-Git-获取帮助信息\" class=\"headerlink\" title=\"1.1.5 Git 获取帮助信息\"></a>1.1.5 Git 获取帮助信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;可以使用 git help <verb> 命令，无需联网即可在浏览器中打开帮助手册，例如：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打开git config帮助手册</span><br><span class=\"line\">git help config</span><br></pre></td></tr></table></figure>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;如果不想查看完整的手册，那么可以用-h 选项获得更简明的“help”输出：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#获取 git config 快速参考</span><br><span class=\"line\">git config -h</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-2-Git-的基本操作\"><a href=\"#1-2-Git-的基本操作\" class=\"headerlink\" title=\"1.2 Git 的基本操作\"></a>1.2 Git 的基本操作</h2><h3 id=\"1-2-1-获取-Git-仓库的两种方式\"><a href=\"#1-2-1-获取-Git-仓库的两种方式\" class=\"headerlink\" title=\"1.2.1 获取 Git 仓库的两种方式\"></a>1.2.1 获取 Git 仓库的两种方式</h3><p>==① 将尚未进行版本控制的本地目录转换为 Git 仓库==</p>\n<p>==② 从其它服务器克隆一个已存在的 Git 仓库==</p>\n<p>以上两种方式都能够在自己的电脑上得到一个可用的 Git 仓库</p>\n<h4 id=\"1-2-2-在现有目录中初始化仓库\"><a href=\"#1-2-2-在现有目录中初始化仓库\" class=\"headerlink\" title=\"1.2.2 在现有目录中初始化仓库\"></a>1.2.2 在现有目录中初始化仓库</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果自己有一个尚未进行版本控制的项目目录，想要用 Git 来控制它，需要执行如下两个步骤：</p>\n<p>==① 在项目目录中，通过鼠标右键打开“Git Bash”==</p>\n<p>==② 执行 git init 命令将当前的目录转化为 Git 仓库==</p>\n<img src=\"/2022/01/11/gitOne/gitOne4.gif\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne4.gif\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>git init 命令会创建一个名为.git 的隐藏目录，这个.git 目录就是当前项目的 Git 仓库，里面包含了初始的必要文件，这些文件是 Git 仓库的必要组成部分。</p>\n<h4 id=\"1-2-3-检查文件状态\"><a href=\"#1-2-3-检查文件状态\" class=\"headerlink\" title=\"1.2.3 检查文件状态\"></a>1.2.3 检查文件状态</h4><p>可以使用 git status 命令查看文件处于什么状态，例如：</p>\n<img src=\"/2022/01/11/gitOne/gitOne5.gif\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne5.gif\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><code>在状态报告中可以看到新建的 文件出现在Untracked files（未跟踪的文件）下面。 未跟踪的文件意味着Git 在之前的快照（提交）中没有这些文件；Git 不会自动将之纳入跟踪范围，除非明确地告诉它“我需要使用Git 跟踪管理该文件”。</code></p>\n<h4 id=\"1-2-4-以精简的方式显示文件状态\"><a href=\"#1-2-4-以精简的方式显示文件状态\" class=\"headerlink\" title=\"1.2.4 以精简的方式显示文件状态\"></a>1.2.4 以精简的方式显示文件状态</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用 git status 输出的状态报告很详细，但有些繁琐。如果希望以精简的方式显示文件的状态，可以使用如下两条完全等价的命令，其中-s 是–short 的简写形式：</p>\n<img src=\"/2022/01/11/gitOne/gitOne6.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne6.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-5-跟踪新文件\"><a href=\"#1-2-5-跟踪新文件\" class=\"headerlink\" title=\"1.2.5 跟踪新文件\"></a>1.2.5 跟踪新文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用命令 git add 开始跟踪一个文件。所以，要跟踪 index.html 文件，运行如下的命令即可：</p>\n<img src=\"/2022/01/11/gitOne/gitOne7.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne7.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>此时再运行 git status 命令，会看到文件在 Changes to be committed 这行的下面，说明已被跟踪，并处于暂存状态：</p>\n<img src=\"/2022/01/11/gitOne/gitOne8.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne8.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>以精简的方式获取状态：</p>\n<img src=\"/2022/01/11/gitOne/gitOne9.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne9.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-6-提交更新\"><a href=\"#1-2-6-提交更新\" class=\"headerlink\" title=\"1.2.6 提交更新\"></a>1.2.6 提交更新</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;现在暂存区中有一个 index.html 文件等待被提交到 Git 仓库中进行保存。可以执行 git commit 命令进行提交,其中-m 选项后面是本次的提交消息，用来对提交的内容做进一步的描述：</p>\n<img src=\"/2022/01/11/gitOne/gitOne10.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne10.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><strong>提交成功之后，会显示如下的信息：</strong></p>\n<img src=\"/2022/01/11/gitOne/gitOne11.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne11.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><strong>再次检查文件状态</strong></p>\n<img src=\"/2022/01/11/gitOne/gitOne12.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne12.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-7-对已提交的文件进行修改\"><a href=\"#1-2-7-对已提交的文件进行修改\" class=\"headerlink\" title=\"1.2.7 对已提交的文件进行修改\"></a>1.2.7 对已提交的文件进行修改</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;目前，index.html 文件已经被 Git 跟踪，并且工作区和 Git 仓库中的 index.html 文件内容保持一致。当我们修改了工作区中 index.html 的内容之后，再次运行 git status 和 git status -s 命令，会看到如下的内容：</p>\n<img src=\"/2022/01/11/gitOne/gitOne13.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne13.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>&nbsp;&nbsp;&nbsp;&nbsp;文件 index.html 出现 Changes not staged for commit 这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。<br><code>注意：修改过的、没有放入暂存区的文件前面有红色的M 标记。</code></p>\n<h4 id=\"1-2-8-暂存已修改的文件\"><a href=\"#1-2-8-暂存已修改的文件\" class=\"headerlink\" title=\"1.2.8 暂存已修改的文件\"></a>1.2.8 暂存已修改的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;目前，工作区中的 index.html 文件已被修改，如果要暂存这次修改，需要再次运行 git add 命令，这个命令是个多功能的命令，主要有如下 3 个功效：<br>==① 可以用它开始跟踪新文件==<br>==② 把已跟踪的、且已修改的文件放到暂存区==<br>==③ 把有冲突的文件标记为已解决状态==</p>\n<img src=\"/2022/01/11/gitOne/gitOne14.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne14.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-9-提交暂存的文件\"><a href=\"#1-2-9-提交暂存的文件\" class=\"headerlink\" title=\"1.2.9 提交暂存的文件\"></a>1.2.9 提交暂存的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;再次运行 git commit -m “提交消息” 命令，即可将暂存区中记录的 index.html 的快照，提交到 Git 仓库中进行保存：</p>\n<img src=\"/2022/01/11/gitOne/gitOne15.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne15.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<img src=\"/2022/01/11/gitOne/gitOne16.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne16.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-10-撤销文件的修改\"><a href=\"#1-2-10-撤销文件的修改\" class=\"headerlink\" title=\"1.2.10 撤销文件的修改\"></a>1.2.10 撤销文件的修改</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;撤销对文件的修改指的是：把对工作区中对应文件的修改，还原成 Git 仓库中所保存的版本。<br><code>操作的结果：所有的修改会丢失，且无法恢复！危险性比较高，请慎重操作！</code></p>\n<img src=\"/2022/01/11/gitOne/gitOne17.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne17.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><code>撤销操作的本质：用Git 仓库中保存的文件，覆盖工作区中指定的文件。</code></p>\n<h4 id=\"1-2-11-向暂存区中一次性添加多个文件\"><a href=\"#1-2-11-向暂存区中一次性添加多个文件\" class=\"headerlink\" title=\"1.2.11 向暂存区中一次性添加多个文件\"></a>1.2.11 向暂存区中一次性添加多个文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果需要被暂存的文件个数比较多，可以使用如下的命令，一次性将所有的新增和修改过的文件加入暂存区：</p>\n<img src=\"/2022/01/11/gitOne/gitOne18.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne18.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><code>注意：今后在项目开发中，会经常使用这个命令，将新增和修改过后的文件加入暂存区。</code></p>\n<h4 id=\"1-2-12-取消暂存的文件\"><a href=\"#1-2-12-取消暂存的文件\" class=\"headerlink\" title=\"1.2.12 取消暂存的文件\"></a>1.2.12 取消暂存的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果需要从暂存区中移除对应的文件，可以使用如下的命令：</p>\n<img src=\"/2022/01/11/gitOne/gitOne19.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne19.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-13-跳过使用暂存区\"><a href=\"#1-2-13-跳过使用暂存区\" class=\"headerlink\" title=\"1.2.13 跳过使用暂存区\"></a>1.2.13 跳过使用暂存区</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Git 标准的工作流程是==工作区==→ ==暂存区==→ ==Git 仓库==，但有时候这么做略显繁琐，此时可以跳过暂存区，直接将工作区中的修改提交到 Git 仓库，这时候 Git 工作的流程简化为了工作区 → Git 仓库。<br>Git 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 git commit 加上-a 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 git add 步骤：</p>\n<img src=\"/2022/01/11/gitOne/gitOne20.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne20.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-14-移除文件\"><a href=\"#1-2-14-移除文件\" class=\"headerlink\" title=\"1.2.14 移除文件\"></a>1.2.14 移除文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;从 Git 仓库中移除文件的方式有两种：<br>① 从 Git 仓库和工作区中同时移除对应的文件<br>② 只从 Git 仓库中移除指定的文件，但保留工作区中对应的文件；</p>\n<img src=\"/2022/01/11/gitOne/gitOne21.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne21.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-15-忽略文件\"><a href=\"#1-2-15-忽略文件\" class=\"headerlink\" title=\"1.2.15 忽略文件\"></a>1.2.15 忽略文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。在这种情况下，我们可以创建一个名为.gitignore 的配置文件，列出要忽略的文件的匹配模式。<br>文件.gitignore 的格式规范如下：<br>① 以# 开头的是注释<br>② 以/结尾的是目录<br>③ 以/开头防止递归<br>④ 以!开头表示取反<br>⑤ 可以使用 glob 模式进行文件和文件夹的匹配（glob 指简化了的正则表达式）</p>\n<h4 id=\"1-2-16-glob-模式\"><a href=\"#1-2-16-glob-模式\" class=\"headerlink\" title=\"1.2.16 glob 模式\"></a>1.2.16 glob 模式</h4><p>所谓的 glob 模式是指简化了的正则表达式：<br>① 星号* 匹配零个或多个任意字符<br>②[abc] 匹配任何一个列在方括号中的字符（此案例匹配一个 a 或匹配一个 b 或匹配一个 c）<br>③ 问号?只匹配一个任意字符<br>④ 在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如[0-9] 表示匹配<br>所有 0 到 9 的数字）<br>⑤ 两个星号** 表示匹配任意中间目录（比如 a/**/z 可以匹配 a/z 、a/b/z 或 a/b/c/z 等）</p>\n<h4 id=\"1-2-17-gitignore-文件的例子\"><a href=\"#1-2-17-gitignore-文件的例子\" class=\"headerlink\" title=\"1.2.17 .gitignore 文件的例子\"></a>1.2.17 .gitignore 文件的例子</h4><img src=\"/2022/01/11/gitOne/gitOne22.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne22.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-18-查看提交历史\"><a href=\"#1-2-18-查看提交历史\" class=\"headerlink\" title=\"1.2.18 查看提交历史\"></a>1.2.18 查看提交历史</h4><p>如果希望回顾项目的提交历史，可以使用 git log 这个简单且有效的命令。</p>\n<img src=\"/2022/01/11/gitOne/gitOne23.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne23.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"1-2-19-回退到指定版本\"><a href=\"#1-2-19-回退到指定版本\" class=\"headerlink\" title=\"1.2.19 回退到指定版本\"></a>1.2.19 回退到指定版本</h4><img src=\"/2022/01/11/gitOne/gitOne24.png\" class=\"lazyload\" data-srcset=\"/2022/01/11/gitOne/gitOne24.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"🥇-知识の总结\"><a href=\"#🥇-知识の总结\" class=\"headerlink\" title=\"🥇 知识の总结\"></a>🥇 知识の总结</h2><p>总结：<br>① 初始化 Git 仓库的命令<br><font color=red>git init </font><br>② 查看文件状态的命令<br><font color=red>git status 或 git status -s</font><br>③ 一次性将文件加入暂存区的命令<br><font color=red>git add .</font><br>④ 将暂存区的文件提交到 Git 仓库的命令<br>$\\textcolor{red} {git commit -m “提交消息”}$<br>📣 注意：项目中经常使用以上基本操作请小伙伴牢记哦 ❗❗❗</p>\n<h2 id=\"🥇-推荐の内容\"><a href=\"#🥇-推荐の内容\" class=\"headerlink\" title=\"🥇 推荐の内容\"></a>🥇 推荐の内容</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p>学会项目管理需还需要掌握 Github、git 分支相关知识，我会陆续为大家整理 Github 和 Git 分支相关知识，大家敬请期待哦！！！</p>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;众所周知，分布式版本控制系统 git 是工作以后进行项目管理必不可少的工具，我将繁杂的命令进行了归类整理和总结，供大家参考学习，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，评论区有你们小二真是如虎添翼呀！！！</p>\n\n\n<p>@<a href=\"%E6%96%87%E7%AB%A0%E3%81%AE%E7%9B%AE%E5%BD%95\">TOC</a></p>\n<h2 id=\"🏆-学习の目标\"><a href=\"#🏆-学习の目标\" class=\"headerlink\" title=\"🏆 学习の目标\"></a>🏆 学习の目标</h2><ol>\n<li> 能够掌握 Git 中基本命令的使用</li>\n<li> 能够使用 Github 创建和维护远程仓库</li>\n<li> 能够掌握 Git 分支及基本使用</li>\n</ol>\n<h2 id=\"一、🏆-Git-基础\"><a href=\"#一、🏆-Git-基础\" class=\"headerlink\" title=\"一、🏆 Git 基础\"></a>一、🏆 Git 基础</h2><h3 id=\"1-1-安装并配置-Git\"><a href=\"#1-1-安装并配置-Git\" class=\"headerlink\" title=\"1.1 安装并配置 Git\"></a>1.1 安装并配置 Git</h3><h4 id=\"1-1-1-在-Windows-中下载并安装-Git\"><a href=\"#1-1-1-在-Windows-中下载并安装-Git\" class=\"headerlink\" title=\"1.1.1 在 Windows 中下载并安装 Git\"></a>1.1.1 在 Windows 中下载并安装 Git</h4><img src=\"/2022/01/11/gitOne/gitOne1.gif\" class=\"\">\n<p>&nbsp;&nbsp;&nbsp;&nbsp;在开始使用 Git 管理项目的版本之前，需要将它安装到计算机上。可以使用浏览器访问如下的网址，根据自己<br>的操作系统，选择下载对应的 Git 安装包：</p>\n<p><a href=\"https://git-scm.com/downloads\">git 安装包下载</a></p>\n<h4 id=\"1-1-2-配置用户信息\"><a href=\"#1-1-2-配置用户信息\" class=\"headerlink\" title=\"1.1.2 配置用户信息\"></a>1.1.2 配置用户信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;安装完 Git 之后，要做的第一件事就是设置自己的用户名和邮件地址。因为通过 Git 对项目进行版本管理的时候，Git 需要使用这些基本信息，来记录是谁对项目进行了操作：</p>\n<img src=\"/2022/01/11/gitOne/gitOne2.png\" class=\"\">\n<p>📣 注意：如果使用了–global 选项，那么该命令只能运行一次，即可永久生效。❗❗❗</p>\n<h4 id=\"1-1-3-Git-的全局配置文件\"><a href=\"#1-1-3-Git-的全局配置文件\" class=\"headerlink\" title=\"1.1.3 Git 的全局配置文件\"></a>1.1.3 Git 的全局配置文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;通过 git config –global user.name 和 git config –global user.email 配置的用户名和邮箱地址，会被写入到 C:/Users/用户名文件夹/.gitconfig 文件中。这个文件是 Git 的全局配置文件，配置一次即可永久生效。可以使用记事本打开此文件，从而查看自己曾经对 Git 做了哪些全局性的配置。</p>\n<img src=\"/2022/01/11/gitOne/gitOne3.png\" class=\"\">\n\n<h4 id=\"1-1-4-Git-检查配置信息\"><a href=\"#1-1-4-Git-检查配置信息\" class=\"headerlink\" title=\"1.1.4 Git 检查配置信息\"></a>1.1.4 Git 检查配置信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;除了使用记事本查看全局的配置信息之外，还可以运行如下的终端命令，快速的查看 Git 的全局配置信息：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//查看所有的全局配置项</span></span><br><span class=\"line\">git config --list --<span class=\"variable language_\">global</span></span><br><span class=\"line\"><span class=\"comment\">//查看指定的全局配置项</span></span><br><span class=\"line\">git config user.<span class=\"property\">name</span></span><br><span class=\"line\">git config user.<span class=\"property\">email</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"1-1-5-Git-获取帮助信息\"><a href=\"#1-1-5-Git-获取帮助信息\" class=\"headerlink\" title=\"1.1.5 Git 获取帮助信息\"></a>1.1.5 Git 获取帮助信息</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;可以使用 git help <verb> 命令，无需联网即可在浏览器中打开帮助手册，例如：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打开git config帮助手册</span><br><span class=\"line\">git help config</span><br></pre></td></tr></table></figure>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;如果不想查看完整的手册，那么可以用-h 选项获得更简明的“help”输出：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#获取 git config 快速参考</span><br><span class=\"line\">git config -h</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-2-Git-的基本操作\"><a href=\"#1-2-Git-的基本操作\" class=\"headerlink\" title=\"1.2 Git 的基本操作\"></a>1.2 Git 的基本操作</h2><h3 id=\"1-2-1-获取-Git-仓库的两种方式\"><a href=\"#1-2-1-获取-Git-仓库的两种方式\" class=\"headerlink\" title=\"1.2.1 获取 Git 仓库的两种方式\"></a>1.2.1 获取 Git 仓库的两种方式</h3><p>==① 将尚未进行版本控制的本地目录转换为 Git 仓库==</p>\n<p>==② 从其它服务器克隆一个已存在的 Git 仓库==</p>\n<p>以上两种方式都能够在自己的电脑上得到一个可用的 Git 仓库</p>\n<h4 id=\"1-2-2-在现有目录中初始化仓库\"><a href=\"#1-2-2-在现有目录中初始化仓库\" class=\"headerlink\" title=\"1.2.2 在现有目录中初始化仓库\"></a>1.2.2 在现有目录中初始化仓库</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果自己有一个尚未进行版本控制的项目目录，想要用 Git 来控制它，需要执行如下两个步骤：</p>\n<p>==① 在项目目录中，通过鼠标右键打开“Git Bash”==</p>\n<p>==② 执行 git init 命令将当前的目录转化为 Git 仓库==</p>\n<img src=\"/2022/01/11/gitOne/gitOne4.gif\" class=\"\">\n<p>git init 命令会创建一个名为.git 的隐藏目录，这个.git 目录就是当前项目的 Git 仓库，里面包含了初始的必要文件，这些文件是 Git 仓库的必要组成部分。</p>\n<h4 id=\"1-2-3-检查文件状态\"><a href=\"#1-2-3-检查文件状态\" class=\"headerlink\" title=\"1.2.3 检查文件状态\"></a>1.2.3 检查文件状态</h4><p>可以使用 git status 命令查看文件处于什么状态，例如：</p>\n<img src=\"/2022/01/11/gitOne/gitOne5.gif\" class=\"\">\n<p><code>在状态报告中可以看到新建的 文件出现在Untracked files（未跟踪的文件）下面。 未跟踪的文件意味着Git 在之前的快照（提交）中没有这些文件；Git 不会自动将之纳入跟踪范围，除非明确地告诉它“我需要使用Git 跟踪管理该文件”。</code></p>\n<h4 id=\"1-2-4-以精简的方式显示文件状态\"><a href=\"#1-2-4-以精简的方式显示文件状态\" class=\"headerlink\" title=\"1.2.4 以精简的方式显示文件状态\"></a>1.2.4 以精简的方式显示文件状态</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用 git status 输出的状态报告很详细，但有些繁琐。如果希望以精简的方式显示文件的状态，可以使用如下两条完全等价的命令，其中-s 是–short 的简写形式：</p>\n<img src=\"/2022/01/11/gitOne/gitOne6.png\" class=\"\">\n\n<h4 id=\"1-2-5-跟踪新文件\"><a href=\"#1-2-5-跟踪新文件\" class=\"headerlink\" title=\"1.2.5 跟踪新文件\"></a>1.2.5 跟踪新文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用命令 git add 开始跟踪一个文件。所以，要跟踪 index.html 文件，运行如下的命令即可：</p>\n<img src=\"/2022/01/11/gitOne/gitOne7.png\" class=\"\">\n<p>此时再运行 git status 命令，会看到文件在 Changes to be committed 这行的下面，说明已被跟踪，并处于暂存状态：</p>\n<img src=\"/2022/01/11/gitOne/gitOne8.png\" class=\"\">\n<p>以精简的方式获取状态：</p>\n<img src=\"/2022/01/11/gitOne/gitOne9.png\" class=\"\">\n\n<h4 id=\"1-2-6-提交更新\"><a href=\"#1-2-6-提交更新\" class=\"headerlink\" title=\"1.2.6 提交更新\"></a>1.2.6 提交更新</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;现在暂存区中有一个 index.html 文件等待被提交到 Git 仓库中进行保存。可以执行 git commit 命令进行提交,其中-m 选项后面是本次的提交消息，用来对提交的内容做进一步的描述：</p>\n<img src=\"/2022/01/11/gitOne/gitOne10.png\" class=\"\">\n<p><strong>提交成功之后，会显示如下的信息：</strong></p>\n<img src=\"/2022/01/11/gitOne/gitOne11.png\" class=\"\">\n<p><strong>再次检查文件状态</strong></p>\n<img src=\"/2022/01/11/gitOne/gitOne12.png\" class=\"\">\n\n<h4 id=\"1-2-7-对已提交的文件进行修改\"><a href=\"#1-2-7-对已提交的文件进行修改\" class=\"headerlink\" title=\"1.2.7 对已提交的文件进行修改\"></a>1.2.7 对已提交的文件进行修改</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;目前，index.html 文件已经被 Git 跟踪，并且工作区和 Git 仓库中的 index.html 文件内容保持一致。当我们修改了工作区中 index.html 的内容之后，再次运行 git status 和 git status -s 命令，会看到如下的内容：</p>\n<img src=\"/2022/01/11/gitOne/gitOne13.png\" class=\"\">\n<p>&nbsp;&nbsp;&nbsp;&nbsp;文件 index.html 出现 Changes not staged for commit 这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。<br><code>注意：修改过的、没有放入暂存区的文件前面有红色的M 标记。</code></p>\n<h4 id=\"1-2-8-暂存已修改的文件\"><a href=\"#1-2-8-暂存已修改的文件\" class=\"headerlink\" title=\"1.2.8 暂存已修改的文件\"></a>1.2.8 暂存已修改的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;目前，工作区中的 index.html 文件已被修改，如果要暂存这次修改，需要再次运行 git add 命令，这个命令是个多功能的命令，主要有如下 3 个功效：<br>==① 可以用它开始跟踪新文件==<br>==② 把已跟踪的、且已修改的文件放到暂存区==<br>==③ 把有冲突的文件标记为已解决状态==</p>\n<img src=\"/2022/01/11/gitOne/gitOne14.png\" class=\"\">\n\n<h4 id=\"1-2-9-提交暂存的文件\"><a href=\"#1-2-9-提交暂存的文件\" class=\"headerlink\" title=\"1.2.9 提交暂存的文件\"></a>1.2.9 提交暂存的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;再次运行 git commit -m “提交消息” 命令，即可将暂存区中记录的 index.html 的快照，提交到 Git 仓库中进行保存：</p>\n<img src=\"/2022/01/11/gitOne/gitOne15.png\" class=\"\">\n<img src=\"/2022/01/11/gitOne/gitOne16.png\" class=\"\">\n\n<h4 id=\"1-2-10-撤销文件的修改\"><a href=\"#1-2-10-撤销文件的修改\" class=\"headerlink\" title=\"1.2.10 撤销文件的修改\"></a>1.2.10 撤销文件的修改</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;撤销对文件的修改指的是：把对工作区中对应文件的修改，还原成 Git 仓库中所保存的版本。<br><code>操作的结果：所有的修改会丢失，且无法恢复！危险性比较高，请慎重操作！</code></p>\n<img src=\"/2022/01/11/gitOne/gitOne17.png\" class=\"\">\n<p><code>撤销操作的本质：用Git 仓库中保存的文件，覆盖工作区中指定的文件。</code></p>\n<h4 id=\"1-2-11-向暂存区中一次性添加多个文件\"><a href=\"#1-2-11-向暂存区中一次性添加多个文件\" class=\"headerlink\" title=\"1.2.11 向暂存区中一次性添加多个文件\"></a>1.2.11 向暂存区中一次性添加多个文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果需要被暂存的文件个数比较多，可以使用如下的命令，一次性将所有的新增和修改过的文件加入暂存区：</p>\n<img src=\"/2022/01/11/gitOne/gitOne18.png\" class=\"\">\n<p><code>注意：今后在项目开发中，会经常使用这个命令，将新增和修改过后的文件加入暂存区。</code></p>\n<h4 id=\"1-2-12-取消暂存的文件\"><a href=\"#1-2-12-取消暂存的文件\" class=\"headerlink\" title=\"1.2.12 取消暂存的文件\"></a>1.2.12 取消暂存的文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果需要从暂存区中移除对应的文件，可以使用如下的命令：</p>\n<img src=\"/2022/01/11/gitOne/gitOne19.png\" class=\"\">\n\n<h4 id=\"1-2-13-跳过使用暂存区\"><a href=\"#1-2-13-跳过使用暂存区\" class=\"headerlink\" title=\"1.2.13 跳过使用暂存区\"></a>1.2.13 跳过使用暂存区</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Git 标准的工作流程是==工作区==→ ==暂存区==→ ==Git 仓库==，但有时候这么做略显繁琐，此时可以跳过暂存区，直接将工作区中的修改提交到 Git 仓库，这时候 Git 工作的流程简化为了工作区 → Git 仓库。<br>Git 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 git commit 加上-a 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 git add 步骤：</p>\n<img src=\"/2022/01/11/gitOne/gitOne20.png\" class=\"\">\n\n<h4 id=\"1-2-14-移除文件\"><a href=\"#1-2-14-移除文件\" class=\"headerlink\" title=\"1.2.14 移除文件\"></a>1.2.14 移除文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;从 Git 仓库中移除文件的方式有两种：<br>① 从 Git 仓库和工作区中同时移除对应的文件<br>② 只从 Git 仓库中移除指定的文件，但保留工作区中对应的文件；</p>\n<img src=\"/2022/01/11/gitOne/gitOne21.png\" class=\"\">\n\n<h4 id=\"1-2-15-忽略文件\"><a href=\"#1-2-15-忽略文件\" class=\"headerlink\" title=\"1.2.15 忽略文件\"></a>1.2.15 忽略文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。在这种情况下，我们可以创建一个名为.gitignore 的配置文件，列出要忽略的文件的匹配模式。<br>文件.gitignore 的格式规范如下：<br>① 以# 开头的是注释<br>② 以/结尾的是目录<br>③ 以/开头防止递归<br>④ 以!开头表示取反<br>⑤ 可以使用 glob 模式进行文件和文件夹的匹配（glob 指简化了的正则表达式）</p>\n<h4 id=\"1-2-16-glob-模式\"><a href=\"#1-2-16-glob-模式\" class=\"headerlink\" title=\"1.2.16 glob 模式\"></a>1.2.16 glob 模式</h4><p>所谓的 glob 模式是指简化了的正则表达式：<br>① 星号* 匹配零个或多个任意字符<br>②[abc] 匹配任何一个列在方括号中的字符（此案例匹配一个 a 或匹配一个 b 或匹配一个 c）<br>③ 问号?只匹配一个任意字符<br>④ 在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如[0-9] 表示匹配<br>所有 0 到 9 的数字）<br>⑤ 两个星号** 表示匹配任意中间目录（比如 a/**/z 可以匹配 a/z 、a/b/z 或 a/b/c/z 等）</p>\n<h4 id=\"1-2-17-gitignore-文件的例子\"><a href=\"#1-2-17-gitignore-文件的例子\" class=\"headerlink\" title=\"1.2.17 .gitignore 文件的例子\"></a>1.2.17 .gitignore 文件的例子</h4><img src=\"/2022/01/11/gitOne/gitOne22.png\" class=\"\">\n\n<h4 id=\"1-2-18-查看提交历史\"><a href=\"#1-2-18-查看提交历史\" class=\"headerlink\" title=\"1.2.18 查看提交历史\"></a>1.2.18 查看提交历史</h4><p>如果希望回顾项目的提交历史，可以使用 git log 这个简单且有效的命令。</p>\n<img src=\"/2022/01/11/gitOne/gitOne23.png\" class=\"\">\n\n<h4 id=\"1-2-19-回退到指定版本\"><a href=\"#1-2-19-回退到指定版本\" class=\"headerlink\" title=\"1.2.19 回退到指定版本\"></a>1.2.19 回退到指定版本</h4><img src=\"/2022/01/11/gitOne/gitOne24.png\" class=\"\">\n\n<h2 id=\"🥇-知识の总结\"><a href=\"#🥇-知识の总结\" class=\"headerlink\" title=\"🥇 知识の总结\"></a>🥇 知识の总结</h2><p>总结：<br>① 初始化 Git 仓库的命令<br><font color=red>git init </font><br>② 查看文件状态的命令<br><font color=red>git status 或 git status -s</font><br>③ 一次性将文件加入暂存区的命令<br><font color=red>git add .</font><br>④ 将暂存区的文件提交到 Git 仓库的命令<br>$\\textcolor{red} {git commit -m “提交消息”}$<br>📣 注意：项目中经常使用以上基本操作请小伙伴牢记哦 ❗❗❗</p>\n<h2 id=\"🥇-推荐の内容\"><a href=\"#🥇-推荐の内容\" class=\"headerlink\" title=\"🥇 推荐の内容\"></a>🥇 推荐の内容</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p>学会项目管理需还需要掌握 Github、git 分支相关知识，我会陆续为大家整理 Github 和 Git 分支相关知识，大家敬请期待哦！！！</p>\n"},{"title":"git rebase 配合 git cherry-pick 使用","description":"git rebase能够合并多个提交，git cherry-pick 能根据commitId将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；","headimg":"/images/git.jpeg","date":"2021-12-08T16:00:00.000Z","_content":"\n## 前言\n\n{% asset_img git.jpeg %}\n相信大家在开发中一定遇到过一下我说是两个问题：\n`1、实现一个功能但是提交了多次，导致commit的log很臃肿，不够清晰；`\n`2、在合并分支时，有时候我们只想合并dev分支上的部分commit，而不是全部合并；`\n若想解决以上两个问题，git rebase 和 git cherry-pick 便是最好的选择，git rebase 能够合并多个提交，git cherry-pick 能根据 commitId 将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；\n\n## 1、 git rebase\n\n第一步：假如你的开发分支是 dev，首先先切到你自己的分支上,然后修改 3 次代码，提交 3 次，git log 后如下所示；\n{% asset_img rebase1.png %}\n第二步：若想和并以上 3 个分支我们可以执行如下命令进行分支编辑；\n\n```javascript\ngit rebase -i  [startpoint]  [endpoint]\n//或者\ngit rebase -i HEAD~3\n```\n\n其中-i 的意思是--interactive，即弹出交互式的界面让用户编辑完成合并操作，[startpoint] [endpoint]则指定了一个编辑区间，均为 commitId，如果不指定[endpoint]，则该区间的终点默认是当前分支 HEAD 所指向的 commit(注：该区间指定的是一个前开后闭的区间)。\n执行以上命令后，进入了分支编辑页面如下：\n{% asset_img rebase2.png %}\n以上#号注释的是指令说明，其释义如下：\npick：保留该 commit（缩写:p）\nreword：保留该 commit，但我需要修改该 commit 的注释（缩写:r）\nedit：保留该 commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）\nsquash：将该 commit 和前一个 commit 合并（缩写:s）\nfixup：将该 commit 和前一个 commit 合并，但我不要保留该提交的注释信息（缩写:f）\nexec：执行 shell 命令（缩写:x）\ndrop：我要丢弃该 commit（缩写:d）\n按 i 进入编辑状态，将下面的两个 pick 改成 s，如下图所示：\n{% asset_img rebase3.png %}\n按 esc -> 冒号 -> wq （退出并保存）\n此时进入了提交信息的编辑页面如下所示：\n{% asset_img rebase4.png %}\n可以使用 dd 删除提交信息保留一个即可,继续按 esc -> 冒号 -> wq （退出并保存）\n此时执行 git log 看到如下图所示，只有 commit1 了\n{% asset_img rebase5.png %}\n\n## 2、 git cherry-pick\n\n第一节已经讲解了 git rebase，本节接上一节的最后教大家如何使用 git cherry-pick 在 dev 分支合并了多个提交后，此时大家一定会首先想到使用 git merge 合并到主分支，实际上假如我只想将已经被合并成 commit1 的最近的三次提交合并到主分支，此时即可以使用 git cherry-pick；\n执行步骤如下：\n1、首先切换到 master 分支；\n2、然后执行 git cherry-pick commitId\n以上 commitId 是在 dev 分支上你要拷贝到主分支的 commitId；执行完毕即可以通过 git log 看到主分支上多了 commit1 的提交；\n\n## 写在最后\n\ngit rebase 和 git cherry-pick 的使用能大大提高代码提交的规范和 git 日志的可读性；对于 git cherry-pick,网上也有些不同的声音，链接如下，欢迎大家留言交流：\n[Stop cherry-picking, start merging, Part 1: The merge conflict\n](https://devblogs.microsoft.com/oldnewthing/20180312-00/?p=98215)\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/gitRebase.md","raw":"---\ntitle: git rebase 配合 git cherry-pick 使用\ndescription: git rebase能够合并多个提交，git cherry-pick 能根据commitId将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；\nheadimg: /images/git.jpeg\ndate: 2021-12-09\ntags:\n  - Git\ncategories:\n  - Git\n---\n\n## 前言\n\n{% asset_img git.jpeg %}\n相信大家在开发中一定遇到过一下我说是两个问题：\n`1、实现一个功能但是提交了多次，导致commit的log很臃肿，不够清晰；`\n`2、在合并分支时，有时候我们只想合并dev分支上的部分commit，而不是全部合并；`\n若想解决以上两个问题，git rebase 和 git cherry-pick 便是最好的选择，git rebase 能够合并多个提交，git cherry-pick 能根据 commitId 将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；\n\n## 1、 git rebase\n\n第一步：假如你的开发分支是 dev，首先先切到你自己的分支上,然后修改 3 次代码，提交 3 次，git log 后如下所示；\n{% asset_img rebase1.png %}\n第二步：若想和并以上 3 个分支我们可以执行如下命令进行分支编辑；\n\n```javascript\ngit rebase -i  [startpoint]  [endpoint]\n//或者\ngit rebase -i HEAD~3\n```\n\n其中-i 的意思是--interactive，即弹出交互式的界面让用户编辑完成合并操作，[startpoint] [endpoint]则指定了一个编辑区间，均为 commitId，如果不指定[endpoint]，则该区间的终点默认是当前分支 HEAD 所指向的 commit(注：该区间指定的是一个前开后闭的区间)。\n执行以上命令后，进入了分支编辑页面如下：\n{% asset_img rebase2.png %}\n以上#号注释的是指令说明，其释义如下：\npick：保留该 commit（缩写:p）\nreword：保留该 commit，但我需要修改该 commit 的注释（缩写:r）\nedit：保留该 commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）\nsquash：将该 commit 和前一个 commit 合并（缩写:s）\nfixup：将该 commit 和前一个 commit 合并，但我不要保留该提交的注释信息（缩写:f）\nexec：执行 shell 命令（缩写:x）\ndrop：我要丢弃该 commit（缩写:d）\n按 i 进入编辑状态，将下面的两个 pick 改成 s，如下图所示：\n{% asset_img rebase3.png %}\n按 esc -> 冒号 -> wq （退出并保存）\n此时进入了提交信息的编辑页面如下所示：\n{% asset_img rebase4.png %}\n可以使用 dd 删除提交信息保留一个即可,继续按 esc -> 冒号 -> wq （退出并保存）\n此时执行 git log 看到如下图所示，只有 commit1 了\n{% asset_img rebase5.png %}\n\n## 2、 git cherry-pick\n\n第一节已经讲解了 git rebase，本节接上一节的最后教大家如何使用 git cherry-pick 在 dev 分支合并了多个提交后，此时大家一定会首先想到使用 git merge 合并到主分支，实际上假如我只想将已经被合并成 commit1 的最近的三次提交合并到主分支，此时即可以使用 git cherry-pick；\n执行步骤如下：\n1、首先切换到 master 分支；\n2、然后执行 git cherry-pick commitId\n以上 commitId 是在 dev 分支上你要拷贝到主分支的 commitId；执行完毕即可以通过 git log 看到主分支上多了 commit1 的提交；\n\n## 写在最后\n\ngit rebase 和 git cherry-pick 的使用能大大提高代码提交的规范和 git 日志的可读性；对于 git cherry-pick,网上也有些不同的声音，链接如下，欢迎大家留言交流：\n[Stop cherry-picking, start merging, Part 1: The merge conflict\n](https://devblogs.microsoft.com/oldnewthing/20180312-00/?p=98215)\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"gitRebase","published":1,"updated":"2023-03-15T11:16:47.426Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqev000mp5o1f5k2cxl4","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2>\n<p>相信大家在开发中一定遇到过一下我说是两个问题：<br><code>1、实现一个功能但是提交了多次，导致commit的log很臃肿，不够清晰；</code><br><code>2、在合并分支时，有时候我们只想合并dev分支上的部分commit，而不是全部合并；</code><br>若想解决以上两个问题，git rebase 和 git cherry-pick 便是最好的选择，git rebase 能够合并多个提交，git cherry-pick 能根据 commitId 将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；</p>\n<h2 id=\"1、-git-rebase\"><a href=\"#1、-git-rebase\" class=\"headerlink\" title=\"1、 git rebase\"></a>1、 git rebase</h2><p>第一步：假如你的开发分支是 dev，首先先切到你自己的分支上,然后修改 3 次代码，提交 3 次，git log 后如下所示；</p>\n<img src=\"/2021/12/09/gitRebase/rebase1.png\" class=\"lazyload\" data-srcset=\"/2021/12/09/gitRebase/rebase1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>第二步：若想和并以上 3 个分支我们可以执行如下命令进行分支编辑；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rebase -i  [startpoint]  [endpoint]</span><br><span class=\"line\"><span class=\"comment\">//或者</span></span><br><span class=\"line\">git rebase -i <span class=\"variable constant_\">HEAD</span>~<span class=\"number\">3</span></span><br></pre></td></tr></table></figure>\n\n<p>其中-i 的意思是–interactive，即弹出交互式的界面让用户编辑完成合并操作，[startpoint] [endpoint]则指定了一个编辑区间，均为 commitId，如果不指定[endpoint]，则该区间的终点默认是当前分支 HEAD 所指向的 commit(注：该区间指定的是一个前开后闭的区间)。<br>执行以上命令后，进入了分支编辑页面如下：</p>\n<img src=\"/2021/12/09/gitRebase/rebase2.png\" class=\"lazyload\" data-srcset=\"/2021/12/09/gitRebase/rebase2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>以上#号注释的是指令说明，其释义如下：<br>pick：保留该 commit（缩写:p）<br>reword：保留该 commit，但我需要修改该 commit 的注释（缩写:r）<br>edit：保留该 commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）<br>squash：将该 commit 和前一个 commit 合并（缩写:s）<br>fixup：将该 commit 和前一个 commit 合并，但我不要保留该提交的注释信息（缩写:f）<br>exec：执行 shell 命令（缩写:x）<br>drop：我要丢弃该 commit（缩写:d）<br>按 i 进入编辑状态，将下面的两个 pick 改成 s，如下图所示：</p>\n<img src=\"/2021/12/09/gitRebase/rebase3.png\" class=\"lazyload\" data-srcset=\"/2021/12/09/gitRebase/rebase3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>按 esc -&gt; 冒号 -&gt; wq （退出并保存）<br>此时进入了提交信息的编辑页面如下所示：</p>\n<img src=\"/2021/12/09/gitRebase/rebase4.png\" class=\"lazyload\" data-srcset=\"/2021/12/09/gitRebase/rebase4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>可以使用 dd 删除提交信息保留一个即可,继续按 esc -&gt; 冒号 -&gt; wq （退出并保存）<br>此时执行 git log 看到如下图所示，只有 commit1 了</p>\n<img src=\"/2021/12/09/gitRebase/rebase5.png\" class=\"lazyload\" data-srcset=\"/2021/12/09/gitRebase/rebase5.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"2、-git-cherry-pick\"><a href=\"#2、-git-cherry-pick\" class=\"headerlink\" title=\"2、 git cherry-pick\"></a>2、 git cherry-pick</h2><p>第一节已经讲解了 git rebase，本节接上一节的最后教大家如何使用 git cherry-pick 在 dev 分支合并了多个提交后，此时大家一定会首先想到使用 git merge 合并到主分支，实际上假如我只想将已经被合并成 commit1 的最近的三次提交合并到主分支，此时即可以使用 git cherry-pick；<br>执行步骤如下：<br>1、首先切换到 master 分支；<br>2、然后执行 git cherry-pick commitId<br>以上 commitId 是在 dev 分支上你要拷贝到主分支的 commitId；执行完毕即可以通过 git log 看到主分支上多了 commit1 的提交；</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>git rebase 和 git cherry-pick 的使用能大大提高代码提交的规范和 git 日志的可读性；对于 git cherry-pick,网上也有些不同的声音，链接如下，欢迎大家留言交流：<br><a href=\"https://devblogs.microsoft.com/oldnewthing/20180312-00/?p=98215\">Stop cherry-picking, start merging, Part 1: The merge conflict\n</a></p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2>\n<p>相信大家在开发中一定遇到过一下我说是两个问题：<br><code>1、实现一个功能但是提交了多次，导致commit的log很臃肿，不够清晰；</code><br><code>2、在合并分支时，有时候我们只想合并dev分支上的部分commit，而不是全部合并；</code><br>若想解决以上两个问题，git rebase 和 git cherry-pick 便是最好的选择，git rebase 能够合并多个提交，git cherry-pick 能根据 commitId 将提交拷贝到主分支上；下面我将依次带大家学习这两个好用的命令；</p>\n<h2 id=\"1、-git-rebase\"><a href=\"#1、-git-rebase\" class=\"headerlink\" title=\"1、 git rebase\"></a>1、 git rebase</h2><p>第一步：假如你的开发分支是 dev，首先先切到你自己的分支上,然后修改 3 次代码，提交 3 次，git log 后如下所示；</p>\n<img src=\"/2021/12/09/gitRebase/rebase1.png\" class=\"\">\n<p>第二步：若想和并以上 3 个分支我们可以执行如下命令进行分支编辑；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rebase -i  [startpoint]  [endpoint]</span><br><span class=\"line\"><span class=\"comment\">//或者</span></span><br><span class=\"line\">git rebase -i <span class=\"variable constant_\">HEAD</span>~<span class=\"number\">3</span></span><br></pre></td></tr></table></figure>\n\n<p>其中-i 的意思是–interactive，即弹出交互式的界面让用户编辑完成合并操作，[startpoint] [endpoint]则指定了一个编辑区间，均为 commitId，如果不指定[endpoint]，则该区间的终点默认是当前分支 HEAD 所指向的 commit(注：该区间指定的是一个前开后闭的区间)。<br>执行以上命令后，进入了分支编辑页面如下：</p>\n<img src=\"/2021/12/09/gitRebase/rebase2.png\" class=\"\">\n<p>以上#号注释的是指令说明，其释义如下：<br>pick：保留该 commit（缩写:p）<br>reword：保留该 commit，但我需要修改该 commit 的注释（缩写:r）<br>edit：保留该 commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）<br>squash：将该 commit 和前一个 commit 合并（缩写:s）<br>fixup：将该 commit 和前一个 commit 合并，但我不要保留该提交的注释信息（缩写:f）<br>exec：执行 shell 命令（缩写:x）<br>drop：我要丢弃该 commit（缩写:d）<br>按 i 进入编辑状态，将下面的两个 pick 改成 s，如下图所示：</p>\n<img src=\"/2021/12/09/gitRebase/rebase3.png\" class=\"\">\n<p>按 esc -&gt; 冒号 -&gt; wq （退出并保存）<br>此时进入了提交信息的编辑页面如下所示：</p>\n<img src=\"/2021/12/09/gitRebase/rebase4.png\" class=\"\">\n<p>可以使用 dd 删除提交信息保留一个即可,继续按 esc -&gt; 冒号 -&gt; wq （退出并保存）<br>此时执行 git log 看到如下图所示，只有 commit1 了</p>\n<img src=\"/2021/12/09/gitRebase/rebase5.png\" class=\"\">\n\n<h2 id=\"2、-git-cherry-pick\"><a href=\"#2、-git-cherry-pick\" class=\"headerlink\" title=\"2、 git cherry-pick\"></a>2、 git cherry-pick</h2><p>第一节已经讲解了 git rebase，本节接上一节的最后教大家如何使用 git cherry-pick 在 dev 分支合并了多个提交后，此时大家一定会首先想到使用 git merge 合并到主分支，实际上假如我只想将已经被合并成 commit1 的最近的三次提交合并到主分支，此时即可以使用 git cherry-pick；<br>执行步骤如下：<br>1、首先切换到 master 分支；<br>2、然后执行 git cherry-pick commitId<br>以上 commitId 是在 dev 分支上你要拷贝到主分支的 commitId；执行完毕即可以通过 git log 看到主分支上多了 commit1 的提交；</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>git rebase 和 git cherry-pick 的使用能大大提高代码提交的规范和 git 日志的可读性；对于 git cherry-pick,网上也有些不同的声音，链接如下，欢迎大家留言交流：<br><a href=\"https://devblogs.microsoft.com/oldnewthing/20180312-00/?p=98215\">Stop cherry-picking, start merging, Part 1: The merge conflict\n</a></p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"Git分布式版本控制系统(二)","description":"应很多粉丝的要求，本篇文章将带小伙伴们学习Git分支、Github相关的知识；","headimg":"/images/git.jpeg","date":"2022-02-21T16:00:00.000Z","_content":"\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n**前言**\n\n&nbsp;&nbsp;&nbsp;&nbsp;上一篇文章已经讲解了 Git 基本命令的使用，应很多粉丝的要求，本篇文章将带小伙伴们学习 Git 分支、Github 相关的知识，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，学习完本篇文章，相信小伙伴们将会有醍醐灌顶，入浴春风的感觉哦！！！\n{% asset_img to1.webp %}\n\n@[TOC](文章の目录)\n\n## 🏆 学习の目标\n\n1.  了解 Github\n2.  会将本地仓库传到远程仓库\n3.  会将远程仓库克隆到本地\n4.  学会使用 Git 分支操作\n\n## 一、Github\n\n### 了解开源相关概念\n\n#### 什么是开源和闭源\n\n&nbsp;&nbsp;&nbsp;&nbsp;==开源==即开放源代码，代码是公开的，任何人都能够去查看、修改、使用的，相反的==闭源==，它的代码是封闭的，只有作者能看到闭源软件的代码，只有作者才能对源代码进行修改；\n\n#### 什么是开源许可协议\n\n&nbsp;&nbsp;&nbsp;&nbsp;开源并不意味着完全没有限制，为了限制使用者的使用范围和保护作者的权利，每个开源项目都应该遵守开源许可协仪（Open Source License ）。\n\n#### 常见的 5 种开源许可协议\n\n① BSD（Berkeley Software Distribution）\n② Apache Licence 2.0\n③ GPL（GNU General Public License）\n⚫ 具有传染性的一种开源协议，不允许修改后和衍生的代码做为闭源的商业软件发布和销售\n⚫ 使用 GPL 的最著名的软件项目是：Linux\n④ LGPL（GNU Lesser General Public License）\n⑤ MIT（Massachusetts Institute of Technology, MIT）\n⚫ 是目前限制最少的协议，唯一的条件：在修改后的代码或者发行包中，必须包含原作者的许可信息\n⚫ 使用 MIT 的软件项目有：jquery、Node.js\n\n#### 为什么要拥抱开源\n\n&nbsp;&nbsp;&nbsp;&nbsp;开源的核心思想是“我为人人，人人为我”，人们越来越喜欢开源大致是出于以下 3 个原因：\n① 开源给使用者更多的控制权\n② 开源让学习变得容易\n③ 开源才有真正的安全\n开源是软件开发领域的大趋势，拥抱开源就像站在了巨人的肩膀上，不用自己重复造轮子，让开发越来越容易。\n\n#### 开源项目托管平台\n\n&nbsp;&nbsp;&nbsp;&nbsp;专门用于免费存放开源项目源代码的网站，叫做开源项目托管平台。目前世界上比较出名的开源项目托管平台\n主要有以下 3 个：\n⚫ Github（全球最牛的开源项目托管平台，没有之一）\n⚫ Gitlab（对代码私有性支持较好，因此企业用户较多）\n⚫ Gitee（又叫做码云，是国产的开源项目托管平台。访问速度快、纯中文界面、使用友好）\n注意：以上 3 个开源项目托管平台，只能托管以 Git 管理的项目源代码，因此，它们的名字都以 Git 开头。\n\n#### 什么是 Github\n\n&nbsp;&nbsp;&nbsp;&nbsp;Github 是全球最大的开源项目托管平台。因为只支持 Git 作为唯一的版本控制工具，故名 GitHub。 在 Github 中，你可以：\n① 关注自己喜欢的开源项目，为其点赞打 call\n② 为自己喜欢的开源项目做贡献（Pull Request） ③ 和开源项目的作者讨论 Bug 和提需求 （Issues） ④ 把喜欢的项目复制一份作为自己的项目进行修改（Fork） ⑤ 创建属于自己的开源项目\n⑥ etc…\nSo，Github ≠ Git\n\n### 注册账号\n\n#### 注册激活 Github 账号流程\n\n① 访问 Github 的官网首页 https://github.com/\n② 点击“Sign up”按钮跳转到注册页面\n③ 填写可用的用户名、邮箱、密码\n④ 通过点击箭头的形式，将验证图片摆正\n⑤ 点击“Create account”按钮注册新用户\n⑥ 登录到第三步填写的邮箱中，点击激活链接，完成注册；\n{% asset_img to2.png %}\n{% asset_img to3.png %}\n{% asset_img to4.png %}\n\n### 远程仓库的使用\n\n#### 新建空白远程仓库\n\n{% asset_img to5.png %}\n{% asset_img to6.png %}\n\n#### 远程仓库的两种访问方式\n\n&nbsp;&nbsp;&nbsp;&nbsp;Github 上的远程仓库，有两种访问方式，分别是 HTTPS 和 SSH。它们的区别是：\n①HTTPS：零配置；但是每次访问仓库时，需要重复输入 Github 的账号和密码才能访问成功\n②SSH：需要进行额外的配置；但是配置成功后，每次访问仓库时，不需重复输入 Github 的账号和密码注意：在实际开发中，推荐使用 SSH 的方式访问远程仓库。\n\n#### 基于 HTTPS 将本地仓库上传到 Github\n\n{% asset_img to7.png %}\n\n#### SSH key\n\nSSH key 的作用：实现本地仓库和 Github 之间免登录的加密数据传输。SSH key 的好处：免登录身份认证、数据加密传输。\nSSH key 由两部分组成，分别是：\n①id_rsa（私钥文件，存放于客户端的电脑中即可）\n②id_rsa.pub（公钥文件，需要配置到 Github 中）\n\n#### 生成 SSH key\n\n① 打开 Git Bash\n② 粘贴如下的命令，并将your_email@example.com 替换为注册 Github 账号时填写的邮箱：\n⚫ssh-keygen -t rsa -b 4096 -C \"your_email@example.com\"\n③ 连续敲击 3 次回车，即可在 C:\\Users\\用户名文件夹\\.ssh 目录中生成 id_rsa 和 id_rsa.pub 两个文件；\n\n#### 配置 SSH key\n\n① 使用记事本打开 id_rsa.pub 文件，复制里面的文本内容\n② 在浏览器中登录 Github，点击头像-> Settings-> SSH and GPG Keys -> New SSH key ③ 将 id_rsa.pub 文件中的内容，粘贴到 Key 对应的文本框中\n④ 在 Title 文本框中任意填写一个名称，来标识这个 Key 从何而来\n\n#### 检测 Github 的 SSH key 是否配置成功\n\n打开 Git Bash，输入如下的命令并回车执行：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/d388e160c89445fba15ac048256e7759.png)\n{% asset_img to8.png %}\n上述的命令执行成功后，可能会看到如下的提示消息：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/4c06a6b3a3254a9cbadec45c24a8e288.png)\n{% asset_img to9.png %}\n输入 yes 之后，如果能看到类似于下面的提示消息，证明 SSH key 已经配置成功了：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/44d6bda9c0134acda1b7670c989cd4c7.png)\n{% asset_img to10.png %}\n\n#### 基于 SSH 将本地仓库上传到 Github\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/3fb664f39cf04308bb61b71f89679413.png)\n{% asset_img to11.png %}\n\n#### 将远程仓库克隆到本地\n\n打开 Git Bash，输入如下的命令并回车执行：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/7f0f14b18ede4502ab805c6ce2fc6218.png)\n{% asset_img to12.png %}\n\n## 二、Git 分支\n\n### Git 本地分支操作\n\n#### 分支的概念\n\n&nbsp;&nbsp;&nbsp;&nbsp;分支就是科幻电影里面的平行宇宙，当你正在电脑前努力学习 Git 的时候，另一个你正在另一个平行宇宙里努力学习 SVN。\n&nbsp;&nbsp;&nbsp;&nbsp;如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，你既学会了 Git 又学会了 SVN！\n![在这里插入图片描述](https://img-blog.csdnimg.cn/80a5846ff5de4197a50d1d424bba724a.png)\n{% asset_img to13.png %}\n\n#### 分支在实际开发中的作用\n\n&nbsp;&nbsp;&nbsp;&nbsp;进行多人协作开发的时候，为了防止互相干扰，提高协同开发的体验，建议每个开发者都基于分支进行项目功能的开发，例如：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/a93cca4790b04c3aa26ba305bbec38bb.png)\n{% asset_img to14.png %}\n\n#### master 主分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;在初始化本地 Git 仓库的时候，Git 默认已经帮我们创建了一个名字叫做 master 的分支。通常我们把这个 master 分支叫做主分支。\n![在这里插入图片描述](https://img-blog.csdnimg.cn/d164fcb49da74d3e901c4c6dbfa9debf.png)\n{% asset_img to15.png %}\n📣 注意：在实际工作中，master 主分支的作用是：==用来保存和记录整个项目已完成的功能代码==。\n&nbsp;&nbsp;&nbsp;&nbsp;因此，不允许程序员直接在 master 分支上修改代码，因为这样做的风险太高，容易导致整个项目崩溃。❗❗❗\n\n#### 功能分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;于程序员不能直接在 master 分支上进行功能的开发，所以就有了==功能分支==的概念。\n&nbsp;&nbsp;&nbsp;&nbsp;==功能分支==指的是==专门用来开发新功能的分支==，它是临时从 master 主分支上分叉出来的，当新功能开发且测试完毕后，最终需要合并到 master 主分支上，如图所示：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/e6f4c1d1fa294b2daf5083cf8caea765.png)\n{% asset_img to16.png %}\n\n#### 查看分支列表\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b2df95b6c7f64be59d39deb24fceacc5.png)\n{% asset_img to17.png %}\n运行的结果如下所示：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/92d62e24d9734c48944f5f4401600ce6.png)\n{% asset_img to18.png %}\n📣 注意：分支名字前面的\\*号表示当前所处的分支。❗❗❗\n\n#### 创建分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用如下的命令，可以基于当前分支，创建一个新的分支，此时，新分支中的代码和当前分支完全一样：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b27891070f944531a8e51bf0c8e60287.png)\n{% asset_img to19.png %}\n图示如下：\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/526910880c774bd5a03244bc3d743471.png)\n{% asset_img to20.png %}\n\n#### 切换分支\n\n使用如下的命令，可以切换到指定的分支上进行开发：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/60fea47d94bd49df9255e33839d3b633.png)\n{% asset_img to21.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/aa09bb19128d4d69beb660230f29eda2.png)\n{% asset_img to22.png %}\n\n#### 分支的快速创建和切换\n\n使用如下的命令，可以创建指定名称的新分支，并立即切换到新分支上：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/453ce0e3da4548dd83f68a57bd878040.png)\n{% asset_img to23.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/c52d590e54ad43ccb82f397fcb36a389.png)\n{% asset_img to24.png %}\n📣 注意：\n\"git checkout -b 分支名称\" 是下面两条命令的简写形式：\n①git branch 分支名称\n②git checkout 分支名称 ❗❗❗\n\n#### 合并分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;功能分支的代码开发测试完毕之后，可以使用如下的命令，将完成后的代码合并到 master 主分支上：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/8546a5c1d6304935bbc003b6b7130ed0.png)\n{% asset_img to25.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cd9182a1084743e6aca6a029c12cc209.png)\n{% asset_img to26.png %}\n📣 合并分支时的注意点：\n假设要把 C 分支的代码合并到 A 分支，则必须==先切换到 A 分支上==，再运行==git merge ==命令，来合并 C 分支 ❗❗❗\n\n#### 删除分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;当把功能分支的代码合并到 master 主分支上以后，就可以使用如下的命令，删除对应的功能分支：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cfb483361c524ecc94f27ec634629e4f.png)\n{% asset_img to27.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/2932181c39da4075b314122004eb4a5a.png)\n{% asset_img to28.png %}\n\n#### 遇到冲突时的分支合并\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果在两个不同的分支中，对同一个文件进行了不同的修改，Git 就没法干净的合并它们。此时，我们需要打开这些包含冲突的文件然后==手动解决冲突==。\n![在这里插入图片描述](https://img-blog.csdnimg.cn/955751fc8f6a4d2baaa4a530988e2b0a.png)\n\n### Git 远程分支操作\n\n#### 将本地分支推送到远程仓库\n\n如果是第一次将本地分支推送到远程仓库，需要运行如下的命令：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/20db9abbafcf420fa9d5de70b49b4b95.png)\n{% asset_img to29.png %}\n📣 注意：第一次推送分支需要带-u 参数，此后可以直接使用 git push 推送代码到远程分支。❗❗❗\n\n#### 查看远程仓库中所有的分支列表\n\n通过如下的命令，可以查看远程仓库中，所有的分支列表的信息：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/7fee94661fdb49c89d86dcdbae44d37e.png)\n{% asset_img to30.png %}\n\n#### 跟踪分支\n\n跟踪分支指的是：从远程仓库中，把远程分支下载到本地仓库中。需要运行的命令如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cfc337af43f1478faa21103e5979854e.png)\n{% asset_img to31.png %}\n\n#### 拉取远程分支的最新的代码\n\n可以使用如下的命令，把远程分支最新的代码下载到本地对应的分支中：\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/f27a90332acc4ebea8d82f9bbe4991d4.png)\n{% asset_img to32.png %}\n\n#### 删除远程分支\n\n可以使用如下的命令，删除远程仓库中指定的分支：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b0b02ff6106146e08b6ee5777589f74e.png)\n{% asset_img to33.png %}\n\n## 知识の总结\n\n&nbsp;&nbsp;&nbsp;&nbsp;看完以上内容小伙伴们一定觉得内容多记不住吧，没关系哦，小二已经为您总结了以后项目常用的命令，大家一定要牢记哦！！！\n![在这里插入图片描述](https://img-blog.csdnimg.cn/591c2d5860e44d528990de0ba0d569ef.png#pic_center)\n{% asset_img to34.png %}\n\n## 🥇 推荐の内容\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n本期为小伙伴们推荐上一期的 Git 基本命令的使用哦，配合本篇文章大家一定会对 Git 有更深刻的理解哦！！下一期我将为大家带来==Git 冲突的解决方法以及案例==，大家敬请期待哟！！!\n[Git 分布式版本控制系统一](https://blog.csdn.net/qq_44588612/article/details/124477260?spm=1001.2014.3001.5501)\n","source":"_posts/gitTo.md","raw":"---\ntitle: Git分布式版本控制系统(二)\ndescription: 应很多粉丝的要求，本篇文章将带小伙伴们学习Git分支、Github相关的知识；\nheadimg: /images/git.jpeg\ndate: 2022-02-22\ntags:\n  - Git\ncategories:\n  - Git\n---\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n**前言**\n\n&nbsp;&nbsp;&nbsp;&nbsp;上一篇文章已经讲解了 Git 基本命令的使用，应很多粉丝的要求，本篇文章将带小伙伴们学习 Git 分支、Github 相关的知识，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，学习完本篇文章，相信小伙伴们将会有醍醐灌顶，入浴春风的感觉哦！！！\n{% asset_img to1.webp %}\n\n@[TOC](文章の目录)\n\n## 🏆 学习の目标\n\n1.  了解 Github\n2.  会将本地仓库传到远程仓库\n3.  会将远程仓库克隆到本地\n4.  学会使用 Git 分支操作\n\n## 一、Github\n\n### 了解开源相关概念\n\n#### 什么是开源和闭源\n\n&nbsp;&nbsp;&nbsp;&nbsp;==开源==即开放源代码，代码是公开的，任何人都能够去查看、修改、使用的，相反的==闭源==，它的代码是封闭的，只有作者能看到闭源软件的代码，只有作者才能对源代码进行修改；\n\n#### 什么是开源许可协议\n\n&nbsp;&nbsp;&nbsp;&nbsp;开源并不意味着完全没有限制，为了限制使用者的使用范围和保护作者的权利，每个开源项目都应该遵守开源许可协仪（Open Source License ）。\n\n#### 常见的 5 种开源许可协议\n\n① BSD（Berkeley Software Distribution）\n② Apache Licence 2.0\n③ GPL（GNU General Public License）\n⚫ 具有传染性的一种开源协议，不允许修改后和衍生的代码做为闭源的商业软件发布和销售\n⚫ 使用 GPL 的最著名的软件项目是：Linux\n④ LGPL（GNU Lesser General Public License）\n⑤ MIT（Massachusetts Institute of Technology, MIT）\n⚫ 是目前限制最少的协议，唯一的条件：在修改后的代码或者发行包中，必须包含原作者的许可信息\n⚫ 使用 MIT 的软件项目有：jquery、Node.js\n\n#### 为什么要拥抱开源\n\n&nbsp;&nbsp;&nbsp;&nbsp;开源的核心思想是“我为人人，人人为我”，人们越来越喜欢开源大致是出于以下 3 个原因：\n① 开源给使用者更多的控制权\n② 开源让学习变得容易\n③ 开源才有真正的安全\n开源是软件开发领域的大趋势，拥抱开源就像站在了巨人的肩膀上，不用自己重复造轮子，让开发越来越容易。\n\n#### 开源项目托管平台\n\n&nbsp;&nbsp;&nbsp;&nbsp;专门用于免费存放开源项目源代码的网站，叫做开源项目托管平台。目前世界上比较出名的开源项目托管平台\n主要有以下 3 个：\n⚫ Github（全球最牛的开源项目托管平台，没有之一）\n⚫ Gitlab（对代码私有性支持较好，因此企业用户较多）\n⚫ Gitee（又叫做码云，是国产的开源项目托管平台。访问速度快、纯中文界面、使用友好）\n注意：以上 3 个开源项目托管平台，只能托管以 Git 管理的项目源代码，因此，它们的名字都以 Git 开头。\n\n#### 什么是 Github\n\n&nbsp;&nbsp;&nbsp;&nbsp;Github 是全球最大的开源项目托管平台。因为只支持 Git 作为唯一的版本控制工具，故名 GitHub。 在 Github 中，你可以：\n① 关注自己喜欢的开源项目，为其点赞打 call\n② 为自己喜欢的开源项目做贡献（Pull Request） ③ 和开源项目的作者讨论 Bug 和提需求 （Issues） ④ 把喜欢的项目复制一份作为自己的项目进行修改（Fork） ⑤ 创建属于自己的开源项目\n⑥ etc…\nSo，Github ≠ Git\n\n### 注册账号\n\n#### 注册激活 Github 账号流程\n\n① 访问 Github 的官网首页 https://github.com/\n② 点击“Sign up”按钮跳转到注册页面\n③ 填写可用的用户名、邮箱、密码\n④ 通过点击箭头的形式，将验证图片摆正\n⑤ 点击“Create account”按钮注册新用户\n⑥ 登录到第三步填写的邮箱中，点击激活链接，完成注册；\n{% asset_img to2.png %}\n{% asset_img to3.png %}\n{% asset_img to4.png %}\n\n### 远程仓库的使用\n\n#### 新建空白远程仓库\n\n{% asset_img to5.png %}\n{% asset_img to6.png %}\n\n#### 远程仓库的两种访问方式\n\n&nbsp;&nbsp;&nbsp;&nbsp;Github 上的远程仓库，有两种访问方式，分别是 HTTPS 和 SSH。它们的区别是：\n①HTTPS：零配置；但是每次访问仓库时，需要重复输入 Github 的账号和密码才能访问成功\n②SSH：需要进行额外的配置；但是配置成功后，每次访问仓库时，不需重复输入 Github 的账号和密码注意：在实际开发中，推荐使用 SSH 的方式访问远程仓库。\n\n#### 基于 HTTPS 将本地仓库上传到 Github\n\n{% asset_img to7.png %}\n\n#### SSH key\n\nSSH key 的作用：实现本地仓库和 Github 之间免登录的加密数据传输。SSH key 的好处：免登录身份认证、数据加密传输。\nSSH key 由两部分组成，分别是：\n①id_rsa（私钥文件，存放于客户端的电脑中即可）\n②id_rsa.pub（公钥文件，需要配置到 Github 中）\n\n#### 生成 SSH key\n\n① 打开 Git Bash\n② 粘贴如下的命令，并将your_email@example.com 替换为注册 Github 账号时填写的邮箱：\n⚫ssh-keygen -t rsa -b 4096 -C \"your_email@example.com\"\n③ 连续敲击 3 次回车，即可在 C:\\Users\\用户名文件夹\\.ssh 目录中生成 id_rsa 和 id_rsa.pub 两个文件；\n\n#### 配置 SSH key\n\n① 使用记事本打开 id_rsa.pub 文件，复制里面的文本内容\n② 在浏览器中登录 Github，点击头像-> Settings-> SSH and GPG Keys -> New SSH key ③ 将 id_rsa.pub 文件中的内容，粘贴到 Key 对应的文本框中\n④ 在 Title 文本框中任意填写一个名称，来标识这个 Key 从何而来\n\n#### 检测 Github 的 SSH key 是否配置成功\n\n打开 Git Bash，输入如下的命令并回车执行：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/d388e160c89445fba15ac048256e7759.png)\n{% asset_img to8.png %}\n上述的命令执行成功后，可能会看到如下的提示消息：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/4c06a6b3a3254a9cbadec45c24a8e288.png)\n{% asset_img to9.png %}\n输入 yes 之后，如果能看到类似于下面的提示消息，证明 SSH key 已经配置成功了：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/44d6bda9c0134acda1b7670c989cd4c7.png)\n{% asset_img to10.png %}\n\n#### 基于 SSH 将本地仓库上传到 Github\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/3fb664f39cf04308bb61b71f89679413.png)\n{% asset_img to11.png %}\n\n#### 将远程仓库克隆到本地\n\n打开 Git Bash，输入如下的命令并回车执行：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/7f0f14b18ede4502ab805c6ce2fc6218.png)\n{% asset_img to12.png %}\n\n## 二、Git 分支\n\n### Git 本地分支操作\n\n#### 分支的概念\n\n&nbsp;&nbsp;&nbsp;&nbsp;分支就是科幻电影里面的平行宇宙，当你正在电脑前努力学习 Git 的时候，另一个你正在另一个平行宇宙里努力学习 SVN。\n&nbsp;&nbsp;&nbsp;&nbsp;如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，你既学会了 Git 又学会了 SVN！\n![在这里插入图片描述](https://img-blog.csdnimg.cn/80a5846ff5de4197a50d1d424bba724a.png)\n{% asset_img to13.png %}\n\n#### 分支在实际开发中的作用\n\n&nbsp;&nbsp;&nbsp;&nbsp;进行多人协作开发的时候，为了防止互相干扰，提高协同开发的体验，建议每个开发者都基于分支进行项目功能的开发，例如：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/a93cca4790b04c3aa26ba305bbec38bb.png)\n{% asset_img to14.png %}\n\n#### master 主分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;在初始化本地 Git 仓库的时候，Git 默认已经帮我们创建了一个名字叫做 master 的分支。通常我们把这个 master 分支叫做主分支。\n![在这里插入图片描述](https://img-blog.csdnimg.cn/d164fcb49da74d3e901c4c6dbfa9debf.png)\n{% asset_img to15.png %}\n📣 注意：在实际工作中，master 主分支的作用是：==用来保存和记录整个项目已完成的功能代码==。\n&nbsp;&nbsp;&nbsp;&nbsp;因此，不允许程序员直接在 master 分支上修改代码，因为这样做的风险太高，容易导致整个项目崩溃。❗❗❗\n\n#### 功能分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;于程序员不能直接在 master 分支上进行功能的开发，所以就有了==功能分支==的概念。\n&nbsp;&nbsp;&nbsp;&nbsp;==功能分支==指的是==专门用来开发新功能的分支==，它是临时从 master 主分支上分叉出来的，当新功能开发且测试完毕后，最终需要合并到 master 主分支上，如图所示：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/e6f4c1d1fa294b2daf5083cf8caea765.png)\n{% asset_img to16.png %}\n\n#### 查看分支列表\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b2df95b6c7f64be59d39deb24fceacc5.png)\n{% asset_img to17.png %}\n运行的结果如下所示：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/92d62e24d9734c48944f5f4401600ce6.png)\n{% asset_img to18.png %}\n📣 注意：分支名字前面的\\*号表示当前所处的分支。❗❗❗\n\n#### 创建分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;使用如下的命令，可以基于当前分支，创建一个新的分支，此时，新分支中的代码和当前分支完全一样：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b27891070f944531a8e51bf0c8e60287.png)\n{% asset_img to19.png %}\n图示如下：\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/526910880c774bd5a03244bc3d743471.png)\n{% asset_img to20.png %}\n\n#### 切换分支\n\n使用如下的命令，可以切换到指定的分支上进行开发：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/60fea47d94bd49df9255e33839d3b633.png)\n{% asset_img to21.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/aa09bb19128d4d69beb660230f29eda2.png)\n{% asset_img to22.png %}\n\n#### 分支的快速创建和切换\n\n使用如下的命令，可以创建指定名称的新分支，并立即切换到新分支上：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/453ce0e3da4548dd83f68a57bd878040.png)\n{% asset_img to23.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/c52d590e54ad43ccb82f397fcb36a389.png)\n{% asset_img to24.png %}\n📣 注意：\n\"git checkout -b 分支名称\" 是下面两条命令的简写形式：\n①git branch 分支名称\n②git checkout 分支名称 ❗❗❗\n\n#### 合并分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;功能分支的代码开发测试完毕之后，可以使用如下的命令，将完成后的代码合并到 master 主分支上：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/8546a5c1d6304935bbc003b6b7130ed0.png)\n{% asset_img to25.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cd9182a1084743e6aca6a029c12cc209.png)\n{% asset_img to26.png %}\n📣 合并分支时的注意点：\n假设要把 C 分支的代码合并到 A 分支，则必须==先切换到 A 分支上==，再运行==git merge ==命令，来合并 C 分支 ❗❗❗\n\n#### 删除分支\n\n&nbsp;&nbsp;&nbsp;&nbsp;当把功能分支的代码合并到 master 主分支上以后，就可以使用如下的命令，删除对应的功能分支：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cfb483361c524ecc94f27ec634629e4f.png)\n{% asset_img to27.png %}\n图示如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/2932181c39da4075b314122004eb4a5a.png)\n{% asset_img to28.png %}\n\n#### 遇到冲突时的分支合并\n\n&nbsp;&nbsp;&nbsp;&nbsp;如果在两个不同的分支中，对同一个文件进行了不同的修改，Git 就没法干净的合并它们。此时，我们需要打开这些包含冲突的文件然后==手动解决冲突==。\n![在这里插入图片描述](https://img-blog.csdnimg.cn/955751fc8f6a4d2baaa4a530988e2b0a.png)\n\n### Git 远程分支操作\n\n#### 将本地分支推送到远程仓库\n\n如果是第一次将本地分支推送到远程仓库，需要运行如下的命令：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/20db9abbafcf420fa9d5de70b49b4b95.png)\n{% asset_img to29.png %}\n📣 注意：第一次推送分支需要带-u 参数，此后可以直接使用 git push 推送代码到远程分支。❗❗❗\n\n#### 查看远程仓库中所有的分支列表\n\n通过如下的命令，可以查看远程仓库中，所有的分支列表的信息：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/7fee94661fdb49c89d86dcdbae44d37e.png)\n{% asset_img to30.png %}\n\n#### 跟踪分支\n\n跟踪分支指的是：从远程仓库中，把远程分支下载到本地仓库中。需要运行的命令如下：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/cfc337af43f1478faa21103e5979854e.png)\n{% asset_img to31.png %}\n\n#### 拉取远程分支的最新的代码\n\n可以使用如下的命令，把远程分支最新的代码下载到本地对应的分支中：\n\n![在这里插入图片描述](https://img-blog.csdnimg.cn/f27a90332acc4ebea8d82f9bbe4991d4.png)\n{% asset_img to32.png %}\n\n#### 删除远程分支\n\n可以使用如下的命令，删除远程仓库中指定的分支：\n![在这里插入图片描述](https://img-blog.csdnimg.cn/b0b02ff6106146e08b6ee5777589f74e.png)\n{% asset_img to33.png %}\n\n## 知识の总结\n\n&nbsp;&nbsp;&nbsp;&nbsp;看完以上内容小伙伴们一定觉得内容多记不住吧，没关系哦，小二已经为您总结了以后项目常用的命令，大家一定要牢记哦！！！\n![在这里插入图片描述](https://img-blog.csdnimg.cn/591c2d5860e44d528990de0ba0d569ef.png#pic_center)\n{% asset_img to34.png %}\n\n## 🥇 推荐の内容\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n本期为小伙伴们推荐上一期的 Git 基本命令的使用哦，配合本篇文章大家一定会对 Git 有更深刻的理解哦！！下一期我将为大家带来==Git 冲突的解决方法以及案例==，大家敬请期待哟！！!\n[Git 分布式版本控制系统一](https://blog.csdn.net/qq_44588612/article/details/124477260?spm=1001.2014.3001.5501)\n","slug":"gitTo","published":1,"updated":"2023-03-15T12:13:00.208Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqex000rp5o1al3de69y","content":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p><strong>前言</strong></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;上一篇文章已经讲解了 Git 基本命令的使用，应很多粉丝的要求，本篇文章将带小伙伴们学习 Git 分支、Github 相关的知识，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，学习完本篇文章，相信小伙伴们将会有醍醐灌顶，入浴春风的感觉哦！！！</p>\n\n\n<p>@<a href=\"%E6%96%87%E7%AB%A0%E3%81%AE%E7%9B%AE%E5%BD%95\">TOC</a></p>\n<h2 id=\"🏆-学习の目标\"><a href=\"#🏆-学习の目标\" class=\"headerlink\" title=\"🏆 学习の目标\"></a>🏆 学习の目标</h2><ol>\n<li> 了解 Github</li>\n<li> 会将本地仓库传到远程仓库</li>\n<li> 会将远程仓库克隆到本地</li>\n<li> 学会使用 Git 分支操作</li>\n</ol>\n<h2 id=\"一、Github\"><a href=\"#一、Github\" class=\"headerlink\" title=\"一、Github\"></a>一、Github</h2><h3 id=\"了解开源相关概念\"><a href=\"#了解开源相关概念\" class=\"headerlink\" title=\"了解开源相关概念\"></a>了解开源相关概念</h3><h4 id=\"什么是开源和闭源\"><a href=\"#什么是开源和闭源\" class=\"headerlink\" title=\"什么是开源和闭源\"></a>什么是开源和闭源</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;==开源==即开放源代码，代码是公开的，任何人都能够去查看、修改、使用的，相反的==闭源==，它的代码是封闭的，只有作者能看到闭源软件的代码，只有作者才能对源代码进行修改；</p>\n<h4 id=\"什么是开源许可协议\"><a href=\"#什么是开源许可协议\" class=\"headerlink\" title=\"什么是开源许可协议\"></a>什么是开源许可协议</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;开源并不意味着完全没有限制，为了限制使用者的使用范围和保护作者的权利，每个开源项目都应该遵守开源许可协仪（Open Source License ）。</p>\n<h4 id=\"常见的-5-种开源许可协议\"><a href=\"#常见的-5-种开源许可协议\" class=\"headerlink\" title=\"常见的 5 种开源许可协议\"></a>常见的 5 种开源许可协议</h4><p>① BSD（Berkeley Software Distribution）<br>② Apache Licence 2.0<br>③ GPL（GNU General Public License）<br>⚫ 具有传染性的一种开源协议，不允许修改后和衍生的代码做为闭源的商业软件发布和销售<br>⚫ 使用 GPL 的最著名的软件项目是：Linux<br>④ LGPL（GNU Lesser General Public License）<br>⑤ MIT（Massachusetts Institute of Technology, MIT）<br>⚫ 是目前限制最少的协议，唯一的条件：在修改后的代码或者发行包中，必须包含原作者的许可信息<br>⚫ 使用 MIT 的软件项目有：jquery、Node.js</p>\n<h4 id=\"为什么要拥抱开源\"><a href=\"#为什么要拥抱开源\" class=\"headerlink\" title=\"为什么要拥抱开源\"></a>为什么要拥抱开源</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;开源的核心思想是“我为人人，人人为我”，人们越来越喜欢开源大致是出于以下 3 个原因：<br>① 开源给使用者更多的控制权<br>② 开源让学习变得容易<br>③ 开源才有真正的安全<br>开源是软件开发领域的大趋势，拥抱开源就像站在了巨人的肩膀上，不用自己重复造轮子，让开发越来越容易。</p>\n<h4 id=\"开源项目托管平台\"><a href=\"#开源项目托管平台\" class=\"headerlink\" title=\"开源项目托管平台\"></a>开源项目托管平台</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;专门用于免费存放开源项目源代码的网站，叫做开源项目托管平台。目前世界上比较出名的开源项目托管平台<br>主要有以下 3 个：<br>⚫ Github（全球最牛的开源项目托管平台，没有之一）<br>⚫ Gitlab（对代码私有性支持较好，因此企业用户较多）<br>⚫ Gitee（又叫做码云，是国产的开源项目托管平台。访问速度快、纯中文界面、使用友好）<br>注意：以上 3 个开源项目托管平台，只能托管以 Git 管理的项目源代码，因此，它们的名字都以 Git 开头。</p>\n<h4 id=\"什么是-Github\"><a href=\"#什么是-Github\" class=\"headerlink\" title=\"什么是 Github\"></a>什么是 Github</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Github 是全球最大的开源项目托管平台。因为只支持 Git 作为唯一的版本控制工具，故名 GitHub。 在 Github 中，你可以：<br>① 关注自己喜欢的开源项目，为其点赞打 call<br>② 为自己喜欢的开源项目做贡献（Pull Request） ③ 和开源项目的作者讨论 Bug 和提需求 （Issues） ④ 把喜欢的项目复制一份作为自己的项目进行修改（Fork） ⑤ 创建属于自己的开源项目<br>⑥ etc…<br>So，Github ≠ Git</p>\n<h3 id=\"注册账号\"><a href=\"#注册账号\" class=\"headerlink\" title=\"注册账号\"></a>注册账号</h3><h4 id=\"注册激活-Github-账号流程\"><a href=\"#注册激活-Github-账号流程\" class=\"headerlink\" title=\"注册激活 Github 账号流程\"></a>注册激活 Github 账号流程</h4><p>① 访问 Github 的官网首页 <a href=\"https://github.com/\">https://github.com/</a><br>② 点击“Sign up”按钮跳转到注册页面<br>③ 填写可用的用户名、邮箱、密码<br>④ 通过点击箭头的形式，将验证图片摆正<br>⑤ 点击“Create account”按钮注册新用户<br>⑥ 登录到第三步填写的邮箱中，点击激活链接，完成注册；</p>\n<img src=\"/2022/02/22/gitTo/to2.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<img src=\"/2022/02/22/gitTo/to3.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<img src=\"/2022/02/22/gitTo/to4.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h3 id=\"远程仓库的使用\"><a href=\"#远程仓库的使用\" class=\"headerlink\" title=\"远程仓库的使用\"></a>远程仓库的使用</h3><h4 id=\"新建空白远程仓库\"><a href=\"#新建空白远程仓库\" class=\"headerlink\" title=\"新建空白远程仓库\"></a>新建空白远程仓库</h4><img src=\"/2022/02/22/gitTo/to5.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to5.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<img src=\"/2022/02/22/gitTo/to6.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to6.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"远程仓库的两种访问方式\"><a href=\"#远程仓库的两种访问方式\" class=\"headerlink\" title=\"远程仓库的两种访问方式\"></a>远程仓库的两种访问方式</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Github 上的远程仓库，有两种访问方式，分别是 HTTPS 和 SSH。它们的区别是：<br>①HTTPS：零配置；但是每次访问仓库时，需要重复输入 Github 的账号和密码才能访问成功<br>②SSH：需要进行额外的配置；但是配置成功后，每次访问仓库时，不需重复输入 Github 的账号和密码注意：在实际开发中，推荐使用 SSH 的方式访问远程仓库。</p>\n<h4 id=\"基于-HTTPS-将本地仓库上传到-Github\"><a href=\"#基于-HTTPS-将本地仓库上传到-Github\" class=\"headerlink\" title=\"基于 HTTPS 将本地仓库上传到 Github\"></a>基于 HTTPS 将本地仓库上传到 Github</h4><img src=\"/2022/02/22/gitTo/to7.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to7.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"SSH-key\"><a href=\"#SSH-key\" class=\"headerlink\" title=\"SSH key\"></a>SSH key</h4><p>SSH key 的作用：实现本地仓库和 Github 之间免登录的加密数据传输。SSH key 的好处：免登录身份认证、数据加密传输。<br>SSH key 由两部分组成，分别是：<br>①id_rsa（私钥文件，存放于客户端的电脑中即可）<br>②id_rsa.pub（公钥文件，需要配置到 Github 中）</p>\n<h4 id=\"生成-SSH-key\"><a href=\"#生成-SSH-key\" class=\"headerlink\" title=\"生成 SSH key\"></a>生成 SSH key</h4><p>① 打开 Git Bash<br>② 粘贴如下的命令，并将<a href=\"mailto:&#121;&#x6f;&#x75;&#114;&#95;&#x65;&#109;&#x61;&#105;&#108;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#109;\">&#121;&#x6f;&#x75;&#114;&#95;&#x65;&#109;&#x61;&#105;&#108;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#109;</a> 替换为注册 Github 账号时填写的邮箱：<br>⚫ssh-keygen -t rsa -b 4096 -C “<a href=\"mailto:&#121;&#111;&#x75;&#114;&#95;&#101;&#109;&#97;&#105;&#x6c;&#x40;&#x65;&#x78;&#x61;&#x6d;&#112;&#x6c;&#x65;&#46;&#99;&#x6f;&#x6d;\">&#121;&#111;&#x75;&#114;&#95;&#101;&#109;&#97;&#105;&#x6c;&#x40;&#x65;&#x78;&#x61;&#x6d;&#112;&#x6c;&#x65;&#46;&#99;&#x6f;&#x6d;</a>“<br>③ 连续敲击 3 次回车，即可在 C:\\Users\\用户名文件夹.ssh 目录中生成 id_rsa 和 id_rsa.pub 两个文件；</p>\n<h4 id=\"配置-SSH-key\"><a href=\"#配置-SSH-key\" class=\"headerlink\" title=\"配置 SSH key\"></a>配置 SSH key</h4><p>① 使用记事本打开 id_rsa.pub 文件，复制里面的文本内容<br>② 在浏览器中登录 Github，点击头像-&gt; Settings-&gt; SSH and GPG Keys -&gt; New SSH key ③ 将 id_rsa.pub 文件中的内容，粘贴到 Key 对应的文本框中<br>④ 在 Title 文本框中任意填写一个名称，来标识这个 Key 从何而来</p>\n<h4 id=\"检测-Github-的-SSH-key-是否配置成功\"><a href=\"#检测-Github-的-SSH-key-是否配置成功\" class=\"headerlink\" title=\"检测 Github 的 SSH key 是否配置成功\"></a>检测 Github 的 SSH key 是否配置成功</h4><p>打开 Git Bash，输入如下的命令并回车执行：<br><img src=\"https://img-blog.csdnimg.cn/d388e160c89445fba15ac048256e7759.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/d388e160c89445fba15ac048256e7759.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to8.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to8.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>上述的命令执行成功后，可能会看到如下的提示消息：<br><img src=\"https://img-blog.csdnimg.cn/4c06a6b3a3254a9cbadec45c24a8e288.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/4c06a6b3a3254a9cbadec45c24a8e288.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to9.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to9.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>输入 yes 之后，如果能看到类似于下面的提示消息，证明 SSH key 已经配置成功了：<br><img src=\"https://img-blog.csdnimg.cn/44d6bda9c0134acda1b7670c989cd4c7.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/44d6bda9c0134acda1b7670c989cd4c7.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to10.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to10.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"基于-SSH-将本地仓库上传到-Github\"><a href=\"#基于-SSH-将本地仓库上传到-Github\" class=\"headerlink\" title=\"基于 SSH 将本地仓库上传到 Github\"></a>基于 SSH 将本地仓库上传到 Github</h4><p><img src=\"https://img-blog.csdnimg.cn/3fb664f39cf04308bb61b71f89679413.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/3fb664f39cf04308bb61b71f89679413.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to11.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to11.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"将远程仓库克隆到本地\"><a href=\"#将远程仓库克隆到本地\" class=\"headerlink\" title=\"将远程仓库克隆到本地\"></a>将远程仓库克隆到本地</h4><p>打开 Git Bash，输入如下的命令并回车执行：<br><img src=\"https://img-blog.csdnimg.cn/7f0f14b18ede4502ab805c6ce2fc6218.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/7f0f14b18ede4502ab805c6ce2fc6218.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to12.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to12.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"二、Git-分支\"><a href=\"#二、Git-分支\" class=\"headerlink\" title=\"二、Git 分支\"></a>二、Git 分支</h2><h3 id=\"Git-本地分支操作\"><a href=\"#Git-本地分支操作\" class=\"headerlink\" title=\"Git 本地分支操作\"></a>Git 本地分支操作</h3><h4 id=\"分支的概念\"><a href=\"#分支的概念\" class=\"headerlink\" title=\"分支的概念\"></a>分支的概念</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;分支就是科幻电影里面的平行宇宙，当你正在电脑前努力学习 Git 的时候，另一个你正在另一个平行宇宙里努力学习 SVN。<br>&nbsp;&nbsp;&nbsp;&nbsp;如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，你既学会了 Git 又学会了 SVN！<br><img src=\"https://img-blog.csdnimg.cn/80a5846ff5de4197a50d1d424bba724a.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/80a5846ff5de4197a50d1d424bba724a.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to13.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to13.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"分支在实际开发中的作用\"><a href=\"#分支在实际开发中的作用\" class=\"headerlink\" title=\"分支在实际开发中的作用\"></a>分支在实际开发中的作用</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;进行多人协作开发的时候，为了防止互相干扰，提高协同开发的体验，建议每个开发者都基于分支进行项目功能的开发，例如：<br><img src=\"https://img-blog.csdnimg.cn/a93cca4790b04c3aa26ba305bbec38bb.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/a93cca4790b04c3aa26ba305bbec38bb.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to14.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to14.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"master-主分支\"><a href=\"#master-主分支\" class=\"headerlink\" title=\"master 主分支\"></a>master 主分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;在初始化本地 Git 仓库的时候，Git 默认已经帮我们创建了一个名字叫做 master 的分支。通常我们把这个 master 分支叫做主分支。<br><img src=\"https://img-blog.csdnimg.cn/d164fcb49da74d3e901c4c6dbfa9debf.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/d164fcb49da74d3e901c4c6dbfa9debf.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to15.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to15.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 注意：在实际工作中，master 主分支的作用是：==用来保存和记录整个项目已完成的功能代码==。<br>&nbsp;&nbsp;&nbsp;&nbsp;因此，不允许程序员直接在 master 分支上修改代码，因为这样做的风险太高，容易导致整个项目崩溃。❗❗❗</p>\n<h4 id=\"功能分支\"><a href=\"#功能分支\" class=\"headerlink\" title=\"功能分支\"></a>功能分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;于程序员不能直接在 master 分支上进行功能的开发，所以就有了==功能分支==的概念。<br>&nbsp;&nbsp;&nbsp;&nbsp;==功能分支==指的是==专门用来开发新功能的分支==，它是临时从 master 主分支上分叉出来的，当新功能开发且测试完毕后，最终需要合并到 master 主分支上，如图所示：<br><img src=\"https://img-blog.csdnimg.cn/e6f4c1d1fa294b2daf5083cf8caea765.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/e6f4c1d1fa294b2daf5083cf8caea765.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to16.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to16.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"查看分支列表\"><a href=\"#查看分支列表\" class=\"headerlink\" title=\"查看分支列表\"></a>查看分支列表</h4><p><img src=\"https://img-blog.csdnimg.cn/b2df95b6c7f64be59d39deb24fceacc5.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/b2df95b6c7f64be59d39deb24fceacc5.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to17.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to17.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>运行的结果如下所示：<br><img src=\"https://img-blog.csdnimg.cn/92d62e24d9734c48944f5f4401600ce6.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/92d62e24d9734c48944f5f4401600ce6.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to18.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to18.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 注意：分支名字前面的*号表示当前所处的分支。❗❗❗</p>\n<h4 id=\"创建分支\"><a href=\"#创建分支\" class=\"headerlink\" title=\"创建分支\"></a>创建分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用如下的命令，可以基于当前分支，创建一个新的分支，此时，新分支中的代码和当前分支完全一样：<br><img src=\"https://img-blog.csdnimg.cn/b27891070f944531a8e51bf0c8e60287.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/b27891070f944531a8e51bf0c8e60287.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to19.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to19.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>图示如下：</p>\n<p><img src=\"https://img-blog.csdnimg.cn/526910880c774bd5a03244bc3d743471.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/526910880c774bd5a03244bc3d743471.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to20.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to20.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"切换分支\"><a href=\"#切换分支\" class=\"headerlink\" title=\"切换分支\"></a>切换分支</h4><p>使用如下的命令，可以切换到指定的分支上进行开发：<br><img src=\"https://img-blog.csdnimg.cn/60fea47d94bd49df9255e33839d3b633.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/60fea47d94bd49df9255e33839d3b633.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to21.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to21.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/aa09bb19128d4d69beb660230f29eda2.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/aa09bb19128d4d69beb660230f29eda2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n\n\n<h4 id=\"分支的快速创建和切换\"><a href=\"#分支的快速创建和切换\" class=\"headerlink\" title=\"分支的快速创建和切换\"></a>分支的快速创建和切换</h4><p>使用如下的命令，可以创建指定名称的新分支，并立即切换到新分支上：<br><img src=\"https://img-blog.csdnimg.cn/453ce0e3da4548dd83f68a57bd878040.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/453ce0e3da4548dd83f68a57bd878040.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to23.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to23.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/c52d590e54ad43ccb82f397fcb36a389.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/c52d590e54ad43ccb82f397fcb36a389.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to24.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to24.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 注意：<br>“git checkout -b 分支名称” 是下面两条命令的简写形式：<br>①git branch 分支名称<br>②git checkout 分支名称 ❗❗❗</p>\n<h4 id=\"合并分支\"><a href=\"#合并分支\" class=\"headerlink\" title=\"合并分支\"></a>合并分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;功能分支的代码开发测试完毕之后，可以使用如下的命令，将完成后的代码合并到 master 主分支上：<br><img src=\"https://img-blog.csdnimg.cn/8546a5c1d6304935bbc003b6b7130ed0.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/8546a5c1d6304935bbc003b6b7130ed0.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to25.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to25.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><img src=\"https://img-blog.csdnimg.cn/cd9182a1084743e6aca6a029c12cc209.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/cd9182a1084743e6aca6a029c12cc209.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to26.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to26.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 合并分支时的注意点：<br>假设要把 C 分支的代码合并到 A 分支，则必须==先切换到 A 分支上==，再运行==git merge ==命令，来合并 C 分支 ❗❗❗</p>\n<h4 id=\"删除分支\"><a href=\"#删除分支\" class=\"headerlink\" title=\"删除分支\"></a>删除分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;当把功能分支的代码合并到 master 主分支上以后，就可以使用如下的命令，删除对应的功能分支：<br><img src=\"https://img-blog.csdnimg.cn/cfb483361c524ecc94f27ec634629e4f.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/cfb483361c524ecc94f27ec634629e4f.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to27.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to27.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/2932181c39da4075b314122004eb4a5a.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/2932181c39da4075b314122004eb4a5a.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to28.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to28.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"遇到冲突时的分支合并\"><a href=\"#遇到冲突时的分支合并\" class=\"headerlink\" title=\"遇到冲突时的分支合并\"></a>遇到冲突时的分支合并</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果在两个不同的分支中，对同一个文件进行了不同的修改，Git 就没法干净的合并它们。此时，我们需要打开这些包含冲突的文件然后==手动解决冲突==。<br><img src=\"https://img-blog.csdnimg.cn/955751fc8f6a4d2baaa4a530988e2b0a.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/955751fc8f6a4d2baaa4a530988e2b0a.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"Git-远程分支操作\"><a href=\"#Git-远程分支操作\" class=\"headerlink\" title=\"Git 远程分支操作\"></a>Git 远程分支操作</h3><h4 id=\"将本地分支推送到远程仓库\"><a href=\"#将本地分支推送到远程仓库\" class=\"headerlink\" title=\"将本地分支推送到远程仓库\"></a>将本地分支推送到远程仓库</h4><p>如果是第一次将本地分支推送到远程仓库，需要运行如下的命令：<br><img src=\"https://img-blog.csdnimg.cn/20db9abbafcf420fa9d5de70b49b4b95.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/20db9abbafcf420fa9d5de70b49b4b95.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to29.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to29.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>📣 注意：第一次推送分支需要带-u 参数，此后可以直接使用 git push 推送代码到远程分支。❗❗❗</p>\n<h4 id=\"查看远程仓库中所有的分支列表\"><a href=\"#查看远程仓库中所有的分支列表\" class=\"headerlink\" title=\"查看远程仓库中所有的分支列表\"></a>查看远程仓库中所有的分支列表</h4><p>通过如下的命令，可以查看远程仓库中，所有的分支列表的信息：<br><img src=\"https://img-blog.csdnimg.cn/7fee94661fdb49c89d86dcdbae44d37e.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/7fee94661fdb49c89d86dcdbae44d37e.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to30.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to30.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"跟踪分支\"><a href=\"#跟踪分支\" class=\"headerlink\" title=\"跟踪分支\"></a>跟踪分支</h4><p>跟踪分支指的是：从远程仓库中，把远程分支下载到本地仓库中。需要运行的命令如下：<br><img src=\"https://img-blog.csdnimg.cn/cfc337af43f1478faa21103e5979854e.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/cfc337af43f1478faa21103e5979854e.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to31.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to31.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"拉取远程分支的最新的代码\"><a href=\"#拉取远程分支的最新的代码\" class=\"headerlink\" title=\"拉取远程分支的最新的代码\"></a>拉取远程分支的最新的代码</h4><p>可以使用如下的命令，把远程分支最新的代码下载到本地对应的分支中：</p>\n<p><img src=\"https://img-blog.csdnimg.cn/f27a90332acc4ebea8d82f9bbe4991d4.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/f27a90332acc4ebea8d82f9bbe4991d4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to32.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to32.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h4 id=\"删除远程分支\"><a href=\"#删除远程分支\" class=\"headerlink\" title=\"删除远程分支\"></a>删除远程分支</h4><p>可以使用如下的命令，删除远程仓库中指定的分支：<br><img src=\"https://img-blog.csdnimg.cn/b0b02ff6106146e08b6ee5777589f74e.png\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/b0b02ff6106146e08b6ee5777589f74e.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to33.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to33.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"知识の总结\"><a href=\"#知识の总结\" class=\"headerlink\" title=\"知识の总结\"></a>知识の总结</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;看完以上内容小伙伴们一定觉得内容多记不住吧，没关系哦，小二已经为您总结了以后项目常用的命令，大家一定要牢记哦！！！<br><img src=\"https://img-blog.csdnimg.cn/591c2d5860e44d528990de0ba0d569ef.png#pic_center\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/591c2d5860e44d528990de0ba0d569ef.png#pic_center\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to34.png\" class=\"lazyload\" data-srcset=\"/2022/02/22/gitTo/to34.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"🥇-推荐の内容\"><a href=\"#🥇-推荐の内容\" class=\"headerlink\" title=\"🥇 推荐の内容\"></a>🥇 推荐の内容</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p>本期为小伙伴们推荐上一期的 Git 基本命令的使用哦，配合本篇文章大家一定会对 Git 有更深刻的理解哦！！下一期我将为大家带来==Git 冲突的解决方法以及案例==，大家敬请期待哟！！!<br><a href=\"https://blog.csdn.net/qq_44588612/article/details/124477260?spm=1001.2014.3001.5501\">Git 分布式版本控制系统一</a></p>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p><strong>前言</strong></p>\n<p>&nbsp;&nbsp;&nbsp;&nbsp;上一篇文章已经讲解了 Git 基本命令的使用，应很多粉丝的要求，本篇文章将带小伙伴们学习 Git 分支、Github 相关的知识，大家也可以在评论区说出自己对本文的意见，和小二一起交流学习，学习完本篇文章，相信小伙伴们将会有醍醐灌顶，入浴春风的感觉哦！！！</p>\n\n\n<p>@<a href=\"%E6%96%87%E7%AB%A0%E3%81%AE%E7%9B%AE%E5%BD%95\">TOC</a></p>\n<h2 id=\"🏆-学习の目标\"><a href=\"#🏆-学习の目标\" class=\"headerlink\" title=\"🏆 学习の目标\"></a>🏆 学习の目标</h2><ol>\n<li> 了解 Github</li>\n<li> 会将本地仓库传到远程仓库</li>\n<li> 会将远程仓库克隆到本地</li>\n<li> 学会使用 Git 分支操作</li>\n</ol>\n<h2 id=\"一、Github\"><a href=\"#一、Github\" class=\"headerlink\" title=\"一、Github\"></a>一、Github</h2><h3 id=\"了解开源相关概念\"><a href=\"#了解开源相关概念\" class=\"headerlink\" title=\"了解开源相关概念\"></a>了解开源相关概念</h3><h4 id=\"什么是开源和闭源\"><a href=\"#什么是开源和闭源\" class=\"headerlink\" title=\"什么是开源和闭源\"></a>什么是开源和闭源</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;==开源==即开放源代码，代码是公开的，任何人都能够去查看、修改、使用的，相反的==闭源==，它的代码是封闭的，只有作者能看到闭源软件的代码，只有作者才能对源代码进行修改；</p>\n<h4 id=\"什么是开源许可协议\"><a href=\"#什么是开源许可协议\" class=\"headerlink\" title=\"什么是开源许可协议\"></a>什么是开源许可协议</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;开源并不意味着完全没有限制，为了限制使用者的使用范围和保护作者的权利，每个开源项目都应该遵守开源许可协仪（Open Source License ）。</p>\n<h4 id=\"常见的-5-种开源许可协议\"><a href=\"#常见的-5-种开源许可协议\" class=\"headerlink\" title=\"常见的 5 种开源许可协议\"></a>常见的 5 种开源许可协议</h4><p>① BSD（Berkeley Software Distribution）<br>② Apache Licence 2.0<br>③ GPL（GNU General Public License）<br>⚫ 具有传染性的一种开源协议，不允许修改后和衍生的代码做为闭源的商业软件发布和销售<br>⚫ 使用 GPL 的最著名的软件项目是：Linux<br>④ LGPL（GNU Lesser General Public License）<br>⑤ MIT（Massachusetts Institute of Technology, MIT）<br>⚫ 是目前限制最少的协议，唯一的条件：在修改后的代码或者发行包中，必须包含原作者的许可信息<br>⚫ 使用 MIT 的软件项目有：jquery、Node.js</p>\n<h4 id=\"为什么要拥抱开源\"><a href=\"#为什么要拥抱开源\" class=\"headerlink\" title=\"为什么要拥抱开源\"></a>为什么要拥抱开源</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;开源的核心思想是“我为人人，人人为我”，人们越来越喜欢开源大致是出于以下 3 个原因：<br>① 开源给使用者更多的控制权<br>② 开源让学习变得容易<br>③ 开源才有真正的安全<br>开源是软件开发领域的大趋势，拥抱开源就像站在了巨人的肩膀上，不用自己重复造轮子，让开发越来越容易。</p>\n<h4 id=\"开源项目托管平台\"><a href=\"#开源项目托管平台\" class=\"headerlink\" title=\"开源项目托管平台\"></a>开源项目托管平台</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;专门用于免费存放开源项目源代码的网站，叫做开源项目托管平台。目前世界上比较出名的开源项目托管平台<br>主要有以下 3 个：<br>⚫ Github（全球最牛的开源项目托管平台，没有之一）<br>⚫ Gitlab（对代码私有性支持较好，因此企业用户较多）<br>⚫ Gitee（又叫做码云，是国产的开源项目托管平台。访问速度快、纯中文界面、使用友好）<br>注意：以上 3 个开源项目托管平台，只能托管以 Git 管理的项目源代码，因此，它们的名字都以 Git 开头。</p>\n<h4 id=\"什么是-Github\"><a href=\"#什么是-Github\" class=\"headerlink\" title=\"什么是 Github\"></a>什么是 Github</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Github 是全球最大的开源项目托管平台。因为只支持 Git 作为唯一的版本控制工具，故名 GitHub。 在 Github 中，你可以：<br>① 关注自己喜欢的开源项目，为其点赞打 call<br>② 为自己喜欢的开源项目做贡献（Pull Request） ③ 和开源项目的作者讨论 Bug 和提需求 （Issues） ④ 把喜欢的项目复制一份作为自己的项目进行修改（Fork） ⑤ 创建属于自己的开源项目<br>⑥ etc…<br>So，Github ≠ Git</p>\n<h3 id=\"注册账号\"><a href=\"#注册账号\" class=\"headerlink\" title=\"注册账号\"></a>注册账号</h3><h4 id=\"注册激活-Github-账号流程\"><a href=\"#注册激活-Github-账号流程\" class=\"headerlink\" title=\"注册激活 Github 账号流程\"></a>注册激活 Github 账号流程</h4><p>① 访问 Github 的官网首页 <a href=\"https://github.com/\">https://github.com/</a><br>② 点击“Sign up”按钮跳转到注册页面<br>③ 填写可用的用户名、邮箱、密码<br>④ 通过点击箭头的形式，将验证图片摆正<br>⑤ 点击“Create account”按钮注册新用户<br>⑥ 登录到第三步填写的邮箱中，点击激活链接，完成注册；</p>\n<img src=\"/2022/02/22/gitTo/to2.png\" class=\"\">\n<img src=\"/2022/02/22/gitTo/to3.png\" class=\"\">\n<img src=\"/2022/02/22/gitTo/to4.png\" class=\"\">\n\n<h3 id=\"远程仓库的使用\"><a href=\"#远程仓库的使用\" class=\"headerlink\" title=\"远程仓库的使用\"></a>远程仓库的使用</h3><h4 id=\"新建空白远程仓库\"><a href=\"#新建空白远程仓库\" class=\"headerlink\" title=\"新建空白远程仓库\"></a>新建空白远程仓库</h4><img src=\"/2022/02/22/gitTo/to5.png\" class=\"\">\n<img src=\"/2022/02/22/gitTo/to6.png\" class=\"\">\n\n<h4 id=\"远程仓库的两种访问方式\"><a href=\"#远程仓库的两种访问方式\" class=\"headerlink\" title=\"远程仓库的两种访问方式\"></a>远程仓库的两种访问方式</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Github 上的远程仓库，有两种访问方式，分别是 HTTPS 和 SSH。它们的区别是：<br>①HTTPS：零配置；但是每次访问仓库时，需要重复输入 Github 的账号和密码才能访问成功<br>②SSH：需要进行额外的配置；但是配置成功后，每次访问仓库时，不需重复输入 Github 的账号和密码注意：在实际开发中，推荐使用 SSH 的方式访问远程仓库。</p>\n<h4 id=\"基于-HTTPS-将本地仓库上传到-Github\"><a href=\"#基于-HTTPS-将本地仓库上传到-Github\" class=\"headerlink\" title=\"基于 HTTPS 将本地仓库上传到 Github\"></a>基于 HTTPS 将本地仓库上传到 Github</h4><img src=\"/2022/02/22/gitTo/to7.png\" class=\"\">\n\n<h4 id=\"SSH-key\"><a href=\"#SSH-key\" class=\"headerlink\" title=\"SSH key\"></a>SSH key</h4><p>SSH key 的作用：实现本地仓库和 Github 之间免登录的加密数据传输。SSH key 的好处：免登录身份认证、数据加密传输。<br>SSH key 由两部分组成，分别是：<br>①id_rsa（私钥文件，存放于客户端的电脑中即可）<br>②id_rsa.pub（公钥文件，需要配置到 Github 中）</p>\n<h4 id=\"生成-SSH-key\"><a href=\"#生成-SSH-key\" class=\"headerlink\" title=\"生成 SSH key\"></a>生成 SSH key</h4><p>① 打开 Git Bash<br>② 粘贴如下的命令，并将<a href=\"mailto:&#121;&#x6f;&#x75;&#114;&#95;&#x65;&#109;&#x61;&#105;&#108;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#109;\">&#121;&#x6f;&#x75;&#114;&#95;&#x65;&#109;&#x61;&#105;&#108;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#x65;&#x2e;&#99;&#111;&#109;</a> 替换为注册 Github 账号时填写的邮箱：<br>⚫ssh-keygen -t rsa -b 4096 -C “<a href=\"mailto:&#121;&#111;&#x75;&#114;&#95;&#101;&#109;&#97;&#105;&#x6c;&#x40;&#x65;&#x78;&#x61;&#x6d;&#112;&#x6c;&#x65;&#46;&#99;&#x6f;&#x6d;\">&#121;&#111;&#x75;&#114;&#95;&#101;&#109;&#97;&#105;&#x6c;&#x40;&#x65;&#x78;&#x61;&#x6d;&#112;&#x6c;&#x65;&#46;&#99;&#x6f;&#x6d;</a>“<br>③ 连续敲击 3 次回车，即可在 C:\\Users\\用户名文件夹.ssh 目录中生成 id_rsa 和 id_rsa.pub 两个文件；</p>\n<h4 id=\"配置-SSH-key\"><a href=\"#配置-SSH-key\" class=\"headerlink\" title=\"配置 SSH key\"></a>配置 SSH key</h4><p>① 使用记事本打开 id_rsa.pub 文件，复制里面的文本内容<br>② 在浏览器中登录 Github，点击头像-&gt; Settings-&gt; SSH and GPG Keys -&gt; New SSH key ③ 将 id_rsa.pub 文件中的内容，粘贴到 Key 对应的文本框中<br>④ 在 Title 文本框中任意填写一个名称，来标识这个 Key 从何而来</p>\n<h4 id=\"检测-Github-的-SSH-key-是否配置成功\"><a href=\"#检测-Github-的-SSH-key-是否配置成功\" class=\"headerlink\" title=\"检测 Github 的 SSH key 是否配置成功\"></a>检测 Github 的 SSH key 是否配置成功</h4><p>打开 Git Bash，输入如下的命令并回车执行：<br><img src=\"https://img-blog.csdnimg.cn/d388e160c89445fba15ac048256e7759.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to8.png\" class=\"\">\n<p>上述的命令执行成功后，可能会看到如下的提示消息：<br><img src=\"https://img-blog.csdnimg.cn/4c06a6b3a3254a9cbadec45c24a8e288.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to9.png\" class=\"\">\n<p>输入 yes 之后，如果能看到类似于下面的提示消息，证明 SSH key 已经配置成功了：<br><img src=\"https://img-blog.csdnimg.cn/44d6bda9c0134acda1b7670c989cd4c7.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to10.png\" class=\"\">\n\n<h4 id=\"基于-SSH-将本地仓库上传到-Github\"><a href=\"#基于-SSH-将本地仓库上传到-Github\" class=\"headerlink\" title=\"基于 SSH 将本地仓库上传到 Github\"></a>基于 SSH 将本地仓库上传到 Github</h4><p><img src=\"https://img-blog.csdnimg.cn/3fb664f39cf04308bb61b71f89679413.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to11.png\" class=\"\">\n\n<h4 id=\"将远程仓库克隆到本地\"><a href=\"#将远程仓库克隆到本地\" class=\"headerlink\" title=\"将远程仓库克隆到本地\"></a>将远程仓库克隆到本地</h4><p>打开 Git Bash，输入如下的命令并回车执行：<br><img src=\"https://img-blog.csdnimg.cn/7f0f14b18ede4502ab805c6ce2fc6218.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to12.png\" class=\"\">\n\n<h2 id=\"二、Git-分支\"><a href=\"#二、Git-分支\" class=\"headerlink\" title=\"二、Git 分支\"></a>二、Git 分支</h2><h3 id=\"Git-本地分支操作\"><a href=\"#Git-本地分支操作\" class=\"headerlink\" title=\"Git 本地分支操作\"></a>Git 本地分支操作</h3><h4 id=\"分支的概念\"><a href=\"#分支的概念\" class=\"headerlink\" title=\"分支的概念\"></a>分支的概念</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;分支就是科幻电影里面的平行宇宙，当你正在电脑前努力学习 Git 的时候，另一个你正在另一个平行宇宙里努力学习 SVN。<br>&nbsp;&nbsp;&nbsp;&nbsp;如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，你既学会了 Git 又学会了 SVN！<br><img src=\"https://img-blog.csdnimg.cn/80a5846ff5de4197a50d1d424bba724a.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to13.png\" class=\"\">\n\n<h4 id=\"分支在实际开发中的作用\"><a href=\"#分支在实际开发中的作用\" class=\"headerlink\" title=\"分支在实际开发中的作用\"></a>分支在实际开发中的作用</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;进行多人协作开发的时候，为了防止互相干扰，提高协同开发的体验，建议每个开发者都基于分支进行项目功能的开发，例如：<br><img src=\"https://img-blog.csdnimg.cn/a93cca4790b04c3aa26ba305bbec38bb.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to14.png\" class=\"\">\n\n<h4 id=\"master-主分支\"><a href=\"#master-主分支\" class=\"headerlink\" title=\"master 主分支\"></a>master 主分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;在初始化本地 Git 仓库的时候，Git 默认已经帮我们创建了一个名字叫做 master 的分支。通常我们把这个 master 分支叫做主分支。<br><img src=\"https://img-blog.csdnimg.cn/d164fcb49da74d3e901c4c6dbfa9debf.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to15.png\" class=\"\">\n<p>📣 注意：在实际工作中，master 主分支的作用是：==用来保存和记录整个项目已完成的功能代码==。<br>&nbsp;&nbsp;&nbsp;&nbsp;因此，不允许程序员直接在 master 分支上修改代码，因为这样做的风险太高，容易导致整个项目崩溃。❗❗❗</p>\n<h4 id=\"功能分支\"><a href=\"#功能分支\" class=\"headerlink\" title=\"功能分支\"></a>功能分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;于程序员不能直接在 master 分支上进行功能的开发，所以就有了==功能分支==的概念。<br>&nbsp;&nbsp;&nbsp;&nbsp;==功能分支==指的是==专门用来开发新功能的分支==，它是临时从 master 主分支上分叉出来的，当新功能开发且测试完毕后，最终需要合并到 master 主分支上，如图所示：<br><img src=\"https://img-blog.csdnimg.cn/e6f4c1d1fa294b2daf5083cf8caea765.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to16.png\" class=\"\">\n\n<h4 id=\"查看分支列表\"><a href=\"#查看分支列表\" class=\"headerlink\" title=\"查看分支列表\"></a>查看分支列表</h4><p><img src=\"https://img-blog.csdnimg.cn/b2df95b6c7f64be59d39deb24fceacc5.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to17.png\" class=\"\">\n<p>运行的结果如下所示：<br><img src=\"https://img-blog.csdnimg.cn/92d62e24d9734c48944f5f4401600ce6.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to18.png\" class=\"\">\n<p>📣 注意：分支名字前面的*号表示当前所处的分支。❗❗❗</p>\n<h4 id=\"创建分支\"><a href=\"#创建分支\" class=\"headerlink\" title=\"创建分支\"></a>创建分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;使用如下的命令，可以基于当前分支，创建一个新的分支，此时，新分支中的代码和当前分支完全一样：<br><img src=\"https://img-blog.csdnimg.cn/b27891070f944531a8e51bf0c8e60287.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to19.png\" class=\"\">\n<p>图示如下：</p>\n<p><img src=\"https://img-blog.csdnimg.cn/526910880c774bd5a03244bc3d743471.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to20.png\" class=\"\">\n\n<h4 id=\"切换分支\"><a href=\"#切换分支\" class=\"headerlink\" title=\"切换分支\"></a>切换分支</h4><p>使用如下的命令，可以切换到指定的分支上进行开发：<br><img src=\"https://img-blog.csdnimg.cn/60fea47d94bd49df9255e33839d3b633.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to21.png\" class=\"\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/aa09bb19128d4d69beb660230f29eda2.png\" alt=\"在这里插入图片描述\"></p>\n\n\n<h4 id=\"分支的快速创建和切换\"><a href=\"#分支的快速创建和切换\" class=\"headerlink\" title=\"分支的快速创建和切换\"></a>分支的快速创建和切换</h4><p>使用如下的命令，可以创建指定名称的新分支，并立即切换到新分支上：<br><img src=\"https://img-blog.csdnimg.cn/453ce0e3da4548dd83f68a57bd878040.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to23.png\" class=\"\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/c52d590e54ad43ccb82f397fcb36a389.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to24.png\" class=\"\">\n<p>📣 注意：<br>“git checkout -b 分支名称” 是下面两条命令的简写形式：<br>①git branch 分支名称<br>②git checkout 分支名称 ❗❗❗</p>\n<h4 id=\"合并分支\"><a href=\"#合并分支\" class=\"headerlink\" title=\"合并分支\"></a>合并分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;功能分支的代码开发测试完毕之后，可以使用如下的命令，将完成后的代码合并到 master 主分支上：<br><img src=\"https://img-blog.csdnimg.cn/8546a5c1d6304935bbc003b6b7130ed0.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to25.png\" class=\"\">\n<p><img src=\"https://img-blog.csdnimg.cn/cd9182a1084743e6aca6a029c12cc209.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to26.png\" class=\"\">\n<p>📣 合并分支时的注意点：<br>假设要把 C 分支的代码合并到 A 分支，则必须==先切换到 A 分支上==，再运行==git merge ==命令，来合并 C 分支 ❗❗❗</p>\n<h4 id=\"删除分支\"><a href=\"#删除分支\" class=\"headerlink\" title=\"删除分支\"></a>删除分支</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;当把功能分支的代码合并到 master 主分支上以后，就可以使用如下的命令，删除对应的功能分支：<br><img src=\"https://img-blog.csdnimg.cn/cfb483361c524ecc94f27ec634629e4f.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to27.png\" class=\"\">\n<p>图示如下：<br><img src=\"https://img-blog.csdnimg.cn/2932181c39da4075b314122004eb4a5a.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to28.png\" class=\"\">\n\n<h4 id=\"遇到冲突时的分支合并\"><a href=\"#遇到冲突时的分支合并\" class=\"headerlink\" title=\"遇到冲突时的分支合并\"></a>遇到冲突时的分支合并</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;如果在两个不同的分支中，对同一个文件进行了不同的修改，Git 就没法干净的合并它们。此时，我们需要打开这些包含冲突的文件然后==手动解决冲突==。<br><img src=\"https://img-blog.csdnimg.cn/955751fc8f6a4d2baaa4a530988e2b0a.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"Git-远程分支操作\"><a href=\"#Git-远程分支操作\" class=\"headerlink\" title=\"Git 远程分支操作\"></a>Git 远程分支操作</h3><h4 id=\"将本地分支推送到远程仓库\"><a href=\"#将本地分支推送到远程仓库\" class=\"headerlink\" title=\"将本地分支推送到远程仓库\"></a>将本地分支推送到远程仓库</h4><p>如果是第一次将本地分支推送到远程仓库，需要运行如下的命令：<br><img src=\"https://img-blog.csdnimg.cn/20db9abbafcf420fa9d5de70b49b4b95.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to29.png\" class=\"\">\n<p>📣 注意：第一次推送分支需要带-u 参数，此后可以直接使用 git push 推送代码到远程分支。❗❗❗</p>\n<h4 id=\"查看远程仓库中所有的分支列表\"><a href=\"#查看远程仓库中所有的分支列表\" class=\"headerlink\" title=\"查看远程仓库中所有的分支列表\"></a>查看远程仓库中所有的分支列表</h4><p>通过如下的命令，可以查看远程仓库中，所有的分支列表的信息：<br><img src=\"https://img-blog.csdnimg.cn/7fee94661fdb49c89d86dcdbae44d37e.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to30.png\" class=\"\">\n\n<h4 id=\"跟踪分支\"><a href=\"#跟踪分支\" class=\"headerlink\" title=\"跟踪分支\"></a>跟踪分支</h4><p>跟踪分支指的是：从远程仓库中，把远程分支下载到本地仓库中。需要运行的命令如下：<br><img src=\"https://img-blog.csdnimg.cn/cfc337af43f1478faa21103e5979854e.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to31.png\" class=\"\">\n\n<h4 id=\"拉取远程分支的最新的代码\"><a href=\"#拉取远程分支的最新的代码\" class=\"headerlink\" title=\"拉取远程分支的最新的代码\"></a>拉取远程分支的最新的代码</h4><p>可以使用如下的命令，把远程分支最新的代码下载到本地对应的分支中：</p>\n<p><img src=\"https://img-blog.csdnimg.cn/f27a90332acc4ebea8d82f9bbe4991d4.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to32.png\" class=\"\">\n\n<h4 id=\"删除远程分支\"><a href=\"#删除远程分支\" class=\"headerlink\" title=\"删除远程分支\"></a>删除远程分支</h4><p>可以使用如下的命令，删除远程仓库中指定的分支：<br><img src=\"https://img-blog.csdnimg.cn/b0b02ff6106146e08b6ee5777589f74e.png\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to33.png\" class=\"\">\n\n<h2 id=\"知识の总结\"><a href=\"#知识の总结\" class=\"headerlink\" title=\"知识の总结\"></a>知识の总结</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;看完以上内容小伙伴们一定觉得内容多记不住吧，没关系哦，小二已经为您总结了以后项目常用的命令，大家一定要牢记哦！！！<br><img src=\"https://img-blog.csdnimg.cn/591c2d5860e44d528990de0ba0d569ef.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/02/22/gitTo/to34.png\" class=\"\">\n\n<h2 id=\"🥇-推荐の内容\"><a href=\"#🥇-推荐の内容\" class=\"headerlink\" title=\"🥇 推荐の内容\"></a>🥇 推荐の内容</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<p>本期为小伙伴们推荐上一期的 Git 基本命令的使用哦，配合本篇文章大家一定会对 Git 有更深刻的理解哦！！下一期我将为大家带来==Git 冲突的解决方法以及案例==，大家敬请期待哟！！!<br><a href=\"https://blog.csdn.net/qq_44588612/article/details/124477260?spm=1001.2014.3001.5501\">Git 分布式版本控制系统一</a></p>\n"},{"title":"【node 报错】Cannot read properties of undefined (reading ‘body‘)","description":"在写更新用户信息接口进行表单的信息进行验证时，报错：'Cannot read properties of undefined (reading 'body')'","headimg":"/images/node.jpeg","date":"2022-04-15T16:00:00.000Z","_content":"\n{% asset_img body1.png %}\n\n## 🏆 前言\n\n在写更新用户信息接口进行表单的信息进行验证时，报错：\n`Cannot read properties of undefined (reading 'body')`\n字面意思是不能读取\"body 属性\"，查找后发现是导入定义的表单验证规则的第三方模块失败，终端打印结果为 undefined。\n==解决并排错过程==：首先打印了导入的第三方验证规则模块，发现结果是 undefined，此时定位错误到：获取的第三方验证规则模块不是一个对象；\n\n## 🥇 一、解决办法\n\n错误原因：导入的第三方验证规则模块的 exports 对象上挂载了两个验证规则对象，导入第三方验证规则模块后，获取的 exports 对象中有两个验证规则，在使用其中的一个验证规则时，需要以下面的格式获取：\n\n```javascript\n//导入表单验证规则，此时获取的update_userinfo_schema为一个包含两个验证规则的对象；\nconst update_userinfo_schema = require('../schema/user')\n//定义更新用户信息的路由，以update_userinfo_schema.UpdateUserinfoSchema方式获取到验证规则\nrouter.post('/userinfo', expressJoi(update_userinfo_schema.UpdateUserinfoSchema), userinfohandler.UpdateUserInfo)\n```\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/nodebody.md","raw":"---\ntitle: 【node 报错】Cannot read properties of undefined (reading ‘body‘)\ndescription: 在写更新用户信息接口进行表单的信息进行验证时，报错：'Cannot read properties of undefined (reading 'body')'\nheadimg: /images/node.jpeg\ndate: 2022-04-16\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n{% asset_img body1.png %}\n\n## 🏆 前言\n\n在写更新用户信息接口进行表单的信息进行验证时，报错：\n`Cannot read properties of undefined (reading 'body')`\n字面意思是不能读取\"body 属性\"，查找后发现是导入定义的表单验证规则的第三方模块失败，终端打印结果为 undefined。\n==解决并排错过程==：首先打印了导入的第三方验证规则模块，发现结果是 undefined，此时定位错误到：获取的第三方验证规则模块不是一个对象；\n\n## 🥇 一、解决办法\n\n错误原因：导入的第三方验证规则模块的 exports 对象上挂载了两个验证规则对象，导入第三方验证规则模块后，获取的 exports 对象中有两个验证规则，在使用其中的一个验证规则时，需要以下面的格式获取：\n\n```javascript\n//导入表单验证规则，此时获取的update_userinfo_schema为一个包含两个验证规则的对象；\nconst update_userinfo_schema = require('../schema/user')\n//定义更新用户信息的路由，以update_userinfo_schema.UpdateUserinfoSchema方式获取到验证规则\nrouter.post('/userinfo', expressJoi(update_userinfo_schema.UpdateUserinfoSchema), userinfohandler.UpdateUserInfo)\n```\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"nodebody","published":1,"updated":"2023-03-23T10:56:43.671Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqez000sp5o19icpfxtg","content":"<img src=\"/2022/04/16/nodebody/body1.png\" class=\"lazyload\" data-srcset=\"/2022/04/16/nodebody/body1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"🏆-前言\"><a href=\"#🏆-前言\" class=\"headerlink\" title=\"🏆 前言\"></a>🏆 前言</h2><p>在写更新用户信息接口进行表单的信息进行验证时，报错：<br><code>Cannot read properties of undefined (reading &#39;body&#39;)</code><br>字面意思是不能读取”body 属性”，查找后发现是导入定义的表单验证规则的第三方模块失败，终端打印结果为 undefined。<br>==解决并排错过程==：首先打印了导入的第三方验证规则模块，发现结果是 undefined，此时定位错误到：获取的第三方验证规则模块不是一个对象；</p>\n<h2 id=\"🥇-一、解决办法\"><a href=\"#🥇-一、解决办法\" class=\"headerlink\" title=\"🥇 一、解决办法\"></a>🥇 一、解决办法</h2><p>错误原因：导入的第三方验证规则模块的 exports 对象上挂载了两个验证规则对象，导入第三方验证规则模块后，获取的 exports 对象中有两个验证规则，在使用其中的一个验证规则时，需要以下面的格式获取：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//导入表单验证规则，此时获取的update_userinfo_schema为一个包含两个验证规则的对象；</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> update_userinfo_schema = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;../schema/user&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">//定义更新用户信息的路由，以update_userinfo_schema.UpdateUserinfoSchema方式获取到验证规则</span></span><br><span class=\"line\">router.<span class=\"title function_\">post</span>(<span class=\"string\">&#x27;/userinfo&#x27;</span>, <span class=\"title function_\">expressJoi</span>(update_userinfo_schema.<span class=\"property\">UpdateUserinfoSchema</span>), userinfohandler.<span class=\"property\">UpdateUserInfo</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<img src=\"/2022/04/16/nodebody/body1.png\" class=\"\">\n\n<h2 id=\"🏆-前言\"><a href=\"#🏆-前言\" class=\"headerlink\" title=\"🏆 前言\"></a>🏆 前言</h2><p>在写更新用户信息接口进行表单的信息进行验证时，报错：<br><code>Cannot read properties of undefined (reading &#39;body&#39;)</code><br>字面意思是不能读取”body 属性”，查找后发现是导入定义的表单验证规则的第三方模块失败，终端打印结果为 undefined。<br>==解决并排错过程==：首先打印了导入的第三方验证规则模块，发现结果是 undefined，此时定位错误到：获取的第三方验证规则模块不是一个对象；</p>\n<h2 id=\"🥇-一、解决办法\"><a href=\"#🥇-一、解决办法\" class=\"headerlink\" title=\"🥇 一、解决办法\"></a>🥇 一、解决办法</h2><p>错误原因：导入的第三方验证规则模块的 exports 对象上挂载了两个验证规则对象，导入第三方验证规则模块后，获取的 exports 对象中有两个验证规则，在使用其中的一个验证规则时，需要以下面的格式获取：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//导入表单验证规则，此时获取的update_userinfo_schema为一个包含两个验证规则的对象；</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> update_userinfo_schema = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;../schema/user&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">//定义更新用户信息的路由，以update_userinfo_schema.UpdateUserinfoSchema方式获取到验证规则</span></span><br><span class=\"line\">router.<span class=\"title function_\">post</span>(<span class=\"string\">&#x27;/userinfo&#x27;</span>, <span class=\"title function_\">expressJoi</span>(update_userinfo_schema.<span class=\"property\">UpdateUserinfoSchema</span>), userinfohandler.<span class=\"property\">UpdateUserInfo</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【node 报错】Cannot set headers after they are sent to the client（消息头被发送到客户端后不能设置消息头）","description":"在写后端接口，进行用户注册验证时，控制台报错。报错信息：Cannot set headers after they are sent to the client","headimg":"/images/node.jpeg","date":"2022-04-19T16:00:00.000Z","_content":"\n## 🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：\n\n`Cannot set headers after they are sent to the client`\n{% asset_img hea1.png %}\n用户注册验证代码如下：\n{% asset_img hea2.png %}\n\n## 🥇 原因分析及解决办法\n\n{% asset_img hea3.png %}\n最终将 32 行注释即解决问题，问题本质原因是 send()冲突，导致返回客户端两个信息\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/nodeheader.md","raw":"---\ntitle: 【node 报错】Cannot set headers after they are sent to the client（消息头被发送到客户端后不能设置消息头）\ndescription: 在写后端接口，进行用户注册验证时，控制台报错。报错信息：Cannot set headers after they are sent to the client\nheadimg: /images/node.jpeg\ndate: 2022-04-20\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n## 🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：\n\n`Cannot set headers after they are sent to the client`\n{% asset_img hea1.png %}\n用户注册验证代码如下：\n{% asset_img hea2.png %}\n\n## 🥇 原因分析及解决办法\n\n{% asset_img hea3.png %}\n最终将 32 行注释即解决问题，问题本质原因是 send()冲突，导致返回客户端两个信息\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"nodeheader","published":1,"updated":"2023-03-23T10:56:55.301Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf1000wp5o1cwak7ba5","content":"<h2 id=\"🥇-在写后端接口，进行用户注册验证时，控制台报错。报错信息：\"><a href=\"#🥇-在写后端接口，进行用户注册验证时，控制台报错。报错信息：\" class=\"headerlink\" title=\"🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：\"></a>🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：</h2><p><code>Cannot set headers after they are sent to the client</code></p>\n<img src=\"/2022/04/20/nodeheader/hea1.png\" class=\"lazyload\" data-srcset=\"/2022/04/20/nodeheader/hea1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>用户注册验证代码如下：</p>\n<img src=\"/2022/04/20/nodeheader/hea2.png\" class=\"lazyload\" data-srcset=\"/2022/04/20/nodeheader/hea2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"🥇-原因分析及解决办法\"><a href=\"#🥇-原因分析及解决办法\" class=\"headerlink\" title=\"🥇 原因分析及解决办法\"></a>🥇 原因分析及解决办法</h2><img src=\"/2022/04/20/nodeheader/hea3.png\" class=\"lazyload\" data-srcset=\"/2022/04/20/nodeheader/hea3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>最终将 32 行注释即解决问题，问题本质原因是 send()冲突，导致返回客户端两个信息</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"🥇-在写后端接口，进行用户注册验证时，控制台报错。报错信息：\"><a href=\"#🥇-在写后端接口，进行用户注册验证时，控制台报错。报错信息：\" class=\"headerlink\" title=\"🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：\"></a>🥇 在写后端接口，进行用户注册验证时，控制台报错。报错信息：</h2><p><code>Cannot set headers after they are sent to the client</code></p>\n<img src=\"/2022/04/20/nodeheader/hea1.png\" class=\"\">\n<p>用户注册验证代码如下：</p>\n<img src=\"/2022/04/20/nodeheader/hea2.png\" class=\"\">\n\n<h2 id=\"🥇-原因分析及解决办法\"><a href=\"#🥇-原因分析及解决办法\" class=\"headerlink\" title=\"🥇 原因分析及解决办法\"></a>🥇 原因分析及解决办法</h2><img src=\"/2022/04/20/nodeheader/hea3.png\" class=\"\">\n<p>最终将 32 行注释即解决问题，问题本质原因是 send()冲突，导致返回客户端两个信息</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【node.js】报错Cannot mix different versions of joi schemas解决方法","description":"使用第三方包@hapi/joi 定义表单验证规则，然后利用postman检测到返回错误为：Cannot mix different versions of joi schemas","headimg":"/images/node.jpeg","date":"2022-05-15T16:00:00.000Z","_content":"\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n## 🏆 前言\n\n使用第三方包@hapi/joi 定义表单验证规则，然后利用 postman 检测到返回错误为：\n`Cannot mix different versions of joi schemas`\n\n{% asset_img joi1.png %}\n\n## 🥇 报错原因：\n\n@hapi/joi 第三方包不可用，需要下载其它版本；\n\n## 🥇 解决办法：\n\n运行如下命令重新安装第三方包\n\n```javascript\nnpm i joi\n```\n\n将将导入的@hapi/joi 更改为 joi\n\n```javascript\n将\nconst joi = require(\"@hapi/joi\")\n改为：\nconst joi = require(\"joi\")\n\n```\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/nodejoi.md","raw":"---\ntitle: 【node.js】报错Cannot mix different versions of joi schemas解决方法\ndescription: 使用第三方包@hapi/joi 定义表单验证规则，然后利用postman检测到返回错误为：Cannot mix different versions of joi schemas\nheadimg: /images/node.jpeg\ndate: 2022-05-16\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n## 🏆 前言\n\n使用第三方包@hapi/joi 定义表单验证规则，然后利用 postman 检测到返回错误为：\n`Cannot mix different versions of joi schemas`\n\n{% asset_img joi1.png %}\n\n## 🥇 报错原因：\n\n@hapi/joi 第三方包不可用，需要下载其它版本；\n\n## 🥇 解决办法：\n\n运行如下命令重新安装第三方包\n\n```javascript\nnpm i joi\n```\n\n将将导入的@hapi/joi 更改为 joi\n\n```javascript\n将\nconst joi = require(\"@hapi/joi\")\n改为：\nconst joi = require(\"joi\")\n\n```\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"nodejoi","published":1,"updated":"2023-03-23T10:48:38.110Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf1000yp5o1evi8bk48","content":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<h2 id=\"🏆-前言\"><a href=\"#🏆-前言\" class=\"headerlink\" title=\"🏆 前言\"></a>🏆 前言</h2><p>使用第三方包@hapi/joi 定义表单验证规则，然后利用 postman 检测到返回错误为：<br><code>Cannot mix different versions of joi schemas</code></p>\n<img src=\"/2022/05/16/nodejoi/joi1.png\" class=\"lazyload\" data-srcset=\"/2022/05/16/nodejoi/joi1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"🥇-报错原因：\"><a href=\"#🥇-报错原因：\" class=\"headerlink\" title=\"🥇 报错原因：\"></a>🥇 报错原因：</h2><p>@hapi/joi 第三方包不可用，需要下载其它版本；</p>\n<h2 id=\"🥇-解决办法：\"><a href=\"#🥇-解决办法：\" class=\"headerlink\" title=\"🥇 解决办法：\"></a>🥇 解决办法：</h2><p>运行如下命令重新安装第三方包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i joi</span><br></pre></td></tr></table></figure>\n\n<p>将将导入的@hapi/joi 更改为 joi</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将</span><br><span class=\"line\"><span class=\"keyword\">const</span> joi = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;@hapi/joi&quot;</span>)</span><br><span class=\"line\">改为：</span><br><span class=\"line\"><span class=\"keyword\">const</span> joi = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;joi&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<h2 id=\"🏆-前言\"><a href=\"#🏆-前言\" class=\"headerlink\" title=\"🏆 前言\"></a>🏆 前言</h2><p>使用第三方包@hapi/joi 定义表单验证规则，然后利用 postman 检测到返回错误为：<br><code>Cannot mix different versions of joi schemas</code></p>\n<img src=\"/2022/05/16/nodejoi/joi1.png\" class=\"\">\n\n<h2 id=\"🥇-报错原因：\"><a href=\"#🥇-报错原因：\" class=\"headerlink\" title=\"🥇 报错原因：\"></a>🥇 报错原因：</h2><p>@hapi/joi 第三方包不可用，需要下载其它版本；</p>\n<h2 id=\"🥇-解决办法：\"><a href=\"#🥇-解决办法：\" class=\"headerlink\" title=\"🥇 解决办法：\"></a>🥇 解决办法：</h2><p>运行如下命令重新安装第三方包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i joi</span><br></pre></td></tr></table></figure>\n\n<p>将将导入的@hapi/joi 更改为 joi</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将</span><br><span class=\"line\"><span class=\"keyword\">const</span> joi = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;@hapi/joi&quot;</span>)</span><br><span class=\"line\">改为：</span><br><span class=\"line\"><span class=\"keyword\">const</span> joi = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;joi&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【node 报错】后端写的接口，postman测试，正常返回数据，前端发起ajax请求报错----Not Found 404","description":"在将后台管理系统的接口写完，并使用postman测试无问题后， 在前端发起ajax请求，结果报错，报错码为：Not Found 404","headimg":"/images/node.jpeg","date":"2022-04-09T16:00:00.000Z","_content":"\n## 🥇 前言\n\n在将后台管理系统的接口写完，并使用 postman 测试无问题后， 在前端发起 ajax 请求，结果报错，报错码为：\n`Not Found 404`\n![在这里插入图片描述](https://img-blog.csdnimg.cn/ff21869b30984adf8fa5e7ba25e7c791.png#pic_center)\n{% asset_img notfound1.png %}\n\n## 排错过程\n\n首先返回为 404 ，首先想到的是路径不对，找不到，但是 postman 又测试没问题，说明 postman 里面的路径是对的，前端发起 ajax 请求的路径是错误，postman 请求的数据是手动输入，而前端发起 ajax 请求的数据是动态获取的，所以将错误定位到了，前端在请求数据拼接路径出错，即前端在获取提交的参数出错；最后排错又定位到如下的 id 参数获取失败，发现数据库中的 id 中的 i 为大写的 I，而在前端获取 Id 属性时，用的小写；\n![在这里插入图片描述](https://img-blog.csdnimg.cn/1aee3e52cb6747098c94997664b8a1e9.png#pic_center)\n{% asset_img notfound2.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/ecca619b8cd9495190f37c32ea45750d.png#pic_center)\n{% asset_img notfound3.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/645a7ae5dacf4dc6a74df95362462d17.png#pic_center)\n{% asset_img notfound4.png %}\n\n最终统一 Id 后问题解决；\n\n## 🥇 知识の总结\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/nodenotfound.md","raw":"---\ntitle: 【node 报错】后端写的接口，postman测试，正常返回数据，前端发起ajax请求报错----Not Found 404\ndescription: 在将后台管理系统的接口写完，并使用postman测试无问题后， 在前端发起ajax请求，结果报错，报错码为：Not Found 404\nheadimg: /images/node.jpeg\ndate: 2022-04-10\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n## 🥇 前言\n\n在将后台管理系统的接口写完，并使用 postman 测试无问题后， 在前端发起 ajax 请求，结果报错，报错码为：\n`Not Found 404`\n![在这里插入图片描述](https://img-blog.csdnimg.cn/ff21869b30984adf8fa5e7ba25e7c791.png#pic_center)\n{% asset_img notfound1.png %}\n\n## 排错过程\n\n首先返回为 404 ，首先想到的是路径不对，找不到，但是 postman 又测试没问题，说明 postman 里面的路径是对的，前端发起 ajax 请求的路径是错误，postman 请求的数据是手动输入，而前端发起 ajax 请求的数据是动态获取的，所以将错误定位到了，前端在请求数据拼接路径出错，即前端在获取提交的参数出错；最后排错又定位到如下的 id 参数获取失败，发现数据库中的 id 中的 i 为大写的 I，而在前端获取 Id 属性时，用的小写；\n![在这里插入图片描述](https://img-blog.csdnimg.cn/1aee3e52cb6747098c94997664b8a1e9.png#pic_center)\n{% asset_img notfound2.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/ecca619b8cd9495190f37c32ea45750d.png#pic_center)\n{% asset_img notfound3.png %}\n![在这里插入图片描述](https://img-blog.csdnimg.cn/645a7ae5dacf4dc6a74df95362462d17.png#pic_center)\n{% asset_img notfound4.png %}\n\n最终统一 Id 后问题解决；\n\n## 🥇 知识の总结\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"nodenotfound","published":1,"updated":"2023-03-23T10:28:55.765Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf30012p5o132px4sf2","content":"<h2 id=\"🥇-前言\"><a href=\"#🥇-前言\" class=\"headerlink\" title=\"🥇 前言\"></a>🥇 前言</h2><p>在将后台管理系统的接口写完，并使用 postman 测试无问题后， 在前端发起 ajax 请求，结果报错，报错码为：<br><code>Not Found 404</code><br><img src=\"https://img-blog.csdnimg.cn/ff21869b30984adf8fa5e7ba25e7c791.png#pic_center\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/ff21869b30984adf8fa5e7ba25e7c791.png#pic_center\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound1.png\" class=\"lazyload\" data-srcset=\"/2022/04/10/nodenotfound/notfound1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"排错过程\"><a href=\"#排错过程\" class=\"headerlink\" title=\"排错过程\"></a>排错过程</h2><p>首先返回为 404 ，首先想到的是路径不对，找不到，但是 postman 又测试没问题，说明 postman 里面的路径是对的，前端发起 ajax 请求的路径是错误，postman 请求的数据是手动输入，而前端发起 ajax 请求的数据是动态获取的，所以将错误定位到了，前端在请求数据拼接路径出错，即前端在获取提交的参数出错；最后排错又定位到如下的 id 参数获取失败，发现数据库中的 id 中的 i 为大写的 I，而在前端获取 Id 属性时，用的小写；<br><img src=\"https://img-blog.csdnimg.cn/1aee3e52cb6747098c94997664b8a1e9.png#pic_center\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/1aee3e52cb6747098c94997664b8a1e9.png#pic_center\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound2.png\" class=\"lazyload\" data-srcset=\"/2022/04/10/nodenotfound/notfound2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><img src=\"https://img-blog.csdnimg.cn/ecca619b8cd9495190f37c32ea45750d.png#pic_center\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/ecca619b8cd9495190f37c32ea45750d.png#pic_center\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound3.png\" class=\"lazyload\" data-srcset=\"/2022/04/10/nodenotfound/notfound3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><img src=\"https://img-blog.csdnimg.cn/645a7ae5dacf4dc6a74df95362462d17.png#pic_center\" class=\"lazyload\" data-srcset=\"https://img-blog.csdnimg.cn/645a7ae5dacf4dc6a74df95362462d17.png#pic_center\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound4.png\" class=\"lazyload\" data-srcset=\"/2022/04/10/nodenotfound/notfound4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<p>最终统一 Id 后问题解决；</p>\n<h2 id=\"🥇-知识の总结\"><a href=\"#🥇-知识の总结\" class=\"headerlink\" title=\"🥇 知识の总结\"></a>🥇 知识の总结</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"🥇-前言\"><a href=\"#🥇-前言\" class=\"headerlink\" title=\"🥇 前言\"></a>🥇 前言</h2><p>在将后台管理系统的接口写完，并使用 postman 测试无问题后， 在前端发起 ajax 请求，结果报错，报错码为：<br><code>Not Found 404</code><br><img src=\"https://img-blog.csdnimg.cn/ff21869b30984adf8fa5e7ba25e7c791.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound1.png\" class=\"\">\n\n<h2 id=\"排错过程\"><a href=\"#排错过程\" class=\"headerlink\" title=\"排错过程\"></a>排错过程</h2><p>首先返回为 404 ，首先想到的是路径不对，找不到，但是 postman 又测试没问题，说明 postman 里面的路径是对的，前端发起 ajax 请求的路径是错误，postman 请求的数据是手动输入，而前端发起 ajax 请求的数据是动态获取的，所以将错误定位到了，前端在请求数据拼接路径出错，即前端在获取提交的参数出错；最后排错又定位到如下的 id 参数获取失败，发现数据库中的 id 中的 i 为大写的 I，而在前端获取 Id 属性时，用的小写；<br><img src=\"https://img-blog.csdnimg.cn/1aee3e52cb6747098c94997664b8a1e9.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound2.png\" class=\"\">\n<p><img src=\"https://img-blog.csdnimg.cn/ecca619b8cd9495190f37c32ea45750d.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound3.png\" class=\"\">\n<p><img src=\"https://img-blog.csdnimg.cn/645a7ae5dacf4dc6a74df95362462d17.png#pic_center\" alt=\"在这里插入图片描述\"></p>\n<img src=\"/2022/04/10/nodenotfound/notfound4.png\" class=\"\">\n\n<p>最终统一 Id 后问题解决；</p>\n<h2 id=\"🥇-知识の总结\"><a href=\"#🥇-知识の总结\" class=\"headerlink\" title=\"🥇 知识の总结\"></a>🥇 知识の总结</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【node 报错】 res.cc is not a function","description":"在使用postman测试获取用户信息的接口时，登录的token字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：`res.cc is not a function`","headimg":"/images/node.jpeg","date":"2022-03-21T16:00:00.000Z","_content":"\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n## 🥇 终端报错信息如下图所示\n\n{% asset_img cc1.png %}\n\n## 前言\n\n在使用 postman 测试获取用户信息的接口时，登录的 token 字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：`res.cc is not a function`\n\n## 🥇 排错过程\n\ncc 函数是挂载在一个全局中间件上的一个处理错误信息的函数，找不到这个函数，首先想到的是这个函数定义错误，但是别的接口，可以利用 res.cc()正常返回错误信息，说明函数本身定义的没有问题；然后想到了 cc 函数挂载的全局中间件可能是位置错误，导致 cc 函数还未挂载到 res 上，已经发生了错误，当错误中间件捕捉到错误后，在 res 上访问不到 res.cc 函数,经调试解决;\n\n**错误原因如下图所示，2 中间件应该放到 1 的前面：**\n{% asset_img cc2.png %}\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/noderes-cc.md","raw":"---\ntitle: 【node 报错】 res.cc is not a function\ndescription: 在使用postman测试获取用户信息的接口时，登录的token字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：`res.cc is not a function`\nheadimg: /images/node.jpeg\ndate: 2022-03-22\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n\n## 🥇 终端报错信息如下图所示\n\n{% asset_img cc1.png %}\n\n## 前言\n\n在使用 postman 测试获取用户信息的接口时，登录的 token 字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：`res.cc is not a function`\n\n## 🥇 排错过程\n\ncc 函数是挂载在一个全局中间件上的一个处理错误信息的函数，找不到这个函数，首先想到的是这个函数定义错误，但是别的接口，可以利用 res.cc()正常返回错误信息，说明函数本身定义的没有问题；然后想到了 cc 函数挂载的全局中间件可能是位置错误，导致 cc 函数还未挂载到 res 上，已经发生了错误，当错误中间件捕捉到错误后，在 res 上访问不到 res.cc 函数,经调试解决;\n\n**错误原因如下图所示，2 中间件应该放到 1 的前面：**\n{% asset_img cc2.png %}\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"noderes-cc","published":1,"updated":"2023-03-23T10:18:30.601Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf30014p5o10k36bao5","content":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<h2 id=\"🥇-终端报错信息如下图所示\"><a href=\"#🥇-终端报错信息如下图所示\" class=\"headerlink\" title=\"🥇 终端报错信息如下图所示\"></a>🥇 终端报错信息如下图所示</h2><img src=\"/2022/03/22/noderes-cc/cc1.png\" class=\"lazyload\" data-srcset=\"/2022/03/22/noderes-cc/cc1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在使用 postman 测试获取用户信息的接口时，登录的 token 字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：<code>res.cc is not a function</code></p>\n<h2 id=\"🥇-排错过程\"><a href=\"#🥇-排错过程\" class=\"headerlink\" title=\"🥇 排错过程\"></a>🥇 排错过程</h2><p>cc 函数是挂载在一个全局中间件上的一个处理错误信息的函数，找不到这个函数，首先想到的是这个函数定义错误，但是别的接口，可以利用 res.cc()正常返回错误信息，说明函数本身定义的没有问题；然后想到了 cc 函数挂载的全局中间件可能是位置错误，导致 cc 函数还未挂载到 res 上，已经发生了错误，当错误中间件捕捉到错误后，在 res 上访问不到 res.cc 函数,经调试解决;</p>\n<p><strong>错误原因如下图所示，2 中间件应该放到 1 的前面：</strong></p>\n<img src=\"/2022/03/22/noderes-cc/cc2.png\" class=\"lazyload\" data-srcset=\"/2022/03/22/noderes-cc/cc2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n<h2 id=\"🥇-终端报错信息如下图所示\"><a href=\"#🥇-终端报错信息如下图所示\" class=\"headerlink\" title=\"🥇 终端报错信息如下图所示\"></a>🥇 终端报错信息如下图所示</h2><img src=\"/2022/03/22/noderes-cc/cc1.png\" class=\"\">\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在使用 postman 测试获取用户信息的接口时，登录的 token 字段错误，错误中间件捕捉不到错误信息，不能返回一个身份认证失败的对象，而是报错：<code>res.cc is not a function</code></p>\n<h2 id=\"🥇-排错过程\"><a href=\"#🥇-排错过程\" class=\"headerlink\" title=\"🥇 排错过程\"></a>🥇 排错过程</h2><p>cc 函数是挂载在一个全局中间件上的一个处理错误信息的函数，找不到这个函数，首先想到的是这个函数定义错误，但是别的接口，可以利用 res.cc()正常返回错误信息，说明函数本身定义的没有问题；然后想到了 cc 函数挂载的全局中间件可能是位置错误，导致 cc 函数还未挂载到 res 上，已经发生了错误，当错误中间件捕捉到错误后，在 res 上访问不到 res.cc 函数,经调试解决;</p>\n<p><strong>错误原因如下图所示，2 中间件应该放到 1 的前面：</strong></p>\n<img src=\"/2022/03/22/noderes-cc/cc2.png\" class=\"\">\n\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"npm install --save、npm install --save-dev","description":"在进行项目开发时，有许多新手小伙伴不理解一些常见的用npm安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点； 1. npm install --save moduleName 2. npm install --save-dev moduleName 3. npm install -g moduleName 4. npm install moduleName","headimg":"/images/node.jpeg","date":"2022-05-19T16:00:00.000Z","_content":"\n## 背景\n\n在进行项目开发时，有许多新手小伙伴不理解一些常见的用 npm 安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点；\n\n1.  npm install --save moduleName\n2.  npm install --save-dev moduleName\n3.  npm install -g moduleName\n4.  npm install moduleName\n\n## 一、npm install --save moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 会将模块依赖写入 dependencies 节点。\n3. 运行 npm install 初始化项目时，会将模块下载到项目目录下。\n4. 运行 npm install --production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。\n\n## 二、npm install --save-dev moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 会将模块依赖写入 dependencies 节点。\n3. 运行 npm install 初始化项目时，会将模块下载到项目目录下。\n4. 运行 npm install --production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。\n\n## 三、npm install -g moduleName 命令\n\n1. 安装模块到全局，不会在项目 node_modules 目录中保存模块包。\n2. 不会将模块依赖写入 devDependencies 或 dependencies 节点。\n3. 运行 npm install 初始化项目时不会下载模块。\n\n## 四、npm install moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 不会将模块依赖写入 devDependencies 或 dependencies 节点。\n3. 运行 npm install 初始化项目时不会下载模块。\n\n## 写在最后\n\ndevDependencies 节点下的模块是我们在开发时需要用的，比如项目中使用的 gulp ，压缩 css、js 的模块。这些模块在我们的项目部署后是不需要的，所以我们可以使用 -save-dev 的形式安装。像 express 这些模块是项目运行必备的，应该安装在 dependencies 节点下，所以我们应该使用 -save 的形式安装。\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/npminstall.md","raw":"---\ntitle: npm install --save、npm install --save-dev\ndescription:\n  在进行项目开发时，有许多新手小伙伴不理解一些常见的用npm安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点；\n  1. npm install --save moduleName\n  2. npm install --save-dev moduleName\n  3. npm install -g moduleName\n  4. npm install moduleName\nheadimg: /images/node.jpeg\ndate: 2022-05-20\ntags:\n  - Node\ncategories:\n  - Node\n---\n\n## 背景\n\n在进行项目开发时，有许多新手小伙伴不理解一些常见的用 npm 安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点；\n\n1.  npm install --save moduleName\n2.  npm install --save-dev moduleName\n3.  npm install -g moduleName\n4.  npm install moduleName\n\n## 一、npm install --save moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 会将模块依赖写入 dependencies 节点。\n3. 运行 npm install 初始化项目时，会将模块下载到项目目录下。\n4. 运行 npm install --production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。\n\n## 二、npm install --save-dev moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 会将模块依赖写入 dependencies 节点。\n3. 运行 npm install 初始化项目时，会将模块下载到项目目录下。\n4. 运行 npm install --production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。\n\n## 三、npm install -g moduleName 命令\n\n1. 安装模块到全局，不会在项目 node_modules 目录中保存模块包。\n2. 不会将模块依赖写入 devDependencies 或 dependencies 节点。\n3. 运行 npm install 初始化项目时不会下载模块。\n\n## 四、npm install moduleName 命令\n\n1. 安装模块到项目 node_modules 目录下。\n2. 不会将模块依赖写入 devDependencies 或 dependencies 节点。\n3. 运行 npm install 初始化项目时不会下载模块。\n\n## 写在最后\n\ndevDependencies 节点下的模块是我们在开发时需要用的，比如项目中使用的 gulp ，压缩 css、js 的模块。这些模块在我们的项目部署后是不需要的，所以我们可以使用 -save-dev 的形式安装。像 express 这些模块是项目运行必备的，应该安装在 dependencies 节点下，所以我们应该使用 -save 的形式安装。\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"npminstall","published":1,"updated":"2023-03-23T10:55:40.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf50018p5o11u3e07ph","content":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在进行项目开发时，有许多新手小伙伴不理解一些常见的用 npm 安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点；</p>\n<ol>\n<li> npm install –save moduleName</li>\n<li> npm install –save-dev moduleName</li>\n<li> npm install -g moduleName</li>\n<li> npm install moduleName</li>\n</ol>\n<h2 id=\"一、npm-install-–save-moduleName-命令\"><a href=\"#一、npm-install-–save-moduleName-命令\" class=\"headerlink\" title=\"一、npm install –save moduleName 命令\"></a>一、npm install –save moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>会将模块依赖写入 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时，会将模块下载到项目目录下。</li>\n<li>运行 npm install –production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。</li>\n</ol>\n<h2 id=\"二、npm-install-–save-dev-moduleName-命令\"><a href=\"#二、npm-install-–save-dev-moduleName-命令\" class=\"headerlink\" title=\"二、npm install –save-dev moduleName 命令\"></a>二、npm install –save-dev moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>会将模块依赖写入 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时，会将模块下载到项目目录下。</li>\n<li>运行 npm install –production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。</li>\n</ol>\n<h2 id=\"三、npm-install-g-moduleName-命令\"><a href=\"#三、npm-install-g-moduleName-命令\" class=\"headerlink\" title=\"三、npm install -g moduleName 命令\"></a>三、npm install -g moduleName 命令</h2><ol>\n<li>安装模块到全局，不会在项目 node_modules 目录中保存模块包。</li>\n<li>不会将模块依赖写入 devDependencies 或 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时不会下载模块。</li>\n</ol>\n<h2 id=\"四、npm-install-moduleName-命令\"><a href=\"#四、npm-install-moduleName-命令\" class=\"headerlink\" title=\"四、npm install moduleName 命令\"></a>四、npm install moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>不会将模块依赖写入 devDependencies 或 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时不会下载模块。</li>\n</ol>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>devDependencies 节点下的模块是我们在开发时需要用的，比如项目中使用的 gulp ，压缩 css、js 的模块。这些模块在我们的项目部署后是不需要的，所以我们可以使用 -save-dev 的形式安装。像 express 这些模块是项目运行必备的，应该安装在 dependencies 节点下，所以我们应该使用 -save 的形式安装。</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在进行项目开发时，有许多新手小伙伴不理解一些常见的用 npm 安装包的命令，让我大跌眼镜，下面将详细讲解以下四个命令的异同点；</p>\n<ol>\n<li> npm install –save moduleName</li>\n<li> npm install –save-dev moduleName</li>\n<li> npm install -g moduleName</li>\n<li> npm install moduleName</li>\n</ol>\n<h2 id=\"一、npm-install-–save-moduleName-命令\"><a href=\"#一、npm-install-–save-moduleName-命令\" class=\"headerlink\" title=\"一、npm install –save moduleName 命令\"></a>一、npm install –save moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>会将模块依赖写入 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时，会将模块下载到项目目录下。</li>\n<li>运行 npm install –production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。</li>\n</ol>\n<h2 id=\"二、npm-install-–save-dev-moduleName-命令\"><a href=\"#二、npm-install-–save-dev-moduleName-命令\" class=\"headerlink\" title=\"二、npm install –save-dev moduleName 命令\"></a>二、npm install –save-dev moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>会将模块依赖写入 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时，会将模块下载到项目目录下。</li>\n<li>运行 npm install –production 或者注明 NODE_ENV 变量值为 production 时，会自动下载模块到 node_modules 目录中。</li>\n</ol>\n<h2 id=\"三、npm-install-g-moduleName-命令\"><a href=\"#三、npm-install-g-moduleName-命令\" class=\"headerlink\" title=\"三、npm install -g moduleName 命令\"></a>三、npm install -g moduleName 命令</h2><ol>\n<li>安装模块到全局，不会在项目 node_modules 目录中保存模块包。</li>\n<li>不会将模块依赖写入 devDependencies 或 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时不会下载模块。</li>\n</ol>\n<h2 id=\"四、npm-install-moduleName-命令\"><a href=\"#四、npm-install-moduleName-命令\" class=\"headerlink\" title=\"四、npm install moduleName 命令\"></a>四、npm install moduleName 命令</h2><ol>\n<li>安装模块到项目 node_modules 目录下。</li>\n<li>不会将模块依赖写入 devDependencies 或 dependencies 节点。</li>\n<li>运行 npm install 初始化项目时不会下载模块。</li>\n</ol>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>devDependencies 节点下的模块是我们在开发时需要用的，比如项目中使用的 gulp ，压缩 css、js 的模块。这些模块在我们的项目部署后是不需要的，所以我们可以使用 -save-dev 的形式安装。像 express 这些模块是项目运行必备的，应该安装在 dependencies 节点下，所以我们应该使用 -save 的形式安装。</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"profile 性能优化工具","description":"项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;","headimg":"/images/react.jpeg","date":"2021-02-20T16:00:00.000Z","sidebar":["toc"],"_content":"\n## 前言\n\n项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;\ndemo 示例如下代码所示：\n\n- 父组件\n\n```javascript\nimport {useState} from 'react'\nimport './App.css'\nimport Display from './component/Display'\nfunction App() {\n  const [count, setCount] = useState(0)\n  const [text, setText] = useState(0)\n  const hangeChange = (e) => {\n    setText(e.target.value)\n  }\n  console.log('父组件App渲染了--------------------------------')\n  return (\n    <div className=\"App\">\n      <div style={{marginTop: 50}}>\n        <input value={text} onChange={hangeChange} />\n        <br />\n      </div>\n      <Display text={text} />\n      <div style={{marginTop: 50}}>\n        <div style={{marginTop: 10}}> {count} </div>\n        <button\n          onClick={() => {\n            setCount(count + 1)\n          }}>\n          +1\n        </button>\n      </div>\n    </div>\n  )\n}\n\nexport default App\n```\n\n- 子组件\n\n```javascript\nimport React, {memo} from 'react'\nconst Display = (props) => {\n  const {text} = props\n  console.log('子组件Display渲染了--------------------------------')\n\n  return <div>{text}</div>\n}\nexport default memo(Display)\n```\n\n## 组件渲染问题\n\n打开应用后，看到如下界面：\n{% asset_img profile1.png %}\n进行如下操作：\n\n- 在文本框的 0 后输入 123\n- 点击三次+1 按钮\n\n操作完成后，查看控制台输出：\n{% asset_img profile2.png %}\n由上图可以看出，在 input 框中输入 123 时，App 组件内部的状态改变，所以子组件 Display 的 porp 改变，因此父组件子组件依次渲染，然而当点击按钮+1 时，子组件 Display 的状态、prop 并未改变却进行了渲染；说明此组件的问题是进行了不必要的 re-render\n\n## Profiler 查看 reRender 原因\n\n如果你安装了 React-dev-tools 在 chrome 浏览器控制台可以打开 profiler 工具栏，如下图所示：\n{% asset_img profile3.png %}\n\n- 点击 reload 按钮\n  {% asset_img profile4.png %}\n  按以下步骤操作：\n- 在文本框的 0 后输入 123\n- 点击三次+1 按钮\n- 点击 stop profiling 按钮\n  {% asset_img profile5.png %}\n\n此时我们可以看到工具记录的信息如下图所示：\n{% asset_img profile6.png %}\n\n- A 区记录了提交的次数\n- B 区记录了应用内组件的状态\n- C 区记录了每次提交的信息\n\n我们点击按钮时，提交信息在最后三次，我们点击 A 区的最后一次提交，在 C 取查看提交信息：\n{% asset_img profile7.png %}\n从 B 区(光标放到组件上)、C 区的信息能看出 Display 组件的 re-render 是由于父组件的更新，此时我们可以考虑用 React.memo 包裹子 Display 组件进行优化，代码如下所示：\n\n```javascript\nimport React, {memo} from 'react'\nconst Display = (props) => {\n  const {text} = props\n  console.log('子组件Display渲染了--------------------------------')\n  return <div>{text}</div>\n}\nexport default memo(Display)\n```\n\n代码优化后使用工具 reload，可以看到在最后一次提交时，尽管 App 组件更新，但是 Display 组件 Did not render，此时便达到了优化组件渲染的目的；\n{% asset_img profile8.png %}\n**参考：**\n[Profiler 的使用](https://juejin.cn/post/7008337341634854942#heading-10)\n[React Profiler 介绍](https://zh-hans.reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html)\n\n## 写在最后\n\n在实际的项目中，如果遇到问题组件，我们应该学会使用 Profiler 组件定位问题组件，查看组件 re-render 原因有的放矢，这样才能提高解决问题的效率；\n当然 React 官方也提供了 Profiler API，具体使用方法见以下链接：\n[Profiler API](https://zh-hans.reactjs.org/docs/profiler.html#gatsby-focus-wrapper)\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/profile.md","raw":"---\ntitle: profile 性能优化工具\ndescription: 项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;\nheadimg: /images/react.jpeg\ncategories:\n  - React\ndate: 2021-02-21\ntags:\n  - Profile\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n## 前言\n\n项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;\ndemo 示例如下代码所示：\n\n- 父组件\n\n```javascript\nimport {useState} from 'react'\nimport './App.css'\nimport Display from './component/Display'\nfunction App() {\n  const [count, setCount] = useState(0)\n  const [text, setText] = useState(0)\n  const hangeChange = (e) => {\n    setText(e.target.value)\n  }\n  console.log('父组件App渲染了--------------------------------')\n  return (\n    <div className=\"App\">\n      <div style={{marginTop: 50}}>\n        <input value={text} onChange={hangeChange} />\n        <br />\n      </div>\n      <Display text={text} />\n      <div style={{marginTop: 50}}>\n        <div style={{marginTop: 10}}> {count} </div>\n        <button\n          onClick={() => {\n            setCount(count + 1)\n          }}>\n          +1\n        </button>\n      </div>\n    </div>\n  )\n}\n\nexport default App\n```\n\n- 子组件\n\n```javascript\nimport React, {memo} from 'react'\nconst Display = (props) => {\n  const {text} = props\n  console.log('子组件Display渲染了--------------------------------')\n\n  return <div>{text}</div>\n}\nexport default memo(Display)\n```\n\n## 组件渲染问题\n\n打开应用后，看到如下界面：\n{% asset_img profile1.png %}\n进行如下操作：\n\n- 在文本框的 0 后输入 123\n- 点击三次+1 按钮\n\n操作完成后，查看控制台输出：\n{% asset_img profile2.png %}\n由上图可以看出，在 input 框中输入 123 时，App 组件内部的状态改变，所以子组件 Display 的 porp 改变，因此父组件子组件依次渲染，然而当点击按钮+1 时，子组件 Display 的状态、prop 并未改变却进行了渲染；说明此组件的问题是进行了不必要的 re-render\n\n## Profiler 查看 reRender 原因\n\n如果你安装了 React-dev-tools 在 chrome 浏览器控制台可以打开 profiler 工具栏，如下图所示：\n{% asset_img profile3.png %}\n\n- 点击 reload 按钮\n  {% asset_img profile4.png %}\n  按以下步骤操作：\n- 在文本框的 0 后输入 123\n- 点击三次+1 按钮\n- 点击 stop profiling 按钮\n  {% asset_img profile5.png %}\n\n此时我们可以看到工具记录的信息如下图所示：\n{% asset_img profile6.png %}\n\n- A 区记录了提交的次数\n- B 区记录了应用内组件的状态\n- C 区记录了每次提交的信息\n\n我们点击按钮时，提交信息在最后三次，我们点击 A 区的最后一次提交，在 C 取查看提交信息：\n{% asset_img profile7.png %}\n从 B 区(光标放到组件上)、C 区的信息能看出 Display 组件的 re-render 是由于父组件的更新，此时我们可以考虑用 React.memo 包裹子 Display 组件进行优化，代码如下所示：\n\n```javascript\nimport React, {memo} from 'react'\nconst Display = (props) => {\n  const {text} = props\n  console.log('子组件Display渲染了--------------------------------')\n  return <div>{text}</div>\n}\nexport default memo(Display)\n```\n\n代码优化后使用工具 reload，可以看到在最后一次提交时，尽管 App 组件更新，但是 Display 组件 Did not render，此时便达到了优化组件渲染的目的；\n{% asset_img profile8.png %}\n**参考：**\n[Profiler 的使用](https://juejin.cn/post/7008337341634854942#heading-10)\n[React Profiler 介绍](https://zh-hans.reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html)\n\n## 写在最后\n\n在实际的项目中，如果遇到问题组件，我们应该学会使用 Profiler 组件定位问题组件，查看组件 re-render 原因有的放矢，这样才能提高解决问题的效率；\n当然 React 官方也提供了 Profiler API，具体使用方法见以下链接：\n[Profiler API](https://zh-hans.reactjs.org/docs/profiler.html#gatsby-focus-wrapper)\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"profile","published":1,"updated":"2023-03-12T09:48:17.499Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf6001ap5o10rxa6fzw","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;<br>demo 示例如下代码所示：</p>\n<ul>\n<li>父组件</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;useState&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./App.css&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Display</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./component/Display&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [count, setCount] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [text, setText] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title function_\">hangeChange</span> = (<span class=\"params\">e</span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setText</span>(e.<span class=\"property\">target</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;父组件App渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;App&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">50</span>&#125;&#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;text&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;hangeChange&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">Display</span> <span class=\"attr\">text</span>=<span class=\"string\">&#123;text&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">50</span>&#125;&#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">10</span>&#125;&#125;&gt;</span> &#123;count&#125; <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">button</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">          <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-xml\">            setCount(count + 1)</span></span><br><span class=\"line\"><span class=\"language-xml\">          &#125;&#125;&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">          +1</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">App</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>子组件</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Display</span> = (<span class=\"params\">props</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123;text&#125; = props</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件Display渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>&#123;text&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Display</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"组件渲染问题\"><a href=\"#组件渲染问题\" class=\"headerlink\" title=\"组件渲染问题\"></a>组件渲染问题</h2><p>打开应用后，看到如下界面：</p>\n<img src=\"/2021/02/21/profile/profile1.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>进行如下操作：</p>\n<ul>\n<li>在文本框的 0 后输入 123</li>\n<li>点击三次+1 按钮</li>\n</ul>\n<p>操作完成后，查看控制台输出：</p>\n<img src=\"/2021/02/21/profile/profile2.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>由上图可以看出，在 input 框中输入 123 时，App 组件内部的状态改变，所以子组件 Display 的 porp 改变，因此父组件子组件依次渲染，然而当点击按钮+1 时，子组件 Display 的状态、prop 并未改变却进行了渲染；说明此组件的问题是进行了不必要的 re-render</p>\n<h2 id=\"Profiler-查看-reRender-原因\"><a href=\"#Profiler-查看-reRender-原因\" class=\"headerlink\" title=\"Profiler 查看 reRender 原因\"></a>Profiler 查看 reRender 原因</h2><p>如果你安装了 React-dev-tools 在 chrome 浏览器控制台可以打开 profiler 工具栏，如下图所示：</p>\n<img src=\"/2021/02/21/profile/profile3.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>点击 reload 按钮<img src=\"/2021/02/21/profile/profile4.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n按以下步骤操作：</li>\n<li>在文本框的 0 后输入 123</li>\n<li>点击三次+1 按钮</li>\n<li>点击 stop profiling 按钮<img src=\"/2021/02/21/profile/profile5.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile5.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\"></li>\n</ul>\n<p>此时我们可以看到工具记录的信息如下图所示：</p>\n<img src=\"/2021/02/21/profile/profile6.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile6.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>A 区记录了提交的次数</li>\n<li>B 区记录了应用内组件的状态</li>\n<li>C 区记录了每次提交的信息</li>\n</ul>\n<p>我们点击按钮时，提交信息在最后三次，我们点击 A 区的最后一次提交，在 C 取查看提交信息：</p>\n<img src=\"/2021/02/21/profile/profile7.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile7.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>从 B 区(光标放到组件上)、C 区的信息能看出 Display 组件的 re-render 是由于父组件的更新，此时我们可以考虑用 React.memo 包裹子 Display 组件进行优化，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Display</span> = (<span class=\"params\">props</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123;text&#125; = props</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件Display渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>&#123;text&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Display</span>)</span><br></pre></td></tr></table></figure>\n\n<p>代码优化后使用工具 reload，可以看到在最后一次提交时，尽管 App 组件更新，但是 Display 组件 Did not render，此时便达到了优化组件渲染的目的；</p>\n<img src=\"/2021/02/21/profile/profile8.png\" class=\"lazyload\" data-srcset=\"/2021/02/21/profile/profile8.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><strong>参考：</strong><br><a href=\"https://juejin.cn/post/7008337341634854942#heading-10\">Profiler 的使用</a><br><a href=\"https://zh-hans.reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html\">React Profiler 介绍</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>在实际的项目中，如果遇到问题组件，我们应该学会使用 Profiler 组件定位问题组件，查看组件 re-render 原因有的放矢，这样才能提高解决问题的效率；<br>当然 React 官方也提供了 Profiler API，具体使用方法见以下链接：<br><a href=\"https://zh-hans.reactjs.org/docs/profiler.html#gatsby-focus-wrapper\">Profiler API</a></p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>项目开发时，难免会遇到一些组件卡顿的情况，那么如何能快速定位到问题组件、了解组件性能，并做出相应调整呢，本篇文章将以一个小 demo 为例，讲述 React 官方推荐的工具 Profiler;<br>demo 示例如下代码所示：</p>\n<ul>\n<li>父组件</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;useState&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./App.css&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">Display</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./component/Display&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [count, setCount] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [text, setText] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title function_\">hangeChange</span> = (<span class=\"params\">e</span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setText</span>(e.<span class=\"property\">target</span>.<span class=\"property\">value</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;父组件App渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;App&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">50</span>&#125;&#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">&#123;text&#125;</span> <span class=\"attr\">onChange</span>=<span class=\"string\">&#123;hangeChange&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">Display</span> <span class=\"attr\">text</span>=<span class=\"string\">&#123;text&#125;</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">50</span>&#125;&#125;&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">10</span>&#125;&#125;&gt;</span> &#123;count&#125; <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">button</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">          <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-xml\">            setCount(count + 1)</span></span><br><span class=\"line\"><span class=\"language-xml\">          &#125;&#125;&gt;</span></span><br><span class=\"line\"><span class=\"language-xml\">          +1</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">App</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>子组件</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Display</span> = (<span class=\"params\">props</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123;text&#125; = props</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件Display渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>&#123;text&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Display</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"组件渲染问题\"><a href=\"#组件渲染问题\" class=\"headerlink\" title=\"组件渲染问题\"></a>组件渲染问题</h2><p>打开应用后，看到如下界面：</p>\n<img src=\"/2021/02/21/profile/profile1.png\" class=\"\">\n<p>进行如下操作：</p>\n<ul>\n<li>在文本框的 0 后输入 123</li>\n<li>点击三次+1 按钮</li>\n</ul>\n<p>操作完成后，查看控制台输出：</p>\n<img src=\"/2021/02/21/profile/profile2.png\" class=\"\">\n<p>由上图可以看出，在 input 框中输入 123 时，App 组件内部的状态改变，所以子组件 Display 的 porp 改变，因此父组件子组件依次渲染，然而当点击按钮+1 时，子组件 Display 的状态、prop 并未改变却进行了渲染；说明此组件的问题是进行了不必要的 re-render</p>\n<h2 id=\"Profiler-查看-reRender-原因\"><a href=\"#Profiler-查看-reRender-原因\" class=\"headerlink\" title=\"Profiler 查看 reRender 原因\"></a>Profiler 查看 reRender 原因</h2><p>如果你安装了 React-dev-tools 在 chrome 浏览器控制台可以打开 profiler 工具栏，如下图所示：</p>\n<img src=\"/2021/02/21/profile/profile3.png\" class=\"\">\n\n<ul>\n<li>点击 reload 按钮<img src=\"/2021/02/21/profile/profile4.png\" class=\"\">\n按以下步骤操作：</li>\n<li>在文本框的 0 后输入 123</li>\n<li>点击三次+1 按钮</li>\n<li>点击 stop profiling 按钮<img src=\"/2021/02/21/profile/profile5.png\" class=\"\"></li>\n</ul>\n<p>此时我们可以看到工具记录的信息如下图所示：</p>\n<img src=\"/2021/02/21/profile/profile6.png\" class=\"\">\n\n<ul>\n<li>A 区记录了提交的次数</li>\n<li>B 区记录了应用内组件的状态</li>\n<li>C 区记录了每次提交的信息</li>\n</ul>\n<p>我们点击按钮时，提交信息在最后三次，我们点击 A 区的最后一次提交，在 C 取查看提交信息：</p>\n<img src=\"/2021/02/21/profile/profile7.png\" class=\"\">\n<p>从 B 区(光标放到组件上)、C 区的信息能看出 Display 组件的 re-render 是由于父组件的更新，此时我们可以考虑用 React.memo 包裹子 Display 组件进行优化，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">Display</span> = (<span class=\"params\">props</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123;text&#125; = props</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件Display渲染了--------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>&#123;text&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Display</span>)</span><br></pre></td></tr></table></figure>\n\n<p>代码优化后使用工具 reload，可以看到在最后一次提交时，尽管 App 组件更新，但是 Display 组件 Did not render，此时便达到了优化组件渲染的目的；</p>\n<img src=\"/2021/02/21/profile/profile8.png\" class=\"\">\n<p><strong>参考：</strong><br><a href=\"https://juejin.cn/post/7008337341634854942#heading-10\">Profiler 的使用</a><br><a href=\"https://zh-hans.reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html\">React Profiler 介绍</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>在实际的项目中，如果遇到问题组件，我们应该学会使用 Profiler 组件定位问题组件，查看组件 re-render 原因有的放矢，这样才能提高解决问题的效率；<br>当然 React 官方也提供了 Profiler API，具体使用方法见以下链接：<br><a href=\"https://zh-hans.reactjs.org/docs/profiler.html#gatsby-focus-wrapper\">Profiler API</a></p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"prop的单向数据流","description":"在Vue的子组件中去修改父组件通过prop传过来的对象时，控制台报错，报错信息如下：`error Unexpected mutation of “xxxx“ prop`，这背后的原因是什么呢，下面我将结合实际开发的报错信息和Vue.js官方文档带大家深入理解prop的单向数据流；","headimg":"/images/vue.png","date":"2021-09-03T16:00:00.000Z","_content":"\n## 前言\n\n在 Vue 的子组件中去修改父组件通过 prop 传过来的对象时，控制台报错，报错信息如下：`error Unexpected mutation of “xxxx“ prop`，这背后的原因是什么呢，下面我将结合实际开发的报错信息和 Vue.js 官方文档带大家深入理解 prop 的单向数据流；\n{% asset_img data1.png %}\n\n## 报错原因分析\n\n代码如下所示：\n\n```javascript\n<script>\nexport default {\n  data() {\n    return {\n      flag: '',\n    }\n  },\n  //props传入的todo使用要加上this\n  props: ['todo'],\n  methods: {\n    changeDone() {\n      this.todo.done = this.flag\n    },\n  },\n}\n</script>\n```\n\n以上代码中可以看出此组件用 props 接收了一个 todo 对象，而我在 methods 对象中定义了一个函数，直接访问 todo 对象并且，修改了其中的 done 属性，导致了控制台报错；首先我们查阅官方文档看看，文档对 prop 的说明，文档中清楚的说明了 prop 的单向数据流，强调了父子组件之间形成了一个单向下行绑定；如果在子组件内部更改 prop，会导致浏览器报错；\n{% asset_img data2.png %}\n\n## 解决办法\n\n对于以上错误，我们已经明确了原因，那么我们如果一定要修改父组件传入的数据，而且不影响父组件呢？下面我们来看看 Vue 官方文档提供的方法：\n{% asset_img data3.png %}\n以上图片看出 Vue 官方文档明确了两种变更 prop 的情形，第一种是在本地的 data 对象中添加属性，并且将 父组件传入的 prop 作为初始值；第二种是定义一个计算属性，用传入的 prop 属性进行计算；\n**特别强调**：==注意在 JavaScript 中对象和数组是通过引用传入的，所以对于一个数组或对象类型的 prop 来说，在子组件中改变变更这个对象或数组本身将会影响到父组件的状态==。\n更详细的信息请查看：[Vue.js 官方文章](https://cn.vuejs.org/v2/guide/components-props.html)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/prop的单向数据流.md","raw":"---\ntitle: prop的单向数据流\ndescription: 在Vue的子组件中去修改父组件通过prop传过来的对象时，控制台报错，报错信息如下：`error Unexpected mutation of “xxxx“ prop`，这背后的原因是什么呢，下面我将结合实际开发的报错信息和Vue.js官方文档带大家深入理解prop的单向数据流；\nheadimg: /images/vue.png\ndate: 2021-09-04\ntags:\n  - Vue\ncategories:\n  - Vue\n---\n\n## 前言\n\n在 Vue 的子组件中去修改父组件通过 prop 传过来的对象时，控制台报错，报错信息如下：`error Unexpected mutation of “xxxx“ prop`，这背后的原因是什么呢，下面我将结合实际开发的报错信息和 Vue.js 官方文档带大家深入理解 prop 的单向数据流；\n{% asset_img data1.png %}\n\n## 报错原因分析\n\n代码如下所示：\n\n```javascript\n<script>\nexport default {\n  data() {\n    return {\n      flag: '',\n    }\n  },\n  //props传入的todo使用要加上this\n  props: ['todo'],\n  methods: {\n    changeDone() {\n      this.todo.done = this.flag\n    },\n  },\n}\n</script>\n```\n\n以上代码中可以看出此组件用 props 接收了一个 todo 对象，而我在 methods 对象中定义了一个函数，直接访问 todo 对象并且，修改了其中的 done 属性，导致了控制台报错；首先我们查阅官方文档看看，文档对 prop 的说明，文档中清楚的说明了 prop 的单向数据流，强调了父子组件之间形成了一个单向下行绑定；如果在子组件内部更改 prop，会导致浏览器报错；\n{% asset_img data2.png %}\n\n## 解决办法\n\n对于以上错误，我们已经明确了原因，那么我们如果一定要修改父组件传入的数据，而且不影响父组件呢？下面我们来看看 Vue 官方文档提供的方法：\n{% asset_img data3.png %}\n以上图片看出 Vue 官方文档明确了两种变更 prop 的情形，第一种是在本地的 data 对象中添加属性，并且将 父组件传入的 prop 作为初始值；第二种是定义一个计算属性，用传入的 prop 属性进行计算；\n**特别强调**：==注意在 JavaScript 中对象和数组是通过引用传入的，所以对于一个数组或对象类型的 prop 来说，在子组件中改变变更这个对象或数组本身将会影响到父组件的状态==。\n更详细的信息请查看：[Vue.js 官方文章](https://cn.vuejs.org/v2/guide/components-props.html)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"prop的单向数据流","published":1,"updated":"2023-03-14T12:06:32.024Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf7001ep5o1g47o0br1","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在 Vue 的子组件中去修改父组件通过 prop 传过来的对象时，控制台报错，报错信息如下：<code>error Unexpected mutation of “xxxx“ prop</code>，这背后的原因是什么呢，下面我将结合实际开发的报错信息和 Vue.js 官方文档带大家深入理解 prop 的单向数据流；</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data1.png\" class=\"lazyload\" data-srcset=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"报错原因分析\"><a href=\"#报错原因分析\" class=\"headerlink\" title=\"报错原因分析\"></a>报错原因分析</h2><p>代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">data</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">      <span class=\"attr\">flag</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">//props传入的todo使用要加上this</span></span><br><span class=\"line\">  <span class=\"attr\">props</span>: [<span class=\"string\">&#x27;todo&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">methods</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">changeDone</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">todo</span>.<span class=\"property\">done</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">flag</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码中可以看出此组件用 props 接收了一个 todo 对象，而我在 methods 对象中定义了一个函数，直接访问 todo 对象并且，修改了其中的 done 属性，导致了控制台报错；首先我们查阅官方文档看看，文档对 prop 的说明，文档中清楚的说明了 prop 的单向数据流，强调了父子组件之间形成了一个单向下行绑定；如果在子组件内部更改 prop，会导致浏览器报错；</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data2.png\" class=\"lazyload\" data-srcset=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><p>对于以上错误，我们已经明确了原因，那么我们如果一定要修改父组件传入的数据，而且不影响父组件呢？下面我们来看看 Vue 官方文档提供的方法：</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data3.png\" class=\"lazyload\" data-srcset=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>以上图片看出 Vue 官方文档明确了两种变更 prop 的情形，第一种是在本地的 data 对象中添加属性，并且将 父组件传入的 prop 作为初始值；第二种是定义一个计算属性，用传入的 prop 属性进行计算；<br><strong>特别强调</strong>：==注意在 JavaScript 中对象和数组是通过引用传入的，所以对于一个数组或对象类型的 prop 来说，在子组件中改变变更这个对象或数组本身将会影响到父组件的状态==。<br>更详细的信息请查看：<a href=\"https://cn.vuejs.org/v2/guide/components-props.html\">Vue.js 官方文章</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在 Vue 的子组件中去修改父组件通过 prop 传过来的对象时，控制台报错，报错信息如下：<code>error Unexpected mutation of “xxxx“ prop</code>，这背后的原因是什么呢，下面我将结合实际开发的报错信息和 Vue.js 官方文档带大家深入理解 prop 的单向数据流；</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data1.png\" class=\"\">\n\n<h2 id=\"报错原因分析\"><a href=\"#报错原因分析\" class=\"headerlink\" title=\"报错原因分析\"></a>报错原因分析</h2><p>代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">  <span class=\"title function_\">data</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">      <span class=\"attr\">flag</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">//props传入的todo使用要加上this</span></span><br><span class=\"line\">  <span class=\"attr\">props</span>: [<span class=\"string\">&#x27;todo&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">methods</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">changeDone</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">todo</span>.<span class=\"property\">done</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">flag</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码中可以看出此组件用 props 接收了一个 todo 对象，而我在 methods 对象中定义了一个函数，直接访问 todo 对象并且，修改了其中的 done 属性，导致了控制台报错；首先我们查阅官方文档看看，文档对 prop 的说明，文档中清楚的说明了 prop 的单向数据流，强调了父子组件之间形成了一个单向下行绑定；如果在子组件内部更改 prop，会导致浏览器报错；</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data2.png\" class=\"\">\n\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><p>对于以上错误，我们已经明确了原因，那么我们如果一定要修改父组件传入的数据，而且不影响父组件呢？下面我们来看看 Vue 官方文档提供的方法：</p>\n<img src=\"/2021/09/04/prop%E7%9A%84%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81/data3.png\" class=\"\">\n<p>以上图片看出 Vue 官方文档明确了两种变更 prop 的情形，第一种是在本地的 data 对象中添加属性，并且将 父组件传入的 prop 作为初始值；第二种是定义一个计算属性，用传入的 prop 属性进行计算；<br><strong>特别强调</strong>：==注意在 JavaScript 中对象和数组是通过引用传入的，所以对于一个数组或对象类型的 prop 来说，在子组件中改变变更这个对象或数组本身将会影响到父组件的状态==。<br>更详细的信息请查看：<a href=\"https://cn.vuejs.org/v2/guide/components-props.html\">Vue.js 官方文章</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"React Fiber树的构建和替换过程","description":"此文讲解在底层 React Fiber 树的构建和替换过程；","headimg":"/images/react.jpeg","date":"2021-04-24T16:00:00.000Z","_content":"\n## 前言\n\nReact Fiber 树的创建和替换过程运用了[双缓存](https://baike.baidu.com/item/%E5%8F%8C%E7%BC%93%E5%86%B2)技术，即先在内存中创建 fiber 树，待 fiber 树创建完成以后，直接将旧的 fiber 树替换成新的 fiber 树，这样做的好处是省去了直接在页面上渲染时的计算时间，避免计算量大导致的白屏、卡顿，现在你一定还不太理解，下面进行详细讲解！\n\n## mount 过程\n\n以一下 demo 为例进行讲解：\n\n```javascript\nfunction App() {\n  const [num, add] = useState(0)\n  return <p onClick={() => add(num + 1)}>{num}</p>\n}\n\nReactDOM.render(<App />, document.getElementById('root'))\n```\n\n- 首次渲染时：\n  执行 `ReactDOM.render(<App/>, document.getElementById('root'));` 创建一个应用的根节点 `fiberRootNode` 和 App 组件的根节点 rootFiber，`fiberRootNode`节点会通过 current 指针指向 rootFiber ；此时构建的 fiber 树叫 current fiber 树，没有子节点；\n  {% asset_img fiber1.png %}\n\n- render 阶段：\n  此阶段会在内存中构建一颗 workInProgress fiber 树，构建时会与 current fiber 树进行 diff ,复用 current fiber 树的 fiber 节点，被复用的 fiber 节点通过 alternate 指针连接；此时的 fiber 树如下图所示：\n  {% asset_img fiber2.png %}\n\n- commit 阶段：\n  由于内容在内存中已经构建完成，下一步就是将内存中的 fiber 树渲染成真实 DOM ，此后 React 底层将 fiberRootNode 的 current 指针指向了新构建的 fiber 树，此时 workInprogress fiber 树变成了 current fiber 树；\n  此时的 fiber 树结构如下图：\n  {% asset_img fiber3.png %}\n\n## update 过程\n\n此时点击，p 元素，此时状态改变，会触发更新，再次进入 render 阶段，在内存中创建一棵 workInProgress fiber 树，并且和 current fiber 树进行 diff 复用 current fiber 树节点，最后进入 commit 阶段 ，将构建的 fiber 树渲染到页面上，此后 fiberRootNode 的 current 指针指向 workInProgress fiber 树，更新后的 fiber 树如下所示：\n{% asset_img fiber4.png %}\n参考：[React 技术揭秘](https://react.iamkasong.com/process/doubleBuffer.html#%E4%BB%80%E4%B9%88%E6%98%AF-%E5%8F%8C%E7%BC%93%E5%AD%98)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/react-fiber.md","raw":"---\ntitle: React Fiber树的构建和替换过程\ndescription: 此文讲解在底层 React Fiber 树的构建和替换过程；\nheadimg: /images/react.jpeg\ndate: 2021-04-25\ntags:\n  - fiber\ncategories:\n  - React\n---\n\n## 前言\n\nReact Fiber 树的创建和替换过程运用了[双缓存](https://baike.baidu.com/item/%E5%8F%8C%E7%BC%93%E5%86%B2)技术，即先在内存中创建 fiber 树，待 fiber 树创建完成以后，直接将旧的 fiber 树替换成新的 fiber 树，这样做的好处是省去了直接在页面上渲染时的计算时间，避免计算量大导致的白屏、卡顿，现在你一定还不太理解，下面进行详细讲解！\n\n## mount 过程\n\n以一下 demo 为例进行讲解：\n\n```javascript\nfunction App() {\n  const [num, add] = useState(0)\n  return <p onClick={() => add(num + 1)}>{num}</p>\n}\n\nReactDOM.render(<App />, document.getElementById('root'))\n```\n\n- 首次渲染时：\n  执行 `ReactDOM.render(<App/>, document.getElementById('root'));` 创建一个应用的根节点 `fiberRootNode` 和 App 组件的根节点 rootFiber，`fiberRootNode`节点会通过 current 指针指向 rootFiber ；此时构建的 fiber 树叫 current fiber 树，没有子节点；\n  {% asset_img fiber1.png %}\n\n- render 阶段：\n  此阶段会在内存中构建一颗 workInProgress fiber 树，构建时会与 current fiber 树进行 diff ,复用 current fiber 树的 fiber 节点，被复用的 fiber 节点通过 alternate 指针连接；此时的 fiber 树如下图所示：\n  {% asset_img fiber2.png %}\n\n- commit 阶段：\n  由于内容在内存中已经构建完成，下一步就是将内存中的 fiber 树渲染成真实 DOM ，此后 React 底层将 fiberRootNode 的 current 指针指向了新构建的 fiber 树，此时 workInprogress fiber 树变成了 current fiber 树；\n  此时的 fiber 树结构如下图：\n  {% asset_img fiber3.png %}\n\n## update 过程\n\n此时点击，p 元素，此时状态改变，会触发更新，再次进入 render 阶段，在内存中创建一棵 workInProgress fiber 树，并且和 current fiber 树进行 diff 复用 current fiber 树节点，最后进入 commit 阶段 ，将构建的 fiber 树渲染到页面上，此后 fiberRootNode 的 current 指针指向 workInProgress fiber 树，更新后的 fiber 树如下所示：\n{% asset_img fiber4.png %}\n参考：[React 技术揭秘](https://react.iamkasong.com/process/doubleBuffer.html#%E4%BB%80%E4%B9%88%E6%98%AF-%E5%8F%8C%E7%BC%93%E5%AD%98)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"react-fiber","published":1,"updated":"2023-03-12T09:34:45.620Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf8001gp5o1d4vneuqh","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>React Fiber 树的创建和替换过程运用了<a href=\"https://baike.baidu.com/item/%E5%8F%8C%E7%BC%93%E5%86%B2\">双缓存</a>技术，即先在内存中创建 fiber 树，待 fiber 树创建完成以后，直接将旧的 fiber 树替换成新的 fiber 树，这样做的好处是省去了直接在页面上渲染时的计算时间，避免计算量大导致的白屏、卡顿，现在你一定还不太理解，下面进行详细讲解！</p>\n<h2 id=\"mount-过程\"><a href=\"#mount-过程\" class=\"headerlink\" title=\"mount 过程\"></a>mount 过程</h2><p>以一下 demo 为例进行讲解：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [num, add] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;()</span> =&gt;</span> add(num + 1)&#125;&gt;&#123;num&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">ReactDOM</span>.<span class=\"title function_\">render</span>(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">App</span> /&gt;</span></span>, <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>首次渲染时：<br>执行 <code>ReactDOM.render(&lt;App/&gt;, document.getElementById(&#39;root&#39;));</code> 创建一个应用的根节点 <code>fiberRootNode</code> 和 App 组件的根节点 rootFiber，<code>fiberRootNode</code>节点会通过 current 指针指向 rootFiber ；此时构建的 fiber 树叫 current fiber 树，没有子节点；</p>\n<img src=\"/2021/04/25/react-fiber/fiber1.png\" class=\"lazyload\" data-srcset=\"/2021/04/25/react-fiber/fiber1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\"></li>\n<li><p>render 阶段：<br>此阶段会在内存中构建一颗 workInProgress fiber 树，构建时会与 current fiber 树进行 diff ,复用 current fiber 树的 fiber 节点，被复用的 fiber 节点通过 alternate 指针连接；此时的 fiber 树如下图所示：</p>\n<img src=\"/2021/04/25/react-fiber/fiber2.png\" class=\"lazyload\" data-srcset=\"/2021/04/25/react-fiber/fiber2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\"></li>\n<li><p>commit 阶段：<br>由于内容在内存中已经构建完成，下一步就是将内存中的 fiber 树渲染成真实 DOM ，此后 React 底层将 fiberRootNode 的 current 指针指向了新构建的 fiber 树，此时 workInprogress fiber 树变成了 current fiber 树；<br>此时的 fiber 树结构如下图：</p>\n<img src=\"/2021/04/25/react-fiber/fiber3.png\" class=\"lazyload\" data-srcset=\"/2021/04/25/react-fiber/fiber3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\"></li>\n</ul>\n<h2 id=\"update-过程\"><a href=\"#update-过程\" class=\"headerlink\" title=\"update 过程\"></a>update 过程</h2><p>此时点击，p 元素，此时状态改变，会触发更新，再次进入 render 阶段，在内存中创建一棵 workInProgress fiber 树，并且和 current fiber 树进行 diff 复用 current fiber 树节点，最后进入 commit 阶段 ，将构建的 fiber 树渲染到页面上，此后 fiberRootNode 的 current 指针指向 workInProgress fiber 树，更新后的 fiber 树如下所示：</p>\n<img src=\"/2021/04/25/react-fiber/fiber4.png\" class=\"lazyload\" data-srcset=\"/2021/04/25/react-fiber/fiber4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>参考：<a href=\"https://react.iamkasong.com/process/doubleBuffer.html#%E4%BB%80%E4%B9%88%E6%98%AF-%E5%8F%8C%E7%BC%93%E5%AD%98\">React 技术揭秘</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>React Fiber 树的创建和替换过程运用了<a href=\"https://baike.baidu.com/item/%E5%8F%8C%E7%BC%93%E5%86%B2\">双缓存</a>技术，即先在内存中创建 fiber 树，待 fiber 树创建完成以后，直接将旧的 fiber 树替换成新的 fiber 树，这样做的好处是省去了直接在页面上渲染时的计算时间，避免计算量大导致的白屏、卡顿，现在你一定还不太理解，下面进行详细讲解！</p>\n<h2 id=\"mount-过程\"><a href=\"#mount-过程\" class=\"headerlink\" title=\"mount 过程\"></a>mount 过程</h2><p>以一下 demo 为例进行讲解：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [num, add] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;()</span> =&gt;</span> add(num + 1)&#125;&gt;&#123;num&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">ReactDOM</span>.<span class=\"title function_\">render</span>(<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">App</span> /&gt;</span></span>, <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>首次渲染时：<br>执行 <code>ReactDOM.render(&lt;App/&gt;, document.getElementById(&#39;root&#39;));</code> 创建一个应用的根节点 <code>fiberRootNode</code> 和 App 组件的根节点 rootFiber，<code>fiberRootNode</code>节点会通过 current 指针指向 rootFiber ；此时构建的 fiber 树叫 current fiber 树，没有子节点；</p>\n<img src=\"/2021/04/25/react-fiber/fiber1.png\" class=\"\"></li>\n<li><p>render 阶段：<br>此阶段会在内存中构建一颗 workInProgress fiber 树，构建时会与 current fiber 树进行 diff ,复用 current fiber 树的 fiber 节点，被复用的 fiber 节点通过 alternate 指针连接；此时的 fiber 树如下图所示：</p>\n<img src=\"/2021/04/25/react-fiber/fiber2.png\" class=\"\"></li>\n<li><p>commit 阶段：<br>由于内容在内存中已经构建完成，下一步就是将内存中的 fiber 树渲染成真实 DOM ，此后 React 底层将 fiberRootNode 的 current 指针指向了新构建的 fiber 树，此时 workInprogress fiber 树变成了 current fiber 树；<br>此时的 fiber 树结构如下图：</p>\n<img src=\"/2021/04/25/react-fiber/fiber3.png\" class=\"\"></li>\n</ul>\n<h2 id=\"update-过程\"><a href=\"#update-过程\" class=\"headerlink\" title=\"update 过程\"></a>update 过程</h2><p>此时点击，p 元素，此时状态改变，会触发更新，再次进入 render 阶段，在内存中创建一棵 workInProgress fiber 树，并且和 current fiber 树进行 diff 复用 current fiber 树节点，最后进入 commit 阶段 ，将构建的 fiber 树渲染到页面上，此后 fiberRootNode 的 current 指针指向 workInProgress fiber 树，更新后的 fiber 树如下所示：</p>\n<img src=\"/2021/04/25/react-fiber/fiber4.png\" class=\"\">\n<p>参考：<a href=\"https://react.iamkasong.com/process/doubleBuffer.html#%E4%BB%80%E4%B9%88%E6%98%AF-%E5%8F%8C%E7%BC%93%E5%AD%98\">React 技术揭秘</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"antd Table 表格滚动高度适配","description":"在开发一个后台管理系统，某一页面用到了table表格，产品的需求是：table表格无论展示多少条数据，表头和分页信息要展示出来,此时我们一定首先想到了table表格的 scroll 属性，然后问题是 ：scrollY一定是动态的才能适配不同的设备高度；","headimg":"/images/antd.jpeg","date":"2021-03-20T16:00:00.000Z","sidebar":["toc"],"_content":"\n## 问题产生背景\n\n在开发一个后台管理系统，某一页面用到了 table 表格，产品的需求是：\n\n- table 表格无论展示多少条数据，表头和分页信息要展示出来\n  此时我们一定首先想到了 table 表格的 scroll 属性，然后问题是 ：\n- scrollY 一定是动态的才能适配不同的设备高度\n  {% asset_img scroll1.png %}\n\n## 如何解决\n\n在解决这个问题之前我们脑海里必须先有一个动态获取表格竖向滚动高度的公式：\n\n- scrollY = 窗口高度 — 表头底部到窗口顶的高度 — 分页高度\n  如下图所示：\n  {% asset_img scroll2.png %}\n  此后问题又来了：\n- 如何获取上图中的表头底到窗口定的距离呢？\n  此时推荐一个 api`getBoundingClientRect()`, 此 api 可以动态获取元素相对视口的位置，详细用法见下 MDN 链接：\n  [getBoundingClientRect](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect)\n  有了这个 api 问题便迎刃而解，代码如下所示：\n\n```javascript\n/**\n * 获取第一个表格的可视化高度\n * @param {*} extraHeight 额外的高度(表格底部的内容高度 Number类型,默认为74)\n * @param {*} id 当前页面中有多个table时需要制定table的id\n */\nexport function getTableScroll({extraHeight, id}) {\n  if (typeof extraHeight == 'undefined') {\n    //  默认底部分页64 + 边距10\n    extraHeight = 74\n  }\n  let tHeader = null\n  if (id) {\n    tHeader = document.getElementById(id)\n      ? document.getElementById(id).getElementsByClassName('ant-table-thead')[0]\n      : null\n  } else {\n    tHeader = document.getElementsByClassName('ant-table-thead')[0]\n  }\n  //表格内容距离顶部的距离\n  let tHeaderBottom = 0\n  if (tHeader) {\n    tHeaderBottom = tHeader.getBoundingClientRect().bottom\n  }\n  //窗体高度-表格内容顶部的高度-表格内容底部的高度\n  // let height = document.body.clientHeight - tHeaderBottom - extraHeight\n  let height = `calc(100vh - ${tHeaderBottom + extraHeight}px)`\n  return height\n}\n```\n\n具体项目中可以将以上函数封装成一个工具函数，在页面初始化时调动，即可调用函数动态获取 scrollY，代码如下所示：\n\n```javascript\nconst [scrollY, setScrollY] = useState(\"\")\n //页面加载完成后才能获取到对应的元素及其位置\n useEffect(() => {\n    setScrollY(getTableScroll())\n  }, [])\n\n\n<Table\n            className=\"components-table-demo-nested\"\n            columns={columns}\n            expandable={{ expandedRowRender }}\n            dataSource={data}\n            scroll={{y:scrollY}}\n/>\n```\n\n## 写在最后\n\n以上便是解决 antd table 表格滚动区域高度适配的方法，如果大家有更好的方法欢迎留言交流~~；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/table-scroll.md","raw":"---\ntitle: antd Table 表格滚动高度适配\ndescription: 在开发一个后台管理系统，某一页面用到了table表格，产品的需求是：table表格无论展示多少条数据，表头和分页信息要展示出来,此时我们一定首先想到了table表格的 scroll 属性，然后问题是 ：scrollY一定是动态的才能适配不同的设备高度；\nheadimg: /images/antd.jpeg\ncategories:\n  - AntDesign\ndate: 2021-03-21\ntags:\n  - antDesign\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n## 问题产生背景\n\n在开发一个后台管理系统，某一页面用到了 table 表格，产品的需求是：\n\n- table 表格无论展示多少条数据，表头和分页信息要展示出来\n  此时我们一定首先想到了 table 表格的 scroll 属性，然后问题是 ：\n- scrollY 一定是动态的才能适配不同的设备高度\n  {% asset_img scroll1.png %}\n\n## 如何解决\n\n在解决这个问题之前我们脑海里必须先有一个动态获取表格竖向滚动高度的公式：\n\n- scrollY = 窗口高度 — 表头底部到窗口顶的高度 — 分页高度\n  如下图所示：\n  {% asset_img scroll2.png %}\n  此后问题又来了：\n- 如何获取上图中的表头底到窗口定的距离呢？\n  此时推荐一个 api`getBoundingClientRect()`, 此 api 可以动态获取元素相对视口的位置，详细用法见下 MDN 链接：\n  [getBoundingClientRect](https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect)\n  有了这个 api 问题便迎刃而解，代码如下所示：\n\n```javascript\n/**\n * 获取第一个表格的可视化高度\n * @param {*} extraHeight 额外的高度(表格底部的内容高度 Number类型,默认为74)\n * @param {*} id 当前页面中有多个table时需要制定table的id\n */\nexport function getTableScroll({extraHeight, id}) {\n  if (typeof extraHeight == 'undefined') {\n    //  默认底部分页64 + 边距10\n    extraHeight = 74\n  }\n  let tHeader = null\n  if (id) {\n    tHeader = document.getElementById(id)\n      ? document.getElementById(id).getElementsByClassName('ant-table-thead')[0]\n      : null\n  } else {\n    tHeader = document.getElementsByClassName('ant-table-thead')[0]\n  }\n  //表格内容距离顶部的距离\n  let tHeaderBottom = 0\n  if (tHeader) {\n    tHeaderBottom = tHeader.getBoundingClientRect().bottom\n  }\n  //窗体高度-表格内容顶部的高度-表格内容底部的高度\n  // let height = document.body.clientHeight - tHeaderBottom - extraHeight\n  let height = `calc(100vh - ${tHeaderBottom + extraHeight}px)`\n  return height\n}\n```\n\n具体项目中可以将以上函数封装成一个工具函数，在页面初始化时调动，即可调用函数动态获取 scrollY，代码如下所示：\n\n```javascript\nconst [scrollY, setScrollY] = useState(\"\")\n //页面加载完成后才能获取到对应的元素及其位置\n useEffect(() => {\n    setScrollY(getTableScroll())\n  }, [])\n\n\n<Table\n            className=\"components-table-demo-nested\"\n            columns={columns}\n            expandable={{ expandedRowRender }}\n            dataSource={data}\n            scroll={{y:scrollY}}\n/>\n```\n\n## 写在最后\n\n以上便是解决 antd table 表格滚动区域高度适配的方法，如果大家有更好的方法欢迎留言交流~~；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"table-scroll","published":1,"updated":"2023-03-12T09:37:46.848Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqf9001ip5o10jgifak4","content":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>在开发一个后台管理系统，某一页面用到了 table 表格，产品的需求是：</p>\n<ul>\n<li>table 表格无论展示多少条数据，表头和分页信息要展示出来<br>此时我们一定首先想到了 table 表格的 scroll 属性，然后问题是 ：</li>\n<li>scrollY 一定是动态的才能适配不同的设备高度<img src=\"/2021/03/21/table-scroll/scroll1.png\" class=\"lazyload\" data-srcset=\"/2021/03/21/table-scroll/scroll1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\"></li>\n</ul>\n<h2 id=\"如何解决\"><a href=\"#如何解决\" class=\"headerlink\" title=\"如何解决\"></a>如何解决</h2><p>在解决这个问题之前我们脑海里必须先有一个动态获取表格竖向滚动高度的公式：</p>\n<ul>\n<li>scrollY = 窗口高度 — 表头底部到窗口顶的高度 — 分页高度<br>如下图所示：<img src=\"/2021/03/21/table-scroll/scroll2.png\" class=\"lazyload\" data-srcset=\"/2021/03/21/table-scroll/scroll2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n此后问题又来了：</li>\n<li>如何获取上图中的表头底到窗口定的距离呢？<br>此时推荐一个 api<code>getBoundingClientRect()</code>, 此 api 可以动态获取元素相对视口的位置，详细用法见下 MDN 链接：<br><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect\">getBoundingClientRect</a><br>有了这个 api 问题便迎刃而解，代码如下所示：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取第一个表格的可视化高度</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125; extraHeight 额外的高度(表格底部的内容高度 Number类型,默认为74)</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125; id 当前页面中有多个table时需要制定table的id</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getTableScroll</span>(<span class=\"params\">&#123;extraHeight, id&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> extraHeight == <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  默认底部分页64 + 边距10</span></span><br><span class=\"line\">    extraHeight = <span class=\"number\">74</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> tHeader = <span class=\"literal\">null</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (id) &#123;</span><br><span class=\"line\">    tHeader = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id)</span><br><span class=\"line\">      ? <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id).<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;ant-table-thead&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">      : <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    tHeader = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;ant-table-thead&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//表格内容距离顶部的距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> tHeaderBottom = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (tHeader) &#123;</span><br><span class=\"line\">    tHeaderBottom = tHeader.<span class=\"title function_\">getBoundingClientRect</span>().<span class=\"property\">bottom</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//窗体高度-表格内容顶部的高度-表格内容底部的高度</span></span><br><span class=\"line\">  <span class=\"comment\">// let height = document.body.clientHeight - tHeaderBottom - extraHeight</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> height = <span class=\"string\">`calc(100vh - <span class=\"subst\">$&#123;tHeaderBottom + extraHeight&#125;</span>px)`</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> height</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>具体项目中可以将以上函数封装成一个工具函数，在页面初始化时调动，即可调用函数动态获取 scrollY，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> [scrollY, setScrollY] = <span class=\"title function_\">useState</span>(<span class=\"string\">&quot;&quot;</span>)</span><br><span class=\"line\"> <span class=\"comment\">//页面加载完成后才能获取到对应的元素及其位置</span></span><br><span class=\"line\"> <span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setScrollY</span>(<span class=\"title function_\">getTableScroll</span>())</span><br><span class=\"line\">  &#125;, [])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;<span class=\"title class_\">Table</span></span><br><span class=\"line\">            className=<span class=\"string\">&quot;components-table-demo-nested&quot;</span></span><br><span class=\"line\">            columns=&#123;columns&#125;</span><br><span class=\"line\">            expandable=&#123;&#123; expandedRowRender &#125;&#125;</span><br><span class=\"line\">            dataSource=&#123;data&#125;</span><br><span class=\"line\">            scroll=&#123;&#123;<span class=\"attr\">y</span>:scrollY&#125;&#125;</span><br><span class=\"line\">/&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上便是解决 antd table 表格滚动区域高度适配的方法，如果大家有更好的方法欢迎留言交流~~；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>在开发一个后台管理系统，某一页面用到了 table 表格，产品的需求是：</p>\n<ul>\n<li>table 表格无论展示多少条数据，表头和分页信息要展示出来<br>此时我们一定首先想到了 table 表格的 scroll 属性，然后问题是 ：</li>\n<li>scrollY 一定是动态的才能适配不同的设备高度<img src=\"/2021/03/21/table-scroll/scroll1.png\" class=\"\"></li>\n</ul>\n<h2 id=\"如何解决\"><a href=\"#如何解决\" class=\"headerlink\" title=\"如何解决\"></a>如何解决</h2><p>在解决这个问题之前我们脑海里必须先有一个动态获取表格竖向滚动高度的公式：</p>\n<ul>\n<li>scrollY = 窗口高度 — 表头底部到窗口顶的高度 — 分页高度<br>如下图所示：<img src=\"/2021/03/21/table-scroll/scroll2.png\" class=\"\">\n此后问题又来了：</li>\n<li>如何获取上图中的表头底到窗口定的距离呢？<br>此时推荐一个 api<code>getBoundingClientRect()</code>, 此 api 可以动态获取元素相对视口的位置，详细用法见下 MDN 链接：<br><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect\">getBoundingClientRect</a><br>有了这个 api 问题便迎刃而解，代码如下所示：</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取第一个表格的可视化高度</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125; extraHeight 额外的高度(表格底部的内容高度 Number类型,默认为74)</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">*</span>&#125; id 当前页面中有多个table时需要制定table的id</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">getTableScroll</span>(<span class=\"params\">&#123;extraHeight, id&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> extraHeight == <span class=\"string\">&#x27;undefined&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  默认底部分页64 + 边距10</span></span><br><span class=\"line\">    extraHeight = <span class=\"number\">74</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> tHeader = <span class=\"literal\">null</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (id) &#123;</span><br><span class=\"line\">    tHeader = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id)</span><br><span class=\"line\">      ? <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id).<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;ant-table-thead&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">      : <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    tHeader = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&#x27;ant-table-thead&#x27;</span>)[<span class=\"number\">0</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//表格内容距离顶部的距离</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> tHeaderBottom = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (tHeader) &#123;</span><br><span class=\"line\">    tHeaderBottom = tHeader.<span class=\"title function_\">getBoundingClientRect</span>().<span class=\"property\">bottom</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//窗体高度-表格内容顶部的高度-表格内容底部的高度</span></span><br><span class=\"line\">  <span class=\"comment\">// let height = document.body.clientHeight - tHeaderBottom - extraHeight</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> height = <span class=\"string\">`calc(100vh - <span class=\"subst\">$&#123;tHeaderBottom + extraHeight&#125;</span>px)`</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> height</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>具体项目中可以将以上函数封装成一个工具函数，在页面初始化时调动，即可调用函数动态获取 scrollY，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> [scrollY, setScrollY] = <span class=\"title function_\">useState</span>(<span class=\"string\">&quot;&quot;</span>)</span><br><span class=\"line\"> <span class=\"comment\">//页面加载完成后才能获取到对应的元素及其位置</span></span><br><span class=\"line\"> <span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setScrollY</span>(<span class=\"title function_\">getTableScroll</span>())</span><br><span class=\"line\">  &#125;, [])</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;<span class=\"title class_\">Table</span></span><br><span class=\"line\">            className=<span class=\"string\">&quot;components-table-demo-nested&quot;</span></span><br><span class=\"line\">            columns=&#123;columns&#125;</span><br><span class=\"line\">            expandable=&#123;&#123; expandedRowRender &#125;&#125;</span><br><span class=\"line\">            dataSource=&#123;data&#125;</span><br><span class=\"line\">            scroll=&#123;&#123;<span class=\"attr\">y</span>:scrollY&#125;&#125;</span><br><span class=\"line\">/&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上便是解决 antd table 表格滚动区域高度适配的方法，如果大家有更好的方法欢迎留言交流~~；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"pin":true,"title":"useMemo使用误区","description":"此文以实际开发遇到的问题为背景讲述 useMemo() 的使用误区；","headimg":"/images/react.jpeg","date":"2021-04-20T16:00:00.000Z","_content":"\n## 问题背景\n\n在某一个 h5 项目中，使用了 useMemo 对项目中的组件进行优化，减少组件不必要的 re-render, 优化后的结果：\n\n- 在组件的 props 和状态未改变时，组件不再进行 re-render\n  表面上看，这样优化没毛病，提高了组件性能，然后仔细阅读官方文档、以及网上一些大牛的文章，你会发现，你错了！！！\n  实际上我们优化时忽略了一个问题：\n\n- useMemo hook 本身的开销！\n  下面将以使用此 hook 和未使用此 hook 的组件性能对比数据来说明，是否应该：\n  `remove most of useMemo`\n\n## useMemo 使用前后组件性能对比\n\n**组件的复杂度为 1 时：**\n{% asset_img memo1.png %}\n\n- 使用 useMemo 时首次渲染和 re-render 时间都更长\n\n**组件的复杂度为 100 时：**\n{% asset_img memo2.png %}\n\n- 首次渲染时，使用 useMemo 更耗时\n- re-render 时 useMemo 稍快\n\n**组件复杂度为 1000 时：**\n{% asset_img memo3.png %}\n\n- useMemo 在首次渲染时更慢\n- re-render 时快了一点\n\n**组件复杂度为 5000 时：**\n{% asset_img memo4.png %}\n\n- useMemo 首次渲染时更慢\n- re-render 更快\n\n## 结论\n\nuseMemo 本身的开销会随着组件的复杂度逐渐变大，导致首次渲染更慢，在实际项目中，我们应该`remove most of useMemo` 。\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/useMemo使用误区.md","raw":"---\npin: true\ntitle: useMemo使用误区\ndescription: 此文以实际开发遇到的问题为背景讲述 useMemo() 的使用误区；\nheadimg: /images/react.jpeg\ndate: 2021-04-21\ntags:\n  - hooks\ncategories:\n  - React\n---\n\n## 问题背景\n\n在某一个 h5 项目中，使用了 useMemo 对项目中的组件进行优化，减少组件不必要的 re-render, 优化后的结果：\n\n- 在组件的 props 和状态未改变时，组件不再进行 re-render\n  表面上看，这样优化没毛病，提高了组件性能，然后仔细阅读官方文档、以及网上一些大牛的文章，你会发现，你错了！！！\n  实际上我们优化时忽略了一个问题：\n\n- useMemo hook 本身的开销！\n  下面将以使用此 hook 和未使用此 hook 的组件性能对比数据来说明，是否应该：\n  `remove most of useMemo`\n\n## useMemo 使用前后组件性能对比\n\n**组件的复杂度为 1 时：**\n{% asset_img memo1.png %}\n\n- 使用 useMemo 时首次渲染和 re-render 时间都更长\n\n**组件的复杂度为 100 时：**\n{% asset_img memo2.png %}\n\n- 首次渲染时，使用 useMemo 更耗时\n- re-render 时 useMemo 稍快\n\n**组件复杂度为 1000 时：**\n{% asset_img memo3.png %}\n\n- useMemo 在首次渲染时更慢\n- re-render 时快了一点\n\n**组件复杂度为 5000 时：**\n{% asset_img memo4.png %}\n\n- useMemo 首次渲染时更慢\n- re-render 更快\n\n## 结论\n\nuseMemo 本身的开销会随着组件的复杂度逐渐变大，导致首次渲染更慢，在实际项目中，我们应该`remove most of useMemo` 。\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"useMemo使用误区","published":1,"updated":"2023-06-21T02:28:15.228Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfb001np5o1fxj29i8p","content":"<h2 id=\"问题背景\"><a href=\"#问题背景\" class=\"headerlink\" title=\"问题背景\"></a>问题背景</h2><p>在某一个 h5 项目中，使用了 useMemo 对项目中的组件进行优化，减少组件不必要的 re-render, 优化后的结果：</p>\n<ul>\n<li><p>在组件的 props 和状态未改变时，组件不再进行 re-render<br>表面上看，这样优化没毛病，提高了组件性能，然后仔细阅读官方文档、以及网上一些大牛的文章，你会发现，你错了！！！<br>实际上我们优化时忽略了一个问题：</p>\n</li>\n<li><p>useMemo hook 本身的开销！<br>下面将以使用此 hook 和未使用此 hook 的组件性能对比数据来说明，是否应该：<br><code>remove most of useMemo</code></p>\n</li>\n</ul>\n<h2 id=\"useMemo-使用前后组件性能对比\"><a href=\"#useMemo-使用前后组件性能对比\" class=\"headerlink\" title=\"useMemo 使用前后组件性能对比\"></a>useMemo 使用前后组件性能对比</h2><p><strong>组件的复杂度为 1 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo1.png\" class=\"lazyload\" data-srcset=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>使用 useMemo 时首次渲染和 re-render 时间都更长</li>\n</ul>\n<p><strong>组件的复杂度为 100 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo2.png\" class=\"lazyload\" data-srcset=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>首次渲染时，使用 useMemo 更耗时</li>\n<li>re-render 时 useMemo 稍快</li>\n</ul>\n<p><strong>组件复杂度为 1000 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo3.png\" class=\"lazyload\" data-srcset=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>useMemo 在首次渲染时更慢</li>\n<li>re-render 时快了一点</li>\n</ul>\n<p><strong>组件复杂度为 5000 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo4.png\" class=\"lazyload\" data-srcset=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<ul>\n<li>useMemo 首次渲染时更慢</li>\n<li>re-render 更快</li>\n</ul>\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>useMemo 本身的开销会随着组件的复杂度逐渐变大，导致首次渲染更慢，在实际项目中，我们应该<code>remove most of useMemo</code> 。</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"问题背景\"><a href=\"#问题背景\" class=\"headerlink\" title=\"问题背景\"></a>问题背景</h2><p>在某一个 h5 项目中，使用了 useMemo 对项目中的组件进行优化，减少组件不必要的 re-render, 优化后的结果：</p>\n<ul>\n<li><p>在组件的 props 和状态未改变时，组件不再进行 re-render<br>表面上看，这样优化没毛病，提高了组件性能，然后仔细阅读官方文档、以及网上一些大牛的文章，你会发现，你错了！！！<br>实际上我们优化时忽略了一个问题：</p>\n</li>\n<li><p>useMemo hook 本身的开销！<br>下面将以使用此 hook 和未使用此 hook 的组件性能对比数据来说明，是否应该：<br><code>remove most of useMemo</code></p>\n</li>\n</ul>\n<h2 id=\"useMemo-使用前后组件性能对比\"><a href=\"#useMemo-使用前后组件性能对比\" class=\"headerlink\" title=\"useMemo 使用前后组件性能对比\"></a>useMemo 使用前后组件性能对比</h2><p><strong>组件的复杂度为 1 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo1.png\" class=\"\">\n\n<ul>\n<li>使用 useMemo 时首次渲染和 re-render 时间都更长</li>\n</ul>\n<p><strong>组件的复杂度为 100 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo2.png\" class=\"\">\n\n<ul>\n<li>首次渲染时，使用 useMemo 更耗时</li>\n<li>re-render 时 useMemo 稍快</li>\n</ul>\n<p><strong>组件复杂度为 1000 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo3.png\" class=\"\">\n\n<ul>\n<li>useMemo 在首次渲染时更慢</li>\n<li>re-render 时快了一点</li>\n</ul>\n<p><strong>组件复杂度为 5000 时：</strong></p>\n<img src=\"/2021/04/21/useMemo%E4%BD%BF%E7%94%A8%E8%AF%AF%E5%8C%BA/memo4.png\" class=\"\">\n\n<ul>\n<li>useMemo 首次渲染时更慢</li>\n<li>re-render 更快</li>\n</ul>\n<h2 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论\"></a>结论</h2><p>useMemo 本身的开销会随着组件的复杂度逐渐变大，导致首次渲染更慢，在实际项目中，我们应该<code>remove most of useMemo</code> 。</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"React.memo 和 useMemo 的使用","description":"本文讲解如何使用 useMemo()、React.memo 减少不必要的reRender","headimg":"/images/react.jpeg","date":"2021-03-14T16:00:00.000Z","sidebar":["toc"],"_content":"\n## 问题背景\n\n大家在使用 React 框架进行开发时一定遇到过以下问题：\n\n- 当函数式组件中的某一状态改变，整个组件刷新，重新渲染\n- 在类组件中 setState() 时，整个组件也会重新渲染\n  以上问题若不进行优化，导致的结果是：\n- 随着代码的增加，每次的状态改变，页面进行一次 reRender ，这将产生很多不必要的 reRender 不仅浪费性能，而且会导致页面卡顿；\n\n## useMemo 进行优化\n\n以下面 App 组件进行分析\n\n```javascript\nimport './App.css'\nimport ProfileTest from './components'\nimport {Profiler, useEffect, useMemo, useState, useRef} from 'react'\nfunction App() {\n  const [name, setName] = useState('')\n  const [num, setNum] = useState(0)\n  useEffect(() => {\n    setTimeout(() => {\n      console.log('111')\n      setName('xxx')\n    }, 2000)\n  }, [])\n  const memoVal = useMemo(() => {\n    console.log('运行了useMemo num值为：', num)\n    return num + 1\n  }, [num])\n  console.log('memoVal值为：', memoVal)\n  console.log('父组件运行分割线----------------------------------------------------')\n  const changeNum = () => {\n    setNum(2)\n  }\n  return (\n    <Profiler id=\"profile-test\">\n      <div className=\"App\">\n        {/* <ProfileTest /> */}\n        <button style={{marginTop: 100}} onClick={changeNum}>\n          改变num\n        </button>\n      </div>\n    </Profiler>\n  )\n}\nexport default App\n```\n\n以上组件在首次渲染、以及 2 秒后的执行结构如下图所示：\n{% asset_img memoopt1.png %}\n很显然首次渲染执行了，useMemo，而 2 秒后有状态变化后没有执行 useMemo。\n点击按钮改变 useMemo 的依赖项后可以发现，如下图所示 useMemo 又执行了。\n{% asset_img memoopt2.png %}\n因此在使用函数式组件时，可以使用 useMemo 减少不必要的 reRender 提高组件的性能；\n\n## React.memo 进行优化\n\n在以上组件的基础上，给 App 增加一个子组件，代码如下所示：\n\n```javascript\nimport React from 'react'\n\nexport default function Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\n```\n\n首次 render 以及 2s 后组件的 reRender 控制台打印结果如下图所示：\n{% asset_img memoopt3.png %}\n由上图可以看出，reRender 时 Children 组件的 props 并未变化，因此，此次 Children 组件的 reRender 是不必要的，需要进行优化；\n\n### props 的值是基本类型\n\n如果 Children 的 props 是基本类型，则可以做一下优化：\n\n```javascript\nimport React, {memo} from 'react'\n\nfunction Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\nexport default memo(Children)\n```\n\n优化后控制台打印如下信息，一下信息可以看出 Children 组件没有进行 reRender\n{% asset_img memoopt4.png %}\n\n### props 的值是引用类型\n\n若子组件的 props 是引用类型 ，则需要进行深度比较，此时 React.memo()要传入第二个参数进行深度比较，改变后 Children 组件的代码如下所示：\n\n```javascript\nimport React, {memo} from 'react'\n\nfunction Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\nexport default memo(Children, (preProps, nextProps) => {\n  return JSON.stringify(preProps) === JSON.stringify(nextProps)\n})\n```\n\n以上 memo 第二个参数 ，通过比较 preProps 和 nextProps 返回一个布尔值，使得 props 进行深度比较；\n`注意：React.memo的第二个参数进行深度比较时有一定开销，其产生的开销存在大于子组件reRender的可能`\n\n## 写在最后\n\nuseMemo() 和 React.memo() 都是进行组件性能优化的方式，其区别是\n\n- useMemo 可以进行更加细粒度的优化(有依赖项)\n- React.memo() 可以控制 props 的浅比较和深度比较\n- React.memo 在没有第二个参数的时候相当于 class 中的 PureComponent，当增加了第二个参数的时候相当于生命周期中的 shouldComponentUpdate；\n  > 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/useMemo的使用.md","raw":"---\ntitle: React.memo 和 useMemo 的使用\ndescription: 本文讲解如何使用 useMemo()、React.memo 减少不必要的reRender\nheadimg: /images/react.jpeg\ncategories:\n  - React\ndate: 2021-03-15\ntags:\n  - React\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n## 问题背景\n\n大家在使用 React 框架进行开发时一定遇到过以下问题：\n\n- 当函数式组件中的某一状态改变，整个组件刷新，重新渲染\n- 在类组件中 setState() 时，整个组件也会重新渲染\n  以上问题若不进行优化，导致的结果是：\n- 随着代码的增加，每次的状态改变，页面进行一次 reRender ，这将产生很多不必要的 reRender 不仅浪费性能，而且会导致页面卡顿；\n\n## useMemo 进行优化\n\n以下面 App 组件进行分析\n\n```javascript\nimport './App.css'\nimport ProfileTest from './components'\nimport {Profiler, useEffect, useMemo, useState, useRef} from 'react'\nfunction App() {\n  const [name, setName] = useState('')\n  const [num, setNum] = useState(0)\n  useEffect(() => {\n    setTimeout(() => {\n      console.log('111')\n      setName('xxx')\n    }, 2000)\n  }, [])\n  const memoVal = useMemo(() => {\n    console.log('运行了useMemo num值为：', num)\n    return num + 1\n  }, [num])\n  console.log('memoVal值为：', memoVal)\n  console.log('父组件运行分割线----------------------------------------------------')\n  const changeNum = () => {\n    setNum(2)\n  }\n  return (\n    <Profiler id=\"profile-test\">\n      <div className=\"App\">\n        {/* <ProfileTest /> */}\n        <button style={{marginTop: 100}} onClick={changeNum}>\n          改变num\n        </button>\n      </div>\n    </Profiler>\n  )\n}\nexport default App\n```\n\n以上组件在首次渲染、以及 2 秒后的执行结构如下图所示：\n{% asset_img memoopt1.png %}\n很显然首次渲染执行了，useMemo，而 2 秒后有状态变化后没有执行 useMemo。\n点击按钮改变 useMemo 的依赖项后可以发现，如下图所示 useMemo 又执行了。\n{% asset_img memoopt2.png %}\n因此在使用函数式组件时，可以使用 useMemo 减少不必要的 reRender 提高组件的性能；\n\n## React.memo 进行优化\n\n在以上组件的基础上，给 App 增加一个子组件，代码如下所示：\n\n```javascript\nimport React from 'react'\n\nexport default function Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\n```\n\n首次 render 以及 2s 后组件的 reRender 控制台打印结果如下图所示：\n{% asset_img memoopt3.png %}\n由上图可以看出，reRender 时 Children 组件的 props 并未变化，因此，此次 Children 组件的 reRender 是不必要的，需要进行优化；\n\n### props 的值是基本类型\n\n如果 Children 的 props 是基本类型，则可以做一下优化：\n\n```javascript\nimport React, {memo} from 'react'\n\nfunction Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\nexport default memo(Children)\n```\n\n优化后控制台打印如下信息，一下信息可以看出 Children 组件没有进行 reRender\n{% asset_img memoopt4.png %}\n\n### props 的值是引用类型\n\n若子组件的 props 是引用类型 ，则需要进行深度比较，此时 React.memo()要传入第二个参数进行深度比较，改变后 Children 组件的代码如下所示：\n\n```javascript\nimport React, {memo} from 'react'\n\nfunction Children(props) {\n  console.log('子组件运行了，接收的props是', props)\n  console.log('子组件渲染分割线------------------------------------------')\n  return <div>子组件</div>\n}\nexport default memo(Children, (preProps, nextProps) => {\n  return JSON.stringify(preProps) === JSON.stringify(nextProps)\n})\n```\n\n以上 memo 第二个参数 ，通过比较 preProps 和 nextProps 返回一个布尔值，使得 props 进行深度比较；\n`注意：React.memo的第二个参数进行深度比较时有一定开销，其产生的开销存在大于子组件reRender的可能`\n\n## 写在最后\n\nuseMemo() 和 React.memo() 都是进行组件性能优化的方式，其区别是\n\n- useMemo 可以进行更加细粒度的优化(有依赖项)\n- React.memo() 可以控制 props 的浅比较和深度比较\n- React.memo 在没有第二个参数的时候相当于 class 中的 PureComponent，当增加了第二个参数的时候相当于生命周期中的 shouldComponentUpdate；\n  > 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"useMemo的使用","published":1,"updated":"2023-03-12T09:37:43.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfc001pp5o1dupddq3l","content":"<h2 id=\"问题背景\"><a href=\"#问题背景\" class=\"headerlink\" title=\"问题背景\"></a>问题背景</h2><p>大家在使用 React 框架进行开发时一定遇到过以下问题：</p>\n<ul>\n<li>当函数式组件中的某一状态改变，整个组件刷新，重新渲染</li>\n<li>在类组件中 setState() 时，整个组件也会重新渲染<br>以上问题若不进行优化，导致的结果是：</li>\n<li>随着代码的增加，每次的状态改变，页面进行一次 reRender ，这将产生很多不必要的 reRender 不仅浪费性能，而且会导致页面卡顿；</li>\n</ul>\n<h2 id=\"useMemo-进行优化\"><a href=\"#useMemo-进行优化\" class=\"headerlink\" title=\"useMemo 进行优化\"></a>useMemo 进行优化</h2><p>以下面 App 组件进行分析</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./App.css&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">ProfileTest</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./components&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;<span class=\"title class_\">Profiler</span>, useEffect, useMemo, useState, useRef&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [name, setName] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [num, setNum] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;111&#x27;</span>)</span><br><span class=\"line\">      <span class=\"title function_\">setName</span>(<span class=\"string\">&#x27;xxx&#x27;</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">2000</span>)</span><br><span class=\"line\">  &#125;, [])</span><br><span class=\"line\">  <span class=\"keyword\">const</span> memoVal = <span class=\"title function_\">useMemo</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;运行了useMemo num值为：&#x27;</span>, num)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> num + <span class=\"number\">1</span></span><br><span class=\"line\">  &#125;, [num])</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;memoVal值为：&#x27;</span>, memoVal)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;父组件运行分割线----------------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title function_\">changeNum</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setNum</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">Profiler</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;profile-test&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;App&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        &#123;/* <span class=\"tag\">&lt;<span class=\"name\">ProfileTest</span> /&gt;</span> */&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">100</span>&#125;&#125; <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;changeNum&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">          改变num</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">Profiler</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">App</span></span><br></pre></td></tr></table></figure>\n\n<p>以上组件在首次渲染、以及 2 秒后的执行结构如下图所示：</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt1.png\" class=\"lazyload\" data-srcset=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>很显然首次渲染执行了，useMemo，而 2 秒后有状态变化后没有执行 useMemo。<br>点击按钮改变 useMemo 的依赖项后可以发现，如下图所示 useMemo 又执行了。</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt2.png\" class=\"lazyload\" data-srcset=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>因此在使用函数式组件时，可以使用 useMemo 减少不必要的 reRender 提高组件的性能；</p>\n<h2 id=\"React-memo-进行优化\"><a href=\"#React-memo-进行优化\" class=\"headerlink\" title=\"React.memo 进行优化\"></a>React.memo 进行优化</h2><p>在以上组件的基础上，给 App 增加一个子组件，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>首次 render 以及 2s 后组件的 reRender 控制台打印结果如下图所示：</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt3.png\" class=\"lazyload\" data-srcset=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>由上图可以看出，reRender 时 Children 组件的 props 并未变化，因此，此次 Children 组件的 reRender 是不必要的，需要进行优化；</p>\n<h3 id=\"props-的值是基本类型\"><a href=\"#props-的值是基本类型\" class=\"headerlink\" title=\"props 的值是基本类型\"></a>props 的值是基本类型</h3><p>如果 Children 的 props 是基本类型，则可以做一下优化：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Children</span>)</span><br></pre></td></tr></table></figure>\n\n<p>优化后控制台打印如下信息，一下信息可以看出 Children 组件没有进行 reRender</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt4.png\" class=\"lazyload\" data-srcset=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h3 id=\"props-的值是引用类型\"><a href=\"#props-的值是引用类型\" class=\"headerlink\" title=\"props 的值是引用类型\"></a>props 的值是引用类型</h3><p>若子组件的 props 是引用类型 ，则需要进行深度比较，此时 React.memo()要传入第二个参数进行深度比较，改变后 Children 组件的代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Children</span>, <span class=\"function\">(<span class=\"params\">preProps, nextProps</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(preProps) === <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(nextProps)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>以上 memo 第二个参数 ，通过比较 preProps 和 nextProps 返回一个布尔值，使得 props 进行深度比较；<br><code>注意：React.memo的第二个参数进行深度比较时有一定开销，其产生的开销存在大于子组件reRender的可能</code></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>useMemo() 和 React.memo() 都是进行组件性能优化的方式，其区别是</p>\n<ul>\n<li>useMemo 可以进行更加细粒度的优化(有依赖项)</li>\n<li>React.memo() 可以控制 props 的浅比较和深度比较</li>\n<li>React.memo 在没有第二个参数的时候相当于 class 中的 PureComponent，当增加了第二个参数的时候相当于生命周期中的 shouldComponentUpdate；<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n</li>\n</ul>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"问题背景\"><a href=\"#问题背景\" class=\"headerlink\" title=\"问题背景\"></a>问题背景</h2><p>大家在使用 React 框架进行开发时一定遇到过以下问题：</p>\n<ul>\n<li>当函数式组件中的某一状态改变，整个组件刷新，重新渲染</li>\n<li>在类组件中 setState() 时，整个组件也会重新渲染<br>以上问题若不进行优化，导致的结果是：</li>\n<li>随着代码的增加，每次的状态改变，页面进行一次 reRender ，这将产生很多不必要的 reRender 不仅浪费性能，而且会导致页面卡顿；</li>\n</ul>\n<h2 id=\"useMemo-进行优化\"><a href=\"#useMemo-进行优化\" class=\"headerlink\" title=\"useMemo 进行优化\"></a>useMemo 进行优化</h2><p>以下面 App 组件进行分析</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./App.css&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">ProfileTest</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./components&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123;<span class=\"title class_\">Profiler</span>, useEffect, useMemo, useState, useRef&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">App</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [name, setName] = <span class=\"title function_\">useState</span>(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [num, setNum] = <span class=\"title function_\">useState</span>(<span class=\"number\">0</span>)</span><br><span class=\"line\">  <span class=\"title function_\">useEffect</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;111&#x27;</span>)</span><br><span class=\"line\">      <span class=\"title function_\">setName</span>(<span class=\"string\">&#x27;xxx&#x27;</span>)</span><br><span class=\"line\">    &#125;, <span class=\"number\">2000</span>)</span><br><span class=\"line\">  &#125;, [])</span><br><span class=\"line\">  <span class=\"keyword\">const</span> memoVal = <span class=\"title function_\">useMemo</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;运行了useMemo num值为：&#x27;</span>, num)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> num + <span class=\"number\">1</span></span><br><span class=\"line\">  &#125;, [num])</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;memoVal值为：&#x27;</span>, memoVal)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;父组件运行分割线----------------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title function_\">changeNum</span> = (<span class=\"params\"></span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"title function_\">setNum</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">Profiler</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;profile-test&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;App&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">        &#123;/* <span class=\"tag\">&lt;<span class=\"name\">ProfileTest</span> /&gt;</span> */&#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">style</span>=<span class=\"string\">&#123;&#123;marginTop:</span> <span class=\"attr\">100</span>&#125;&#125; <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;changeNum&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">          改变num</span></span><br><span class=\"line\"><span class=\"language-xml\">        <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">Profiler</span>&gt;</span></span></span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">App</span></span><br></pre></td></tr></table></figure>\n\n<p>以上组件在首次渲染、以及 2 秒后的执行结构如下图所示：</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt1.png\" class=\"\">\n<p>很显然首次渲染执行了，useMemo，而 2 秒后有状态变化后没有执行 useMemo。<br>点击按钮改变 useMemo 的依赖项后可以发现，如下图所示 useMemo 又执行了。</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt2.png\" class=\"\">\n<p>因此在使用函数式组件时，可以使用 useMemo 减少不必要的 reRender 提高组件的性能；</p>\n<h2 id=\"React-memo-进行优化\"><a href=\"#React-memo-进行优化\" class=\"headerlink\" title=\"React.memo 进行优化\"></a>React.memo 进行优化</h2><p>在以上组件的基础上，给 App 增加一个子组件，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>首次 render 以及 2s 后组件的 reRender 控制台打印结果如下图所示：</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt3.png\" class=\"\">\n<p>由上图可以看出，reRender 时 Children 组件的 props 并未变化，因此，此次 Children 组件的 reRender 是不必要的，需要进行优化；</p>\n<h3 id=\"props-的值是基本类型\"><a href=\"#props-的值是基本类型\" class=\"headerlink\" title=\"props 的值是基本类型\"></a>props 的值是基本类型</h3><p>如果 Children 的 props 是基本类型，则可以做一下优化：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Children</span>)</span><br></pre></td></tr></table></figure>\n\n<p>优化后控制台打印如下信息，一下信息可以看出 Children 组件没有进行 reRender</p>\n<img src=\"/2021/03/15/useMemo%E7%9A%84%E4%BD%BF%E7%94%A8/memoopt4.png\" class=\"\">\n\n<h3 id=\"props-的值是引用类型\"><a href=\"#props-的值是引用类型\" class=\"headerlink\" title=\"props 的值是引用类型\"></a>props 的值是引用类型</h3><p>若子组件的 props 是引用类型 ，则需要进行深度比较，此时 React.memo()要传入第二个参数进行深度比较，改变后 Children 组件的代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123;memo&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Children</span>(<span class=\"params\">props</span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件运行了，接收的props是&#x27;</span>, props)</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;子组件渲染分割线------------------------------------------&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>子组件<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title function_\">memo</span>(<span class=\"title class_\">Children</span>, <span class=\"function\">(<span class=\"params\">preProps, nextProps</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(preProps) === <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(nextProps)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>以上 memo 第二个参数 ，通过比较 preProps 和 nextProps 返回一个布尔值，使得 props 进行深度比较；<br><code>注意：React.memo的第二个参数进行深度比较时有一定开销，其产生的开销存在大于子组件reRender的可能</code></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>useMemo() 和 React.memo() 都是进行组件性能优化的方式，其区别是</p>\n<ul>\n<li>useMemo 可以进行更加细粒度的优化(有依赖项)</li>\n<li>React.memo() 可以控制 props 的浅比较和深度比较</li>\n<li>React.memo 在没有第二个参数的时候相当于 class 中的 PureComponent，当增加了第二个参数的时候相当于生命周期中的 shouldComponentUpdate；<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n</li>\n</ul>\n"},{"title":"深入理解Vue响应式原理","description":"Vue响应式原理是Vue最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解Vue的响应式原理；","headimg":"/images/vue.png","date":"2021-07-03T16:00:00.000Z","_content":"\n## 前言\n\nVue 响应式原理是 Vue 最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解 Vue 的响应式原理；\n{% asset_img vue.png %}\n\n## 如何监测数据的变化\n\n要想准确响应数据的变化，首先需要精确及时的监测数据的变化，Vue 检测数据的变化核心还是通过 Object.defineProperty();下面通过实例为大家详细阐述 Vue 检测数据变化的过程，代码示例如下：\n\n```javascript\n<script type=\"text/javascript\" >\n\t\t\tlet data = {\n\t\t\t\tname:'xizhutao',\n\t\t\t\taddress:'安徽',\n\t\t\t}\n\t\t\t//创建一个监视的实例对象，用于监视data中属性的变化\n\t\t\tconst obs = new Observer(data)\n\t\t\tconsole.log(obs)\n\t\t\t//准备一个vm实例对象\n\t\t\tlet vm = {}\n\t\t\tvm._data = data = obs\n\t\t\tfunction Observer(obj){\n\t\t\t\t//汇总对象中所有的属性形成一个数组\n\t\t\t\tconst keys = Object.keys(obj)\n\t\t\t\t//遍历\n\t\t\t\tkeys.forEach((k)=>{\n\t\t\t\t\tObject.defineProperty(this,k,{\n\t\t\t\t\t\tget(){\n\t\t\t\t\t\t\treturn obj[k]\n\t\t\t\t\t\t},\n\t\t\t\t\t\tset(val){\n\t\t\t\t\t\t\tconsole.log(`${k}被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`)\n\t\t\t\t\t\t\tobj[k] = val\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t</script>\n```\n\n以上代码检测数据变化的思路如下：\n一、封装一个 Observer 构造函数，接收一个 data 数据对象，通过 Object.keys()方法，将接收到的数据对象中的属性存放到一个数组中，然后调用 forEach()方法对数组进行遍历，用 Object.defineProperty()给 this 即 Observer 实例对象添加数组中的每一项属性；\n二、通过 get、set 方法监测数据的操作，一旦 Observer 构造函数的实例对象上的属性被访问，get 函数就会被调用，返回 data 数据中的属性值，同样的 Observer 构造函数的实例对象上的属性被修改了，data 数据中的属性值也实现了修改；这就是 Vue 监测数据变化的原理；\n\n## 注意事项\n\n### 对象\n\nVue 不能监测对象的 Property 的添加和删除，在监测数据变化原理中讲到，在 Vue 初始化实例对象时，会将 data 对象中的属性存到数组中进行遍历，然后调用 Object.defineProperty()给属性添加 get ， set 方法监视 data 对象中属性的变化，因此如果我们在初始化实例对象后，给 Vue 实例添加属性，并不会给添加的属性添加对应的 get、set 方法，导致添加的属性并不是响应式的；如果你还不理解，请看以下示例代码：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    a: 11\n  }\n})\n// vm.a 是响应式的\nvm.b = 22\n// vm.b 是非响应式的\n```\n\n以上代码中的 a 属性在初始化实例对象时就有，因此会生成相对应的 get、set 方法，然而 b 属性是在初始化 vm 实例后添加的属性，因此并没有生成相对于的 set 和 get 方法；导致属性 b 并不是响应式的；\n针对以上问题我们可以使用 Vue.set(object, propertyName, value)或者 vm.$set ( target，propertyName/index，value)方法解决，但是此方法只能给嵌套的对象添加属性，不能给 vm 或 vm 的根数据对象添加响应式属性；\n代码示例如下：\n\n```javascript\n//someObject为嵌套在data数据对象内的一个对象\nVue.set(vm.someObject, 'b', 22)\nvm.$set(this.someObject, 'b', 22)\n```\n\n⚠ 注意：set 方法不能给 vm 或 vm 的根数据对象设置属性，只能给跟数据对象中嵌套的对象设置属性 ❗❗❗\n\n### 数组\n\nVue 不能监测以下数组的变动：1、通过索引号修改数组的对应值，修改后的值不是响应式的；2.通过 length 修改数组长度时，数据不是响应式的；示例如下：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    items: ['a', 'b', 'c']\n  }\n})\nvm.items[1] = 'x' // 不是响应性的\nvm.items.length = 2 // 不是响应性的\n```\n\n为了解决以上通过索引添加的数据不是响应式的，可以使用以下方法解决：\n==1、Vue.set(vm.items, indexOfItem, newValue)==\n==2、vm.$set(vm.items, indexOfItem, newValue)==\n==3、vm.items.splice(indexOfItem, 1, newValue)==\n为了解决通过 length 属性改变数组长度也是响应式的，可以使用以下方法：\n==vm.items.splice(newLength)==\n代码示例如下：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    items: ['a', 'b', 'c']\n  }\n})\nVue.set(vm.items, 0, 'aa') // 响应性的\nvm.$set(vm.items, 0, 'aa') // 响应性的\nvm.items.splice(0, 1, 'aa') //响应性的\n//通过length\nvm.items.splice(2) //响应性的\n```\n\n更详细的信息请查看 Vue.js 官网：[深入理解响应式原理](https://cn.vuejs.org/v2/guide/reactivity.html)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/vue响应式原理.md","raw":"---\ntitle: 深入理解Vue响应式原理\ndescription: Vue响应式原理是Vue最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解Vue的响应式原理；\nheadimg: /images/vue.png\ndate: 2021-07-04\ntags:\n  - Vue\ncategories:\n  - Vue\n---\n\n## 前言\n\nVue 响应式原理是 Vue 最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解 Vue 的响应式原理；\n{% asset_img vue.png %}\n\n## 如何监测数据的变化\n\n要想准确响应数据的变化，首先需要精确及时的监测数据的变化，Vue 检测数据的变化核心还是通过 Object.defineProperty();下面通过实例为大家详细阐述 Vue 检测数据变化的过程，代码示例如下：\n\n```javascript\n<script type=\"text/javascript\" >\n\t\t\tlet data = {\n\t\t\t\tname:'xizhutao',\n\t\t\t\taddress:'安徽',\n\t\t\t}\n\t\t\t//创建一个监视的实例对象，用于监视data中属性的变化\n\t\t\tconst obs = new Observer(data)\n\t\t\tconsole.log(obs)\n\t\t\t//准备一个vm实例对象\n\t\t\tlet vm = {}\n\t\t\tvm._data = data = obs\n\t\t\tfunction Observer(obj){\n\t\t\t\t//汇总对象中所有的属性形成一个数组\n\t\t\t\tconst keys = Object.keys(obj)\n\t\t\t\t//遍历\n\t\t\t\tkeys.forEach((k)=>{\n\t\t\t\t\tObject.defineProperty(this,k,{\n\t\t\t\t\t\tget(){\n\t\t\t\t\t\t\treturn obj[k]\n\t\t\t\t\t\t},\n\t\t\t\t\t\tset(val){\n\t\t\t\t\t\t\tconsole.log(`${k}被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`)\n\t\t\t\t\t\t\tobj[k] = val\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t</script>\n```\n\n以上代码检测数据变化的思路如下：\n一、封装一个 Observer 构造函数，接收一个 data 数据对象，通过 Object.keys()方法，将接收到的数据对象中的属性存放到一个数组中，然后调用 forEach()方法对数组进行遍历，用 Object.defineProperty()给 this 即 Observer 实例对象添加数组中的每一项属性；\n二、通过 get、set 方法监测数据的操作，一旦 Observer 构造函数的实例对象上的属性被访问，get 函数就会被调用，返回 data 数据中的属性值，同样的 Observer 构造函数的实例对象上的属性被修改了，data 数据中的属性值也实现了修改；这就是 Vue 监测数据变化的原理；\n\n## 注意事项\n\n### 对象\n\nVue 不能监测对象的 Property 的添加和删除，在监测数据变化原理中讲到，在 Vue 初始化实例对象时，会将 data 对象中的属性存到数组中进行遍历，然后调用 Object.defineProperty()给属性添加 get ， set 方法监视 data 对象中属性的变化，因此如果我们在初始化实例对象后，给 Vue 实例添加属性，并不会给添加的属性添加对应的 get、set 方法，导致添加的属性并不是响应式的；如果你还不理解，请看以下示例代码：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    a: 11\n  }\n})\n// vm.a 是响应式的\nvm.b = 22\n// vm.b 是非响应式的\n```\n\n以上代码中的 a 属性在初始化实例对象时就有，因此会生成相对应的 get、set 方法，然而 b 属性是在初始化 vm 实例后添加的属性，因此并没有生成相对于的 set 和 get 方法；导致属性 b 并不是响应式的；\n针对以上问题我们可以使用 Vue.set(object, propertyName, value)或者 vm.$set ( target，propertyName/index，value)方法解决，但是此方法只能给嵌套的对象添加属性，不能给 vm 或 vm 的根数据对象添加响应式属性；\n代码示例如下：\n\n```javascript\n//someObject为嵌套在data数据对象内的一个对象\nVue.set(vm.someObject, 'b', 22)\nvm.$set(this.someObject, 'b', 22)\n```\n\n⚠ 注意：set 方法不能给 vm 或 vm 的根数据对象设置属性，只能给跟数据对象中嵌套的对象设置属性 ❗❗❗\n\n### 数组\n\nVue 不能监测以下数组的变动：1、通过索引号修改数组的对应值，修改后的值不是响应式的；2.通过 length 修改数组长度时，数据不是响应式的；示例如下：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    items: ['a', 'b', 'c']\n  }\n})\nvm.items[1] = 'x' // 不是响应性的\nvm.items.length = 2 // 不是响应性的\n```\n\n为了解决以上通过索引添加的数据不是响应式的，可以使用以下方法解决：\n==1、Vue.set(vm.items, indexOfItem, newValue)==\n==2、vm.$set(vm.items, indexOfItem, newValue)==\n==3、vm.items.splice(indexOfItem, 1, newValue)==\n为了解决通过 length 属性改变数组长度也是响应式的，可以使用以下方法：\n==vm.items.splice(newLength)==\n代码示例如下：\n\n```javascript\nvar vm = new Vue({\n  data: {\n    items: ['a', 'b', 'c']\n  }\n})\nVue.set(vm.items, 0, 'aa') // 响应性的\nvm.$set(vm.items, 0, 'aa') // 响应性的\nvm.items.splice(0, 1, 'aa') //响应性的\n//通过length\nvm.items.splice(2) //响应性的\n```\n\n更详细的信息请查看 Vue.js 官网：[深入理解响应式原理](https://cn.vuejs.org/v2/guide/reactivity.html)\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"vue响应式原理","published":1,"updated":"2023-03-14T11:53:24.816Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfe001up5o1dwnk640e","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Vue 响应式原理是 Vue 最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解 Vue 的响应式原理；</p>\n\n\n<h2 id=\"如何监测数据的变化\"><a href=\"#如何监测数据的变化\" class=\"headerlink\" title=\"如何监测数据的变化\"></a>如何监测数据的变化</h2><p>要想准确响应数据的变化，首先需要精确及时的监测数据的变化，Vue 检测数据的变化核心还是通过 Object.defineProperty();下面通过实例为大家详细阐述 Vue 检测数据变化的过程，代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script type=<span class=\"string\">&quot;text/javascript&quot;</span> &gt;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> data = &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;xizhutao&#x27;</span>,</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">address</span>:<span class=\"string\">&#x27;安徽&#x27;</span>,</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//创建一个监视的实例对象，用于监视data中属性的变化</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">const</span> obs = <span class=\"keyword\">new</span> <span class=\"title class_\">Observer</span>(data)</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(obs)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//准备一个vm实例对象</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> vm = &#123;&#125;</span><br><span class=\"line\">\t\t\tvm.<span class=\"property\">_data</span> = data = obs</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">function</span> <span class=\"title function_\">Observer</span>(<span class=\"params\">obj</span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//汇总对象中所有的属性形成一个数组</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">const</span> keys = <span class=\"title class_\">Object</span>.<span class=\"title function_\">keys</span>(obj)</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//遍历</span></span><br><span class=\"line\">\t\t\t\tkeys.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">k</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(<span class=\"variable language_\">this</span>,k,&#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"title function_\">get</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">return</span> obj[k]</span><br><span class=\"line\">\t\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"title function_\">set</span>(<span class=\"params\">val</span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;k&#125;</span>被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`</span>)</span><br><span class=\"line\">\t\t\t\t\t\t\tobj[k] = val</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码检测数据变化的思路如下：<br>一、封装一个 Observer 构造函数，接收一个 data 数据对象，通过 Object.keys()方法，将接收到的数据对象中的属性存放到一个数组中，然后调用 forEach()方法对数组进行遍历，用 Object.defineProperty()给 this 即 Observer 实例对象添加数组中的每一项属性；<br>二、通过 get、set 方法监测数据的操作，一旦 Observer 构造函数的实例对象上的属性被访问，get 函数就会被调用，返回 data 数据中的属性值，同样的 Observer 构造函数的实例对象上的属性被修改了，data 数据中的属性值也实现了修改；这就是 Vue 监测数据变化的原理；</p>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><h3 id=\"对象\"><a href=\"#对象\" class=\"headerlink\" title=\"对象\"></a>对象</h3><p>Vue 不能监测对象的 Property 的添加和删除，在监测数据变化原理中讲到，在 Vue 初始化实例对象时，会将 data 对象中的属性存到数组中进行遍历，然后调用 Object.defineProperty()给属性添加 get ， set 方法监视 data 对象中属性的变化，因此如果我们在初始化实例对象后，给 Vue 实例添加属性，并不会给添加的属性添加对应的 get、set 方法，导致添加的属性并不是响应式的；如果你还不理解，请看以下示例代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">a</span>: <span class=\"number\">11</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// vm.a 是响应式的</span></span><br><span class=\"line\">vm.<span class=\"property\">b</span> = <span class=\"number\">22</span></span><br><span class=\"line\"><span class=\"comment\">// vm.b 是非响应式的</span></span><br></pre></td></tr></table></figure>\n\n<p>以上代码中的 a 属性在初始化实例对象时就有，因此会生成相对应的 get、set 方法，然而 b 属性是在初始化 vm 实例后添加的属性，因此并没有生成相对于的 set 和 get 方法；导致属性 b 并不是响应式的；<br>针对以上问题我们可以使用 Vue.set(object, propertyName, value)或者 vm.$set ( target，propertyName/index，value)方法解决，但是此方法只能给嵌套的对象添加属性，不能给 vm 或 vm 的根数据对象添加响应式属性；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//someObject为嵌套在data数据对象内的一个对象</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">set</span>(vm.<span class=\"property\">someObject</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"number\">22</span>)</span><br><span class=\"line\">vm.$set(<span class=\"variable language_\">this</span>.<span class=\"property\">someObject</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"number\">22</span>)</span><br></pre></td></tr></table></figure>\n\n<p>⚠ 注意：set 方法不能给 vm 或 vm 的根数据对象设置属性，只能给跟数据对象中嵌套的对象设置属性 ❗❗❗</p>\n<h3 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h3><p>Vue 不能监测以下数组的变动：1、通过索引号修改数组的对应值，修改后的值不是响应式的；2.通过 length 修改数组长度时，数据不是响应式的；示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">items</span>: [<span class=\"string\">&#x27;a&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">vm.<span class=\"property\">items</span>[<span class=\"number\">1</span>] = <span class=\"string\">&#x27;x&#x27;</span> <span class=\"comment\">// 不是响应性的</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"property\">length</span> = <span class=\"number\">2</span> <span class=\"comment\">// 不是响应性的</span></span><br></pre></td></tr></table></figure>\n\n<p>为了解决以上通过索引添加的数据不是响应式的，可以使用以下方法解决：<br>==1、Vue.set(vm.items, indexOfItem, newValue)==<br>==2、vm.$set(vm.items, indexOfItem, newValue)==<br>==3、vm.items.splice(indexOfItem, 1, newValue)==<br>为了解决通过 length 属性改变数组长度也是响应式的，可以使用以下方法：<br>==vm.items.splice(newLength)==<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">items</span>: [<span class=\"string\">&#x27;a&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">set</span>(vm.<span class=\"property\">items</span>, <span class=\"number\">0</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">// 响应性的</span></span><br><span class=\"line\">vm.$set(vm.<span class=\"property\">items</span>, <span class=\"number\">0</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">// 响应性的</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"title function_\">splice</span>(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">//响应性的</span></span><br><span class=\"line\"><span class=\"comment\">//通过length</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"title function_\">splice</span>(<span class=\"number\">2</span>) <span class=\"comment\">//响应性的</span></span><br></pre></td></tr></table></figure>\n\n<p>更详细的信息请查看 Vue.js 官网：<a href=\"https://cn.vuejs.org/v2/guide/reactivity.html\">深入理解响应式原理</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Vue 响应式原理是 Vue 最独特的特性之一，当数据模型进行修改时，视图就会进行更新，这使得状态管理简单直接，但是其底层的细节还是需要我们深入学习理解，这样遇到一些问题我们才能快速进行定位，并解决；下面我将带大家由浅入深，逐步理解 Vue 的响应式原理；</p>\n\n\n<h2 id=\"如何监测数据的变化\"><a href=\"#如何监测数据的变化\" class=\"headerlink\" title=\"如何监测数据的变化\"></a>如何监测数据的变化</h2><p>要想准确响应数据的变化，首先需要精确及时的监测数据的变化，Vue 检测数据的变化核心还是通过 Object.defineProperty();下面通过实例为大家详细阐述 Vue 检测数据变化的过程，代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script type=<span class=\"string\">&quot;text/javascript&quot;</span> &gt;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> data = &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;xizhutao&#x27;</span>,</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">address</span>:<span class=\"string\">&#x27;安徽&#x27;</span>,</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//创建一个监视的实例对象，用于监视data中属性的变化</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">const</span> obs = <span class=\"keyword\">new</span> <span class=\"title class_\">Observer</span>(data)</span><br><span class=\"line\">\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(obs)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//准备一个vm实例对象</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">let</span> vm = &#123;&#125;</span><br><span class=\"line\">\t\t\tvm.<span class=\"property\">_data</span> = data = obs</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">function</span> <span class=\"title function_\">Observer</span>(<span class=\"params\">obj</span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//汇总对象中所有的属性形成一个数组</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">const</span> keys = <span class=\"title class_\">Object</span>.<span class=\"title function_\">keys</span>(obj)</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//遍历</span></span><br><span class=\"line\">\t\t\t\tkeys.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">k</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(<span class=\"variable language_\">this</span>,k,&#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"title function_\">get</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"keyword\">return</span> obj[k]</span><br><span class=\"line\">\t\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"title function_\">set</span>(<span class=\"params\">val</span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;k&#125;</span>被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`</span>)</span><br><span class=\"line\">\t\t\t\t\t\t\tobj[k] = val</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p>以上代码检测数据变化的思路如下：<br>一、封装一个 Observer 构造函数，接收一个 data 数据对象，通过 Object.keys()方法，将接收到的数据对象中的属性存放到一个数组中，然后调用 forEach()方法对数组进行遍历，用 Object.defineProperty()给 this 即 Observer 实例对象添加数组中的每一项属性；<br>二、通过 get、set 方法监测数据的操作，一旦 Observer 构造函数的实例对象上的属性被访问，get 函数就会被调用，返回 data 数据中的属性值，同样的 Observer 构造函数的实例对象上的属性被修改了，data 数据中的属性值也实现了修改；这就是 Vue 监测数据变化的原理；</p>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><h3 id=\"对象\"><a href=\"#对象\" class=\"headerlink\" title=\"对象\"></a>对象</h3><p>Vue 不能监测对象的 Property 的添加和删除，在监测数据变化原理中讲到，在 Vue 初始化实例对象时，会将 data 对象中的属性存到数组中进行遍历，然后调用 Object.defineProperty()给属性添加 get ， set 方法监视 data 对象中属性的变化，因此如果我们在初始化实例对象后，给 Vue 实例添加属性，并不会给添加的属性添加对应的 get、set 方法，导致添加的属性并不是响应式的；如果你还不理解，请看以下示例代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">a</span>: <span class=\"number\">11</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// vm.a 是响应式的</span></span><br><span class=\"line\">vm.<span class=\"property\">b</span> = <span class=\"number\">22</span></span><br><span class=\"line\"><span class=\"comment\">// vm.b 是非响应式的</span></span><br></pre></td></tr></table></figure>\n\n<p>以上代码中的 a 属性在初始化实例对象时就有，因此会生成相对应的 get、set 方法，然而 b 属性是在初始化 vm 实例后添加的属性，因此并没有生成相对于的 set 和 get 方法；导致属性 b 并不是响应式的；<br>针对以上问题我们可以使用 Vue.set(object, propertyName, value)或者 vm.$set ( target，propertyName/index，value)方法解决，但是此方法只能给嵌套的对象添加属性，不能给 vm 或 vm 的根数据对象添加响应式属性；<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//someObject为嵌套在data数据对象内的一个对象</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">set</span>(vm.<span class=\"property\">someObject</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"number\">22</span>)</span><br><span class=\"line\">vm.$set(<span class=\"variable language_\">this</span>.<span class=\"property\">someObject</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"number\">22</span>)</span><br></pre></td></tr></table></figure>\n\n<p>⚠ 注意：set 方法不能给 vm 或 vm 的根数据对象设置属性，只能给跟数据对象中嵌套的对象设置属性 ❗❗❗</p>\n<h3 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h3><p>Vue 不能监测以下数组的变动：1、通过索引号修改数组的对应值，修改后的值不是响应式的；2.通过 length 修改数组长度时，数据不是响应式的；示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">items</span>: [<span class=\"string\">&#x27;a&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">vm.<span class=\"property\">items</span>[<span class=\"number\">1</span>] = <span class=\"string\">&#x27;x&#x27;</span> <span class=\"comment\">// 不是响应性的</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"property\">length</span> = <span class=\"number\">2</span> <span class=\"comment\">// 不是响应性的</span></span><br></pre></td></tr></table></figure>\n\n<p>为了解决以上通过索引添加的数据不是响应式的，可以使用以下方法解决：<br>==1、Vue.set(vm.items, indexOfItem, newValue)==<br>==2、vm.$set(vm.items, indexOfItem, newValue)==<br>==3、vm.items.splice(indexOfItem, 1, newValue)==<br>为了解决通过 length 属性改变数组长度也是响应式的，可以使用以下方法：<br>==vm.items.splice(newLength)==<br>代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">data</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">items</span>: [<span class=\"string\">&#x27;a&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">set</span>(vm.<span class=\"property\">items</span>, <span class=\"number\">0</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">// 响应性的</span></span><br><span class=\"line\">vm.$set(vm.<span class=\"property\">items</span>, <span class=\"number\">0</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">// 响应性的</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"title function_\">splice</span>(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"string\">&#x27;aa&#x27;</span>) <span class=\"comment\">//响应性的</span></span><br><span class=\"line\"><span class=\"comment\">//通过length</span></span><br><span class=\"line\">vm.<span class=\"property\">items</span>.<span class=\"title function_\">splice</span>(<span class=\"number\">2</span>) <span class=\"comment\">//响应性的</span></span><br></pre></td></tr></table></figure>\n\n<p>更详细的信息请查看 Vue.js 官网：<a href=\"https://cn.vuejs.org/v2/guide/reactivity.html\">深入理解响应式原理</a></p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"【Vue报错】Object.prototype method ‘hasOwnProperty‘ from target object no-prototype-builtins","description":"no-prototype-builtins规则限制了我们在目标对象上通过原型链使用Object上的方法；下面我将为大家提供解决办法；","headimg":"/images/vue.png","date":"2021-10-13T16:00:00.000Z","_content":"\n## 前言\n\n在判断一个对象中是否有一个属性时，我调用了 Object 对象上的 hasOwnProperty()接口时，控制台报错报错信息如下：\n`Do not  access Object.prototype method 'hasOwnProperty' from target object no-prototype-builtins`,把此错误信息翻译过来是：目标对象没有 Object 原型对象上的方法 hasOwnProperty 的使用权，规则是 no-prototype-builtins；意思就是 no-prototype-builtins 规则限制了我们在目标对象上通过原型链使用 Object 上的方法；下面我将为大家提供解决办法；\n\n## 方法一\n\n```javascript\nlet events = {'some-index': false}\nlet key = 'some-index'\nif (Object.prototype.hasOwnProperty.call(events, key)) {\n  // This would compile without any issue !\n  console.log('The object has the property')\n}\n```\n\n此方法很显然绝对不会出现问题，直接使用 Object.prototype.hasOwnProperty.call(events, key)调用接口，然后用 call 方法改变 this 指向，将 this 指向目标对象，传入要判断的参数 key 就将问题解决；\n\n## 方法二\n\n```javascript\nlet events = {'some-index': false}\nlet key = 'some-index'\nif (!!Object.getOwnPropertyDescriptor(events, key)) {\n  // This would compile without any issue !\n  console.log('The object has the property')\n}\n```\n\n此方法是直接调用了 getOwnPropertyDescriptor(events, key)这个方法也能解决问题；\n\n## 方法三\n\n最后一种是最暴力的方法，直接将 ESlint 的配置项 lintOnSave 改为 false 重新启动以下 VSCode 也能解决问题\n\n```javascript\nconst {defineConfig} = require('@vue/cli-service')\nmodule.exports = defineConfig({\n  transpileDependencies: true,\n  lintOnSave: false\n})\n```\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/vue报错one.md","raw":"---\ntitle: 【Vue报错】Object.prototype method ‘hasOwnProperty‘ from target object no-prototype-builtins\ndescription: no-prototype-builtins规则限制了我们在目标对象上通过原型链使用Object上的方法；下面我将为大家提供解决办法；\nheadimg: /images/vue.png\ndate: 2021-10-14\ntags:\n  - Vue\ncategories:\n  - Vue\n---\n\n## 前言\n\n在判断一个对象中是否有一个属性时，我调用了 Object 对象上的 hasOwnProperty()接口时，控制台报错报错信息如下：\n`Do not  access Object.prototype method 'hasOwnProperty' from target object no-prototype-builtins`,把此错误信息翻译过来是：目标对象没有 Object 原型对象上的方法 hasOwnProperty 的使用权，规则是 no-prototype-builtins；意思就是 no-prototype-builtins 规则限制了我们在目标对象上通过原型链使用 Object 上的方法；下面我将为大家提供解决办法；\n\n## 方法一\n\n```javascript\nlet events = {'some-index': false}\nlet key = 'some-index'\nif (Object.prototype.hasOwnProperty.call(events, key)) {\n  // This would compile without any issue !\n  console.log('The object has the property')\n}\n```\n\n此方法很显然绝对不会出现问题，直接使用 Object.prototype.hasOwnProperty.call(events, key)调用接口，然后用 call 方法改变 this 指向，将 this 指向目标对象，传入要判断的参数 key 就将问题解决；\n\n## 方法二\n\n```javascript\nlet events = {'some-index': false}\nlet key = 'some-index'\nif (!!Object.getOwnPropertyDescriptor(events, key)) {\n  // This would compile without any issue !\n  console.log('The object has the property')\n}\n```\n\n此方法是直接调用了 getOwnPropertyDescriptor(events, key)这个方法也能解决问题；\n\n## 方法三\n\n最后一种是最暴力的方法，直接将 ESlint 的配置项 lintOnSave 改为 false 重新启动以下 VSCode 也能解决问题\n\n```javascript\nconst {defineConfig} = require('@vue/cli-service')\nmodule.exports = defineConfig({\n  transpileDependencies: true,\n  lintOnSave: false\n})\n```\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"vue报错one","published":1,"updated":"2023-03-14T12:12:57.149Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfh001xp5o17c7x5eit","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在判断一个对象中是否有一个属性时，我调用了 Object 对象上的 hasOwnProperty()接口时，控制台报错报错信息如下：<br><code>Do not  access Object.prototype method &#39;hasOwnProperty&#39; from target object no-prototype-builtins</code>,把此错误信息翻译过来是：目标对象没有 Object 原型对象上的方法 hasOwnProperty 的使用权，规则是 no-prototype-builtins；意思就是 no-prototype-builtins 规则限制了我们在目标对象上通过原型链使用 Object 上的方法；下面我将为大家提供解决办法；</p>\n<h2 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> events = &#123;<span class=\"string\">&#x27;some-index&#x27;</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> key = <span class=\"string\">&#x27;some-index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title class_\">Object</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">hasOwnProperty</span>.<span class=\"title function_\">call</span>(events, key)) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// This would compile without any issue !</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;The object has the property&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此方法很显然绝对不会出现问题，直接使用 Object.prototype.hasOwnProperty.call(events, key)调用接口，然后用 call 方法改变 this 指向，将 this 指向目标对象，传入要判断的参数 key 就将问题解决；</p>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> events = &#123;<span class=\"string\">&#x27;some-index&#x27;</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> key = <span class=\"string\">&#x27;some-index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!!<span class=\"title class_\">Object</span>.<span class=\"title function_\">getOwnPropertyDescriptor</span>(events, key)) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// This would compile without any issue !</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;The object has the property&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此方法是直接调用了 getOwnPropertyDescriptor(events, key)这个方法也能解决问题；</p>\n<h2 id=\"方法三\"><a href=\"#方法三\" class=\"headerlink\" title=\"方法三\"></a>方法三</h2><p>最后一种是最暴力的方法，直接将 ESlint 的配置项 lintOnSave 改为 false 重新启动以下 VSCode 也能解决问题</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> &#123;defineConfig&#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;@vue/cli-service&#x27;</span>)</span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">transpileDependencies</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">lintOnSave</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在判断一个对象中是否有一个属性时，我调用了 Object 对象上的 hasOwnProperty()接口时，控制台报错报错信息如下：<br><code>Do not  access Object.prototype method &#39;hasOwnProperty&#39; from target object no-prototype-builtins</code>,把此错误信息翻译过来是：目标对象没有 Object 原型对象上的方法 hasOwnProperty 的使用权，规则是 no-prototype-builtins；意思就是 no-prototype-builtins 规则限制了我们在目标对象上通过原型链使用 Object 上的方法；下面我将为大家提供解决办法；</p>\n<h2 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一\"></a>方法一</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> events = &#123;<span class=\"string\">&#x27;some-index&#x27;</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> key = <span class=\"string\">&#x27;some-index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title class_\">Object</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">hasOwnProperty</span>.<span class=\"title function_\">call</span>(events, key)) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// This would compile without any issue !</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;The object has the property&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此方法很显然绝对不会出现问题，直接使用 Object.prototype.hasOwnProperty.call(events, key)调用接口，然后用 call 方法改变 this 指向，将 this 指向目标对象，传入要判断的参数 key 就将问题解决；</p>\n<h2 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> events = &#123;<span class=\"string\">&#x27;some-index&#x27;</span>: <span class=\"literal\">false</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> key = <span class=\"string\">&#x27;some-index&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!!<span class=\"title class_\">Object</span>.<span class=\"title function_\">getOwnPropertyDescriptor</span>(events, key)) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// This would compile without any issue !</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;The object has the property&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>此方法是直接调用了 getOwnPropertyDescriptor(events, key)这个方法也能解决问题；</p>\n<h2 id=\"方法三\"><a href=\"#方法三\" class=\"headerlink\" title=\"方法三\"></a>方法三</h2><p>最后一种是最暴力的方法，直接将 ESlint 的配置项 lintOnSave 改为 false 重新启动以下 VSCode 也能解决问题</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> &#123;defineConfig&#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;@vue/cli-service&#x27;</span>)</span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"title function_\">defineConfig</span>(&#123;</span><br><span class=\"line\">  <span class=\"attr\">transpileDependencies</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">lintOnSave</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"Vue数据代理的原理","description":"Vue的数据代理的原理是十分重要的，它的学习对我们了解Vue的底层工作原理以及学习Vue具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习Vue的响应式原理；因此本篇文章我将带领大家详细的了解Vue实现数据代理的核心----Object.defineProperty();","headimg":"/images/vue.png","date":"2021-08-03T16:00:00.000Z","_content":"\n## 前言\n\nVue 的数据代理的原理是十分重要的，它的学习对我们了解 Vue 的底层工作原理以及学习 Vue 具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习 Vue 的响应式原理；因此本篇文章我将带领大家详细的了解 Vue 实现数据代理的核心----Object.defineProperty();\n{% asset_img vueproxy1.jpeg %}\n\n## 何为数据代理\n\n首先在讲解 Vue 数据代理的原理之前，我们应该知道什么是数据代理；==数据代理的定义是==：一个对象操作(读写)另一个对象中的属性和方法。定义比较抽象我们可能难以理解，下面我将结合实例向大家讲述什么是数据代理，实例代码如下：\n\n```javascript\n//  数据代理：通过一个对象代理对另一个对象中属性的操作（读/写）\nlet obj = {x: 100}\nlet obj2 = {y: 200}\nObject.defineProperty(obj2, 'x', {\n  get() {\n    return obj.x\n  },\n  set(value) {\n    obj.x = value\n  }\n})\n```\n\n从以上代码上可以看出实现数据代理的核心是使用 Object.defineProperty()方法，当访问 obj2 上的 x 属性时，就会调用 get 方法读取 obj 的属性，当我们修改了 obj2 上 x 属性时，就会调用 set 方法，并且传入修改的值 value 值，将 obj 的 x 属性改为 value；以上我们相当与通过 obj2 对象操作了 obj 对象中的 x 属性，这样便定义中所说的一个对象代理了另一个对象中的属性的操作；\n\n## Vue 中的数据代理\n\n详细大家通过上一节的学习，已经了解了什么是数据代理，下面我将结合下面实例带大家来看看 Vue 中的数据代理；代码示例如下：\n\n```javascript\n <body>\n    <!--\n\t\t\t\t1.Vue中的数据代理：\n\t\t\t\t\t\t\t通过vm对象来代理data对象中属性的操作（读/写）\n\t\t\t\t2.Vue中数据代理的好处：\n\t\t\t\t\t\t\t更加方便的操作data中的数据\n\t\t\t\t3.基本原理：\n\t\t\t\t\t\t\t通过Object.defineProperty()把data对象中所有属性添加到vm上。\n\t\t\t\t\t\t\t为每一个添加到vm上的属性，都指定一个getter/setter。\n\t\t\t\t\t\t\t在getter/setter内部去操作（读/写）data中对应的属性。\n\t\t -->\n    <!-- 准备好一个容器-->\n    <div id=\"root\">\n      <h2>学校名称：{{name}}</h2>\n      <h2>学校地址：{{address}}</h2>\n    </div>\n  </body>\n\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n    let data = {\n      name: 'xizhutao',\n      address: '中国',\n    }\n    const vm = new Vue({\n      el: '#root',\n      data,\n    })\n  </script>\n```\n\n从数据代理的定义上说是一个对象代理了另一个对象的读写操作，因此我们首先要找到 Vue 中的两个对象，其次是哪个对象代理了哪个对象的操作；如下图所示我们在 new Vue()时产生了一个 vm 实例对象，传入的参数内部又有一个 data 对象；\n{% asset_img vueproxy2.png %}\n那么以上两个对象是谁代理谁呢，下面通过控制面板演示是 vm 实例对象代理了 data 对象；首先在控制面板执行以下代码修改 vm 实例对象上的 name 和 address 属性；\n{% asset_img vueproxy3.png %}\n执行完以上代码后我们打开 vue 的调试面板，发现 data 上定义的属性确实变成了我们在 vm 实例上修改的值；即我们通过修改 vm 实例对象上的属性，实现了修改 data 对象的属性，即实现了数据代理，这就是 Vue 中的数据代理；\n{% asset_img vueproxy4.png %}\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/vue数据代理的原理.md","raw":"---\ntitle: Vue数据代理的原理\ndescription: Vue的数据代理的原理是十分重要的，它的学习对我们了解Vue的底层工作原理以及学习Vue具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习Vue的响应式原理；因此本篇文章我将带领大家详细的了解Vue实现数据代理的核心----Object.defineProperty();\nheadimg: /images/vue.png\ndate: 2021-08-04\ntags:\n  - Vue\ncategories:\n  - Vue\n---\n\n## 前言\n\nVue 的数据代理的原理是十分重要的，它的学习对我们了解 Vue 的底层工作原理以及学习 Vue 具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习 Vue 的响应式原理；因此本篇文章我将带领大家详细的了解 Vue 实现数据代理的核心----Object.defineProperty();\n{% asset_img vueproxy1.jpeg %}\n\n## 何为数据代理\n\n首先在讲解 Vue 数据代理的原理之前，我们应该知道什么是数据代理；==数据代理的定义是==：一个对象操作(读写)另一个对象中的属性和方法。定义比较抽象我们可能难以理解，下面我将结合实例向大家讲述什么是数据代理，实例代码如下：\n\n```javascript\n//  数据代理：通过一个对象代理对另一个对象中属性的操作（读/写）\nlet obj = {x: 100}\nlet obj2 = {y: 200}\nObject.defineProperty(obj2, 'x', {\n  get() {\n    return obj.x\n  },\n  set(value) {\n    obj.x = value\n  }\n})\n```\n\n从以上代码上可以看出实现数据代理的核心是使用 Object.defineProperty()方法，当访问 obj2 上的 x 属性时，就会调用 get 方法读取 obj 的属性，当我们修改了 obj2 上 x 属性时，就会调用 set 方法，并且传入修改的值 value 值，将 obj 的 x 属性改为 value；以上我们相当与通过 obj2 对象操作了 obj 对象中的 x 属性，这样便定义中所说的一个对象代理了另一个对象中的属性的操作；\n\n## Vue 中的数据代理\n\n详细大家通过上一节的学习，已经了解了什么是数据代理，下面我将结合下面实例带大家来看看 Vue 中的数据代理；代码示例如下：\n\n```javascript\n <body>\n    <!--\n\t\t\t\t1.Vue中的数据代理：\n\t\t\t\t\t\t\t通过vm对象来代理data对象中属性的操作（读/写）\n\t\t\t\t2.Vue中数据代理的好处：\n\t\t\t\t\t\t\t更加方便的操作data中的数据\n\t\t\t\t3.基本原理：\n\t\t\t\t\t\t\t通过Object.defineProperty()把data对象中所有属性添加到vm上。\n\t\t\t\t\t\t\t为每一个添加到vm上的属性，都指定一个getter/setter。\n\t\t\t\t\t\t\t在getter/setter内部去操作（读/写）data中对应的属性。\n\t\t -->\n    <!-- 准备好一个容器-->\n    <div id=\"root\">\n      <h2>学校名称：{{name}}</h2>\n      <h2>学校地址：{{address}}</h2>\n    </div>\n  </body>\n\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n    let data = {\n      name: 'xizhutao',\n      address: '中国',\n    }\n    const vm = new Vue({\n      el: '#root',\n      data,\n    })\n  </script>\n```\n\n从数据代理的定义上说是一个对象代理了另一个对象的读写操作，因此我们首先要找到 Vue 中的两个对象，其次是哪个对象代理了哪个对象的操作；如下图所示我们在 new Vue()时产生了一个 vm 实例对象，传入的参数内部又有一个 data 对象；\n{% asset_img vueproxy2.png %}\n那么以上两个对象是谁代理谁呢，下面通过控制面板演示是 vm 实例对象代理了 data 对象；首先在控制面板执行以下代码修改 vm 实例对象上的 name 和 address 属性；\n{% asset_img vueproxy3.png %}\n执行完以上代码后我们打开 vue 的调试面板，发现 data 上定义的属性确实变成了我们在 vm 实例上修改的值；即我们通过修改 vm 实例对象上的属性，实现了修改 data 对象的属性，即实现了数据代理，这就是 Vue 中的数据代理；\n{% asset_img vueproxy4.png %}\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"vue数据代理的原理","published":1,"updated":"2023-03-14T11:58:51.988Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfj0022p5o199pj3md2","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Vue 的数据代理的原理是十分重要的，它的学习对我们了解 Vue 的底层工作原理以及学习 Vue 具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习 Vue 的响应式原理；因此本篇文章我将带领大家详细的了解 Vue 实现数据代理的核心—-Object.defineProperty();</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy1.jpeg\" class=\"lazyload\" data-srcset=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy1.jpeg\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"何为数据代理\"><a href=\"#何为数据代理\" class=\"headerlink\" title=\"何为数据代理\"></a>何为数据代理</h2><p>首先在讲解 Vue 数据代理的原理之前，我们应该知道什么是数据代理；==数据代理的定义是==：一个对象操作(读写)另一个对象中的属性和方法。定义比较抽象我们可能难以理解，下面我将结合实例向大家讲述什么是数据代理，实例代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  数据代理：通过一个对象代理对另一个对象中属性的操作（读/写）</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">x</span>: <span class=\"number\">100</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123;<span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;</span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(obj2, <span class=\"string\">&#x27;x&#x27;</span>, &#123;</span><br><span class=\"line\">  <span class=\"title function_\">get</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj.<span class=\"property\">x</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"title function_\">set</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">    obj.<span class=\"property\">x</span> = value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>从以上代码上可以看出实现数据代理的核心是使用 Object.defineProperty()方法，当访问 obj2 上的 x 属性时，就会调用 get 方法读取 obj 的属性，当我们修改了 obj2 上 x 属性时，就会调用 set 方法，并且传入修改的值 value 值，将 obj 的 x 属性改为 value；以上我们相当与通过 obj2 对象操作了 obj 对象中的 x 属性，这样便定义中所说的一个对象代理了另一个对象中的属性的操作；</p>\n<h2 id=\"Vue-中的数据代理\"><a href=\"#Vue-中的数据代理\" class=\"headerlink\" title=\"Vue 中的数据代理\"></a>Vue 中的数据代理</h2><p>详细大家通过上一节的学习，已经了解了什么是数据代理，下面我将结合下面实例带大家来看看 Vue 中的数据代理；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">   &lt;!--</span><br><span class=\"line\">\t\t\t<span class=\"number\">1.</span><span class=\"title class_\">Vue</span>中的数据代理：</span><br><span class=\"line\">\t\t\t\t\t\t通过vm对象来代理data对象中属性的操作（读/写）</span><br><span class=\"line\">\t\t\t<span class=\"number\">2.</span><span class=\"title class_\">Vue</span>中数据代理的好处：</span><br><span class=\"line\">\t\t\t\t\t\t更加方便的操作data中的数据</span><br><span class=\"line\">\t\t\t<span class=\"number\">3.</span>基本原理：</span><br><span class=\"line\">\t\t\t\t\t\t通过<span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>()把data对象中所有属性添加到vm上。</span><br><span class=\"line\">\t\t\t\t\t\t为每一个添加到vm上的属性，都指定一个getter/setter。</span><br><span class=\"line\">\t\t\t\t\t\t在getter/setter内部去操作（读/写）data中对应的属性。</span><br><span class=\"line\">\t --&gt;</span><br><span class=\"line\">   &lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">     <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>学校名称：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">     <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>学校地址：&#123;&#123;address&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">   <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"> &lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"keyword\">let</span> data = &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;xizhutao&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">address</span>: <span class=\"string\">&#x27;中国&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   &#125;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     data,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   &#125;)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"> </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>从数据代理的定义上说是一个对象代理了另一个对象的读写操作，因此我们首先要找到 Vue 中的两个对象，其次是哪个对象代理了哪个对象的操作；如下图所示我们在 new Vue()时产生了一个 vm 实例对象，传入的参数内部又有一个 data 对象；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy2.png\" class=\"lazyload\" data-srcset=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>那么以上两个对象是谁代理谁呢，下面通过控制面板演示是 vm 实例对象代理了 data 对象；首先在控制面板执行以下代码修改 vm 实例对象上的 name 和 address 属性；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy3.png\" class=\"lazyload\" data-srcset=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p>执行完以上代码后我们打开 vue 的调试面板，发现 data 上定义的属性确实变成了我们在 vm 实例上修改的值；即我们通过修改 vm 实例对象上的属性，实现了修改 data 对象的属性，即实现了数据代理，这就是 Vue 中的数据代理；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy4.png\" class=\"lazyload\" data-srcset=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy4.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Vue 的数据代理的原理是十分重要的，它的学习对我们了解 Vue 的底层工作原理以及学习 Vue 具有举足轻重的作用，掌握了数据代理的原理，我们便可以由浅入深，再去学习 Vue 的响应式原理；因此本篇文章我将带领大家详细的了解 Vue 实现数据代理的核心—-Object.defineProperty();</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy1.jpeg\" class=\"\">\n\n<h2 id=\"何为数据代理\"><a href=\"#何为数据代理\" class=\"headerlink\" title=\"何为数据代理\"></a>何为数据代理</h2><p>首先在讲解 Vue 数据代理的原理之前，我们应该知道什么是数据代理；==数据代理的定义是==：一个对象操作(读写)另一个对象中的属性和方法。定义比较抽象我们可能难以理解，下面我将结合实例向大家讲述什么是数据代理，实例代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  数据代理：通过一个对象代理对另一个对象中属性的操作（读/写）</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">x</span>: <span class=\"number\">100</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj2 = &#123;<span class=\"attr\">y</span>: <span class=\"number\">200</span>&#125;</span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(obj2, <span class=\"string\">&#x27;x&#x27;</span>, &#123;</span><br><span class=\"line\">  <span class=\"title function_\">get</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj.<span class=\"property\">x</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"title function_\">set</span>(<span class=\"params\">value</span>) &#123;</span><br><span class=\"line\">    obj.<span class=\"property\">x</span> = value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>从以上代码上可以看出实现数据代理的核心是使用 Object.defineProperty()方法，当访问 obj2 上的 x 属性时，就会调用 get 方法读取 obj 的属性，当我们修改了 obj2 上 x 属性时，就会调用 set 方法，并且传入修改的值 value 值，将 obj 的 x 属性改为 value；以上我们相当与通过 obj2 对象操作了 obj 对象中的 x 属性，这样便定义中所说的一个对象代理了另一个对象中的属性的操作；</p>\n<h2 id=\"Vue-中的数据代理\"><a href=\"#Vue-中的数据代理\" class=\"headerlink\" title=\"Vue 中的数据代理\"></a>Vue 中的数据代理</h2><p>详细大家通过上一节的学习，已经了解了什么是数据代理，下面我将结合下面实例带大家来看看 Vue 中的数据代理；代码示例如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">   &lt;!--</span><br><span class=\"line\">\t\t\t<span class=\"number\">1.</span><span class=\"title class_\">Vue</span>中的数据代理：</span><br><span class=\"line\">\t\t\t\t\t\t通过vm对象来代理data对象中属性的操作（读/写）</span><br><span class=\"line\">\t\t\t<span class=\"number\">2.</span><span class=\"title class_\">Vue</span>中数据代理的好处：</span><br><span class=\"line\">\t\t\t\t\t\t更加方便的操作data中的数据</span><br><span class=\"line\">\t\t\t<span class=\"number\">3.</span>基本原理：</span><br><span class=\"line\">\t\t\t\t\t\t通过<span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>()把data对象中所有属性添加到vm上。</span><br><span class=\"line\">\t\t\t\t\t\t为每一个添加到vm上的属性，都指定一个getter/setter。</span><br><span class=\"line\">\t\t\t\t\t\t在getter/setter内部去操作（读/写）data中对应的属性。</span><br><span class=\"line\">\t --&gt;</span><br><span class=\"line\">   &lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">   <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">     <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>学校名称：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">     <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>学校地址：&#123;&#123;address&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">   <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"> &lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"keyword\">let</span> data = &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">name</span>: <span class=\"string\">&#x27;xizhutao&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">address</span>: <span class=\"string\">&#x27;中国&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   &#125;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">     data,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">   &#125;)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"> </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>从数据代理的定义上说是一个对象代理了另一个对象的读写操作，因此我们首先要找到 Vue 中的两个对象，其次是哪个对象代理了哪个对象的操作；如下图所示我们在 new Vue()时产生了一个 vm 实例对象，传入的参数内部又有一个 data 对象；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy2.png\" class=\"\">\n<p>那么以上两个对象是谁代理谁呢，下面通过控制面板演示是 vm 实例对象代理了 data 对象；首先在控制面板执行以下代码修改 vm 实例对象上的 name 和 address 属性；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy3.png\" class=\"\">\n<p>执行完以上代码后我们打开 vue 的调试面板，发现 data 上定义的属性确实变成了我们在 vm 实例上修改的值；即我们通过修改 vm 实例对象上的属性，实现了修改 data 对象的属性，即实现了数据代理，这就是 Vue 中的数据代理；</p>\n<img src=\"/2021/08/04/vue%E6%95%B0%E6%8D%AE%E4%BB%A3%E7%90%86%E7%9A%84%E5%8E%9F%E7%90%86/vueproxy4.png\" class=\"\">\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"深入理解Vuex的五大模块","description":"vuex是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合Vue.js官网带领大家深入学习Vuex的五大模块；","headimg":"/images/vue.png","date":"2021-11-15T16:00:00.000Z","_content":"\n## 前言\n\n相信大家在学习组件通信时，多个组件之间进行通信，会存在父传子，子传父，兄弟传兄弟等等情况的发生，多个组件互相通信容易造成逻辑混乱，数据不好管理，复用性差的情况，而 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化；总结一句话就是：Vuex 是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合 Vue.js 官网带领大家深入学习 Vuex 的五大模块；\n{% asset_img vuex1.png %}\n\n## state 模块\n\n如上原理图所示，其中的 state 模块是用来定义和存放数据的，如果使用次数不多，可以使用$store.state.数据名去读取 state 中存放的数据；其中的 store 是 Vuex 模块的管理者，无论调用 dispatch 还是 commit 都需要 store。多次使用建议用 mapState 引入，然后在 computed 中用...展开使用，mapState 本身是一个函数，调用传递一个数组，要用哪像直接将名字写到数组里就行，他的返回值是一个对象，对象里存的就是想要用到的数据的计算属性使用：直接写 this.数据名字就行；\n\n## actions 模块\n\nactions 模块用于响应组件中的动作一般代码的逻辑写在 actions 中，比如我需要点击一个按钮 500 毫秒以后提交给下一个模块操作，此时可以给 commit 操作写在一个定时器里面，500 毫秒以后再调用 commit 方法；\n\n## mutations 模块\n\n此模块用于修改 state 模块中的数据，actions 模块调用 commit 方法就能直接将数据传到 mutations 模块中，mutations 模块可以根据收到的数据，直接修改 state 模块中储存的数据；\n\n## getters 模块\n\n此模块用于对 state 的中存储的数据进行加工处理，有点类似于 computed 计算属性；\n\n## store 模块\n\nstore 如上原理图所示，是用于管理其它模块的，在调用 dispatch 和 commit 方法时，都需要使用$store;\n**dispatch**\n{% asset_img vue2.png %}\n**commit**\n{% asset_img vuex3.png %}\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/vux.md","raw":"---\ntitle: 深入理解Vuex的五大模块\ndescription: vuex是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合Vue.js官网带领大家深入学习Vuex的五大模块；\nheadimg: /images/vue.png\ndate: 2021-11-16\ntags:\n  - Vuex\ncategories:\n  - Vuex\n---\n\n## 前言\n\n相信大家在学习组件通信时，多个组件之间进行通信，会存在父传子，子传父，兄弟传兄弟等等情况的发生，多个组件互相通信容易造成逻辑混乱，数据不好管理，复用性差的情况，而 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化；总结一句话就是：Vuex 是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合 Vue.js 官网带领大家深入学习 Vuex 的五大模块；\n{% asset_img vuex1.png %}\n\n## state 模块\n\n如上原理图所示，其中的 state 模块是用来定义和存放数据的，如果使用次数不多，可以使用$store.state.数据名去读取 state 中存放的数据；其中的 store 是 Vuex 模块的管理者，无论调用 dispatch 还是 commit 都需要 store。多次使用建议用 mapState 引入，然后在 computed 中用...展开使用，mapState 本身是一个函数，调用传递一个数组，要用哪像直接将名字写到数组里就行，他的返回值是一个对象，对象里存的就是想要用到的数据的计算属性使用：直接写 this.数据名字就行；\n\n## actions 模块\n\nactions 模块用于响应组件中的动作一般代码的逻辑写在 actions 中，比如我需要点击一个按钮 500 毫秒以后提交给下一个模块操作，此时可以给 commit 操作写在一个定时器里面，500 毫秒以后再调用 commit 方法；\n\n## mutations 模块\n\n此模块用于修改 state 模块中的数据，actions 模块调用 commit 方法就能直接将数据传到 mutations 模块中，mutations 模块可以根据收到的数据，直接修改 state 模块中储存的数据；\n\n## getters 模块\n\n此模块用于对 state 的中存储的数据进行加工处理，有点类似于 computed 计算属性；\n\n## store 模块\n\nstore 如上原理图所示，是用于管理其它模块的，在调用 dispatch 和 commit 方法时，都需要使用$store;\n**dispatch**\n{% asset_img vue2.png %}\n**commit**\n{% asset_img vuex3.png %}\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"vux","published":1,"updated":"2023-03-14T12:24:25.432Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfk0024p5o1f5flbdhk","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>相信大家在学习组件通信时，多个组件之间进行通信，会存在父传子，子传父，兄弟传兄弟等等情况的发生，多个组件互相通信容易造成逻辑混乱，数据不好管理，复用性差的情况，而 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化；总结一句话就是：Vuex 是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合 Vue.js 官网带领大家深入学习 Vuex 的五大模块；</p>\n<img src=\"/2021/11/16/vux/vuex1.png\" class=\"lazyload\" data-srcset=\"/2021/11/16/vux/vuex1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"state-模块\"><a href=\"#state-模块\" class=\"headerlink\" title=\"state 模块\"></a>state 模块</h2><p>如上原理图所示，其中的 state 模块是用来定义和存放数据的，如果使用次数不多，可以使用$store.state.数据名去读取 state 中存放的数据；其中的 store 是 Vuex 模块的管理者，无论调用 dispatch 还是 commit 都需要 store。多次使用建议用 mapState 引入，然后在 computed 中用…展开使用，mapState 本身是一个函数，调用传递一个数组，要用哪像直接将名字写到数组里就行，他的返回值是一个对象，对象里存的就是想要用到的数据的计算属性使用：直接写 this.数据名字就行；</p>\n<h2 id=\"actions-模块\"><a href=\"#actions-模块\" class=\"headerlink\" title=\"actions 模块\"></a>actions 模块</h2><p>actions 模块用于响应组件中的动作一般代码的逻辑写在 actions 中，比如我需要点击一个按钮 500 毫秒以后提交给下一个模块操作，此时可以给 commit 操作写在一个定时器里面，500 毫秒以后再调用 commit 方法；</p>\n<h2 id=\"mutations-模块\"><a href=\"#mutations-模块\" class=\"headerlink\" title=\"mutations 模块\"></a>mutations 模块</h2><p>此模块用于修改 state 模块中的数据，actions 模块调用 commit 方法就能直接将数据传到 mutations 模块中，mutations 模块可以根据收到的数据，直接修改 state 模块中储存的数据；</p>\n<h2 id=\"getters-模块\"><a href=\"#getters-模块\" class=\"headerlink\" title=\"getters 模块\"></a>getters 模块</h2><p>此模块用于对 state 的中存储的数据进行加工处理，有点类似于 computed 计算属性；</p>\n<h2 id=\"store-模块\"><a href=\"#store-模块\" class=\"headerlink\" title=\"store 模块\"></a>store 模块</h2><p>store 如上原理图所示，是用于管理其它模块的，在调用 dispatch 和 commit 方法时，都需要使用$store;<br><strong>dispatch</strong></p>\n<img src=\"/2021/11/16/vux/vue2.png\" class=\"lazyload\" data-srcset=\"/2021/11/16/vux/vue2.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n<p><strong>commit</strong></p>\n<img src=\"/2021/11/16/vux/vuex3.png\" class=\"lazyload\" data-srcset=\"/2021/11/16/vux/vuex3.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>相信大家在学习组件通信时，多个组件之间进行通信，会存在父传子，子传父，兄弟传兄弟等等情况的发生，多个组件互相通信容易造成逻辑混乱，数据不好管理，复用性差的情况，而 Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化；总结一句话就是：Vuex 是用来集中管理组件依赖的数据，很好的解决了组件之间通信麻烦不易维护的缺点；下面我将结合 Vue.js 官网带领大家深入学习 Vuex 的五大模块；</p>\n<img src=\"/2021/11/16/vux/vuex1.png\" class=\"\">\n\n<h2 id=\"state-模块\"><a href=\"#state-模块\" class=\"headerlink\" title=\"state 模块\"></a>state 模块</h2><p>如上原理图所示，其中的 state 模块是用来定义和存放数据的，如果使用次数不多，可以使用$store.state.数据名去读取 state 中存放的数据；其中的 store 是 Vuex 模块的管理者，无论调用 dispatch 还是 commit 都需要 store。多次使用建议用 mapState 引入，然后在 computed 中用…展开使用，mapState 本身是一个函数，调用传递一个数组，要用哪像直接将名字写到数组里就行，他的返回值是一个对象，对象里存的就是想要用到的数据的计算属性使用：直接写 this.数据名字就行；</p>\n<h2 id=\"actions-模块\"><a href=\"#actions-模块\" class=\"headerlink\" title=\"actions 模块\"></a>actions 模块</h2><p>actions 模块用于响应组件中的动作一般代码的逻辑写在 actions 中，比如我需要点击一个按钮 500 毫秒以后提交给下一个模块操作，此时可以给 commit 操作写在一个定时器里面，500 毫秒以后再调用 commit 方法；</p>\n<h2 id=\"mutations-模块\"><a href=\"#mutations-模块\" class=\"headerlink\" title=\"mutations 模块\"></a>mutations 模块</h2><p>此模块用于修改 state 模块中的数据，actions 模块调用 commit 方法就能直接将数据传到 mutations 模块中，mutations 模块可以根据收到的数据，直接修改 state 模块中储存的数据；</p>\n<h2 id=\"getters-模块\"><a href=\"#getters-模块\" class=\"headerlink\" title=\"getters 模块\"></a>getters 模块</h2><p>此模块用于对 state 的中存储的数据进行加工处理，有点类似于 computed 计算属性；</p>\n<h2 id=\"store-模块\"><a href=\"#store-模块\" class=\"headerlink\" title=\"store 模块\"></a>store 模块</h2><p>store 如上原理图所示，是用于管理其它模块的，在调用 dispatch 和 commit 方法时，都需要使用$store;<br><strong>dispatch</strong></p>\n<img src=\"/2021/11/16/vux/vue2.png\" class=\"\">\n<p><strong>commit</strong></p>\n<img src=\"/2021/11/16/vux/vuex3.png\" class=\"\">\n\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"watch 和 computed 的区别","description":"watch 和 computed 是vue实例对象中的两个重要属性，watch是监视属性，用来监视vue实例对象上属性和方法的变化，computed被称为计算属性，可以将data对象中的属性进行计算得到新的属性；由于watch属性监视data对象中的属性变化时，也能拿到data对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；","headimg":"/images/vue.png","date":"2021-08-15T16:00:00.000Z","_content":"\n## 前言\n\nwatch 和 computed 是 vue 实例对象中的两个重要属性，watch 是监视属性，用来监视 vue 实例对象上属性和方法的变化，computed 被称为计算属性，可以将 data 对象中的属性进行计算得到新的属性；由于 watch 属性监视 data 对象中的属性变化时，也能拿到 data 对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；\n\n## watch 实现案例\n\n```javascript\n  <!-- 准备好一个容器-->\n    <div id=\"root\">\n      姓：<input type=\"text\" v-model=\"firstName\" /> <br /><br />\n      名：<input type=\"text\" v-model=\"lastName\" /> <br /><br />\n      全名：<span>{{fullName}}</span> <br /><br />\n    </div>\n  </body>\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n    const vm = new Vue({\n      el: '#root',\n      data: {\n        firstName: '张',\n        lastName: '三',\n        fullName: '张-三',\n      },\n      watch: {\n        firstName(val) {\n          setTimeout(() => {\n            this.fullName = val + '-' + this.lastName\n          }, 1000)\n        },\n        lastName(val) {\n          setTimeout(() => {\n            this.fullName = this.firstName + '-' + val\n          }, 1000)\n        },\n      },\n    })\n  </script>\n```\n\n以上为 watch 通过监视 data 中的 firstName 和 lastName 的变化改变 fullName\n\n## computed 实现案例\n\n```javascript\n<body>\n    <!-- 准备好一个容器-->\n    <div id=\"root\">\n      姓：<input type=\"text\" v-model=\"firstName\" /> <br /><br />\n      名：<input type=\"text\" v-model=\"lastName\" /> <br /><br />\n      全名：<span>{{fullName}}</span> <br /><br />\n    </div>\n  </body>\n\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n\n    const vm = new Vue({\n      el: '#root',\n      data: {\n        firstName: '张',\n        lastName: '三',\n      },\n      computed: {\n        fullName() {\n          return this.firstName + '-' + this.lastName\n        },\n      },\n    })\n```\n\n以上为通过 computed 计算属性实现 fullName 和 firstName、lastName 产生联系；\n\n## 对比\n\n通过对比可以看出，watch 和 computed 都能实现相同的功能，但是首先第一眼看去，computed 计算属性实现的案例明显代码更少更精简；但是 watch 能将 fullName 的变化改成异步；因此对 watch 和 computed 属性做出如下总结：\n1、computed 能完成的功能 watch 也能完成\n2、watch 能完成的功能 computed 不一定能完成，比如 watch 可以进行异步操作；\n📣 注意： 1.所被 Vue 管理的函数，最好写成普通函数，这样 this 的指向才是 vm 或 组件实例对象。 2.所有不被 Vue 所管理的函数（定时器的回调函数、ajax 的回调函数等、Promise 的回调函数），最好写成箭头函数，这样 this 的指向才是 vm 或 组件实例对象。\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/watch和computed的区别.md","raw":"---\ntitle: watch 和 computed 的区别\ndescription: watch 和 computed 是vue实例对象中的两个重要属性，watch是监视属性，用来监视vue实例对象上属性和方法的变化，computed被称为计算属性，可以将data对象中的属性进行计算得到新的属性；由于watch属性监视data对象中的属性变化时，也能拿到data对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；\nheadimg: /images/vue.png\ndate: 2021-08-16\ntags:\n  - Vue\ncategories:\n  - Vue\n---\n\n## 前言\n\nwatch 和 computed 是 vue 实例对象中的两个重要属性，watch 是监视属性，用来监视 vue 实例对象上属性和方法的变化，computed 被称为计算属性，可以将 data 对象中的属性进行计算得到新的属性；由于 watch 属性监视 data 对象中的属性变化时，也能拿到 data 对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；\n\n## watch 实现案例\n\n```javascript\n  <!-- 准备好一个容器-->\n    <div id=\"root\">\n      姓：<input type=\"text\" v-model=\"firstName\" /> <br /><br />\n      名：<input type=\"text\" v-model=\"lastName\" /> <br /><br />\n      全名：<span>{{fullName}}</span> <br /><br />\n    </div>\n  </body>\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n    const vm = new Vue({\n      el: '#root',\n      data: {\n        firstName: '张',\n        lastName: '三',\n        fullName: '张-三',\n      },\n      watch: {\n        firstName(val) {\n          setTimeout(() => {\n            this.fullName = val + '-' + this.lastName\n          }, 1000)\n        },\n        lastName(val) {\n          setTimeout(() => {\n            this.fullName = this.firstName + '-' + val\n          }, 1000)\n        },\n      },\n    })\n  </script>\n```\n\n以上为 watch 通过监视 data 中的 firstName 和 lastName 的变化改变 fullName\n\n## computed 实现案例\n\n```javascript\n<body>\n    <!-- 准备好一个容器-->\n    <div id=\"root\">\n      姓：<input type=\"text\" v-model=\"firstName\" /> <br /><br />\n      名：<input type=\"text\" v-model=\"lastName\" /> <br /><br />\n      全名：<span>{{fullName}}</span> <br /><br />\n    </div>\n  </body>\n\n  <script type=\"text/javascript\">\n    Vue.config.productionTip = false //阻止 vue 在启动时生成生产提示。\n\n    const vm = new Vue({\n      el: '#root',\n      data: {\n        firstName: '张',\n        lastName: '三',\n      },\n      computed: {\n        fullName() {\n          return this.firstName + '-' + this.lastName\n        },\n      },\n    })\n```\n\n以上为通过 computed 计算属性实现 fullName 和 firstName、lastName 产生联系；\n\n## 对比\n\n通过对比可以看出，watch 和 computed 都能实现相同的功能，但是首先第一眼看去，computed 计算属性实现的案例明显代码更少更精简；但是 watch 能将 fullName 的变化改成异步；因此对 watch 和 computed 属性做出如下总结：\n1、computed 能完成的功能 watch 也能完成\n2、watch 能完成的功能 computed 不一定能完成，比如 watch 可以进行异步操作；\n📣 注意： 1.所被 Vue 管理的函数，最好写成普通函数，这样 this 的指向才是 vm 或 组件实例对象。 2.所有不被 Vue 所管理的函数（定时器的回调函数、ajax 的回调函数等、Promise 的回调函数），最好写成箭头函数，这样 this 的指向才是 vm 或 组件实例对象。\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"watch和computed的区别","published":1,"updated":"2023-03-14T12:01:51.268Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfl0028p5o185aafp6v","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>watch 和 computed 是 vue 实例对象中的两个重要属性，watch 是监视属性，用来监视 vue 实例对象上属性和方法的变化，computed 被称为计算属性，可以将 data 对象中的属性进行计算得到新的属性；由于 watch 属性监视 data 对象中的属性变化时，也能拿到 data 对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；</p>\n<h2 id=\"watch-实现案例\"><a href=\"#watch-实现案例\" class=\"headerlink\" title=\"watch 实现案例\"></a>watch 实现案例</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    姓：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;firstName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    名：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;lastName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    全名：<span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">data</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">firstName</span>: <span class=\"string\">&#x27;张&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">lastName</span>: <span class=\"string\">&#x27;三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">fullName</span>: <span class=\"string\">&#x27;张-三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">watch</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"title function_\">firstName</span>(<span class=\"params\">val</span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"variable language_\">this</span>.<span class=\"property\">fullName</span> = val + <span class=\"string\">&#x27;-&#x27;</span> + <span class=\"variable language_\">this</span>.<span class=\"property\">lastName</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;, <span class=\"number\">1000</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"title function_\">lastName</span>(<span class=\"params\">val</span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"variable language_\">this</span>.<span class=\"property\">fullName</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">firstName</span> + <span class=\"string\">&#x27;-&#x27;</span> + val</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;, <span class=\"number\">1000</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  &#125;)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>以上为 watch 通过监视 data 中的 firstName 和 lastName 的变化改变 fullName</p>\n<h2 id=\"computed-实现案例\"><a href=\"#computed-实现案例\" class=\"headerlink\" title=\"computed 实现案例\"></a>computed 实现案例</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    &lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      姓：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;firstName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      名：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;lastName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      全名：<span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">data</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"attr\">firstName</span>: <span class=\"string\">&#x27;张&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"attr\">lastName</span>: <span class=\"string\">&#x27;三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">computed</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"title function_\">fullName</span>(<span class=\"params\"></span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">firstName</span> + <span class=\"string\">&#x27;-&#x27;</span> + <span class=\"variable language_\">this</span>.<span class=\"property\">lastName</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>以上为通过 computed 计算属性实现 fullName 和 firstName、lastName 产生联系；</p>\n<h2 id=\"对比\"><a href=\"#对比\" class=\"headerlink\" title=\"对比\"></a>对比</h2><p>通过对比可以看出，watch 和 computed 都能实现相同的功能，但是首先第一眼看去，computed 计算属性实现的案例明显代码更少更精简；但是 watch 能将 fullName 的变化改成异步；因此对 watch 和 computed 属性做出如下总结：<br>1、computed 能完成的功能 watch 也能完成<br>2、watch 能完成的功能 computed 不一定能完成，比如 watch 可以进行异步操作；<br>📣 注意： 1.所被 Vue 管理的函数，最好写成普通函数，这样 this 的指向才是 vm 或 组件实例对象。 2.所有不被 Vue 所管理的函数（定时器的回调函数、ajax 的回调函数等、Promise 的回调函数），最好写成箭头函数，这样 this 的指向才是 vm 或 组件实例对象。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>watch 和 computed 是 vue 实例对象中的两个重要属性，watch 是监视属性，用来监视 vue 实例对象上属性和方法的变化，computed 被称为计算属性，可以将 data 对象中的属性进行计算得到新的属性；由于 watch 属性监视 data 对象中的属性变化时，也能拿到 data 对象中的属性进行计算；因此产生疑问既然两者都能实现同一功能，两者有什么区别呢？下面将以此疑问为突破点结合实例详述两者的区别；</p>\n<h2 id=\"watch-实现案例\"><a href=\"#watch-实现案例\" class=\"headerlink\" title=\"watch 实现案例\"></a>watch 实现案例</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    姓：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;firstName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    名：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;lastName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    全名：<span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">data</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">firstName</span>: <span class=\"string\">&#x27;张&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">lastName</span>: <span class=\"string\">&#x27;三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">fullName</span>: <span class=\"string\">&#x27;张-三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"attr\">watch</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"title function_\">firstName</span>(<span class=\"params\">val</span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"variable language_\">this</span>.<span class=\"property\">fullName</span> = val + <span class=\"string\">&#x27;-&#x27;</span> + <span class=\"variable language_\">this</span>.<span class=\"property\">lastName</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;, <span class=\"number\">1000</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"title function_\">lastName</span>(<span class=\"params\">val</span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"variable language_\">this</span>.<span class=\"property\">fullName</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">firstName</span> + <span class=\"string\">&#x27;-&#x27;</span> + val</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;, <span class=\"number\">1000</span>)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">  &#125;)</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n\n<p>以上为 watch 通过监视 data 中的 firstName 和 lastName 的变化改变 fullName</p>\n<h2 id=\"computed-实现案例\"><a href=\"#computed-实现案例\" class=\"headerlink\" title=\"computed 实现案例\"></a>computed 实现案例</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    &lt;!-- 准备好一个容器--&gt;</span><br><span class=\"line\">    <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;root&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      姓：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;firstName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      名：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;lastName&quot;</span> /&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">      全名：<span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">  &lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span> <span class=\"comment\">//阻止 vue 在启动时生成生产提示。</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">el</span>: <span class=\"string\">&#x27;#root&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">data</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"attr\">firstName</span>: <span class=\"string\">&#x27;张&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"attr\">lastName</span>: <span class=\"string\">&#x27;三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">computed</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        <span class=\"title function_\">fullName</span>(<span class=\"params\"></span>) &#123;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">          <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">firstName</span> + <span class=\"string\">&#x27;-&#x27;</span> + <span class=\"variable language_\">this</span>.<span class=\"property\">lastName</span></span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">        &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">      &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"language-xml\">    &#125;)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>以上为通过 computed 计算属性实现 fullName 和 firstName、lastName 产生联系；</p>\n<h2 id=\"对比\"><a href=\"#对比\" class=\"headerlink\" title=\"对比\"></a>对比</h2><p>通过对比可以看出，watch 和 computed 都能实现相同的功能，但是首先第一眼看去，computed 计算属性实现的案例明显代码更少更精简；但是 watch 能将 fullName 的变化改成异步；因此对 watch 和 computed 属性做出如下总结：<br>1、computed 能完成的功能 watch 也能完成<br>2、watch 能完成的功能 computed 不一定能完成，比如 watch 可以进行异步操作；<br>📣 注意： 1.所被 Vue 管理的函数，最好写成普通函数，这样 this 的指向才是 vm 或 组件实例对象。 2.所有不被 Vue 所管理的函数（定时器的回调函数、ajax 的回调函数等、Promise 的回调函数），最好写成箭头函数，这样 this 的指向才是 vm 或 组件实例对象。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"Webpack打包优化","description":"此篇文章带大家学习Webpack的优化，让我们的代码在编译/运行时性能更好~","headimg":"/images/webpack.jpeg","date":"2022-04-21T16:00:00.000Z","_content":"\n## 前言\n\n上一篇文章详细讲解了 Webpack 的基础配置，这篇文章将在上一篇的基础上讲解 Webpack 的高级配置，带大家学习 Webpack 的优化，让我们的代码在编译/运行时性能更好~\n\n## 1、提升开发体验\n\n&nbsp;&nbsp;&nbsp;&nbsp;开发时我们运行的代码是经过 webpack 编译后的，所有 css 和 js 合并成了一个文件，并且多了其他代码。此时如果代码运行出错那么提示代码错误位置我们是看不懂的。一旦将来开发代码文件很多，那么很难去发现错误出现在哪里。所以我们需要更加准确的错误提示，来帮助我们更好的开发代码。\n&nbsp;&nbsp;&nbsp;&nbsp;SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案。它会生成一个 xxx.map 文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过 xxx.map 文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快的找到错误根源;\n1、开发模式下的配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  mode: 'development',\n  devtool: 'cheap-module-source-map'\n}\n```\n\n开发模式下打包速度快，只包含行映射不包含列映射；\n2、生产模式下的配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  mode: 'production',\n  devtool: 'source-map'\n}\n```\n\n## 2、提升打包构建速度\n\n### 2.1 HotModuleReplacement\n\n开发时我们修改了其中一个模块代码，Webpack 默认会将所有模块全部重新打包编译，速度很慢。所以我们需要做到修改某个模块代码，就只有这个模块代码需要重新打包编译，其他模块不变，这样打包速度就能很快;HotModuleReplacement（HMR/热模块替换）：在程序运行中，替换、添加或删除模块，而无需重新加载整个页面。\n1、基本配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  devServer: {\n    host: 'localhost', // 启动服务器域名\n    port: '3000', // 启动服务器端口号\n    open: true, // 是否自动打开浏览器\n    hot: true // 开启HMR功能（只能用于开发环境，生产环境不需要了）\n  }\n}\n```\n\n开启热模替换后，实际开发配合[Vue-loader](https://github.com/vuejs/vue-loader) 插件进行配置\n\n### 2.2 oneOf\n\n打包时每个文件都会经过所有 loader 处理，虽然因为 test 正则原因实际没有处理上，但是都要过一遍，比较慢。如果想要提升效率，就要只匹配一次，即匹配上了就不再往下匹配；\n配置代码如下:\n\n```javascript\n module: {\n    rules: [\n      {\n        oneOf: [\n          {\n            // 用来匹配 .css 结尾的文件\n            test: /\\.css$/,\n            // use 数组里面 Loader 执行顺序是从右到左\n            use: [\"style-loader\", \"css-loader\"],\n          },\n          {\n            test: /\\.less$/,\n            use: [\"style-loader\", \"css-loader\", \"less-loader\"],\n          },\n          {\n            test: /\\.s[ac]ss$/,\n            use: [\"style-loader\", \"css-loader\", \"sass-loader\"],\n          },\n          {\n            test: /\\.styl$/,\n            use: [\"style-loader\", \"css-loader\", \"stylus-loader\"],\n          },\n          {\n            test: /\\.(png|jpe?g|gif|webp)$/,\n            type: \"asset\",\n            parser: {\n              dataUrlCondition: {\n                maxSize: 10 * 1024, // 小于10kb的图片会被base64处理\n              },\n            },\n            generator: {\n              // 将图片文件输出到 static/imgs 目录中\n              // 将图片文件命名 [hash:8][ext][query]\n              // [hash:8]: hash值取8位\n              // [ext]: 使用之前的文件扩展名\n              // [query]: 添加之前的query参数\n              filename: \"static/imgs/[hash:8][ext][query]\",\n            },\n          },\n          {\n            test: /\\.(ttf|woff2?)$/,\n            type: \"asset/resource\",\n            generator: {\n              filename: \"static/media/[hash:8][ext][query]\",\n            },\n          },\n          {\n            test: /\\.js$/,\n            exclude: /node_modules/, // 排除node_modules代码不编译\n            loader: \"babel-loader\",\n          },\n        ],\n      },\n    ],\n  },\n```\n\n### 2.3 Include/Exclude\n\n开发时我们需要使用第三方的库或插件，所有文件都下载到 node_modules 中了。而这些文件是不需要编译可以直接使用的。所以我们在对 js 文件处理时，要排除 node_modules 下面的文件;\n配置代码如下：\n**babel 编译：**\n\n```javascript\n{\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, \"../src\"), // 也可以用包含\n            loader: \"babel-loader\",\n          },\n```\n\n**eslint 检查：**\n\n```javascript\nnew ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"../src\"),\n      exclude: \"node_modules\", // 默认值\n    }),\n```\n\n### 2.4 Cache\n\n每次打包时 js 文件都要经过 Eslint 检查 和 Babel 编译，速度比较慢。我们可以缓存之前的 Eslint 检查 和 Babel 编译结果，这样第二次打包时速度就会更快了。\n**js 编译**\n\n```javascript\n{\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, \"../src\"), // 也可以用包含\n            loader: \"babel-loader\",\n            options: {\n              cacheDirectory: true, // 开启babel编译缓存\n              cacheCompression: false, // 缓存文件不要压缩\n            },\n          },\n```\n\n**eslint 检查**\n\n```javascript\nnew ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"../src\"),\n      exclude: \"node_modules\", // 默认值\n      cache: true, // 开启缓存\n      // 缓存目录\n      cacheLocation: path.resolve(\n        __dirname,\n        \"../node_modules/.cache/.eslintcache\"\n      ),\n    }),\n```\n\n### 2.5 Thead\n\n当项目越来越庞大时，打包速度越来越慢，甚至于需要一个下午才能打包出来代码。这个速度是比较慢的。我们想要继续提升打包速度，其实就是要提升 js 的打包速度，因为其他文件都比较少。而对 js 文件处理主要就是 eslint 、babel、Terser 三个工具，所以我们要提升它们的运行速度。我们可以开启多进程同时处理 js 文件，这样速度就比之前的单进程打包更快了。\n1、获取 cpu 核数\n\n```javascript\n// nodejs核心模块，直接使用\nconst os = require('os')\n// cpu核数\nconst threads = os.cpus().length\n```\n\n2、下载包\n\n```javascript\nnpm i thread-loader -D\n```\n\n3、配置\n\n```javascript\nconst os = require('os')\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin')\nconst CssMinimizerPlugin = require('css-minimizer-webpack-plugin')\nconst TerserPlugin = require('terser-webpack-plugin')\n\n// cpu核数\nconst threads = os.cpus().length\n\n// 获取处理样式的Loaders\nconst getStyleLoaders = (preProcessor) => {\n  return [\n    MiniCssExtractPlugin.loader,\n    'css-loader',\n    {\n      loader: 'postcss-loader',\n      options: {\n        postcssOptions: {\n          plugins: [\n            'postcss-preset-env' // 能解决大多数样式兼容性问题\n          ]\n        }\n      }\n    },\n    preProcessor\n  ].filter(Boolean)\n}\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, '../dist'), // 生产模式需要输出\n    filename: 'static/js/main.js', // 将 js 文件输出到 static/js 目录中\n    clean: true\n  },\n  module: {\n    rules: [\n      {\n        oneOf: [\n          {\n            // 用来匹配 .css 结尾的文件\n            test: /\\.css$/,\n            // use 数组里面 Loader 执行顺序是从右到左\n            use: getStyleLoaders()\n          },\n          {\n            test: /\\.less$/,\n            use: getStyleLoaders('less-loader')\n          },\n          {\n            test: /\\.s[ac]ss$/,\n            use: getStyleLoaders('sass-loader')\n          },\n          {\n            test: /\\.styl$/,\n            use: getStyleLoaders('stylus-loader')\n          },\n          {\n            test: /\\.(png|jpe?g|gif|webp)$/,\n            type: 'asset',\n            parser: {\n              dataUrlCondition: {\n                maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n              }\n            },\n            generator: {\n              // 将图片文件输出到 static/imgs 目录中\n              // 将图片文件命名 [hash:8][ext][query]\n              // [hash:8]: hash值取8位\n              // [ext]: 使用之前的文件扩展名\n              // [query]: 添加之前的query参数\n              filename: 'static/imgs/[hash:8][ext][query]'\n            }\n          },\n          {\n            test: /\\.(ttf|woff2?)$/,\n            type: 'asset/resource',\n            generator: {\n              filename: 'static/media/[hash:8][ext][query]'\n            }\n          },\n          {\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, '../src'), // 也可以用包含\n            use: [\n              {\n                loader: 'thread-loader', // 开启多进程\n                options: {\n                  workers: threads // 数量\n                }\n              },\n              {\n                loader: 'babel-loader',\n                options: {\n                  cacheDirectory: true // 开启babel编译缓存\n                }\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src'),\n      exclude: 'node_modules', // 默认值\n      cache: true, // 开启缓存\n      // 缓存目录\n      cacheLocation: path.resolve(__dirname, '../node_modules/.cache/.eslintcache'),\n      threads // 开启多进程\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    }),\n    // 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: 'static/css/main.css'\n    })\n    // css压缩\n    // new CssMinimizerPlugin(),\n  ],\n  optimization: {\n    minimize: true,\n    minimizer: [\n      // css压缩也可以写到optimization.minimizer里面，效果一样的\n      new CssMinimizerPlugin(),\n      // 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了\n      new TerserPlugin({\n        parallel: threads // 开启多进程\n      })\n    ]\n  },\n  // devServer: {\n  //   host: \"localhost\", // 启动服务器域名\n  //   port: \"3000\", // 启动服务器端口号\n  //   open: true, // 是否自动打开浏览器\n  // },\n  mode: 'production',\n  devtool: 'source-map'\n}\n```\n\n注意 📣：==请仅在特别耗时的操作中使用，因为每个进程启动就有大约为 600ms 左右开销==。❗❗❗❗❗❗\n\n## 3、减少代码体积\n\n### 3.1 TreeShaking\n\n&nbsp;&nbsp;&nbsp;&nbsp;开发时我们定义了一些工具函数库，或者引用第三方工具函数库或组件库。如果没有特殊处理的话我们打包时会引入整个库，但是实际上可能我们可能只用上极小部分的功能。这样将整个库都打包进来，体积就太大了。\n&nbsp;&nbsp;&nbsp;&nbsp;Tree Shaking 是一个术语，通常用于描述移除 JavaScript 中的没有使用上的代码,Webpack 已经默认开启了这个功能，无需其他配置。\n\n### 3.2 Babel\n\nBabel 为编译的每个文件都插入了辅助代码，使代码体积过大！Babel 对一些公共方法使用了非常小的辅助代码，比如 \\_extend。默认情况下会被添加到每一个需要它的文件中。你可以将这些辅助代码作为一个独立模块，来避免重复引入。\n@babel/plugin-transform-runtime: 禁用了 Babel 自动对每个文件的 runtime 注入，而是引入 @babel/plugin-transform-runtime 并且使所有辅助代码从这里引用;\n1、下载包\n\n```javascript\nnpm i @babel/plugin-transform-runtime -D\n```\n\n2、配置\n\n```javascript\n {\n                loader: \"babel-loader\",\n                options: {\n                  cacheDirectory: true, // 开启babel编译缓存\n                  cacheCompression: false, // 缓存文件不要压缩\n                  plugins: [\"@babel/plugin-transform-runtime\"], // 减少代码体积\n                },\n              },\n```\n\n### 3.3 Image Minimizer\n\n开发如果项目中引用了较多图片，那么图片体积会比较大，将来请求速度比较慢。我们可以对图片进行压缩，减少图片体积。\n1、下载插件\n\n```javascript\nnpm i image-minimizer-webpack-plugin imagemin -D\n```\n\n2、无损压缩下载如下包\n\n```javascript\nnpm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D\n```\n\n3、有损压缩\n\n```javascript\nnpm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo -D\n```\n\n4、以无损压缩进行示例配置\n\n```javascript\n// 压缩图片\n      new ImageMinimizerPlugin({\n        minimizer: {\n          implementation: ImageMinimizerPlugin.imageminGenerate,\n          options: {\n            plugins: [\n              [\"gifsicle\", { interlaced: true }],\n              [\"jpegtran\", { progressive: true }],\n              [\"optipng\", { optimizationLevel: 5 }],\n              [\n                \"svgo\",\n                {\n                  plugins: [\n                    \"preset-default\",\n                    \"prefixIds\",\n                    {\n                      name: \"sortAttrs\",\n                      params: {\n                        xmlnsOrder: \"alphabetical\",\n                      },\n                    },\n                  ],\n                },\n              ],\n            ],\n          },\n        },\n      }),\n```\n\n注意：📣== 如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩 ❗❗❗\n\n## 4、优化代码运行性能\n\n### 4.1 Code Split\n\n&nbsp;&nbsp;&nbsp;&nbsp;打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快；\n&nbsp;&nbsp;&nbsp;&nbsp;代码分割（Code Split）主要做了两件事：1、分割文件：将打包生成的文件进行分割，生成多个 js 文件。2、按需加载：需要哪个文件就加载哪个文件；\nspa 单页面应用的配置如下：\n\n```javascript\noptimization: {\n    // 代码分割配置\n    splitChunks: {\n      chunks: \"all\", // 对所有模块都进行分割\n      // 以下是默认值\n      // minSize: 20000, // 分割代码最小的大小\n      // minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0\n      // minChunks: 1, // 至少被引用的次数，满足条件才会代码分割\n      // maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量\n      // maxInitialRequests: 30, // 入口js文件最大并行请求数量\n      // enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）\n      // cacheGroups: { // 组，哪些模块要打包到一个组\n      //   defaultVendors: { // 组名\n      //     test: /[\\\\/]node_modules[\\\\/]/, // 需要打包到一起的模块\n      //     priority: -10, // 权重（越大越高）\n      //     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块\n      //   },\n      //   default: { // 其他没有写的配置会使用上面的默认值\n      //     minChunks: 2, // 这里的minChunks权重更大\n      //     priority: -20,\n      //     reuseExistingChunk: true,\n      //   },\n      // },\n  },\n```\n\n以上注释的都是默认配置，不需要另外配置；\n\n### 4.2 Preload / Prefetch\n\n&nbsp;&nbsp;&nbsp;&nbsp;我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。\n**两者都能预加载资源有缓存，但是存在兼容性问题**\n1、下载插件\n\n```javascript\nnpm i @vue/preload-webpack-plugin -D\n```\n\n2、配置\n\n```javascript\n new PreloadWebpackPlugin({\n      rel: \"preload\", // preload兼容性更好\n      as: \"script\",\n      // rel: 'prefetch' // prefetch兼容性更差\n    }),\n```\n\n### 4.3 Network Cache\n\n将来开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了。\n**配置：**\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"../dist\"), // 生产模式需要输出\n    // [contenthash:8]使用contenthash，取8位长度\n    filename: \"static/js/[name].[contenthash:8].js\", // 入口文件打包输出资源命名方式\n    chunkFilename: \"static/js/[name].[contenthash:8].chunk.js\", // 动态导入输出资源命名方式\n    assetModuleFilename: \"static/media/[name].[hash][ext]\", // 图片、字体等资源命名方式（注意用hash）\n    clean: true,\n  },\n```\n\n```javascript\n// 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: \"static/css/[name].[contenthash:8].css\",\n      chunkFilename: \"static/css/[name].[contenthash:8].chunk.css\",\n    }),\n```\n\n**以上配置出现的问题：**\n当我们修改 math.js 文件再重新打包的时候，因为 contenthash 原因，math.js 文件 hash 值发生了变化（这是正常的）。但是 main.js 文件的 hash 值也发生了变化，这会导致 main.js 的缓存失效。明明我们只修改 math.js, 为什么 main.js 也会变身变化呢？\n**原因分析：**\n更新前：math.xxx.js, main.js 引用的 math.xxx.js\n更新后：math.yyy.js, main.js 引用的 math.yyy.js, 文件名发生了变化，间接导致 main.js 也发生了变化\n**解决办法：**\n将 hash 值单独保管在一个 runtime 文件中。我们最终输出三个文件：main、math、runtime。当 math 文件发送变化，变化的是 math 和 runtime 文件，main 不变。runtime 文件只保存文件的 hash 值和它们与文件关系，整个文件体积就比较小，所以变化重新请求的代价也小。\n**添加配置如下：**\n\n```javascript\n // 提取runtime文件\n    runtimeChunk: {\n      name: (entrypoint) => `runtime~${entrypoint.name}`, // runtime文件命名规则\n    },\n```\n\n### 4.4 Core-js\n\n&nbsp;&nbsp;&nbsp;&nbsp;过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel/preset-env 智能预设来处理兼容性问题。它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决；\n&nbsp;&nbsp;&nbsp;&nbsp;core-js 是专门用来做 ES6 以及以上 API 的 polyfill。polyfill 翻译过来叫做垫片/补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性；\n1、下载包\n\n```javascript\nnpm i @babel/eslint-parser -D\n```\n\n2、在.eslintrc.js 配置\n\n```javascript\nparser: \"@babel/eslint-parser\", // 支持最新的最终 ECMAScript 标准\n```\n\n3、下载 corejs 包\n\n```javascript\nnpm i core-js\n```\n\n4、在 babel.config.js 中配置\n\n```javascript\nmodule.exports = {\n  // 智能预设：能够编译ES6语法\n  presets: [\n    [\n      '@babel/preset-env',\n      // 按需加载core-js的polyfill\n      {useBuiltIns: 'usage', corejs: {version: '3', proposals: true}}\n    ]\n  ]\n}\n```\n\n### 4.5 PWA\n\n开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。我们希望给项目提供离线体验。渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。其中最重要的是，在 离线(offline) 时应用程序能够继续运行功能。内部通过 Service Workers 技术实现的。\n1、下载包\n\n```javascript\nnpm i workbox-webpack-plugin -D\n```\n\n2、配置插件\n\n```javascript\nnew WorkboxPlugin.GenerateSW({\n      // 这些选项帮助快速启用 ServiceWorkers\n      // 不允许遗留任何“旧的” ServiceWorkers\n      clientsClaim: true,\n      skipWaiting: true,\n    }),\n```\n\n3、问题\n此时如果直接通过 VSCode 访问打包后页面，在浏览器控制台会发现 SW registration failed。因为我们打开的访问路径是：http://127.0.0.1:5500/dist/index.html。此时页面会去请求 service-worker.js 文件，请求路径是：http://127.0.0.1:5500/service-worker.js，这样找不到会 404。实际 service-worker.js 文件路径是：http://127.0.0.1:5500/dist/service-worker.js。\n4、解决办法\n4.1 下载包\n\n```javascript\nnpm i serve -g\n```\n\n4.2 运行指令\n\n```javascript\nserve dist\n```\n\n## 总结\n\n我们从 4 个角度对 webpack 和代码进行了优化：\n**1、提升开发体验**\n使用 Source Map 让开发或上线时代码报错能有更加准确的错误提示。\n**2、提升 webpack 提升打包构建速度**\n使用 HotModuleReplacement 让开发时只重新编译打包更新变化了的代码，不变的代码使用缓存，从而使更新速度更快。\n使用 OneOf 让资源文件一旦被某个 loader 处理了，就不会继续遍历了，打包速度更快。\n使用 Include/Exclude 排除或只检测某些文件，处理的文件更少，速度更快。\n使用 Cache 对 eslint 和 babel 处理的结果进行缓存，让第二次打包速度更快。\n使用 Thead 多进程处理 eslint 和 babel 任务，速度更快。（需要注意的是，进程启动通信都有开销的，要在比较多代码处理时使用才有效果）\n**3、减少代码体积**\n使用 Tree Shaking 剔除了没有使用的多余代码，让代码体积更小。\n使用 @babel/plugin-transform-runtime 插件对 babel 进行处理，让辅助代码从中引入，而不是每个文件都生成辅助代码，从而体积更小。\n使用 Image Minimizer 对项目中图片进行压缩，体积更小，请求速度更快。（需要注意的是，如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。）\n**4、优化代码运行性能**\n使用 Code Split 对代码进行分割成多个 js 文件，从而使单个文件体积更小，并行加载 js 速度更快。并通过 import 动态导入语法进行按需加载，从而达到需要使用时才加载该资源，不用时不加载资源。\n使用 Preload / Prefetch 对代码进行提前加载，等未来需要使用时就能直接使用，从而用户体验更好。\n使用 Network Cache 能对输出资源文件进行更好的命名，将来好做缓存，从而用户体验更好。\n使用 Core-js 对 js 进行兼容性处理，让我们代码能运行在低版本浏览器。\n使用 PWA 能让代码离线也能访问，从而提升用户体验。\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/webpack-opt.md","raw":"---\ntitle: Webpack打包优化\ndescription: 此篇文章带大家学习Webpack的优化，让我们的代码在编译/运行时性能更好~\nheadimg: /images/webpack.jpeg\ndate: 2022-04-22\ntags:\n  - Webpack\ncategories:\n  - Webpack\n---\n\n## 前言\n\n上一篇文章详细讲解了 Webpack 的基础配置，这篇文章将在上一篇的基础上讲解 Webpack 的高级配置，带大家学习 Webpack 的优化，让我们的代码在编译/运行时性能更好~\n\n## 1、提升开发体验\n\n&nbsp;&nbsp;&nbsp;&nbsp;开发时我们运行的代码是经过 webpack 编译后的，所有 css 和 js 合并成了一个文件，并且多了其他代码。此时如果代码运行出错那么提示代码错误位置我们是看不懂的。一旦将来开发代码文件很多，那么很难去发现错误出现在哪里。所以我们需要更加准确的错误提示，来帮助我们更好的开发代码。\n&nbsp;&nbsp;&nbsp;&nbsp;SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案。它会生成一个 xxx.map 文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过 xxx.map 文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快的找到错误根源;\n1、开发模式下的配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  mode: 'development',\n  devtool: 'cheap-module-source-map'\n}\n```\n\n开发模式下打包速度快，只包含行映射不包含列映射；\n2、生产模式下的配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  mode: 'production',\n  devtool: 'source-map'\n}\n```\n\n## 2、提升打包构建速度\n\n### 2.1 HotModuleReplacement\n\n开发时我们修改了其中一个模块代码，Webpack 默认会将所有模块全部重新打包编译，速度很慢。所以我们需要做到修改某个模块代码，就只有这个模块代码需要重新打包编译，其他模块不变，这样打包速度就能很快;HotModuleReplacement（HMR/热模块替换）：在程序运行中，替换、添加或删除模块，而无需重新加载整个页面。\n1、基本配置：\n\n```javascript\nmodule.exports = {\n  // 其他省略\n  devServer: {\n    host: 'localhost', // 启动服务器域名\n    port: '3000', // 启动服务器端口号\n    open: true, // 是否自动打开浏览器\n    hot: true // 开启HMR功能（只能用于开发环境，生产环境不需要了）\n  }\n}\n```\n\n开启热模替换后，实际开发配合[Vue-loader](https://github.com/vuejs/vue-loader) 插件进行配置\n\n### 2.2 oneOf\n\n打包时每个文件都会经过所有 loader 处理，虽然因为 test 正则原因实际没有处理上，但是都要过一遍，比较慢。如果想要提升效率，就要只匹配一次，即匹配上了就不再往下匹配；\n配置代码如下:\n\n```javascript\n module: {\n    rules: [\n      {\n        oneOf: [\n          {\n            // 用来匹配 .css 结尾的文件\n            test: /\\.css$/,\n            // use 数组里面 Loader 执行顺序是从右到左\n            use: [\"style-loader\", \"css-loader\"],\n          },\n          {\n            test: /\\.less$/,\n            use: [\"style-loader\", \"css-loader\", \"less-loader\"],\n          },\n          {\n            test: /\\.s[ac]ss$/,\n            use: [\"style-loader\", \"css-loader\", \"sass-loader\"],\n          },\n          {\n            test: /\\.styl$/,\n            use: [\"style-loader\", \"css-loader\", \"stylus-loader\"],\n          },\n          {\n            test: /\\.(png|jpe?g|gif|webp)$/,\n            type: \"asset\",\n            parser: {\n              dataUrlCondition: {\n                maxSize: 10 * 1024, // 小于10kb的图片会被base64处理\n              },\n            },\n            generator: {\n              // 将图片文件输出到 static/imgs 目录中\n              // 将图片文件命名 [hash:8][ext][query]\n              // [hash:8]: hash值取8位\n              // [ext]: 使用之前的文件扩展名\n              // [query]: 添加之前的query参数\n              filename: \"static/imgs/[hash:8][ext][query]\",\n            },\n          },\n          {\n            test: /\\.(ttf|woff2?)$/,\n            type: \"asset/resource\",\n            generator: {\n              filename: \"static/media/[hash:8][ext][query]\",\n            },\n          },\n          {\n            test: /\\.js$/,\n            exclude: /node_modules/, // 排除node_modules代码不编译\n            loader: \"babel-loader\",\n          },\n        ],\n      },\n    ],\n  },\n```\n\n### 2.3 Include/Exclude\n\n开发时我们需要使用第三方的库或插件，所有文件都下载到 node_modules 中了。而这些文件是不需要编译可以直接使用的。所以我们在对 js 文件处理时，要排除 node_modules 下面的文件;\n配置代码如下：\n**babel 编译：**\n\n```javascript\n{\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, \"../src\"), // 也可以用包含\n            loader: \"babel-loader\",\n          },\n```\n\n**eslint 检查：**\n\n```javascript\nnew ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"../src\"),\n      exclude: \"node_modules\", // 默认值\n    }),\n```\n\n### 2.4 Cache\n\n每次打包时 js 文件都要经过 Eslint 检查 和 Babel 编译，速度比较慢。我们可以缓存之前的 Eslint 检查 和 Babel 编译结果，这样第二次打包时速度就会更快了。\n**js 编译**\n\n```javascript\n{\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, \"../src\"), // 也可以用包含\n            loader: \"babel-loader\",\n            options: {\n              cacheDirectory: true, // 开启babel编译缓存\n              cacheCompression: false, // 缓存文件不要压缩\n            },\n          },\n```\n\n**eslint 检查**\n\n```javascript\nnew ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"../src\"),\n      exclude: \"node_modules\", // 默认值\n      cache: true, // 开启缓存\n      // 缓存目录\n      cacheLocation: path.resolve(\n        __dirname,\n        \"../node_modules/.cache/.eslintcache\"\n      ),\n    }),\n```\n\n### 2.5 Thead\n\n当项目越来越庞大时，打包速度越来越慢，甚至于需要一个下午才能打包出来代码。这个速度是比较慢的。我们想要继续提升打包速度，其实就是要提升 js 的打包速度，因为其他文件都比较少。而对 js 文件处理主要就是 eslint 、babel、Terser 三个工具，所以我们要提升它们的运行速度。我们可以开启多进程同时处理 js 文件，这样速度就比之前的单进程打包更快了。\n1、获取 cpu 核数\n\n```javascript\n// nodejs核心模块，直接使用\nconst os = require('os')\n// cpu核数\nconst threads = os.cpus().length\n```\n\n2、下载包\n\n```javascript\nnpm i thread-loader -D\n```\n\n3、配置\n\n```javascript\nconst os = require('os')\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin')\nconst CssMinimizerPlugin = require('css-minimizer-webpack-plugin')\nconst TerserPlugin = require('terser-webpack-plugin')\n\n// cpu核数\nconst threads = os.cpus().length\n\n// 获取处理样式的Loaders\nconst getStyleLoaders = (preProcessor) => {\n  return [\n    MiniCssExtractPlugin.loader,\n    'css-loader',\n    {\n      loader: 'postcss-loader',\n      options: {\n        postcssOptions: {\n          plugins: [\n            'postcss-preset-env' // 能解决大多数样式兼容性问题\n          ]\n        }\n      }\n    },\n    preProcessor\n  ].filter(Boolean)\n}\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, '../dist'), // 生产模式需要输出\n    filename: 'static/js/main.js', // 将 js 文件输出到 static/js 目录中\n    clean: true\n  },\n  module: {\n    rules: [\n      {\n        oneOf: [\n          {\n            // 用来匹配 .css 结尾的文件\n            test: /\\.css$/,\n            // use 数组里面 Loader 执行顺序是从右到左\n            use: getStyleLoaders()\n          },\n          {\n            test: /\\.less$/,\n            use: getStyleLoaders('less-loader')\n          },\n          {\n            test: /\\.s[ac]ss$/,\n            use: getStyleLoaders('sass-loader')\n          },\n          {\n            test: /\\.styl$/,\n            use: getStyleLoaders('stylus-loader')\n          },\n          {\n            test: /\\.(png|jpe?g|gif|webp)$/,\n            type: 'asset',\n            parser: {\n              dataUrlCondition: {\n                maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n              }\n            },\n            generator: {\n              // 将图片文件输出到 static/imgs 目录中\n              // 将图片文件命名 [hash:8][ext][query]\n              // [hash:8]: hash值取8位\n              // [ext]: 使用之前的文件扩展名\n              // [query]: 添加之前的query参数\n              filename: 'static/imgs/[hash:8][ext][query]'\n            }\n          },\n          {\n            test: /\\.(ttf|woff2?)$/,\n            type: 'asset/resource',\n            generator: {\n              filename: 'static/media/[hash:8][ext][query]'\n            }\n          },\n          {\n            test: /\\.js$/,\n            // exclude: /node_modules/, // 排除node_modules代码不编译\n            include: path.resolve(__dirname, '../src'), // 也可以用包含\n            use: [\n              {\n                loader: 'thread-loader', // 开启多进程\n                options: {\n                  workers: threads // 数量\n                }\n              },\n              {\n                loader: 'babel-loader',\n                options: {\n                  cacheDirectory: true // 开启babel编译缓存\n                }\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src'),\n      exclude: 'node_modules', // 默认值\n      cache: true, // 开启缓存\n      // 缓存目录\n      cacheLocation: path.resolve(__dirname, '../node_modules/.cache/.eslintcache'),\n      threads // 开启多进程\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    }),\n    // 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: 'static/css/main.css'\n    })\n    // css压缩\n    // new CssMinimizerPlugin(),\n  ],\n  optimization: {\n    minimize: true,\n    minimizer: [\n      // css压缩也可以写到optimization.minimizer里面，效果一样的\n      new CssMinimizerPlugin(),\n      // 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了\n      new TerserPlugin({\n        parallel: threads // 开启多进程\n      })\n    ]\n  },\n  // devServer: {\n  //   host: \"localhost\", // 启动服务器域名\n  //   port: \"3000\", // 启动服务器端口号\n  //   open: true, // 是否自动打开浏览器\n  // },\n  mode: 'production',\n  devtool: 'source-map'\n}\n```\n\n注意 📣：==请仅在特别耗时的操作中使用，因为每个进程启动就有大约为 600ms 左右开销==。❗❗❗❗❗❗\n\n## 3、减少代码体积\n\n### 3.1 TreeShaking\n\n&nbsp;&nbsp;&nbsp;&nbsp;开发时我们定义了一些工具函数库，或者引用第三方工具函数库或组件库。如果没有特殊处理的话我们打包时会引入整个库，但是实际上可能我们可能只用上极小部分的功能。这样将整个库都打包进来，体积就太大了。\n&nbsp;&nbsp;&nbsp;&nbsp;Tree Shaking 是一个术语，通常用于描述移除 JavaScript 中的没有使用上的代码,Webpack 已经默认开启了这个功能，无需其他配置。\n\n### 3.2 Babel\n\nBabel 为编译的每个文件都插入了辅助代码，使代码体积过大！Babel 对一些公共方法使用了非常小的辅助代码，比如 \\_extend。默认情况下会被添加到每一个需要它的文件中。你可以将这些辅助代码作为一个独立模块，来避免重复引入。\n@babel/plugin-transform-runtime: 禁用了 Babel 自动对每个文件的 runtime 注入，而是引入 @babel/plugin-transform-runtime 并且使所有辅助代码从这里引用;\n1、下载包\n\n```javascript\nnpm i @babel/plugin-transform-runtime -D\n```\n\n2、配置\n\n```javascript\n {\n                loader: \"babel-loader\",\n                options: {\n                  cacheDirectory: true, // 开启babel编译缓存\n                  cacheCompression: false, // 缓存文件不要压缩\n                  plugins: [\"@babel/plugin-transform-runtime\"], // 减少代码体积\n                },\n              },\n```\n\n### 3.3 Image Minimizer\n\n开发如果项目中引用了较多图片，那么图片体积会比较大，将来请求速度比较慢。我们可以对图片进行压缩，减少图片体积。\n1、下载插件\n\n```javascript\nnpm i image-minimizer-webpack-plugin imagemin -D\n```\n\n2、无损压缩下载如下包\n\n```javascript\nnpm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D\n```\n\n3、有损压缩\n\n```javascript\nnpm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo -D\n```\n\n4、以无损压缩进行示例配置\n\n```javascript\n// 压缩图片\n      new ImageMinimizerPlugin({\n        minimizer: {\n          implementation: ImageMinimizerPlugin.imageminGenerate,\n          options: {\n            plugins: [\n              [\"gifsicle\", { interlaced: true }],\n              [\"jpegtran\", { progressive: true }],\n              [\"optipng\", { optimizationLevel: 5 }],\n              [\n                \"svgo\",\n                {\n                  plugins: [\n                    \"preset-default\",\n                    \"prefixIds\",\n                    {\n                      name: \"sortAttrs\",\n                      params: {\n                        xmlnsOrder: \"alphabetical\",\n                      },\n                    },\n                  ],\n                },\n              ],\n            ],\n          },\n        },\n      }),\n```\n\n注意：📣== 如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩 ❗❗❗\n\n## 4、优化代码运行性能\n\n### 4.1 Code Split\n\n&nbsp;&nbsp;&nbsp;&nbsp;打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快；\n&nbsp;&nbsp;&nbsp;&nbsp;代码分割（Code Split）主要做了两件事：1、分割文件：将打包生成的文件进行分割，生成多个 js 文件。2、按需加载：需要哪个文件就加载哪个文件；\nspa 单页面应用的配置如下：\n\n```javascript\noptimization: {\n    // 代码分割配置\n    splitChunks: {\n      chunks: \"all\", // 对所有模块都进行分割\n      // 以下是默认值\n      // minSize: 20000, // 分割代码最小的大小\n      // minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0\n      // minChunks: 1, // 至少被引用的次数，满足条件才会代码分割\n      // maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量\n      // maxInitialRequests: 30, // 入口js文件最大并行请求数量\n      // enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）\n      // cacheGroups: { // 组，哪些模块要打包到一个组\n      //   defaultVendors: { // 组名\n      //     test: /[\\\\/]node_modules[\\\\/]/, // 需要打包到一起的模块\n      //     priority: -10, // 权重（越大越高）\n      //     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块\n      //   },\n      //   default: { // 其他没有写的配置会使用上面的默认值\n      //     minChunks: 2, // 这里的minChunks权重更大\n      //     priority: -20,\n      //     reuseExistingChunk: true,\n      //   },\n      // },\n  },\n```\n\n以上注释的都是默认配置，不需要另外配置；\n\n### 4.2 Preload / Prefetch\n\n&nbsp;&nbsp;&nbsp;&nbsp;我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。\n**两者都能预加载资源有缓存，但是存在兼容性问题**\n1、下载插件\n\n```javascript\nnpm i @vue/preload-webpack-plugin -D\n```\n\n2、配置\n\n```javascript\n new PreloadWebpackPlugin({\n      rel: \"preload\", // preload兼容性更好\n      as: \"script\",\n      // rel: 'prefetch' // prefetch兼容性更差\n    }),\n```\n\n### 4.3 Network Cache\n\n将来开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了。\n**配置：**\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"../dist\"), // 生产模式需要输出\n    // [contenthash:8]使用contenthash，取8位长度\n    filename: \"static/js/[name].[contenthash:8].js\", // 入口文件打包输出资源命名方式\n    chunkFilename: \"static/js/[name].[contenthash:8].chunk.js\", // 动态导入输出资源命名方式\n    assetModuleFilename: \"static/media/[name].[hash][ext]\", // 图片、字体等资源命名方式（注意用hash）\n    clean: true,\n  },\n```\n\n```javascript\n// 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: \"static/css/[name].[contenthash:8].css\",\n      chunkFilename: \"static/css/[name].[contenthash:8].chunk.css\",\n    }),\n```\n\n**以上配置出现的问题：**\n当我们修改 math.js 文件再重新打包的时候，因为 contenthash 原因，math.js 文件 hash 值发生了变化（这是正常的）。但是 main.js 文件的 hash 值也发生了变化，这会导致 main.js 的缓存失效。明明我们只修改 math.js, 为什么 main.js 也会变身变化呢？\n**原因分析：**\n更新前：math.xxx.js, main.js 引用的 math.xxx.js\n更新后：math.yyy.js, main.js 引用的 math.yyy.js, 文件名发生了变化，间接导致 main.js 也发生了变化\n**解决办法：**\n将 hash 值单独保管在一个 runtime 文件中。我们最终输出三个文件：main、math、runtime。当 math 文件发送变化，变化的是 math 和 runtime 文件，main 不变。runtime 文件只保存文件的 hash 值和它们与文件关系，整个文件体积就比较小，所以变化重新请求的代价也小。\n**添加配置如下：**\n\n```javascript\n // 提取runtime文件\n    runtimeChunk: {\n      name: (entrypoint) => `runtime~${entrypoint.name}`, // runtime文件命名规则\n    },\n```\n\n### 4.4 Core-js\n\n&nbsp;&nbsp;&nbsp;&nbsp;过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel/preset-env 智能预设来处理兼容性问题。它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决；\n&nbsp;&nbsp;&nbsp;&nbsp;core-js 是专门用来做 ES6 以及以上 API 的 polyfill。polyfill 翻译过来叫做垫片/补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性；\n1、下载包\n\n```javascript\nnpm i @babel/eslint-parser -D\n```\n\n2、在.eslintrc.js 配置\n\n```javascript\nparser: \"@babel/eslint-parser\", // 支持最新的最终 ECMAScript 标准\n```\n\n3、下载 corejs 包\n\n```javascript\nnpm i core-js\n```\n\n4、在 babel.config.js 中配置\n\n```javascript\nmodule.exports = {\n  // 智能预设：能够编译ES6语法\n  presets: [\n    [\n      '@babel/preset-env',\n      // 按需加载core-js的polyfill\n      {useBuiltIns: 'usage', corejs: {version: '3', proposals: true}}\n    ]\n  ]\n}\n```\n\n### 4.5 PWA\n\n开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。我们希望给项目提供离线体验。渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。其中最重要的是，在 离线(offline) 时应用程序能够继续运行功能。内部通过 Service Workers 技术实现的。\n1、下载包\n\n```javascript\nnpm i workbox-webpack-plugin -D\n```\n\n2、配置插件\n\n```javascript\nnew WorkboxPlugin.GenerateSW({\n      // 这些选项帮助快速启用 ServiceWorkers\n      // 不允许遗留任何“旧的” ServiceWorkers\n      clientsClaim: true,\n      skipWaiting: true,\n    }),\n```\n\n3、问题\n此时如果直接通过 VSCode 访问打包后页面，在浏览器控制台会发现 SW registration failed。因为我们打开的访问路径是：http://127.0.0.1:5500/dist/index.html。此时页面会去请求 service-worker.js 文件，请求路径是：http://127.0.0.1:5500/service-worker.js，这样找不到会 404。实际 service-worker.js 文件路径是：http://127.0.0.1:5500/dist/service-worker.js。\n4、解决办法\n4.1 下载包\n\n```javascript\nnpm i serve -g\n```\n\n4.2 运行指令\n\n```javascript\nserve dist\n```\n\n## 总结\n\n我们从 4 个角度对 webpack 和代码进行了优化：\n**1、提升开发体验**\n使用 Source Map 让开发或上线时代码报错能有更加准确的错误提示。\n**2、提升 webpack 提升打包构建速度**\n使用 HotModuleReplacement 让开发时只重新编译打包更新变化了的代码，不变的代码使用缓存，从而使更新速度更快。\n使用 OneOf 让资源文件一旦被某个 loader 处理了，就不会继续遍历了，打包速度更快。\n使用 Include/Exclude 排除或只检测某些文件，处理的文件更少，速度更快。\n使用 Cache 对 eslint 和 babel 处理的结果进行缓存，让第二次打包速度更快。\n使用 Thead 多进程处理 eslint 和 babel 任务，速度更快。（需要注意的是，进程启动通信都有开销的，要在比较多代码处理时使用才有效果）\n**3、减少代码体积**\n使用 Tree Shaking 剔除了没有使用的多余代码，让代码体积更小。\n使用 @babel/plugin-transform-runtime 插件对 babel 进行处理，让辅助代码从中引入，而不是每个文件都生成辅助代码，从而体积更小。\n使用 Image Minimizer 对项目中图片进行压缩，体积更小，请求速度更快。（需要注意的是，如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。）\n**4、优化代码运行性能**\n使用 Code Split 对代码进行分割成多个 js 文件，从而使单个文件体积更小，并行加载 js 速度更快。并通过 import 动态导入语法进行按需加载，从而达到需要使用时才加载该资源，不用时不加载资源。\n使用 Preload / Prefetch 对代码进行提前加载，等未来需要使用时就能直接使用，从而用户体验更好。\n使用 Network Cache 能对输出资源文件进行更好的命名，将来好做缓存，从而用户体验更好。\n使用 Core-js 对 js 进行兼容性处理，让我们代码能运行在低版本浏览器。\n使用 PWA 能让代码离线也能访问，从而提升用户体验。\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"webpack-opt","published":1,"updated":"2023-03-15T12:26:18.114Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfm002bp5o1gnvnf5pl","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上一篇文章详细讲解了 Webpack 的基础配置，这篇文章将在上一篇的基础上讲解 Webpack 的高级配置，带大家学习 Webpack 的优化，让我们的代码在编译/运行时性能更好~</p>\n<h2 id=\"1、提升开发体验\"><a href=\"#1、提升开发体验\" class=\"headerlink\" title=\"1、提升开发体验\"></a>1、提升开发体验</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;开发时我们运行的代码是经过 webpack 编译后的，所有 css 和 js 合并成了一个文件，并且多了其他代码。此时如果代码运行出错那么提示代码错误位置我们是看不懂的。一旦将来开发代码文件很多，那么很难去发现错误出现在哪里。所以我们需要更加准确的错误提示，来帮助我们更好的开发代码。<br>&nbsp;&nbsp;&nbsp;&nbsp;SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案。它会生成一个 xxx.map 文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过 xxx.map 文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快的找到错误根源;<br>1、开发模式下的配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;cheap-module-source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>开发模式下打包速度快，只包含行映射不包含列映射；<br>2、生产模式下的配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、提升打包构建速度\"><a href=\"#2、提升打包构建速度\" class=\"headerlink\" title=\"2、提升打包构建速度\"></a>2、提升打包构建速度</h2><h3 id=\"2-1-HotModuleReplacement\"><a href=\"#2-1-HotModuleReplacement\" class=\"headerlink\" title=\"2.1 HotModuleReplacement\"></a>2.1 HotModuleReplacement</h3><p>开发时我们修改了其中一个模块代码，Webpack 默认会将所有模块全部重新打包编译，速度很慢。所以我们需要做到修改某个模块代码，就只有这个模块代码需要重新打包编译，其他模块不变，这样打包速度就能很快;HotModuleReplacement（HMR/热模块替换）：在程序运行中，替换、添加或删除模块，而无需重新加载整个页面。<br>1、基本配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;localhost&#x27;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&#x27;3000&#x27;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">    <span class=\"attr\">hot</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 开启HMR功能（只能用于开发环境，生产环境不需要了）</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>开启热模替换后，实际开发配合<a href=\"https://github.com/vuejs/vue-loader\">Vue-loader</a> 插件进行配置</p>\n<h3 id=\"2-2-oneOf\"><a href=\"#2-2-oneOf\" class=\"headerlink\" title=\"2.2 oneOf\"></a>2.2 oneOf</h3><p>打包时每个文件都会经过所有 loader 处理，虽然因为 test 正则原因实际没有处理上，但是都要过一遍，比较慢。如果想要提升效率，就要只匹配一次，即匹配上了就不再往下匹配；<br>配置代码如下:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">   <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">       <span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">           <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;less-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;sass-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;stylus-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">           <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">             <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">               <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span>, <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">             &#125;,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">           <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">             <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">             <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">             <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">             <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">             <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">             <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/imgs/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">           <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">             <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">           <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">       ],</span><br><span class=\"line\">     &#125;,</span><br><span class=\"line\">   ],</span><br><span class=\"line\"> &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-3-Include-Exclude\"><a href=\"#2-3-Include-Exclude\" class=\"headerlink\" title=\"2.3 Include/Exclude\"></a>2.3 Include/Exclude</h3><p>开发时我们需要使用第三方的库或插件，所有文件都下载到 node_modules 中了。而这些文件是不需要编译可以直接使用的。所以我们在对 js 文件处理时，要排除 node_modules 下面的文件;<br>配置代码如下：<br><strong>babel 编译：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p><strong>eslint 检查：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&quot;node_modules&quot;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-4-Cache\"><a href=\"#2-4-Cache\" class=\"headerlink\" title=\"2.4 Cache\"></a>2.4 Cache</h3><p>每次打包时 js 文件都要经过 Eslint 检查 和 Babel 编译，速度比较慢。我们可以缓存之前的 Eslint 检查 和 Babel 编译结果，这样第二次打包时速度就会更快了。<br><strong>js 编译</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">              <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 缓存文件不要压缩</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p><strong>eslint 检查</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&quot;node_modules&quot;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">      <span class=\"attr\">cache</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">      <span class=\"comment\">// 缓存目录</span></span><br><span class=\"line\">      <span class=\"attr\">cacheLocation</span>: path.<span class=\"title function_\">resolve</span>(</span><br><span class=\"line\">        __dirname,</span><br><span class=\"line\">        <span class=\"string\">&quot;../node_modules/.cache/.eslintcache&quot;</span></span><br><span class=\"line\">      ),</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-5-Thead\"><a href=\"#2-5-Thead\" class=\"headerlink\" title=\"2.5 Thead\"></a>2.5 Thead</h3><p>当项目越来越庞大时，打包速度越来越慢，甚至于需要一个下午才能打包出来代码。这个速度是比较慢的。我们想要继续提升打包速度，其实就是要提升 js 的打包速度，因为其他文件都比较少。而对 js 文件处理主要就是 eslint 、babel、Terser 三个工具，所以我们要提升它们的运行速度。我们可以开启多进程同时处理 js 文件，这样速度就比之前的单进程打包更快了。<br>1、获取 cpu 核数</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// nodejs核心模块，直接使用</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;os&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// cpu核数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> threads = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span></span><br></pre></td></tr></table></figure>\n\n<p>2、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i thread-loader -D</span><br></pre></td></tr></table></figure>\n\n<p>3、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;os&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">MiniCssExtractPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">CssMinimizerPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;css-minimizer-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">TerserPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;terser-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// cpu核数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> threads = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取处理样式的Loaders</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getStyleLoaders</span> = (<span class=\"params\">preProcessor</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> [</span><br><span class=\"line\">    <span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;css-loader&#x27;</span>,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;postcss-loader&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">postcssOptions</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">            <span class=\"string\">&#x27;postcss-preset-env&#x27;</span> <span class=\"comment\">// 能解决大多数样式兼容性问题</span></span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    preProcessor</span><br><span class=\"line\">  ].<span class=\"title function_\">filter</span>(<span class=\"title class_\">Boolean</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../dist&#x27;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>()</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;less-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;sass-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;stylus-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">              <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">              <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">              <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">              <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">              <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">              <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">use</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;thread-loader&#x27;</span>, <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">                <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                  <span class=\"attr\">workers</span>: threads <span class=\"comment\">// 数量</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;,</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span>,</span><br><span class=\"line\">                <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                  <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&#x27;node_modules&#x27;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">      <span class=\"attr\">cache</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">      <span class=\"comment\">// 缓存目录</span></span><br><span class=\"line\">      <span class=\"attr\">cacheLocation</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../node_modules/.cache/.eslintcache&#x27;</span>),</span><br><span class=\"line\">      threads <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/css/main.css&#x27;</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">// css压缩</span></span><br><span class=\"line\">    <span class=\"comment\">// new CssMinimizerPlugin(),</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// css压缩也可以写到optimization.minimizer里面，效果一样的</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">CssMinimizerPlugin</span>(),</span><br><span class=\"line\">      <span class=\"comment\">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">TerserPlugin</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">parallel</span>: threads <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// devServer: &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   host: &quot;localhost&quot;, // 启动服务器域名</span></span><br><span class=\"line\">  <span class=\"comment\">//   port: &quot;3000&quot;, // 启动服务器端口号</span></span><br><span class=\"line\">  <span class=\"comment\">//   open: true, // 是否自动打开浏览器</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意 📣：==请仅在特别耗时的操作中使用，因为每个进程启动就有大约为 600ms 左右开销==。❗❗❗❗❗❗</p>\n<h2 id=\"3、减少代码体积\"><a href=\"#3、减少代码体积\" class=\"headerlink\" title=\"3、减少代码体积\"></a>3、减少代码体积</h2><h3 id=\"3-1-TreeShaking\"><a href=\"#3-1-TreeShaking\" class=\"headerlink\" title=\"3.1 TreeShaking\"></a>3.1 TreeShaking</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;开发时我们定义了一些工具函数库，或者引用第三方工具函数库或组件库。如果没有特殊处理的话我们打包时会引入整个库，但是实际上可能我们可能只用上极小部分的功能。这样将整个库都打包进来，体积就太大了。<br>&nbsp;&nbsp;&nbsp;&nbsp;Tree Shaking 是一个术语，通常用于描述移除 JavaScript 中的没有使用上的代码,Webpack 已经默认开启了这个功能，无需其他配置。</p>\n<h3 id=\"3-2-Babel\"><a href=\"#3-2-Babel\" class=\"headerlink\" title=\"3.2 Babel\"></a>3.2 Babel</h3><p>Babel 为编译的每个文件都插入了辅助代码，使代码体积过大！Babel 对一些公共方法使用了非常小的辅助代码，比如 _extend。默认情况下会被添加到每一个需要它的文件中。你可以将这些辅助代码作为一个独立模块，来避免重复引入。<br>@babel/plugin-transform-runtime: 禁用了 Babel 自动对每个文件的 runtime 注入，而是引入 @babel/plugin-transform-runtime 并且使所有辅助代码从这里引用;<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @babel/plugin-transform-runtime -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">               <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">               <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                 <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">                 <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 缓存文件不要压缩</span></span><br><span class=\"line\">                 <span class=\"attr\">plugins</span>: [<span class=\"string\">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class=\"comment\">// 减少代码体积</span></span><br><span class=\"line\">               &#125;,</span><br><span class=\"line\">             &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3-Image-Minimizer\"><a href=\"#3-3-Image-Minimizer\" class=\"headerlink\" title=\"3.3 Image Minimizer\"></a>3.3 Image Minimizer</h3><p>开发如果项目中引用了较多图片，那么图片体积会比较大，将来请求速度比较慢。我们可以对图片进行压缩，减少图片体积。<br>1、下载插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i image-minimizer-webpack-plugin imagemin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、无损压缩下载如下包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D</span><br></pre></td></tr></table></figure>\n\n<p>3、有损压缩</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo -D</span><br></pre></td></tr></table></figure>\n\n<p>4、以无损压缩进行示例配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 压缩图片</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">ImageMinimizerPlugin</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">implementation</span>: <span class=\"title class_\">ImageMinimizerPlugin</span>.<span class=\"property\">imageminGenerate</span>,</span><br><span class=\"line\">          <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">              [<span class=\"string\">&quot;gifsicle&quot;</span>, &#123; <span class=\"attr\">interlaced</span>: <span class=\"literal\">true</span> &#125;],</span><br><span class=\"line\">              [<span class=\"string\">&quot;jpegtran&quot;</span>, &#123; <span class=\"attr\">progressive</span>: <span class=\"literal\">true</span> &#125;],</span><br><span class=\"line\">              [<span class=\"string\">&quot;optipng&quot;</span>, &#123; <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">5</span> &#125;],</span><br><span class=\"line\">              [</span><br><span class=\"line\">                <span class=\"string\">&quot;svgo&quot;</span>,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">                    <span class=\"string\">&quot;preset-default&quot;</span>,</span><br><span class=\"line\">                    <span class=\"string\">&quot;prefixIds&quot;</span>,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                      <span class=\"attr\">name</span>: <span class=\"string\">&quot;sortAttrs&quot;</span>,</span><br><span class=\"line\">                      <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">                        <span class=\"attr\">xmlnsOrder</span>: <span class=\"string\">&quot;alphabetical&quot;</span>,</span><br><span class=\"line\">                      &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                  ],</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">              ],</span><br><span class=\"line\">            ],</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;),</span><br></pre></td></tr></table></figure>\n\n<p>注意：📣== 如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩 ❗❗❗</p>\n<h2 id=\"4、优化代码运行性能\"><a href=\"#4、优化代码运行性能\" class=\"headerlink\" title=\"4、优化代码运行性能\"></a>4、优化代码运行性能</h2><h3 id=\"4-1-Code-Split\"><a href=\"#4-1-Code-Split\" class=\"headerlink\" title=\"4.1 Code Split\"></a>4.1 Code Split</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快；<br>&nbsp;&nbsp;&nbsp;&nbsp;代码分割（Code Split）主要做了两件事：1、分割文件：将打包生成的文件进行分割，生成多个 js 文件。2、按需加载：需要哪个文件就加载哪个文件；<br>spa 单页面应用的配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 代码分割配置</span></span><br><span class=\"line\">    <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">chunks</span>: <span class=\"string\">&quot;all&quot;</span>, <span class=\"comment\">// 对所有模块都进行分割</span></span><br><span class=\"line\">      <span class=\"comment\">// 以下是默认值</span></span><br><span class=\"line\">      <span class=\"comment\">// minSize: 20000, // 分割代码最小的大小</span></span><br><span class=\"line\">      <span class=\"comment\">// minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0</span></span><br><span class=\"line\">      <span class=\"comment\">// minChunks: 1, // 至少被引用的次数，满足条件才会代码分割</span></span><br><span class=\"line\">      <span class=\"comment\">// maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量</span></span><br><span class=\"line\">      <span class=\"comment\">// maxInitialRequests: 30, // 入口js文件最大并行请求数量</span></span><br><span class=\"line\">      <span class=\"comment\">// enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）</span></span><br><span class=\"line\">      <span class=\"comment\">// cacheGroups: &#123; // 组，哪些模块要打包到一个组</span></span><br><span class=\"line\">      <span class=\"comment\">//   defaultVendors: &#123; // 组名</span></span><br><span class=\"line\">      <span class=\"comment\">//     test: /[\\\\/]node_modules[\\\\/]/, // 需要打包到一起的模块</span></span><br><span class=\"line\">      <span class=\"comment\">//     priority: -10, // 权重（越大越高）</span></span><br><span class=\"line\">      <span class=\"comment\">//     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块</span></span><br><span class=\"line\">      <span class=\"comment\">//   &#125;,</span></span><br><span class=\"line\">      <span class=\"comment\">//   default: &#123; // 其他没有写的配置会使用上面的默认值</span></span><br><span class=\"line\">      <span class=\"comment\">//     minChunks: 2, // 这里的minChunks权重更大</span></span><br><span class=\"line\">      <span class=\"comment\">//     priority: -20,</span></span><br><span class=\"line\">      <span class=\"comment\">//     reuseExistingChunk: true,</span></span><br><span class=\"line\">      <span class=\"comment\">//   &#125;,</span></span><br><span class=\"line\">      <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>以上注释的都是默认配置，不需要另外配置；</p>\n<h3 id=\"4-2-Preload-Prefetch\"><a href=\"#4-2-Preload-Prefetch\" class=\"headerlink\" title=\"4.2 Preload / Prefetch\"></a>4.2 Preload / Prefetch</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。<br><strong>两者都能预加载资源有缓存，但是存在兼容性问题</strong><br>1、下载插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @vue/preload-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">PreloadWebpackPlugin</span>(&#123;</span><br><span class=\"line\">     <span class=\"attr\">rel</span>: <span class=\"string\">&quot;preload&quot;</span>, <span class=\"comment\">// preload兼容性更好</span></span><br><span class=\"line\">     <span class=\"attr\">as</span>: <span class=\"string\">&quot;script&quot;</span>,</span><br><span class=\"line\">     <span class=\"comment\">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span></span><br><span class=\"line\">   &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-3-Network-Cache\"><a href=\"#4-3-Network-Cache\" class=\"headerlink\" title=\"4.3 Network Cache\"></a>4.3 Network Cache</h3><p>将来开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了。<br><strong>配置：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../dist&quot;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"comment\">// [contenthash:8]使用contenthash，取8位长度</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/[name].[contenthash:8].js&quot;</span>, <span class=\"comment\">// 入口文件打包输出资源命名方式</span></span><br><span class=\"line\">    <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span>, <span class=\"comment\">// 动态导入输出资源命名方式</span></span><br><span class=\"line\">    <span class=\"attr\">assetModuleFilename</span>: <span class=\"string\">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class=\"comment\">// 图片、字体等资源命名方式（注意用hash）</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/css/[name].[contenthash:8].css&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&quot;static/css/[name].[contenthash:8].chunk.css&quot;</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<p><strong>以上配置出现的问题：</strong><br>当我们修改 math.js 文件再重新打包的时候，因为 contenthash 原因，math.js 文件 hash 值发生了变化（这是正常的）。但是 main.js 文件的 hash 值也发生了变化，这会导致 main.js 的缓存失效。明明我们只修改 math.js, 为什么 main.js 也会变身变化呢？<br><strong>原因分析：</strong><br>更新前：math.xxx.js, main.js 引用的 math.xxx.js<br>更新后：math.yyy.js, main.js 引用的 math.yyy.js, 文件名发生了变化，间接导致 main.js 也发生了变化<br><strong>解决办法：</strong><br>将 hash 值单独保管在一个 runtime 文件中。我们最终输出三个文件：main、math、runtime。当 math 文件发送变化，变化的是 math 和 runtime 文件，main 不变。runtime 文件只保存文件的 hash 值和它们与文件关系，整个文件体积就比较小，所以变化重新请求的代价也小。<br><strong>添加配置如下：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取runtime文件</span></span><br><span class=\"line\">   <span class=\"attr\">runtimeChunk</span>: &#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"function\">(<span class=\"params\">entrypoint</span>) =&gt;</span> <span class=\"string\">`runtime~<span class=\"subst\">$&#123;entrypoint.name&#125;</span>`</span>, <span class=\"comment\">// runtime文件命名规则</span></span><br><span class=\"line\">   &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4-Core-js\"><a href=\"#4-4-Core-js\" class=\"headerlink\" title=\"4.4 Core-js\"></a>4.4 Core-js</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel/preset-env 智能预设来处理兼容性问题。它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决；<br>&nbsp;&nbsp;&nbsp;&nbsp;core-js 是专门用来做 ES6 以及以上 API 的 polyfill。polyfill 翻译过来叫做垫片/补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性；<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @babel/eslint-parser -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在.eslintrc.js 配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">parser</span>: <span class=\"string\">&quot;@babel/eslint-parser&quot;</span>, <span class=\"comment\">// 支持最新的最终 ECMAScript 标准</span></span><br></pre></td></tr></table></figure>\n\n<p>3、下载 corejs 包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i core-js</span><br></pre></td></tr></table></figure>\n\n<p>4、在 babel.config.js 中配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 智能预设：能够编译ES6语法</span></span><br><span class=\"line\">  <span class=\"attr\">presets</span>: [</span><br><span class=\"line\">    [</span><br><span class=\"line\">      <span class=\"string\">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 按需加载core-js的polyfill</span></span><br><span class=\"line\">      &#123;<span class=\"attr\">useBuiltIns</span>: <span class=\"string\">&#x27;usage&#x27;</span>, <span class=\"attr\">corejs</span>: &#123;<span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span>, <span class=\"attr\">proposals</span>: <span class=\"literal\">true</span>&#125;&#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-5-PWA\"><a href=\"#4-5-PWA\" class=\"headerlink\" title=\"4.5 PWA\"></a>4.5 PWA</h3><p>开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。我们希望给项目提供离线体验。渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。其中最重要的是，在 离线(offline) 时应用程序能够继续运行功能。内部通过 Service Workers 技术实现的。<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i workbox-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">WorkboxPlugin</span>.<span class=\"title class_\">GenerateSW</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 这些选项帮助快速启用 ServiceWorkers</span></span><br><span class=\"line\">      <span class=\"comment\">// 不允许遗留任何“旧的” ServiceWorkers</span></span><br><span class=\"line\">      <span class=\"attr\">clientsClaim</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">skipWaiting</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<p>3、问题<br>此时如果直接通过 VSCode 访问打包后页面，在浏览器控制台会发现 SW registration failed。因为我们打开的访问路径是：<a href=\"http://127.0.0.1:5500/dist/index.html%E3%80%82%E6%AD%A4%E6%97%B6%E9%A1%B5%E9%9D%A2%E4%BC%9A%E5%8E%BB%E8%AF%B7%E6%B1%82\">http://127.0.0.1:5500/dist/index.html。此时页面会去请求</a> service-worker.js 文件，请求路径是：<a href=\"http://127.0.0.1:5500/service-worker.js%EF%BC%8C%E8%BF%99%E6%A0%B7%E6%89%BE%E4%B8%8D%E5%88%B0%E4%BC%9A\">http://127.0.0.1:5500/service-worker.js，这样找不到会</a> 404。实际 service-worker.js 文件路径是：<a href=\"http://127.0.0.1:5500/dist/service-worker.js%E3%80%82\">http://127.0.0.1:5500/dist/service-worker.js。</a><br>4、解决办法<br>4.1 下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i serve -g</span><br></pre></td></tr></table></figure>\n\n<p>4.2 运行指令</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serve dist</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>我们从 4 个角度对 webpack 和代码进行了优化：<br><strong>1、提升开发体验</strong><br>使用 Source Map 让开发或上线时代码报错能有更加准确的错误提示。<br><strong>2、提升 webpack 提升打包构建速度</strong><br>使用 HotModuleReplacement 让开发时只重新编译打包更新变化了的代码，不变的代码使用缓存，从而使更新速度更快。<br>使用 OneOf 让资源文件一旦被某个 loader 处理了，就不会继续遍历了，打包速度更快。<br>使用 Include/Exclude 排除或只检测某些文件，处理的文件更少，速度更快。<br>使用 Cache 对 eslint 和 babel 处理的结果进行缓存，让第二次打包速度更快。<br>使用 Thead 多进程处理 eslint 和 babel 任务，速度更快。（需要注意的是，进程启动通信都有开销的，要在比较多代码处理时使用才有效果）<br><strong>3、减少代码体积</strong><br>使用 Tree Shaking 剔除了没有使用的多余代码，让代码体积更小。<br>使用 @babel/plugin-transform-runtime 插件对 babel 进行处理，让辅助代码从中引入，而不是每个文件都生成辅助代码，从而体积更小。<br>使用 Image Minimizer 对项目中图片进行压缩，体积更小，请求速度更快。（需要注意的是，如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。）<br><strong>4、优化代码运行性能</strong><br>使用 Code Split 对代码进行分割成多个 js 文件，从而使单个文件体积更小，并行加载 js 速度更快。并通过 import 动态导入语法进行按需加载，从而达到需要使用时才加载该资源，不用时不加载资源。<br>使用 Preload / Prefetch 对代码进行提前加载，等未来需要使用时就能直接使用，从而用户体验更好。<br>使用 Network Cache 能对输出资源文件进行更好的命名，将来好做缓存，从而用户体验更好。<br>使用 Core-js 对 js 进行兼容性处理，让我们代码能运行在低版本浏览器。<br>使用 PWA 能让代码离线也能访问，从而提升用户体验。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>上一篇文章详细讲解了 Webpack 的基础配置，这篇文章将在上一篇的基础上讲解 Webpack 的高级配置，带大家学习 Webpack 的优化，让我们的代码在编译/运行时性能更好~</p>\n<h2 id=\"1、提升开发体验\"><a href=\"#1、提升开发体验\" class=\"headerlink\" title=\"1、提升开发体验\"></a>1、提升开发体验</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;开发时我们运行的代码是经过 webpack 编译后的，所有 css 和 js 合并成了一个文件，并且多了其他代码。此时如果代码运行出错那么提示代码错误位置我们是看不懂的。一旦将来开发代码文件很多，那么很难去发现错误出现在哪里。所以我们需要更加准确的错误提示，来帮助我们更好的开发代码。<br>&nbsp;&nbsp;&nbsp;&nbsp;SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案。它会生成一个 xxx.map 文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过 xxx.map 文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快的找到错误根源;<br>1、开发模式下的配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;cheap-module-source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>开发模式下打包速度快，只包含行映射不包含列映射；<br>2、生产模式下的配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、提升打包构建速度\"><a href=\"#2、提升打包构建速度\" class=\"headerlink\" title=\"2、提升打包构建速度\"></a>2、提升打包构建速度</h2><h3 id=\"2-1-HotModuleReplacement\"><a href=\"#2-1-HotModuleReplacement\" class=\"headerlink\" title=\"2.1 HotModuleReplacement\"></a>2.1 HotModuleReplacement</h3><p>开发时我们修改了其中一个模块代码，Webpack 默认会将所有模块全部重新打包编译，速度很慢。所以我们需要做到修改某个模块代码，就只有这个模块代码需要重新打包编译，其他模块不变，这样打包速度就能很快;HotModuleReplacement（HMR/热模块替换）：在程序运行中，替换、添加或删除模块，而无需重新加载整个页面。<br>1、基本配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;localhost&#x27;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&#x27;3000&#x27;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">    <span class=\"attr\">hot</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 开启HMR功能（只能用于开发环境，生产环境不需要了）</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>开启热模替换后，实际开发配合<a href=\"https://github.com/vuejs/vue-loader\">Vue-loader</a> 插件进行配置</p>\n<h3 id=\"2-2-oneOf\"><a href=\"#2-2-oneOf\" class=\"headerlink\" title=\"2.2 oneOf\"></a>2.2 oneOf</h3><p>打包时每个文件都会经过所有 loader 处理，虽然因为 test 正则原因实际没有处理上，但是都要过一遍，比较慢。如果想要提升效率，就要只匹配一次，即匹配上了就不再往下匹配；<br>配置代码如下:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">   <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">     &#123;</span><br><span class=\"line\">       <span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">           <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;less-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;sass-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">use</span>: [<span class=\"string\">&quot;style-loader&quot;</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;stylus-loader&quot;</span>],</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">           <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">             <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">               <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span>, <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">             &#125;,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">           <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">             <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">             <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">             <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">             <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">             <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">             <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/imgs/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">           <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">             <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">           &#125;,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">         &#123;</span><br><span class=\"line\">           <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">           <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">           <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">       ],</span><br><span class=\"line\">     &#125;,</span><br><span class=\"line\">   ],</span><br><span class=\"line\"> &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-3-Include-Exclude\"><a href=\"#2-3-Include-Exclude\" class=\"headerlink\" title=\"2.3 Include/Exclude\"></a>2.3 Include/Exclude</h3><p>开发时我们需要使用第三方的库或插件，所有文件都下载到 node_modules 中了。而这些文件是不需要编译可以直接使用的。所以我们在对 js 文件处理时，要排除 node_modules 下面的文件;<br>配置代码如下：<br><strong>babel 编译：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p><strong>eslint 检查：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&quot;node_modules&quot;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-4-Cache\"><a href=\"#2-4-Cache\" class=\"headerlink\" title=\"2.4 Cache\"></a>2.4 Cache</h3><p>每次打包时 js 文件都要经过 Eslint 检查 和 Babel 编译，速度比较慢。我们可以缓存之前的 Eslint 检查 和 Babel 编译结果，这样第二次打包时速度就会更快了。<br><strong>js 编译</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">              <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 缓存文件不要压缩</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p><strong>eslint 检查</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../src&quot;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&quot;node_modules&quot;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">      <span class=\"attr\">cache</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">      <span class=\"comment\">// 缓存目录</span></span><br><span class=\"line\">      <span class=\"attr\">cacheLocation</span>: path.<span class=\"title function_\">resolve</span>(</span><br><span class=\"line\">        __dirname,</span><br><span class=\"line\">        <span class=\"string\">&quot;../node_modules/.cache/.eslintcache&quot;</span></span><br><span class=\"line\">      ),</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-5-Thead\"><a href=\"#2-5-Thead\" class=\"headerlink\" title=\"2.5 Thead\"></a>2.5 Thead</h3><p>当项目越来越庞大时，打包速度越来越慢，甚至于需要一个下午才能打包出来代码。这个速度是比较慢的。我们想要继续提升打包速度，其实就是要提升 js 的打包速度，因为其他文件都比较少。而对 js 文件处理主要就是 eslint 、babel、Terser 三个工具，所以我们要提升它们的运行速度。我们可以开启多进程同时处理 js 文件，这样速度就比之前的单进程打包更快了。<br>1、获取 cpu 核数</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// nodejs核心模块，直接使用</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;os&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// cpu核数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> threads = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span></span><br></pre></td></tr></table></figure>\n\n<p>2、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i thread-loader -D</span><br></pre></td></tr></table></figure>\n\n<p>3、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> os = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;os&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">MiniCssExtractPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;mini-css-extract-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">CssMinimizerPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;css-minimizer-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">TerserPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;terser-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// cpu核数</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> threads = os.<span class=\"title function_\">cpus</span>().<span class=\"property\">length</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取处理样式的Loaders</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">getStyleLoaders</span> = (<span class=\"params\">preProcessor</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> [</span><br><span class=\"line\">    <span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;css-loader&#x27;</span>,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;postcss-loader&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">postcssOptions</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">            <span class=\"string\">&#x27;postcss-preset-env&#x27;</span> <span class=\"comment\">// 能解决大多数样式兼容性问题</span></span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    preProcessor</span><br><span class=\"line\">  ].<span class=\"title function_\">filter</span>(<span class=\"title class_\">Boolean</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../dist&#x27;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">oneOf</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>()</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;less-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;sass-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">use</span>: <span class=\"title function_\">getStyleLoaders</span>(<span class=\"string\">&#x27;stylus-loader&#x27;</span>)</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">              <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">              <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">              <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">              <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">              <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">              <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">            <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">            <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">            <span class=\"comment\">// exclude: /node_modules/, // 排除node_modules代码不编译</span></span><br><span class=\"line\">            <span class=\"attr\">include</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>), <span class=\"comment\">// 也可以用包含</span></span><br><span class=\"line\">            <span class=\"attr\">use</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;thread-loader&#x27;</span>, <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">                <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                  <span class=\"attr\">workers</span>: threads <span class=\"comment\">// 数量</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;,</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span>,</span><br><span class=\"line\">                <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                  <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>),</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: <span class=\"string\">&#x27;node_modules&#x27;</span>, <span class=\"comment\">// 默认值</span></span><br><span class=\"line\">      <span class=\"attr\">cache</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启缓存</span></span><br><span class=\"line\">      <span class=\"comment\">// 缓存目录</span></span><br><span class=\"line\">      <span class=\"attr\">cacheLocation</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../node_modules/.cache/.eslintcache&#x27;</span>),</span><br><span class=\"line\">      threads <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/css/main.css&#x27;</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">// css压缩</span></span><br><span class=\"line\">    <span class=\"comment\">// new CssMinimizerPlugin(),</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">minimize</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">minimizer</span>: [</span><br><span class=\"line\">      <span class=\"comment\">// css压缩也可以写到optimization.minimizer里面，效果一样的</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">CssMinimizerPlugin</span>(),</span><br><span class=\"line\">      <span class=\"comment\">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">TerserPlugin</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">parallel</span>: threads <span class=\"comment\">// 开启多进程</span></span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// devServer: &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   host: &quot;localhost&quot;, // 启动服务器域名</span></span><br><span class=\"line\">  <span class=\"comment\">//   port: &quot;3000&quot;, // 启动服务器端口号</span></span><br><span class=\"line\">  <span class=\"comment\">//   open: true, // 是否自动打开浏览器</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">devtool</span>: <span class=\"string\">&#x27;source-map&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意 📣：==请仅在特别耗时的操作中使用，因为每个进程启动就有大约为 600ms 左右开销==。❗❗❗❗❗❗</p>\n<h2 id=\"3、减少代码体积\"><a href=\"#3、减少代码体积\" class=\"headerlink\" title=\"3、减少代码体积\"></a>3、减少代码体积</h2><h3 id=\"3-1-TreeShaking\"><a href=\"#3-1-TreeShaking\" class=\"headerlink\" title=\"3.1 TreeShaking\"></a>3.1 TreeShaking</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;开发时我们定义了一些工具函数库，或者引用第三方工具函数库或组件库。如果没有特殊处理的话我们打包时会引入整个库，但是实际上可能我们可能只用上极小部分的功能。这样将整个库都打包进来，体积就太大了。<br>&nbsp;&nbsp;&nbsp;&nbsp;Tree Shaking 是一个术语，通常用于描述移除 JavaScript 中的没有使用上的代码,Webpack 已经默认开启了这个功能，无需其他配置。</p>\n<h3 id=\"3-2-Babel\"><a href=\"#3-2-Babel\" class=\"headerlink\" title=\"3.2 Babel\"></a>3.2 Babel</h3><p>Babel 为编译的每个文件都插入了辅助代码，使代码体积过大！Babel 对一些公共方法使用了非常小的辅助代码，比如 _extend。默认情况下会被添加到每一个需要它的文件中。你可以将这些辅助代码作为一个独立模块，来避免重复引入。<br>@babel/plugin-transform-runtime: 禁用了 Babel 自动对每个文件的 runtime 注入，而是引入 @babel/plugin-transform-runtime 并且使所有辅助代码从这里引用;<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @babel/plugin-transform-runtime -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">               <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">               <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">                 <span class=\"attr\">cacheDirectory</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 开启babel编译缓存</span></span><br><span class=\"line\">                 <span class=\"attr\">cacheCompression</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 缓存文件不要压缩</span></span><br><span class=\"line\">                 <span class=\"attr\">plugins</span>: [<span class=\"string\">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class=\"comment\">// 减少代码体积</span></span><br><span class=\"line\">               &#125;,</span><br><span class=\"line\">             &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-3-Image-Minimizer\"><a href=\"#3-3-Image-Minimizer\" class=\"headerlink\" title=\"3.3 Image Minimizer\"></a>3.3 Image Minimizer</h3><p>开发如果项目中引用了较多图片，那么图片体积会比较大，将来请求速度比较慢。我们可以对图片进行压缩，减少图片体积。<br>1、下载插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i image-minimizer-webpack-plugin imagemin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、无损压缩下载如下包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo -D</span><br></pre></td></tr></table></figure>\n\n<p>3、有损压缩</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo -D</span><br></pre></td></tr></table></figure>\n\n<p>4、以无损压缩进行示例配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 压缩图片</span></span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">ImageMinimizerPlugin</span>(&#123;</span><br><span class=\"line\">        <span class=\"attr\">minimizer</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">implementation</span>: <span class=\"title class_\">ImageMinimizerPlugin</span>.<span class=\"property\">imageminGenerate</span>,</span><br><span class=\"line\">          <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">              [<span class=\"string\">&quot;gifsicle&quot;</span>, &#123; <span class=\"attr\">interlaced</span>: <span class=\"literal\">true</span> &#125;],</span><br><span class=\"line\">              [<span class=\"string\">&quot;jpegtran&quot;</span>, &#123; <span class=\"attr\">progressive</span>: <span class=\"literal\">true</span> &#125;],</span><br><span class=\"line\">              [<span class=\"string\">&quot;optipng&quot;</span>, &#123; <span class=\"attr\">optimizationLevel</span>: <span class=\"number\">5</span> &#125;],</span><br><span class=\"line\">              [</span><br><span class=\"line\">                <span class=\"string\">&quot;svgo&quot;</span>,</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">                    <span class=\"string\">&quot;preset-default&quot;</span>,</span><br><span class=\"line\">                    <span class=\"string\">&quot;prefixIds&quot;</span>,</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                      <span class=\"attr\">name</span>: <span class=\"string\">&quot;sortAttrs&quot;</span>,</span><br><span class=\"line\">                      <span class=\"attr\">params</span>: &#123;</span><br><span class=\"line\">                        <span class=\"attr\">xmlnsOrder</span>: <span class=\"string\">&quot;alphabetical&quot;</span>,</span><br><span class=\"line\">                      &#125;,</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                  ],</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">              ],</span><br><span class=\"line\">            ],</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;),</span><br></pre></td></tr></table></figure>\n\n<p>注意：📣== 如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩 ❗❗❗</p>\n<h2 id=\"4、优化代码运行性能\"><a href=\"#4、优化代码运行性能\" class=\"headerlink\" title=\"4、优化代码运行性能\"></a>4、优化代码运行性能</h2><h3 id=\"4-1-Code-Split\"><a href=\"#4-1-Code-Split\" class=\"headerlink\" title=\"4.1 Code Split\"></a>4.1 Code Split</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快；<br>&nbsp;&nbsp;&nbsp;&nbsp;代码分割（Code Split）主要做了两件事：1、分割文件：将打包生成的文件进行分割，生成多个 js 文件。2、按需加载：需要哪个文件就加载哪个文件；<br>spa 单页面应用的配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 代码分割配置</span></span><br><span class=\"line\">    <span class=\"attr\">splitChunks</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">chunks</span>: <span class=\"string\">&quot;all&quot;</span>, <span class=\"comment\">// 对所有模块都进行分割</span></span><br><span class=\"line\">      <span class=\"comment\">// 以下是默认值</span></span><br><span class=\"line\">      <span class=\"comment\">// minSize: 20000, // 分割代码最小的大小</span></span><br><span class=\"line\">      <span class=\"comment\">// minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0</span></span><br><span class=\"line\">      <span class=\"comment\">// minChunks: 1, // 至少被引用的次数，满足条件才会代码分割</span></span><br><span class=\"line\">      <span class=\"comment\">// maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量</span></span><br><span class=\"line\">      <span class=\"comment\">// maxInitialRequests: 30, // 入口js文件最大并行请求数量</span></span><br><span class=\"line\">      <span class=\"comment\">// enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）</span></span><br><span class=\"line\">      <span class=\"comment\">// cacheGroups: &#123; // 组，哪些模块要打包到一个组</span></span><br><span class=\"line\">      <span class=\"comment\">//   defaultVendors: &#123; // 组名</span></span><br><span class=\"line\">      <span class=\"comment\">//     test: /[\\\\/]node_modules[\\\\/]/, // 需要打包到一起的模块</span></span><br><span class=\"line\">      <span class=\"comment\">//     priority: -10, // 权重（越大越高）</span></span><br><span class=\"line\">      <span class=\"comment\">//     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块</span></span><br><span class=\"line\">      <span class=\"comment\">//   &#125;,</span></span><br><span class=\"line\">      <span class=\"comment\">//   default: &#123; // 其他没有写的配置会使用上面的默认值</span></span><br><span class=\"line\">      <span class=\"comment\">//     minChunks: 2, // 这里的minChunks权重更大</span></span><br><span class=\"line\">      <span class=\"comment\">//     priority: -20,</span></span><br><span class=\"line\">      <span class=\"comment\">//     reuseExistingChunk: true,</span></span><br><span class=\"line\">      <span class=\"comment\">//   &#125;,</span></span><br><span class=\"line\">      <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>以上注释的都是默认配置，不需要另外配置；</p>\n<h3 id=\"4-2-Preload-Prefetch\"><a href=\"#4-2-Preload-Prefetch\" class=\"headerlink\" title=\"4.2 Preload / Prefetch\"></a>4.2 Preload / Prefetch</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。<br><strong>两者都能预加载资源有缓存，但是存在兼容性问题</strong><br>1、下载插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @vue/preload-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">PreloadWebpackPlugin</span>(&#123;</span><br><span class=\"line\">     <span class=\"attr\">rel</span>: <span class=\"string\">&quot;preload&quot;</span>, <span class=\"comment\">// preload兼容性更好</span></span><br><span class=\"line\">     <span class=\"attr\">as</span>: <span class=\"string\">&quot;script&quot;</span>,</span><br><span class=\"line\">     <span class=\"comment\">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span></span><br><span class=\"line\">   &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-3-Network-Cache\"><a href=\"#4-3-Network-Cache\" class=\"headerlink\" title=\"4.3 Network Cache\"></a>4.3 Network Cache</h3><p>将来开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了。<br><strong>配置：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;../dist&quot;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"comment\">// [contenthash:8]使用contenthash，取8位长度</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/[name].[contenthash:8].js&quot;</span>, <span class=\"comment\">// 入口文件打包输出资源命名方式</span></span><br><span class=\"line\">    <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span>, <span class=\"comment\">// 动态导入输出资源命名方式</span></span><br><span class=\"line\">    <span class=\"attr\">assetModuleFilename</span>: <span class=\"string\">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class=\"comment\">// 图片、字体等资源命名方式（注意用hash）</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/css/[name].[contenthash:8].css&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&quot;static/css/[name].[contenthash:8].chunk.css&quot;</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<p><strong>以上配置出现的问题：</strong><br>当我们修改 math.js 文件再重新打包的时候，因为 contenthash 原因，math.js 文件 hash 值发生了变化（这是正常的）。但是 main.js 文件的 hash 值也发生了变化，这会导致 main.js 的缓存失效。明明我们只修改 math.js, 为什么 main.js 也会变身变化呢？<br><strong>原因分析：</strong><br>更新前：math.xxx.js, main.js 引用的 math.xxx.js<br>更新后：math.yyy.js, main.js 引用的 math.yyy.js, 文件名发生了变化，间接导致 main.js 也发生了变化<br><strong>解决办法：</strong><br>将 hash 值单独保管在一个 runtime 文件中。我们最终输出三个文件：main、math、runtime。当 math 文件发送变化，变化的是 math 和 runtime 文件，main 不变。runtime 文件只保存文件的 hash 值和它们与文件关系，整个文件体积就比较小，所以变化重新请求的代价也小。<br><strong>添加配置如下：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取runtime文件</span></span><br><span class=\"line\">   <span class=\"attr\">runtimeChunk</span>: &#123;</span><br><span class=\"line\">     <span class=\"attr\">name</span>: <span class=\"function\">(<span class=\"params\">entrypoint</span>) =&gt;</span> <span class=\"string\">`runtime~<span class=\"subst\">$&#123;entrypoint.name&#125;</span>`</span>, <span class=\"comment\">// runtime文件命名规则</span></span><br><span class=\"line\">   &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4-Core-js\"><a href=\"#4-4-Core-js\" class=\"headerlink\" title=\"4.4 Core-js\"></a>4.4 Core-js</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel/preset-env 智能预设来处理兼容性问题。它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决；<br>&nbsp;&nbsp;&nbsp;&nbsp;core-js 是专门用来做 ES6 以及以上 API 的 polyfill。polyfill 翻译过来叫做垫片/补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性；<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i @babel/eslint-parser -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在.eslintrc.js 配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">parser</span>: <span class=\"string\">&quot;@babel/eslint-parser&quot;</span>, <span class=\"comment\">// 支持最新的最终 ECMAScript 标准</span></span><br></pre></td></tr></table></figure>\n\n<p>3、下载 corejs 包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i core-js</span><br></pre></td></tr></table></figure>\n\n<p>4、在 babel.config.js 中配置</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 智能预设：能够编译ES6语法</span></span><br><span class=\"line\">  <span class=\"attr\">presets</span>: [</span><br><span class=\"line\">    [</span><br><span class=\"line\">      <span class=\"string\">&#x27;@babel/preset-env&#x27;</span>,</span><br><span class=\"line\">      <span class=\"comment\">// 按需加载core-js的polyfill</span></span><br><span class=\"line\">      &#123;<span class=\"attr\">useBuiltIns</span>: <span class=\"string\">&#x27;usage&#x27;</span>, <span class=\"attr\">corejs</span>: &#123;<span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span>, <span class=\"attr\">proposals</span>: <span class=\"literal\">true</span>&#125;&#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-5-PWA\"><a href=\"#4-5-PWA\" class=\"headerlink\" title=\"4.5 PWA\"></a>4.5 PWA</h3><p>开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。我们希望给项目提供离线体验。渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。其中最重要的是，在 离线(offline) 时应用程序能够继续运行功能。内部通过 Service Workers 技术实现的。<br>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i workbox-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、配置插件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">WorkboxPlugin</span>.<span class=\"title class_\">GenerateSW</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 这些选项帮助快速启用 ServiceWorkers</span></span><br><span class=\"line\">      <span class=\"comment\">// 不允许遗留任何“旧的” ServiceWorkers</span></span><br><span class=\"line\">      <span class=\"attr\">clientsClaim</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">skipWaiting</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<p>3、问题<br>此时如果直接通过 VSCode 访问打包后页面，在浏览器控制台会发现 SW registration failed。因为我们打开的访问路径是：<a href=\"http://127.0.0.1:5500/dist/index.html%E3%80%82%E6%AD%A4%E6%97%B6%E9%A1%B5%E9%9D%A2%E4%BC%9A%E5%8E%BB%E8%AF%B7%E6%B1%82\">http://127.0.0.1:5500/dist/index.html。此时页面会去请求</a> service-worker.js 文件，请求路径是：<a href=\"http://127.0.0.1:5500/service-worker.js%EF%BC%8C%E8%BF%99%E6%A0%B7%E6%89%BE%E4%B8%8D%E5%88%B0%E4%BC%9A\">http://127.0.0.1:5500/service-worker.js，这样找不到会</a> 404。实际 service-worker.js 文件路径是：<a href=\"http://127.0.0.1:5500/dist/service-worker.js%E3%80%82\">http://127.0.0.1:5500/dist/service-worker.js。</a><br>4、解决办法<br>4.1 下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i serve -g</span><br></pre></td></tr></table></figure>\n\n<p>4.2 运行指令</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">serve dist</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>我们从 4 个角度对 webpack 和代码进行了优化：<br><strong>1、提升开发体验</strong><br>使用 Source Map 让开发或上线时代码报错能有更加准确的错误提示。<br><strong>2、提升 webpack 提升打包构建速度</strong><br>使用 HotModuleReplacement 让开发时只重新编译打包更新变化了的代码，不变的代码使用缓存，从而使更新速度更快。<br>使用 OneOf 让资源文件一旦被某个 loader 处理了，就不会继续遍历了，打包速度更快。<br>使用 Include/Exclude 排除或只检测某些文件，处理的文件更少，速度更快。<br>使用 Cache 对 eslint 和 babel 处理的结果进行缓存，让第二次打包速度更快。<br>使用 Thead 多进程处理 eslint 和 babel 任务，速度更快。（需要注意的是，进程启动通信都有开销的，要在比较多代码处理时使用才有效果）<br><strong>3、减少代码体积</strong><br>使用 Tree Shaking 剔除了没有使用的多余代码，让代码体积更小。<br>使用 @babel/plugin-transform-runtime 插件对 babel 进行处理，让辅助代码从中引入，而不是每个文件都生成辅助代码，从而体积更小。<br>使用 Image Minimizer 对项目中图片进行压缩，体积更小，请求速度更快。（需要注意的是，如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。）<br><strong>4、优化代码运行性能</strong><br>使用 Code Split 对代码进行分割成多个 js 文件，从而使单个文件体积更小，并行加载 js 速度更快。并通过 import 动态导入语法进行按需加载，从而达到需要使用时才加载该资源，不用时不加载资源。<br>使用 Preload / Prefetch 对代码进行提前加载，等未来需要使用时就能直接使用，从而用户体验更好。<br>使用 Network Cache 能对输出资源文件进行更好的命名，将来好做缓存，从而用户体验更好。<br>使用 Core-js 对 js 进行兼容性处理，让我们代码能运行在低版本浏览器。<br>使用 PWA 能让代码离线也能访问，从而提升用户体验。</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"从零搭建webpack","description":"本篇文章将从基础配置入手，带大家了解webpack的核心；","headimg":"/images/webpack.jpeg","date":"2022-03-21T16:00:00.000Z","_content":"\n## 前言\n\n本质上，webpack 是一个用于现代 JavaScript 应用程序的 静态模块打包工具。当 webpack 处理应用程序时，它会在内部从一个或多个入口点构建一个 依赖图(dependency graph)，然后将你项目中所需的每一个模块组合成一个或多个 bundles，它们均为静态资源，用于展示你的内容，可想而知 webpack 的重要性。然而由于 vuecli 的出现，我们不再把更多的重心放到 webpack 的配置，导致对 webpack 的配置以及优化逐渐失去了自己的认识，本篇文章将从基础配置入手，带大家了解 webpack 的核心；\n\n## 🥇 准备\n\n首先我们需要在项目的根目录创建 webpack.config.js 文件用于 webpack 的配置，Webpack 是基于 Node.js 运行的，所以采用 Common.js 模块化规范；其五大核心为：entry、output、module、plugins、mode；代码如下所示：\n\n```javascript\nmodule.exports = {\n  // 入口\n  entry: '',\n  // 输出\n  output: {},\n  // 加载器\n  module: {\n    rules: []\n  },\n  // 插件\n  plugins: [],\n  // 模式\n  mode: ''\n}\n```\n\n## 🥇 开发模式的配置\n\n开发模式顾名思义就是我们开发代码时使用的模式。这个模式下我们主要做两件事：==1、编译代码，使浏览器能识别运行开发时我们有样式资源、字体图标、图片资源、html 资源等，webpack 默认都不能处理这些资源，所以我们要加载配置来编译这些资源代码质量检查，2、树立代码规范提前检查代码的一些隐患，让代码运行时能更加健壮。提前检查代码规范和格式，统一团队编码风格，让代码更优雅美观。==\n\n### 1、处理 css 样式资源\n\n由于 Webpack 是不能解析样式资源的因此我们需要借助 loader 去帮组 webpack 解析样式资源；官方文档有对应的 loader 模块，我们可以参考官方文档进行 loader 的配置；链接如下：\n[webpack----------Loader 地址](https://webpack.docschina.org/loaders/)\n第一步下载 loader，代码如下所示：\n\n```javascript\nnpm i css-loader style-loader -D\n```\n\n第二步在配置文件中配置，代码如下所示：\n\n```javascript\nconst path = require('path')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: 'main.js'\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      }\n    ]\n  },\n  plugins: [],\n  mode: 'development'\n}\n```\n\n对 less、sass、styl 资源的处理和 css 资源的处理雷同，不再累述，查看官方文档进行配置即可;\n\n### 2、处理图片资源\n\n在 Webapack4 我们需要对一个两个 loader 对图片资源处理图片，而 webpack5 已经将处理图片的 loader 内置处理了，现在只需要进行简单配置就能处理图片资源，配置代码如下所示：\n\n```javascript\nconst path = require('path')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: 'main.js'\n  },\n  module: {\n    rules: [\n      //...........处理图片资源的配置\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset'\n      }\n    ]\n  },\n  plugins: [],\n  mode: 'development'\n}\n```\n\n#### 2.1 对图片资源进行优化\n\n项目中肯定会存在一定的图片资源，为了减少向后端发请求的次数，我们配置了小于 10kb 的图片转 base64 格式的配置项；\n\n```javascript\n {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: \"asset\",\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        }\n      },\n```\n\n### 3、修改输出资源的名称和路径\n\n输出 js 文件名称和路径的配置在如下 output 中配置：\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"dist\"),\n    filename: \"static/js/main.js\", // 将 js 文件输出到 static/js 目录中\n  },\n```\n\n输出图片的名称和路径的配置如下：\n\n```javascript\ngenerator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: \"static/imgs/[hash:8][ext][query]\",\n        },\n```\n\n### 4、自动清空上次打包的配置\n\n由于每次在打包资源之前我们都需要手动删除 dist 目录下的打包文件，非常麻烦，因此需要配置每次打包之前先清除 dist 目录下的资源再进行打包，配置代码如下：\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"dist\"),\n    filename: \"static/js/main.js\",\n    clean: true, // 自动将上次打包目录资源清空\n  },\n```\n\n### 5、字体图标资源的处理\n\n对于字体图标的处理和图片资源的处理类似，因为 webpack 内置的有 loader 解析，我们只需要简单的配置即可，配置代码如下：\n\n```javascript\n{\n        test: /\\.(ttf|woff2?)$/,\n        type: \"asset/resource\",\n        generator: {\n          filename: \"static/media/[hash:8][ext][query]\",\n        },\n      },\n```\n\n注意：📣 type: \"asset/resource\"和 type: \"asset\"的区别：\ntype: \"asset/resource\" 相当于 file-loader, 将文件转化成 Webpack 能识别的资源，其他不做处理\ntype: \"asset\" 相当于 url-loader, 将文件转化成 Webpack 能识别的资源，同时小于某个大小的资源会处理成 data URI 形式 ❗❗❗\n\n### 6、处理其它资源\n\n开发中可能还存在一些其他资源，如音视频等，我们在字体图标的配置中也一起处理了，代码如下：\n\n```javascript\n{\n        test: /\\.(ttf|woff2?|map4|map3|avi)$/,\n        type: \"asset/resource\",\n        generator: {\n          filename: \"static/media/[hash:8][ext][query]\",\n        },\n      },\n```\n\n### 7、处理 js 资源\n\n#### 7.1 Eslint\n\n在团队的开发中对代码的格式是有严格的要求，因此为了团队代码的规范，我们需要配置 eslint 去保证开发的代码格式的一致性；首先我们需要在项目的根目录下创建一个.eslintrc.js 文件，在里面配置如下三项规则：\n\n```javascript\nmodule.exports = {\n  // 解析选项\n  parserOptions: {},\n  // 具体检查规则\n  rules: {},\n  // 继承其他规则\n  extends: []\n  // ...\n  // 其他规则详见：https://eslint.bootcss.com/docs/user-guide/configuring\n}\n```\n\n1、parserOptions 选项配置如下：\n\n```javascript\nparserOptions: {\n  ecmaVersion: 6, // ES 语法版本\n  sourceType: \"module\", // ES 模块化\n  ecmaFeatures: { // ES 其他特性\n    jsx: true // 如果是 React 项目，就需要开启 jsx 语法\n  }\n}\n```\n\n2、rules 的配置规则：\n\"off\" 或 0 - 关闭规则\n\"warn\" 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)\n\"error\" 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)；\n其配置如下所示：\n\n```javascript\nrules: {\n  semi: \"error\", // 禁止使用分号\n  'array-callback-return': 'warn', // 强制数组方法的回调函数中有 return 语句，否则警告\n  'default-case': [\n    'warn', // 要求 switch 语句中有 default 分支，否则警告\n    { commentPattern: '^no default$' } // 允许在最后注释 no default, 就不会有警告了\n  ],\n  eqeqeq: [\n    'warn', // 强制使用 === 和 !==，否则警告\n    'smart' // https://eslint.bootcss.com/docs/rules/eqeqeq#smart 除了少数情况下不会有警告\n  ],\n}\n```\n\n更多规则可以参考如下官方文档：[ESLint 官方](https://eslint.bootcss.com/docs/rules/)\n3、在 webpack 中的使用：\n\n```javascript\nmodule.exports = {\n  // 继承 Eslint 规则\n  extends: ['eslint:recommended'],\n  env: {\n    node: true, // 启用node中全局变量\n    browser: true // 启用浏览器中全局变量\n  },\n  parserOptions: {\n    ecmaVersion: 6,\n    sourceType: 'module'\n  },\n  rules: {\n    'no-var': 2 // 不能使用 var 定义变量\n  }\n}\n```\n\n与此同时我们可以在 webpackconfig.js 中配置插件指定检查文件的目录：\n\n```javascript\nplugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"src\"),\n    }),\n  ],\n```\n\n配置插件之前需要下载插件并且引入，文章以下的内容不再累述下包引入的过程；\n\n##### 7.1.1 VS Code 的 Eslint 插件\n\n打开 VSCode，下载 Eslint 插件，即可不用编译就能看到错误，可以提前解决但是此时就会对项目所有文件默认进行 Eslint 检查了，我们 dist 目录下的打包后文件就会报错。但是我们只需要检查 src 下面的文件，不需要检查 dist 下面的文件。所以可以使用 Eslint 忽略文件解决。在项目根目录新建.eslintignore 文件:\n\n```javascript\n# 忽略dist目录下所有文件\ndist\n```\n\n#### 7.2 Babel\n\nBabel 为 javascript 编译器，主要用于将 ES6 语法编写的代码转换为向后兼容的 JavaScript 语法，以便能够运行在当前和旧版本的浏览器或其他环境中；我们需要先在根目录下创建一个 babel.config.js 文件；\n在 webpack 中的使用：\n1、下载包：\n\n```javascript\nnpm i babel-loader @babel/core @babel/preset-env -D\n```\n\n2、定义 babel.config.js 文件\n\n```javascript\nmodule.exports = {\n  presets: ['@babel/preset-env']\n}\n```\n\n3、webconfig.js 中配置如下代码：\n\n```javascript\n {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: \"babel-loader\",\n      },\n```\n\n以上代码配置排除 node_modules 文件，提高打包的速度；\n\n### 8、处理 html 资源\n\n1、下载包\n\n```javascript\nnpm i html-webpack-plugin -D\n```\n\n2、在插件模块配置如下代码：\n\n```javascript\n new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, \"public/index.html\"),\n    }),\n```\n\n## 🥇 开发服务器&自动化\n\n每次写完代码都需要手动输入指令才能编译代码，太麻烦了，我们希望一切自动化\n\n### 1、下载包\n\n```javascript\nnpm i webpack-dev-server -D\n```\n\n### 2、配置开发服务器\n\n```javascript\n// 开发服务器\n  devServer: {\n    host: \"localhost\", // 启动服务器域名\n    port: \"3000\", // 启动服务器端口号\n    open: true, // 是否自动打开浏览器\n  },\n```\n\n## 🥇 生产模式配置\n\n生产模式是开发完成代码后，我们需要得到代码将来部署上线。这个模式下我们主要对代码进行优化，让其运行性能更好。优化主要从两个角度出发:\n1、优化代码运行性能\n2、优化代码打包速度\n\n### 1、准备\n\n在根目录下创建 config 文件夹用来放置开发环境和生产环境的配置 webpack.dev.js、webpack.prod.js\n\n### 2、修改 webpack.dev.js 文件\n\n因为文件目录变了，所以所有绝对路径需要回退一层目录才能找到对应的文件\n完整代码如下：\n\n```javascript\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: undefined, // 开发模式没有输出，不需要指定输出目录\n    filename: 'static/js/main.js' // 将 js 文件输出到 static/js 目录中\n    // clean: true, // 开发模式没有输出，不需要清空输出结果\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      },\n      {\n        test: /\\.less$/,\n        use: ['style-loader', 'css-loader', 'less-loader']\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: ['style-loader', 'css-loader', 'sass-loader']\n      },\n      {\n        test: /\\.styl$/,\n        use: ['style-loader', 'css-loader', 'stylus-loader']\n      },\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset',\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        },\n        generator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: 'static/imgs/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.(ttf|woff2?)$/,\n        type: 'asset/resource',\n        generator: {\n          filename: 'static/media/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: 'babel-loader'\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src')\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    })\n  ],\n  // 其他省略\n  devServer: {\n    host: 'localhost', // 启动服务器域名\n    port: '3000', // 启动服务器端口号\n    open: true // 是否自动打开浏览器\n  },\n  mode: 'development'\n}\n```\n\n运行开发模式的指令：`npx webpack serve --config ./config/webpack.dev.js`\n\n### 3、修改 webpack.prod.js 文件\n\n修改后的代码如下：\n\n```javascript\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, '../dist'), // 生产模式需要输出\n    filename: 'static/js/main.js', // 将 js 文件输出到 static/js 目录中\n    clean: true\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      },\n      {\n        test: /\\.less$/,\n        use: ['style-loader', 'css-loader', 'less-loader']\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: ['style-loader', 'css-loader', 'sass-loader']\n      },\n      {\n        test: /\\.styl$/,\n        use: ['style-loader', 'css-loader', 'stylus-loader']\n      },\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset',\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        },\n        generator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: 'static/imgs/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.(ttf|woff2?)$/,\n        type: 'asset/resource',\n        generator: {\n          filename: 'static/media/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: 'babel-loader'\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src')\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    })\n  ],\n  // devServer: {\n  //   host: \"localhost\", // 启动服务器域名\n  //   port: \"3000\", // 启动服务器端口号\n  //   open: true, // 是否自动打开浏览器\n  // },\n  mode: 'production'\n}\n```\n\n运行如下指令：`npx webpack --config ./config/webpack.prod.js`\n\n### 4、修改 package.json 文件\n\n修改 script 使得指令更简单：\n\n```javascript\n// package.json\n{\n  // 其他省略\n  \"scripts\": {\n    \"start\": \"npm run dev\",\n    \"dev\": \"npx webpack serve --config ./config/webpack.dev.js\",\n    \"build\": \"npx webpack --config ./config/webpack.prod.js\"\n  }\n}\n```\n\n## 🥇 Css 的处理\n\n### 1、提取 css 成单独文件\n\nCss 文件目前被打包到 js 文件中，当 js 文件加载时，会创建一个 style 标签来生成样式这样对于网站来说，会出现闪屏现象，用户体验不好我们应该是单独的 Css 文件，通过 link 标签加载性能才好；\n1、下载包：\n\n```javascript\nnpm i mini-css-extract-plugin -D\n```\n\n2、webpack.prod.js 中添加如下代码：\n在 use 数组中添加 MiniCssExtractPlugin.loader\n\n```javascript\n{\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: [MiniCssExtractPlugin.loader, \"css-loader\"],\n      },\n      {\n        test: /\\.less$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"less-loader\"],\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"sass-loader\"],\n      },\n      {\n        test: /\\.styl$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"stylus-loader\"],\n      },\n```\n\n在 plugin 插件中配置如下代码：\n\n```javascript\n// 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: \"static/css/main.css\",\n    }),\n```\n\n### 2、css 兼容性处理\n\n1、下载包：\n\n```javascript\nnpm i postcss-loader postcss postcss-preset-env -D\n```\n\n2、在 css-loader 下添加如下配置：\n\n```javascript\n{\n            loader: \"postcss-loader\",\n            options: {\n              postcssOptions: {\n                plugins: [\n                  \"postcss-preset-env\", // 能解决大多数样式兼容性问题\n                ],\n              },\n            },\n          },\n```\n\n3、控制兼容性\n我们可以在 package.json 文件中添加 browserslist 来控制样式的兼容性做到什么程度。\n\n```javascript\n{\n  // 其他省略\n  \"browserslist\": [\"last 2 version\", \"> 1%\", \"not dead\"]\n}\n```\n\n### 3、css 压缩\n\n1、下载包：\n\n```javascript\nnpm i css-minimizer-webpack-plugin -D\n```\n\n2、在 plugins 模块配置如下代码：\n\n```javascript\n // css压缩\n    new CssMinimizerPlugin(),\n```\n\n## 🥇 html 压缩\n\n默认生产模式已经开启了：html 压缩和 js 压缩不需要额外进行配置\n\n## 🥇 总结\n\n本章文章我们学会了 Webpack 基本使用，掌握了以下功能：\n\n1、两种开发模式\n1.1 开发模式：代码能编译自动化运行\n1.2 生产模式：代码编译优化输出\n2、Webpack 基本功能\n2.1 开发模式：可以编译 ES Module 语法\n2.2 生产模式：可以编译 ES Module 语法，压缩 js 代码\n3、Webpack 配置文件 5 个核心概念\nentry\noutput\nloader\nplugins\nmode\ndevServer 配置\nWebpack 脚本指令用法\nwebpack 直接打包输出\nwebpack serve 启动开发服务器，内存编译打包没有输出\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/webpackConfig.md","raw":"---\ntitle: 从零搭建webpack\ndescription: 本篇文章将从基础配置入手，带大家了解webpack的核心；\nheadimg: /images/webpack.jpeg\ndate: 2022-03-22\ntags:\n  - Webpack\ncategories:\n  - Webpack\n---\n\n## 前言\n\n本质上，webpack 是一个用于现代 JavaScript 应用程序的 静态模块打包工具。当 webpack 处理应用程序时，它会在内部从一个或多个入口点构建一个 依赖图(dependency graph)，然后将你项目中所需的每一个模块组合成一个或多个 bundles，它们均为静态资源，用于展示你的内容，可想而知 webpack 的重要性。然而由于 vuecli 的出现，我们不再把更多的重心放到 webpack 的配置，导致对 webpack 的配置以及优化逐渐失去了自己的认识，本篇文章将从基础配置入手，带大家了解 webpack 的核心；\n\n## 🥇 准备\n\n首先我们需要在项目的根目录创建 webpack.config.js 文件用于 webpack 的配置，Webpack 是基于 Node.js 运行的，所以采用 Common.js 模块化规范；其五大核心为：entry、output、module、plugins、mode；代码如下所示：\n\n```javascript\nmodule.exports = {\n  // 入口\n  entry: '',\n  // 输出\n  output: {},\n  // 加载器\n  module: {\n    rules: []\n  },\n  // 插件\n  plugins: [],\n  // 模式\n  mode: ''\n}\n```\n\n## 🥇 开发模式的配置\n\n开发模式顾名思义就是我们开发代码时使用的模式。这个模式下我们主要做两件事：==1、编译代码，使浏览器能识别运行开发时我们有样式资源、字体图标、图片资源、html 资源等，webpack 默认都不能处理这些资源，所以我们要加载配置来编译这些资源代码质量检查，2、树立代码规范提前检查代码的一些隐患，让代码运行时能更加健壮。提前检查代码规范和格式，统一团队编码风格，让代码更优雅美观。==\n\n### 1、处理 css 样式资源\n\n由于 Webpack 是不能解析样式资源的因此我们需要借助 loader 去帮组 webpack 解析样式资源；官方文档有对应的 loader 模块，我们可以参考官方文档进行 loader 的配置；链接如下：\n[webpack----------Loader 地址](https://webpack.docschina.org/loaders/)\n第一步下载 loader，代码如下所示：\n\n```javascript\nnpm i css-loader style-loader -D\n```\n\n第二步在配置文件中配置，代码如下所示：\n\n```javascript\nconst path = require('path')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: 'main.js'\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      }\n    ]\n  },\n  plugins: [],\n  mode: 'development'\n}\n```\n\n对 less、sass、styl 资源的处理和 css 资源的处理雷同，不再累述，查看官方文档进行配置即可;\n\n### 2、处理图片资源\n\n在 Webapack4 我们需要对一个两个 loader 对图片资源处理图片，而 webpack5 已经将处理图片的 loader 内置处理了，现在只需要进行简单配置就能处理图片资源，配置代码如下所示：\n\n```javascript\nconst path = require('path')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: 'main.js'\n  },\n  module: {\n    rules: [\n      //...........处理图片资源的配置\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset'\n      }\n    ]\n  },\n  plugins: [],\n  mode: 'development'\n}\n```\n\n#### 2.1 对图片资源进行优化\n\n项目中肯定会存在一定的图片资源，为了减少向后端发请求的次数，我们配置了小于 10kb 的图片转 base64 格式的配置项；\n\n```javascript\n {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: \"asset\",\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        }\n      },\n```\n\n### 3、修改输出资源的名称和路径\n\n输出 js 文件名称和路径的配置在如下 output 中配置：\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"dist\"),\n    filename: \"static/js/main.js\", // 将 js 文件输出到 static/js 目录中\n  },\n```\n\n输出图片的名称和路径的配置如下：\n\n```javascript\ngenerator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: \"static/imgs/[hash:8][ext][query]\",\n        },\n```\n\n### 4、自动清空上次打包的配置\n\n由于每次在打包资源之前我们都需要手动删除 dist 目录下的打包文件，非常麻烦，因此需要配置每次打包之前先清除 dist 目录下的资源再进行打包，配置代码如下：\n\n```javascript\noutput: {\n    path: path.resolve(__dirname, \"dist\"),\n    filename: \"static/js/main.js\",\n    clean: true, // 自动将上次打包目录资源清空\n  },\n```\n\n### 5、字体图标资源的处理\n\n对于字体图标的处理和图片资源的处理类似，因为 webpack 内置的有 loader 解析，我们只需要简单的配置即可，配置代码如下：\n\n```javascript\n{\n        test: /\\.(ttf|woff2?)$/,\n        type: \"asset/resource\",\n        generator: {\n          filename: \"static/media/[hash:8][ext][query]\",\n        },\n      },\n```\n\n注意：📣 type: \"asset/resource\"和 type: \"asset\"的区别：\ntype: \"asset/resource\" 相当于 file-loader, 将文件转化成 Webpack 能识别的资源，其他不做处理\ntype: \"asset\" 相当于 url-loader, 将文件转化成 Webpack 能识别的资源，同时小于某个大小的资源会处理成 data URI 形式 ❗❗❗\n\n### 6、处理其它资源\n\n开发中可能还存在一些其他资源，如音视频等，我们在字体图标的配置中也一起处理了，代码如下：\n\n```javascript\n{\n        test: /\\.(ttf|woff2?|map4|map3|avi)$/,\n        type: \"asset/resource\",\n        generator: {\n          filename: \"static/media/[hash:8][ext][query]\",\n        },\n      },\n```\n\n### 7、处理 js 资源\n\n#### 7.1 Eslint\n\n在团队的开发中对代码的格式是有严格的要求，因此为了团队代码的规范，我们需要配置 eslint 去保证开发的代码格式的一致性；首先我们需要在项目的根目录下创建一个.eslintrc.js 文件，在里面配置如下三项规则：\n\n```javascript\nmodule.exports = {\n  // 解析选项\n  parserOptions: {},\n  // 具体检查规则\n  rules: {},\n  // 继承其他规则\n  extends: []\n  // ...\n  // 其他规则详见：https://eslint.bootcss.com/docs/user-guide/configuring\n}\n```\n\n1、parserOptions 选项配置如下：\n\n```javascript\nparserOptions: {\n  ecmaVersion: 6, // ES 语法版本\n  sourceType: \"module\", // ES 模块化\n  ecmaFeatures: { // ES 其他特性\n    jsx: true // 如果是 React 项目，就需要开启 jsx 语法\n  }\n}\n```\n\n2、rules 的配置规则：\n\"off\" 或 0 - 关闭规则\n\"warn\" 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)\n\"error\" 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)；\n其配置如下所示：\n\n```javascript\nrules: {\n  semi: \"error\", // 禁止使用分号\n  'array-callback-return': 'warn', // 强制数组方法的回调函数中有 return 语句，否则警告\n  'default-case': [\n    'warn', // 要求 switch 语句中有 default 分支，否则警告\n    { commentPattern: '^no default$' } // 允许在最后注释 no default, 就不会有警告了\n  ],\n  eqeqeq: [\n    'warn', // 强制使用 === 和 !==，否则警告\n    'smart' // https://eslint.bootcss.com/docs/rules/eqeqeq#smart 除了少数情况下不会有警告\n  ],\n}\n```\n\n更多规则可以参考如下官方文档：[ESLint 官方](https://eslint.bootcss.com/docs/rules/)\n3、在 webpack 中的使用：\n\n```javascript\nmodule.exports = {\n  // 继承 Eslint 规则\n  extends: ['eslint:recommended'],\n  env: {\n    node: true, // 启用node中全局变量\n    browser: true // 启用浏览器中全局变量\n  },\n  parserOptions: {\n    ecmaVersion: 6,\n    sourceType: 'module'\n  },\n  rules: {\n    'no-var': 2 // 不能使用 var 定义变量\n  }\n}\n```\n\n与此同时我们可以在 webpackconfig.js 中配置插件指定检查文件的目录：\n\n```javascript\nplugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, \"src\"),\n    }),\n  ],\n```\n\n配置插件之前需要下载插件并且引入，文章以下的内容不再累述下包引入的过程；\n\n##### 7.1.1 VS Code 的 Eslint 插件\n\n打开 VSCode，下载 Eslint 插件，即可不用编译就能看到错误，可以提前解决但是此时就会对项目所有文件默认进行 Eslint 检查了，我们 dist 目录下的打包后文件就会报错。但是我们只需要检查 src 下面的文件，不需要检查 dist 下面的文件。所以可以使用 Eslint 忽略文件解决。在项目根目录新建.eslintignore 文件:\n\n```javascript\n# 忽略dist目录下所有文件\ndist\n```\n\n#### 7.2 Babel\n\nBabel 为 javascript 编译器，主要用于将 ES6 语法编写的代码转换为向后兼容的 JavaScript 语法，以便能够运行在当前和旧版本的浏览器或其他环境中；我们需要先在根目录下创建一个 babel.config.js 文件；\n在 webpack 中的使用：\n1、下载包：\n\n```javascript\nnpm i babel-loader @babel/core @babel/preset-env -D\n```\n\n2、定义 babel.config.js 文件\n\n```javascript\nmodule.exports = {\n  presets: ['@babel/preset-env']\n}\n```\n\n3、webconfig.js 中配置如下代码：\n\n```javascript\n {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: \"babel-loader\",\n      },\n```\n\n以上代码配置排除 node_modules 文件，提高打包的速度；\n\n### 8、处理 html 资源\n\n1、下载包\n\n```javascript\nnpm i html-webpack-plugin -D\n```\n\n2、在插件模块配置如下代码：\n\n```javascript\n new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, \"public/index.html\"),\n    }),\n```\n\n## 🥇 开发服务器&自动化\n\n每次写完代码都需要手动输入指令才能编译代码，太麻烦了，我们希望一切自动化\n\n### 1、下载包\n\n```javascript\nnpm i webpack-dev-server -D\n```\n\n### 2、配置开发服务器\n\n```javascript\n// 开发服务器\n  devServer: {\n    host: \"localhost\", // 启动服务器域名\n    port: \"3000\", // 启动服务器端口号\n    open: true, // 是否自动打开浏览器\n  },\n```\n\n## 🥇 生产模式配置\n\n生产模式是开发完成代码后，我们需要得到代码将来部署上线。这个模式下我们主要对代码进行优化，让其运行性能更好。优化主要从两个角度出发:\n1、优化代码运行性能\n2、优化代码打包速度\n\n### 1、准备\n\n在根目录下创建 config 文件夹用来放置开发环境和生产环境的配置 webpack.dev.js、webpack.prod.js\n\n### 2、修改 webpack.dev.js 文件\n\n因为文件目录变了，所以所有绝对路径需要回退一层目录才能找到对应的文件\n完整代码如下：\n\n```javascript\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: undefined, // 开发模式没有输出，不需要指定输出目录\n    filename: 'static/js/main.js' // 将 js 文件输出到 static/js 目录中\n    // clean: true, // 开发模式没有输出，不需要清空输出结果\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      },\n      {\n        test: /\\.less$/,\n        use: ['style-loader', 'css-loader', 'less-loader']\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: ['style-loader', 'css-loader', 'sass-loader']\n      },\n      {\n        test: /\\.styl$/,\n        use: ['style-loader', 'css-loader', 'stylus-loader']\n      },\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset',\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        },\n        generator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: 'static/imgs/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.(ttf|woff2?)$/,\n        type: 'asset/resource',\n        generator: {\n          filename: 'static/media/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: 'babel-loader'\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src')\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    })\n  ],\n  // 其他省略\n  devServer: {\n    host: 'localhost', // 启动服务器域名\n    port: '3000', // 启动服务器端口号\n    open: true // 是否自动打开浏览器\n  },\n  mode: 'development'\n}\n```\n\n运行开发模式的指令：`npx webpack serve --config ./config/webpack.dev.js`\n\n### 3、修改 webpack.prod.js 文件\n\n修改后的代码如下：\n\n```javascript\nconst path = require('path')\nconst ESLintWebpackPlugin = require('eslint-webpack-plugin')\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nmodule.exports = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, '../dist'), // 生产模式需要输出\n    filename: 'static/js/main.js', // 将 js 文件输出到 static/js 目录中\n    clean: true\n  },\n  module: {\n    rules: [\n      {\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: ['style-loader', 'css-loader']\n      },\n      {\n        test: /\\.less$/,\n        use: ['style-loader', 'css-loader', 'less-loader']\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: ['style-loader', 'css-loader', 'sass-loader']\n      },\n      {\n        test: /\\.styl$/,\n        use: ['style-loader', 'css-loader', 'stylus-loader']\n      },\n      {\n        test: /\\.(png|jpe?g|gif|webp)$/,\n        type: 'asset',\n        parser: {\n          dataUrlCondition: {\n            maxSize: 10 * 1024 // 小于10kb的图片会被base64处理\n          }\n        },\n        generator: {\n          // 将图片文件输出到 static/imgs 目录中\n          // 将图片文件命名 [hash:8][ext][query]\n          // [hash:8]: hash值取8位\n          // [ext]: 使用之前的文件扩展名\n          // [query]: 添加之前的query参数\n          filename: 'static/imgs/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.(ttf|woff2?)$/,\n        type: 'asset/resource',\n        generator: {\n          filename: 'static/media/[hash:8][ext][query]'\n        }\n      },\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/, // 排除node_modules代码不编译\n        loader: 'babel-loader'\n      }\n    ]\n  },\n  plugins: [\n    new ESLintWebpackPlugin({\n      // 指定检查文件的根目录\n      context: path.resolve(__dirname, '../src')\n    }),\n    new HtmlWebpackPlugin({\n      // 以 public/index.html 为模板创建文件\n      // 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源\n      template: path.resolve(__dirname, '../public/index.html')\n    })\n  ],\n  // devServer: {\n  //   host: \"localhost\", // 启动服务器域名\n  //   port: \"3000\", // 启动服务器端口号\n  //   open: true, // 是否自动打开浏览器\n  // },\n  mode: 'production'\n}\n```\n\n运行如下指令：`npx webpack --config ./config/webpack.prod.js`\n\n### 4、修改 package.json 文件\n\n修改 script 使得指令更简单：\n\n```javascript\n// package.json\n{\n  // 其他省略\n  \"scripts\": {\n    \"start\": \"npm run dev\",\n    \"dev\": \"npx webpack serve --config ./config/webpack.dev.js\",\n    \"build\": \"npx webpack --config ./config/webpack.prod.js\"\n  }\n}\n```\n\n## 🥇 Css 的处理\n\n### 1、提取 css 成单独文件\n\nCss 文件目前被打包到 js 文件中，当 js 文件加载时，会创建一个 style 标签来生成样式这样对于网站来说，会出现闪屏现象，用户体验不好我们应该是单独的 Css 文件，通过 link 标签加载性能才好；\n1、下载包：\n\n```javascript\nnpm i mini-css-extract-plugin -D\n```\n\n2、webpack.prod.js 中添加如下代码：\n在 use 数组中添加 MiniCssExtractPlugin.loader\n\n```javascript\n{\n        // 用来匹配 .css 结尾的文件\n        test: /\\.css$/,\n        // use 数组里面 Loader 执行顺序是从右到左\n        use: [MiniCssExtractPlugin.loader, \"css-loader\"],\n      },\n      {\n        test: /\\.less$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"less-loader\"],\n      },\n      {\n        test: /\\.s[ac]ss$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"sass-loader\"],\n      },\n      {\n        test: /\\.styl$/,\n        use: [MiniCssExtractPlugin.loader, \"css-loader\", \"stylus-loader\"],\n      },\n```\n\n在 plugin 插件中配置如下代码：\n\n```javascript\n// 提取css成单独文件\n    new MiniCssExtractPlugin({\n      // 定义输出文件名和目录\n      filename: \"static/css/main.css\",\n    }),\n```\n\n### 2、css 兼容性处理\n\n1、下载包：\n\n```javascript\nnpm i postcss-loader postcss postcss-preset-env -D\n```\n\n2、在 css-loader 下添加如下配置：\n\n```javascript\n{\n            loader: \"postcss-loader\",\n            options: {\n              postcssOptions: {\n                plugins: [\n                  \"postcss-preset-env\", // 能解决大多数样式兼容性问题\n                ],\n              },\n            },\n          },\n```\n\n3、控制兼容性\n我们可以在 package.json 文件中添加 browserslist 来控制样式的兼容性做到什么程度。\n\n```javascript\n{\n  // 其他省略\n  \"browserslist\": [\"last 2 version\", \"> 1%\", \"not dead\"]\n}\n```\n\n### 3、css 压缩\n\n1、下载包：\n\n```javascript\nnpm i css-minimizer-webpack-plugin -D\n```\n\n2、在 plugins 模块配置如下代码：\n\n```javascript\n // css压缩\n    new CssMinimizerPlugin(),\n```\n\n## 🥇 html 压缩\n\n默认生产模式已经开启了：html 压缩和 js 压缩不需要额外进行配置\n\n## 🥇 总结\n\n本章文章我们学会了 Webpack 基本使用，掌握了以下功能：\n\n1、两种开发模式\n1.1 开发模式：代码能编译自动化运行\n1.2 生产模式：代码编译优化输出\n2、Webpack 基本功能\n2.1 开发模式：可以编译 ES Module 语法\n2.2 生产模式：可以编译 ES Module 语法，压缩 js 代码\n3、Webpack 配置文件 5 个核心概念\nentry\noutput\nloader\nplugins\nmode\ndevServer 配置\nWebpack 脚本指令用法\nwebpack 直接打包输出\nwebpack serve 启动开发服务器，内存编译打包没有输出\n\n## 写在最后\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"webpackConfig","published":1,"updated":"2023-03-15T12:26:10.944Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfo002fp5o14emk5gwg","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本质上，webpack 是一个用于现代 JavaScript 应用程序的 静态模块打包工具。当 webpack 处理应用程序时，它会在内部从一个或多个入口点构建一个 依赖图(dependency graph)，然后将你项目中所需的每一个模块组合成一个或多个 bundles，它们均为静态资源，用于展示你的内容，可想而知 webpack 的重要性。然而由于 vuecli 的出现，我们不再把更多的重心放到 webpack 的配置，导致对 webpack 的配置以及优化逐渐失去了自己的认识，本篇文章将从基础配置入手，带大家了解 webpack 的核心；</p>\n<h2 id=\"🥇-准备\"><a href=\"#🥇-准备\" class=\"headerlink\" title=\"🥇 准备\"></a>🥇 准备</h2><p>首先我们需要在项目的根目录创建 webpack.config.js 文件用于 webpack 的配置，Webpack 是基于 Node.js 运行的，所以采用 Common.js 模块化规范；其五大核心为：entry、output、module、plugins、mode；代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 入口</span></span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 加载器</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: []</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 插件</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"comment\">// 模式</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-开发模式的配置\"><a href=\"#🥇-开发模式的配置\" class=\"headerlink\" title=\"🥇 开发模式的配置\"></a>🥇 开发模式的配置</h2><p>开发模式顾名思义就是我们开发代码时使用的模式。这个模式下我们主要做两件事：==1、编译代码，使浏览器能识别运行开发时我们有样式资源、字体图标、图片资源、html 资源等，webpack 默认都不能处理这些资源，所以我们要加载配置来编译这些资源代码质量检查，2、树立代码规范提前检查代码的一些隐患，让代码运行时能更加健壮。提前检查代码规范和格式，统一团队编码风格，让代码更优雅美观。==</p>\n<h3 id=\"1、处理-css-样式资源\"><a href=\"#1、处理-css-样式资源\" class=\"headerlink\" title=\"1、处理 css 样式资源\"></a>1、处理 css 样式资源</h3><p>由于 Webpack 是不能解析样式资源的因此我们需要借助 loader 去帮组 webpack 解析样式资源；官方文档有对应的 loader 模块，我们可以参考官方文档进行 loader 的配置；链接如下：<br><a href=\"https://webpack.docschina.org/loaders/\">webpack———-Loader 地址</a><br>第一步下载 loader，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-loader style-loader -D</span><br></pre></td></tr></table></figure>\n\n<p>第二步在配置文件中配置，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>对 less、sass、styl 资源的处理和 css 资源的处理雷同，不再累述，查看官方文档进行配置即可;</p>\n<h3 id=\"2、处理图片资源\"><a href=\"#2、处理图片资源\" class=\"headerlink\" title=\"2、处理图片资源\"></a>2、处理图片资源</h3><p>在 Webapack4 我们需要对一个两个 loader 对图片资源处理图片，而 webpack5 已经将处理图片的 loader 内置处理了，现在只需要进行简单配置就能处理图片资源，配置代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">//...........处理图片资源的配置</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-1-对图片资源进行优化\"><a href=\"#2-1-对图片资源进行优化\" class=\"headerlink\" title=\"2.1 对图片资源进行优化\"></a>2.1 对图片资源进行优化</h4><p>项目中肯定会存在一定的图片资源，为了减少向后端发请求的次数，我们配置了小于 10kb 的图片转 base64 格式的配置项；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">       <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">       <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">         <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">           <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、修改输出资源的名称和路径\"><a href=\"#3、修改输出资源的名称和路径\" class=\"headerlink\" title=\"3、修改输出资源的名称和路径\"></a>3、修改输出资源的名称和路径</h3><p>输出 js 文件名称和路径的配置在如下 output 中配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>输出图片的名称和路径的配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/imgs/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4、自动清空上次打包的配置\"><a href=\"#4、自动清空上次打包的配置\" class=\"headerlink\" title=\"4、自动清空上次打包的配置\"></a>4、自动清空上次打包的配置</h3><p>由于每次在打包资源之前我们都需要手动删除 dist 目录下的打包文件，非常麻烦，因此需要配置每次打包之前先清除 dist 目录下的资源再进行打包，配置代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 自动将上次打包目录资源清空</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、字体图标资源的处理\"><a href=\"#5、字体图标资源的处理\" class=\"headerlink\" title=\"5、字体图标资源的处理\"></a>5、字体图标资源的处理</h3><p>对于字体图标的处理和图片资源的处理类似，因为 webpack 内置的有 loader 解析，我们只需要简单的配置即可，配置代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>注意：📣 type: “asset/resource”和 type: “asset”的区别：<br>type: “asset/resource” 相当于 file-loader, 将文件转化成 Webpack 能识别的资源，其他不做处理<br>type: “asset” 相当于 url-loader, 将文件转化成 Webpack 能识别的资源，同时小于某个大小的资源会处理成 data URI 形式 ❗❗❗</p>\n<h3 id=\"6、处理其它资源\"><a href=\"#6、处理其它资源\" class=\"headerlink\" title=\"6、处理其它资源\"></a>6、处理其它资源</h3><p>开发中可能还存在一些其他资源，如音视频等，我们在字体图标的配置中也一起处理了，代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?|map4|map3|avi)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、处理-js-资源\"><a href=\"#7、处理-js-资源\" class=\"headerlink\" title=\"7、处理 js 资源\"></a>7、处理 js 资源</h3><h4 id=\"7-1-Eslint\"><a href=\"#7-1-Eslint\" class=\"headerlink\" title=\"7.1 Eslint\"></a>7.1 Eslint</h4><p>在团队的开发中对代码的格式是有严格的要求，因此为了团队代码的规范，我们需要配置 eslint 去保证开发的代码格式的一致性；首先我们需要在项目的根目录下创建一个.eslintrc.js 文件，在里面配置如下三项规则：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 解析选项</span></span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 具体检查规则</span></span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 继承其他规则</span></span><br><span class=\"line\">  <span class=\"attr\">extends</span>: []</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"comment\">// 其他规则详见：https://eslint.bootcss.com/docs/user-guide/configuring</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1、parserOptions 选项配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">ecmaVersion</span>: <span class=\"number\">6</span>, <span class=\"comment\">// ES 语法版本</span></span><br><span class=\"line\">  <span class=\"attr\">sourceType</span>: <span class=\"string\">&quot;module&quot;</span>, <span class=\"comment\">// ES 模块化</span></span><br><span class=\"line\">  <span class=\"attr\">ecmaFeatures</span>: &#123; <span class=\"comment\">// ES 其他特性</span></span><br><span class=\"line\">    <span class=\"attr\">jsx</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 如果是 React 项目，就需要开启 jsx 语法</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2、rules 的配置规则：<br>“off” 或 0 - 关闭规则<br>“warn” 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)<br>“error” 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)；<br>其配置如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">semi</span>: <span class=\"string\">&quot;error&quot;</span>, <span class=\"comment\">// 禁止使用分号</span></span><br><span class=\"line\">  <span class=\"string\">&#x27;array-callback-return&#x27;</span>: <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 强制数组方法的回调函数中有 return 语句，否则警告</span></span><br><span class=\"line\">  <span class=\"string\">&#x27;default-case&#x27;</span>: [</span><br><span class=\"line\">    <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 要求 switch 语句中有 default 分支，否则警告</span></span><br><span class=\"line\">    &#123; <span class=\"attr\">commentPattern</span>: <span class=\"string\">&#x27;^no default$&#x27;</span> &#125; <span class=\"comment\">// 允许在最后注释 no default, 就不会有警告了</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">eqeqeq</span>: [</span><br><span class=\"line\">    <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 强制使用 === 和 !==，否则警告</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;smart&#x27;</span> <span class=\"comment\">// https://eslint.bootcss.com/docs/rules/eqeqeq#smart 除了少数情况下不会有警告</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>更多规则可以参考如下官方文档：<a href=\"https://eslint.bootcss.com/docs/rules/\">ESLint 官方</a><br>3、在 webpack 中的使用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 继承 Eslint 规则</span></span><br><span class=\"line\">  <span class=\"attr\">extends</span>: [<span class=\"string\">&#x27;eslint:recommended&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">env</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">node</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 启用node中全局变量</span></span><br><span class=\"line\">    <span class=\"attr\">browser</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 启用浏览器中全局变量</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">ecmaVersion</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">    <span class=\"attr\">sourceType</span>: <span class=\"string\">&#x27;module&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-var&#x27;</span>: <span class=\"number\">2</span> <span class=\"comment\">// 不能使用 var 定义变量</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>与此同时我们可以在 webpackconfig.js 中配置插件指定检查文件的目录：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">  ],</span><br></pre></td></tr></table></figure>\n\n<p>配置插件之前需要下载插件并且引入，文章以下的内容不再累述下包引入的过程；</p>\n<h5 id=\"7-1-1-VS-Code-的-Eslint-插件\"><a href=\"#7-1-1-VS-Code-的-Eslint-插件\" class=\"headerlink\" title=\"7.1.1 VS Code 的 Eslint 插件\"></a>7.1.1 VS Code 的 Eslint 插件</h5><p>打开 VSCode，下载 Eslint 插件，即可不用编译就能看到错误，可以提前解决但是此时就会对项目所有文件默认进行 Eslint 检查了，我们 dist 目录下的打包后文件就会报错。但是我们只需要检查 src 下面的文件，不需要检查 dist 下面的文件。所以可以使用 Eslint 忽略文件解决。在项目根目录新建.eslintignore 文件:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 忽略dist目录下所有文件</span><br><span class=\"line\">dist</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"7-2-Babel\"><a href=\"#7-2-Babel\" class=\"headerlink\" title=\"7.2 Babel\"></a>7.2 Babel</h4><p>Babel 为 javascript 编译器，主要用于将 ES6 语法编写的代码转换为向后兼容的 JavaScript 语法，以便能够运行在当前和旧版本的浏览器或其他环境中；我们需要先在根目录下创建一个 babel.config.js 文件；<br>在 webpack 中的使用：<br>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i babel-loader @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>\n\n<p>2、定义 babel.config.js 文件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">presets</span>: [<span class=\"string\">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3、webconfig.js 中配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">       <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">       <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>以上代码配置排除 node_modules 文件，提高打包的速度；</p>\n<h3 id=\"8、处理-html-资源\"><a href=\"#8、处理-html-资源\" class=\"headerlink\" title=\"8、处理 html 资源\"></a>8、处理 html 资源</h3><p>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在插件模块配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">     <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">     <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">     <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;public/index.html&quot;</span>),</span><br><span class=\"line\">   &#125;),</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-开发服务器-amp-自动化\"><a href=\"#🥇-开发服务器-amp-自动化\" class=\"headerlink\" title=\"🥇 开发服务器&amp;自动化\"></a>🥇 开发服务器&amp;自动化</h2><p>每次写完代码都需要手动输入指令才能编译代码，太麻烦了，我们希望一切自动化</p>\n<h3 id=\"1、下载包\"><a href=\"#1、下载包\" class=\"headerlink\" title=\"1、下载包\"></a>1、下载包</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、配置开发服务器\"><a href=\"#2、配置开发服务器\" class=\"headerlink\" title=\"2、配置开发服务器\"></a>2、配置开发服务器</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 开发服务器</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&quot;localhost&quot;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&quot;3000&quot;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-生产模式配置\"><a href=\"#🥇-生产模式配置\" class=\"headerlink\" title=\"🥇 生产模式配置\"></a>🥇 生产模式配置</h2><p>生产模式是开发完成代码后，我们需要得到代码将来部署上线。这个模式下我们主要对代码进行优化，让其运行性能更好。优化主要从两个角度出发:<br>1、优化代码运行性能<br>2、优化代码打包速度</p>\n<h3 id=\"1、准备\"><a href=\"#1、准备\" class=\"headerlink\" title=\"1、准备\"></a>1、准备</h3><p>在根目录下创建 config 文件夹用来放置开发环境和生产环境的配置 webpack.dev.js、webpack.prod.js</p>\n<h3 id=\"2、修改-webpack-dev-js-文件\"><a href=\"#2、修改-webpack-dev-js-文件\" class=\"headerlink\" title=\"2、修改 webpack.dev.js 文件\"></a>2、修改 webpack.dev.js 文件</h3><p>因为文件目录变了，所以所有绝对路径需要回退一层目录才能找到对应的文件<br>完整代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"literal\">undefined</span>, <span class=\"comment\">// 开发模式没有输出，不需要指定输出目录</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span> <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"comment\">// clean: true, // 开发模式没有输出，不需要清空输出结果</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;less-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;sass-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;stylus-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;localhost&#x27;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&#x27;3000&#x27;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>运行开发模式的指令：<code>npx webpack serve --config ./config/webpack.dev.js</code></p>\n<h3 id=\"3、修改-webpack-prod-js-文件\"><a href=\"#3、修改-webpack-prod-js-文件\" class=\"headerlink\" title=\"3、修改 webpack.prod.js 文件\"></a>3、修改 webpack.prod.js 文件</h3><p>修改后的代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../dist&#x27;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;less-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;sass-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;stylus-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// devServer: &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   host: &quot;localhost&quot;, // 启动服务器域名</span></span><br><span class=\"line\">  <span class=\"comment\">//   port: &quot;3000&quot;, // 启动服务器端口号</span></span><br><span class=\"line\">  <span class=\"comment\">//   open: true, // 是否自动打开浏览器</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>运行如下指令：<code>npx webpack --config ./config/webpack.prod.js</code></p>\n<h3 id=\"4、修改-package-json-文件\"><a href=\"#4、修改-package-json-文件\" class=\"headerlink\" title=\"4、修改 package.json 文件\"></a>4、修改 package.json 文件</h3><p>修改 script 使得指令更简单：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"string\">&quot;scripts&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;start&quot;</span>: <span class=\"string\">&quot;npm run dev&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;dev&quot;</span>: <span class=\"string\">&quot;npx webpack serve --config ./config/webpack.dev.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;build&quot;</span>: <span class=\"string\">&quot;npx webpack --config ./config/webpack.prod.js&quot;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-Css-的处理\"><a href=\"#🥇-Css-的处理\" class=\"headerlink\" title=\"🥇 Css 的处理\"></a>🥇 Css 的处理</h2><h3 id=\"1、提取-css-成单独文件\"><a href=\"#1、提取-css-成单独文件\" class=\"headerlink\" title=\"1、提取 css 成单独文件\"></a>1、提取 css 成单独文件</h3><p>Css 文件目前被打包到 js 文件中，当 js 文件加载时，会创建一个 style 标签来生成样式这样对于网站来说，会出现闪屏现象，用户体验不好我们应该是单独的 Css 文件，通过 link 标签加载性能才好；<br>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、webpack.prod.js 中添加如下代码：<br>在 use 数组中添加 MiniCssExtractPlugin.loader</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;less-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;sass-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;stylus-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>在 plugin 插件中配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/css/main.css&quot;</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、css-兼容性处理\"><a href=\"#2、css-兼容性处理\" class=\"headerlink\" title=\"2、css 兼容性处理\"></a>2、css 兼容性处理</h3><p>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i postcss-loader postcss postcss-preset-env -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在 css-loader 下添加如下配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;postcss-loader&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">postcssOptions</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">                  <span class=\"string\">&quot;postcss-preset-env&quot;</span>, <span class=\"comment\">// 能解决大多数样式兼容性问题</span></span><br><span class=\"line\">                ],</span><br><span class=\"line\">              &#125;,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>3、控制兼容性<br>我们可以在 package.json 文件中添加 browserslist 来控制样式的兼容性做到什么程度。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"string\">&quot;browserslist&quot;</span>: [<span class=\"string\">&quot;last 2 version&quot;</span>, <span class=\"string\">&quot;&gt; 1%&quot;</span>, <span class=\"string\">&quot;not dead&quot;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、css-压缩\"><a href=\"#3、css-压缩\" class=\"headerlink\" title=\"3、css 压缩\"></a>3、css 压缩</h3><p>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-minimizer-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在 plugins 模块配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// css压缩</span></span><br><span class=\"line\">   <span class=\"keyword\">new</span> <span class=\"title class_\">CssMinimizerPlugin</span>(),</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-html-压缩\"><a href=\"#🥇-html-压缩\" class=\"headerlink\" title=\"🥇 html 压缩\"></a>🥇 html 压缩</h2><p>默认生产模式已经开启了：html 压缩和 js 压缩不需要额外进行配置</p>\n<h2 id=\"🥇-总结\"><a href=\"#🥇-总结\" class=\"headerlink\" title=\"🥇 总结\"></a>🥇 总结</h2><p>本章文章我们学会了 Webpack 基本使用，掌握了以下功能：</p>\n<p>1、两种开发模式<br>1.1 开发模式：代码能编译自动化运行<br>1.2 生产模式：代码编译优化输出<br>2、Webpack 基本功能<br>2.1 开发模式：可以编译 ES Module 语法<br>2.2 生产模式：可以编译 ES Module 语法，压缩 js 代码<br>3、Webpack 配置文件 5 个核心概念<br>entry<br>output<br>loader<br>plugins<br>mode<br>devServer 配置<br>Webpack 脚本指令用法<br>webpack 直接打包输出<br>webpack serve 启动开发服务器，内存编译打包没有输出</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>本质上，webpack 是一个用于现代 JavaScript 应用程序的 静态模块打包工具。当 webpack 处理应用程序时，它会在内部从一个或多个入口点构建一个 依赖图(dependency graph)，然后将你项目中所需的每一个模块组合成一个或多个 bundles，它们均为静态资源，用于展示你的内容，可想而知 webpack 的重要性。然而由于 vuecli 的出现，我们不再把更多的重心放到 webpack 的配置，导致对 webpack 的配置以及优化逐渐失去了自己的认识，本篇文章将从基础配置入手，带大家了解 webpack 的核心；</p>\n<h2 id=\"🥇-准备\"><a href=\"#🥇-准备\" class=\"headerlink\" title=\"🥇 准备\"></a>🥇 准备</h2><p>首先我们需要在项目的根目录创建 webpack.config.js 文件用于 webpack 的配置，Webpack 是基于 Node.js 运行的，所以采用 Common.js 模块化规范；其五大核心为：entry、output、module、plugins、mode；代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 入口</span></span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 输出</span></span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 加载器</span></span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: []</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 插件</span></span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"comment\">// 模式</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-开发模式的配置\"><a href=\"#🥇-开发模式的配置\" class=\"headerlink\" title=\"🥇 开发模式的配置\"></a>🥇 开发模式的配置</h2><p>开发模式顾名思义就是我们开发代码时使用的模式。这个模式下我们主要做两件事：==1、编译代码，使浏览器能识别运行开发时我们有样式资源、字体图标、图片资源、html 资源等，webpack 默认都不能处理这些资源，所以我们要加载配置来编译这些资源代码质量检查，2、树立代码规范提前检查代码的一些隐患，让代码运行时能更加健壮。提前检查代码规范和格式，统一团队编码风格，让代码更优雅美观。==</p>\n<h3 id=\"1、处理-css-样式资源\"><a href=\"#1、处理-css-样式资源\" class=\"headerlink\" title=\"1、处理 css 样式资源\"></a>1、处理 css 样式资源</h3><p>由于 Webpack 是不能解析样式资源的因此我们需要借助 loader 去帮组 webpack 解析样式资源；官方文档有对应的 loader 模块，我们可以参考官方文档进行 loader 的配置；链接如下：<br><a href=\"https://webpack.docschina.org/loaders/\">webpack———-Loader 地址</a><br>第一步下载 loader，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-loader style-loader -D</span><br></pre></td></tr></table></figure>\n\n<p>第二步在配置文件中配置，代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>对 less、sass、styl 资源的处理和 css 资源的处理雷同，不再累述，查看官方文档进行配置即可;</p>\n<h3 id=\"2、处理图片资源\"><a href=\"#2、处理图片资源\" class=\"headerlink\" title=\"2、处理图片资源\"></a>2、处理图片资源</h3><p>在 Webapack4 我们需要对一个两个 loader 对图片资源处理图片，而 webpack5 已经将处理图片的 loader 内置处理了，现在只需要进行简单配置就能处理图片资源，配置代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      <span class=\"comment\">//...........处理图片资源的配置</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [],</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-1-对图片资源进行优化\"><a href=\"#2-1-对图片资源进行优化\" class=\"headerlink\" title=\"2.1 对图片资源进行优化\"></a>2.1 对图片资源进行优化</h4><p>项目中肯定会存在一定的图片资源，为了减少向后端发请求的次数，我们配置了小于 10kb 的图片转 base64 格式的配置项；</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">       <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset&quot;</span>,</span><br><span class=\"line\">       <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">         <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">           <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、修改输出资源的名称和路径\"><a href=\"#3、修改输出资源的名称和路径\" class=\"headerlink\" title=\"3、修改输出资源的名称和路径\"></a>3、修改输出资源的名称和路径</h3><p>输出 js 文件名称和路径的配置在如下 output 中配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>输出图片的名称和路径的配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/imgs/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4、自动清空上次打包的配置\"><a href=\"#4、自动清空上次打包的配置\" class=\"headerlink\" title=\"4、自动清空上次打包的配置\"></a>4、自动清空上次打包的配置</h3><p>由于每次在打包资源之前我们都需要手动删除 dist 目录下的打包文件，非常麻烦，因此需要配置每次打包之前先清除 dist 目录下的资源再进行打包，配置代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;dist&quot;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/js/main.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 自动将上次打包目录资源清空</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"5、字体图标资源的处理\"><a href=\"#5、字体图标资源的处理\" class=\"headerlink\" title=\"5、字体图标资源的处理\"></a>5、字体图标资源的处理</h3><p>对于字体图标的处理和图片资源的处理类似，因为 webpack 内置的有 loader 解析，我们只需要简单的配置即可，配置代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>注意：📣 type: “asset/resource”和 type: “asset”的区别：<br>type: “asset/resource” 相当于 file-loader, 将文件转化成 Webpack 能识别的资源，其他不做处理<br>type: “asset” 相当于 url-loader, 将文件转化成 Webpack 能识别的资源，同时小于某个大小的资源会处理成 data URI 形式 ❗❗❗</p>\n<h3 id=\"6、处理其它资源\"><a href=\"#6、处理其它资源\" class=\"headerlink\" title=\"6、处理其它资源\"></a>6、处理其它资源</h3><p>开发中可能还存在一些其他资源，如音视频等，我们在字体图标的配置中也一起处理了，代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?|map4|map3|avi)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&quot;asset/resource&quot;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/media/[hash:8][ext][query]&quot;</span>,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7、处理-js-资源\"><a href=\"#7、处理-js-资源\" class=\"headerlink\" title=\"7、处理 js 资源\"></a>7、处理 js 资源</h3><h4 id=\"7-1-Eslint\"><a href=\"#7-1-Eslint\" class=\"headerlink\" title=\"7.1 Eslint\"></a>7.1 Eslint</h4><p>在团队的开发中对代码的格式是有严格的要求，因此为了团队代码的规范，我们需要配置 eslint 去保证开发的代码格式的一致性；首先我们需要在项目的根目录下创建一个.eslintrc.js 文件，在里面配置如下三项规则：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 解析选项</span></span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 具体检查规则</span></span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 继承其他规则</span></span><br><span class=\"line\">  <span class=\"attr\">extends</span>: []</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"comment\">// 其他规则详见：https://eslint.bootcss.com/docs/user-guide/configuring</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>1、parserOptions 选项配置如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">ecmaVersion</span>: <span class=\"number\">6</span>, <span class=\"comment\">// ES 语法版本</span></span><br><span class=\"line\">  <span class=\"attr\">sourceType</span>: <span class=\"string\">&quot;module&quot;</span>, <span class=\"comment\">// ES 模块化</span></span><br><span class=\"line\">  <span class=\"attr\">ecmaFeatures</span>: &#123; <span class=\"comment\">// ES 其他特性</span></span><br><span class=\"line\">    <span class=\"attr\">jsx</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 如果是 React 项目，就需要开启 jsx 语法</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>2、rules 的配置规则：<br>“off” 或 0 - 关闭规则<br>“warn” 或 1 - 开启规则，使用警告级别的错误：warn (不会导致程序退出)<br>“error” 或 2 - 开启规则，使用错误级别的错误：error (当被触发的时候，程序会退出)；<br>其配置如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">  <span class=\"attr\">semi</span>: <span class=\"string\">&quot;error&quot;</span>, <span class=\"comment\">// 禁止使用分号</span></span><br><span class=\"line\">  <span class=\"string\">&#x27;array-callback-return&#x27;</span>: <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 强制数组方法的回调函数中有 return 语句，否则警告</span></span><br><span class=\"line\">  <span class=\"string\">&#x27;default-case&#x27;</span>: [</span><br><span class=\"line\">    <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 要求 switch 语句中有 default 分支，否则警告</span></span><br><span class=\"line\">    &#123; <span class=\"attr\">commentPattern</span>: <span class=\"string\">&#x27;^no default$&#x27;</span> &#125; <span class=\"comment\">// 允许在最后注释 no default, 就不会有警告了</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">eqeqeq</span>: [</span><br><span class=\"line\">    <span class=\"string\">&#x27;warn&#x27;</span>, <span class=\"comment\">// 强制使用 === 和 !==，否则警告</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;smart&#x27;</span> <span class=\"comment\">// https://eslint.bootcss.com/docs/rules/eqeqeq#smart 除了少数情况下不会有警告</span></span><br><span class=\"line\">  ],</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>更多规则可以参考如下官方文档：<a href=\"https://eslint.bootcss.com/docs/rules/\">ESLint 官方</a><br>3、在 webpack 中的使用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 继承 Eslint 规则</span></span><br><span class=\"line\">  <span class=\"attr\">extends</span>: [<span class=\"string\">&#x27;eslint:recommended&#x27;</span>],</span><br><span class=\"line\">  <span class=\"attr\">env</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">node</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 启用node中全局变量</span></span><br><span class=\"line\">    <span class=\"attr\">browser</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 启用浏览器中全局变量</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">ecmaVersion</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">    <span class=\"attr\">sourceType</span>: <span class=\"string\">&#x27;module&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-var&#x27;</span>: <span class=\"number\">2</span> <span class=\"comment\">// 不能使用 var 定义变量</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>与此同时我们可以在 webpackconfig.js 中配置插件指定检查文件的目录：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;src&quot;</span>),</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">  ],</span><br></pre></td></tr></table></figure>\n\n<p>配置插件之前需要下载插件并且引入，文章以下的内容不再累述下包引入的过程；</p>\n<h5 id=\"7-1-1-VS-Code-的-Eslint-插件\"><a href=\"#7-1-1-VS-Code-的-Eslint-插件\" class=\"headerlink\" title=\"7.1.1 VS Code 的 Eslint 插件\"></a>7.1.1 VS Code 的 Eslint 插件</h5><p>打开 VSCode，下载 Eslint 插件，即可不用编译就能看到错误，可以提前解决但是此时就会对项目所有文件默认进行 Eslint 检查了，我们 dist 目录下的打包后文件就会报错。但是我们只需要检查 src 下面的文件，不需要检查 dist 下面的文件。所以可以使用 Eslint 忽略文件解决。在项目根目录新建.eslintignore 文件:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 忽略dist目录下所有文件</span><br><span class=\"line\">dist</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"7-2-Babel\"><a href=\"#7-2-Babel\" class=\"headerlink\" title=\"7.2 Babel\"></a>7.2 Babel</h4><p>Babel 为 javascript 编译器，主要用于将 ES6 语法编写的代码转换为向后兼容的 JavaScript 语法，以便能够运行在当前和旧版本的浏览器或其他环境中；我们需要先在根目录下创建一个 babel.config.js 文件；<br>在 webpack 中的使用：<br>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i babel-loader @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>\n\n<p>2、定义 babel.config.js 文件</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">presets</span>: [<span class=\"string\">&#x27;@babel/preset-env&#x27;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3、webconfig.js 中配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">       <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">       <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">       <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span>,</span><br><span class=\"line\">     &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>以上代码配置排除 node_modules 文件，提高打包的速度；</p>\n<h3 id=\"8、处理-html-资源\"><a href=\"#8、处理-html-资源\" class=\"headerlink\" title=\"8、处理 html 资源\"></a>8、处理 html 资源</h3><p>1、下载包</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在插件模块配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">     <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">     <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">     <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&quot;public/index.html&quot;</span>),</span><br><span class=\"line\">   &#125;),</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-开发服务器-amp-自动化\"><a href=\"#🥇-开发服务器-amp-自动化\" class=\"headerlink\" title=\"🥇 开发服务器&amp;自动化\"></a>🥇 开发服务器&amp;自动化</h2><p>每次写完代码都需要手动输入指令才能编译代码，太麻烦了，我们希望一切自动化</p>\n<h3 id=\"1、下载包\"><a href=\"#1、下载包\" class=\"headerlink\" title=\"1、下载包\"></a>1、下载包</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、配置开发服务器\"><a href=\"#2、配置开发服务器\" class=\"headerlink\" title=\"2、配置开发服务器\"></a>2、配置开发服务器</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 开发服务器</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&quot;localhost&quot;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&quot;3000&quot;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-生产模式配置\"><a href=\"#🥇-生产模式配置\" class=\"headerlink\" title=\"🥇 生产模式配置\"></a>🥇 生产模式配置</h2><p>生产模式是开发完成代码后，我们需要得到代码将来部署上线。这个模式下我们主要对代码进行优化，让其运行性能更好。优化主要从两个角度出发:<br>1、优化代码运行性能<br>2、优化代码打包速度</p>\n<h3 id=\"1、准备\"><a href=\"#1、准备\" class=\"headerlink\" title=\"1、准备\"></a>1、准备</h3><p>在根目录下创建 config 文件夹用来放置开发环境和生产环境的配置 webpack.dev.js、webpack.prod.js</p>\n<h3 id=\"2、修改-webpack-dev-js-文件\"><a href=\"#2、修改-webpack-dev-js-文件\" class=\"headerlink\" title=\"2、修改 webpack.dev.js 文件\"></a>2、修改 webpack.dev.js 文件</h3><p>因为文件目录变了，所以所有绝对路径需要回退一层目录才能找到对应的文件<br>完整代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: <span class=\"literal\">undefined</span>, <span class=\"comment\">// 开发模式没有输出，不需要指定输出目录</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span> <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"comment\">// clean: true, // 开发模式没有输出，不需要清空输出结果</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;less-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;sass-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;stylus-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"attr\">devServer</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;localhost&#x27;</span>, <span class=\"comment\">// 启动服务器域名</span></span><br><span class=\"line\">    <span class=\"attr\">port</span>: <span class=\"string\">&#x27;3000&#x27;</span>, <span class=\"comment\">// 启动服务器端口号</span></span><br><span class=\"line\">    <span class=\"attr\">open</span>: <span class=\"literal\">true</span> <span class=\"comment\">// 是否自动打开浏览器</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;development&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>运行开发模式的指令：<code>npx webpack serve --config ./config/webpack.dev.js</code></p>\n<h3 id=\"3、修改-webpack-prod-js-文件\"><a href=\"#3、修改-webpack-prod-js-文件\" class=\"headerlink\" title=\"3、修改 webpack.prod.js 文件\"></a>3、修改 webpack.prod.js 文件</h3><p>修改后的代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">ESLintWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;eslint-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">HtmlWebpackPlugin</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/main.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../dist&#x27;</span>), <span class=\"comment\">// 生产模式需要输出</span></span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/js/main.js&#x27;</span>, <span class=\"comment\">// 将 js 文件输出到 static/js 目录中</span></span><br><span class=\"line\">    <span class=\"attr\">clean</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;less-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;sass-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"string\">&#x27;style-loader&#x27;</span>, <span class=\"string\">&#x27;css-loader&#x27;</span>, <span class=\"string\">&#x27;stylus-loader&#x27;</span>]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpe?g|gif|webp)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">parser</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">dataUrlCondition</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">maxSize</span>: <span class=\"number\">10</span> * <span class=\"number\">1024</span> <span class=\"comment\">// 小于10kb的图片会被base64处理</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件输出到 static/imgs 目录中</span></span><br><span class=\"line\">          <span class=\"comment\">// 将图片文件命名 [hash:8][ext][query]</span></span><br><span class=\"line\">          <span class=\"comment\">// [hash:8]: hash值取8位</span></span><br><span class=\"line\">          <span class=\"comment\">// [ext]: 使用之前的文件扩展名</span></span><br><span class=\"line\">          <span class=\"comment\">// [query]: 添加之前的query参数</span></span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/imgs/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(ttf|woff2?)$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">type</span>: <span class=\"string\">&#x27;asset/resource&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">generator</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;static/media/[hash:8][ext][query]&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"comment\">// 排除node_modules代码不编译</span></span><br><span class=\"line\">        <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;babel-loader&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">ESLintWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 指定检查文件的根目录</span></span><br><span class=\"line\">      <span class=\"attr\">context</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../src&#x27;</span>)</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">HtmlWebpackPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 以 public/index.html 为模板创建文件</span></span><br><span class=\"line\">      <span class=\"comment\">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span></span><br><span class=\"line\">      <span class=\"attr\">template</span>: path.<span class=\"title function_\">resolve</span>(__dirname, <span class=\"string\">&#x27;../public/index.html&#x27;</span>)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"comment\">// devServer: &#123;</span></span><br><span class=\"line\">  <span class=\"comment\">//   host: &quot;localhost&quot;, // 启动服务器域名</span></span><br><span class=\"line\">  <span class=\"comment\">//   port: &quot;3000&quot;, // 启动服务器端口号</span></span><br><span class=\"line\">  <span class=\"comment\">//   open: true, // 是否自动打开浏览器</span></span><br><span class=\"line\">  <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">  <span class=\"attr\">mode</span>: <span class=\"string\">&#x27;production&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>运行如下指令：<code>npx webpack --config ./config/webpack.prod.js</code></p>\n<h3 id=\"4、修改-package-json-文件\"><a href=\"#4、修改-package-json-文件\" class=\"headerlink\" title=\"4、修改 package.json 文件\"></a>4、修改 package.json 文件</h3><p>修改 script 使得指令更简单：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"string\">&quot;scripts&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;start&quot;</span>: <span class=\"string\">&quot;npm run dev&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;dev&quot;</span>: <span class=\"string\">&quot;npx webpack serve --config ./config/webpack.dev.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;build&quot;</span>: <span class=\"string\">&quot;npx webpack --config ./config/webpack.prod.js&quot;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-Css-的处理\"><a href=\"#🥇-Css-的处理\" class=\"headerlink\" title=\"🥇 Css 的处理\"></a>🥇 Css 的处理</h2><h3 id=\"1、提取-css-成单独文件\"><a href=\"#1、提取-css-成单独文件\" class=\"headerlink\" title=\"1、提取 css 成单独文件\"></a>1、提取 css 成单独文件</h3><p>Css 文件目前被打包到 js 文件中，当 js 文件加载时，会创建一个 style 标签来生成样式这样对于网站来说，会出现闪屏现象，用户体验不好我们应该是单独的 Css 文件，通过 link 标签加载性能才好；<br>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、webpack.prod.js 中添加如下代码：<br>在 use 数组中添加 MiniCssExtractPlugin.loader</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用来匹配 .css 结尾的文件</span></span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.css$/</span>,</span><br><span class=\"line\">        <span class=\"comment\">// use 数组里面 Loader 执行顺序是从右到左</span></span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.less$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;less-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.s[ac]ss$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;sass-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.styl$/</span>,</span><br><span class=\"line\">        <span class=\"attr\">use</span>: [<span class=\"title class_\">MiniCssExtractPlugin</span>.<span class=\"property\">loader</span>, <span class=\"string\">&quot;css-loader&quot;</span>, <span class=\"string\">&quot;stylus-loader&quot;</span>],</span><br><span class=\"line\">      &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>在 plugin 插件中配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 提取css成单独文件</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">MiniCssExtractPlugin</span>(&#123;</span><br><span class=\"line\">      <span class=\"comment\">// 定义输出文件名和目录</span></span><br><span class=\"line\">      <span class=\"attr\">filename</span>: <span class=\"string\">&quot;static/css/main.css&quot;</span>,</span><br><span class=\"line\">    &#125;),</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2、css-兼容性处理\"><a href=\"#2、css-兼容性处理\" class=\"headerlink\" title=\"2、css 兼容性处理\"></a>2、css 兼容性处理</h3><p>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i postcss-loader postcss postcss-preset-env -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在 css-loader 下添加如下配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">            <span class=\"attr\">loader</span>: <span class=\"string\">&quot;postcss-loader&quot;</span>,</span><br><span class=\"line\">            <span class=\"attr\">options</span>: &#123;</span><br><span class=\"line\">              <span class=\"attr\">postcssOptions</span>: &#123;</span><br><span class=\"line\">                <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">                  <span class=\"string\">&quot;postcss-preset-env&quot;</span>, <span class=\"comment\">// 能解决大多数样式兼容性问题</span></span><br><span class=\"line\">                ],</span><br><span class=\"line\">              &#125;,</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">          &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>3、控制兼容性<br>我们可以在 package.json 文件中添加 browserslist 来控制样式的兼容性做到什么程度。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// 其他省略</span></span><br><span class=\"line\">  <span class=\"string\">&quot;browserslist&quot;</span>: [<span class=\"string\">&quot;last 2 version&quot;</span>, <span class=\"string\">&quot;&gt; 1%&quot;</span>, <span class=\"string\">&quot;not dead&quot;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3、css-压缩\"><a href=\"#3、css-压缩\" class=\"headerlink\" title=\"3、css 压缩\"></a>3、css 压缩</h3><p>1、下载包：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i css-minimizer-webpack-plugin -D</span><br></pre></td></tr></table></figure>\n\n<p>2、在 plugins 模块配置如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// css压缩</span></span><br><span class=\"line\">   <span class=\"keyword\">new</span> <span class=\"title class_\">CssMinimizerPlugin</span>(),</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"🥇-html-压缩\"><a href=\"#🥇-html-压缩\" class=\"headerlink\" title=\"🥇 html 压缩\"></a>🥇 html 压缩</h2><p>默认生产模式已经开启了：html 压缩和 js 压缩不需要额外进行配置</p>\n<h2 id=\"🥇-总结\"><a href=\"#🥇-总结\" class=\"headerlink\" title=\"🥇 总结\"></a>🥇 总结</h2><p>本章文章我们学会了 Webpack 基本使用，掌握了以下功能：</p>\n<p>1、两种开发模式<br>1.1 开发模式：代码能编译自动化运行<br>1.2 生产模式：代码编译优化输出<br>2、Webpack 基本功能<br>2.1 开发模式：可以编译 ES Module 语法<br>2.2 生产模式：可以编译 ES Module 语法，压缩 js 代码<br>3、Webpack 配置文件 5 个核心概念<br>entry<br>output<br>loader<br>plugins<br>mode<br>devServer 配置<br>Webpack 脚本指令用法<br>webpack 直接打包输出<br>webpack serve 启动开发服务器，内存编译打包没有输出</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"前端图片压缩解决办法","description":"在某一h5的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在MB 级别，转base64 以后，图片的体积会增大30%以上，随着图片的体积增加，转换的base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；","headimg":"/images/antd.jpeg","date":"2021-05-20T16:00:00.000Z","sidebar":["toc"],"_content":"\n## 问题产生背景\n\n在某一 h5 的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在 MB 级别，转 base64 以后，图片的体积会增大 30%以上，随着图片的体积增加，转换的 base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；\n\n## 解决办法\n\n### 1、使用纯 js 解决\n\n解决思路：\n1、通过 input 文件选择框拿到要上传的图片文件 file\n2、FileReader.readAsDataURL() 读取 file 内容。完成后 result 属性中将包含一个 data: URL 格式的 Base64 字符串以表示所读取文件的内容。\n3、创建一个 img 标签，将 FileReader 对象返回的 base64 格式 url 给到一个 img 标签\n4、img.onload() 函数中获取图片的尺寸，再通过 canvas.drawImage() 绘制图像，设置尺寸或者图像的质量等\ncanvas.toDataURL(file.type, quality) 设置图像的质量，将 canvas 转换为图片 base64 格式\n代码如下所示：\n\n```javascript\ncompressImg(file) {\n    const reader = new FileReader();\n        // readAsDataURL 方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成DONE，并触发 loadend (en-US) 事件，\n        // 同时 result 属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          const img = new Image();\n          img.src = reader.result;\n          img.onload = () => {\n            // 图片的宽高\n            const w = img.width;\n            const h = img.height;\n            const canvas = document.createElement(\"canvas\");\n            // canvas对图片进行裁剪，这里设置为图片的原始尺寸\n            canvas.width = w;\n            canvas.height = h;\n            const ctx = canvas.getContext(\"2d\");\n            // canvas中，png转jpg会变黑底，所以先给canvas铺一张白底\n            ctx.fillStyle = \"#fff\";\n            // fillRect()方法绘制一个填充了内容的矩形，这个矩形的开始点（左上点）在\n            // (x, y) ，它的宽度和高度分别由width 和 height 确定，填充样式由当前的fillStyle 决定。\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            // 绘制图像\n            ctx.drawImage(img, 0, 0, w, h);\n            // canvas转图片达到图片压缩效果\n            // 返回一个包含图片展示的 data URI base64 在指定图片格式为 image/jpeg 或 image/webp的情况下，\n            // 可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92。其他参数会被忽略。\n            const dataUrl = canvas.toDataURL(\"image/jpeg\", 0.8);\n            // base64格式文件转成Blob文件格式\n            return blobFile = dataURLtoBlob(dataUrl);\n            // 拿到这个blobFile文件就可以上传给服务端\n            console.log(\"压缩后的file----------\", blobFile);\n          };\n        };\n}\n    // canvas生成的格式为base64，如果需要Blob格式可按如下进行转化\n    dataURLtoBlob(dataurl) {\n      const arr = dataurl.split(\",\"),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], { type: mime });\n    },\n```\n\n使用以上方法存在缺点：\n\n- 压缩后的格式只能是 jpeg 格式，如果需要其他格式的可能需要优化或者用别的方法\n\n### 2、插件 js-image-compressor\n\n在使用中，我们可以根据自身需求自定义配置压缩比（quality）、输出图片类型（mimeType）、宽（width）、高（height）、最大宽（maxWidth）、最大高（maxHeight）、最小宽（minWidth）、最大高（minHeight）、png 转 jpeg 阈值（convertSize）、是否矫正 jpeg 方向（redressOrientation）和是否宽松模式（loose）。\n● 是否矫正 jpeg 方向（redressOrientation），jpeg 格式图片在某些 iOS 浏览器会按其方向呈现图像，这个选项可以控制恢复初始方向，默认为 true；\n● 是否宽松模式（loose）、的意思是控制当压缩的图片 size 大于源图片，输出源图片，否则输出压缩后图片，默认是 true。\n以下是标准配置：\n\n```javascript\nvar options = {\n  file: file,\n  quality: 0.6,\n  mimeType: 'image/jpeg',\n  maxWidth: 2000,\n  maxHeight: 2000,\n  width: 1000,\n  height: 1000,\n  minWidth: 500,\n  minHeight: 500,\n  convertSize: Infinity,\n  loose: true,\n  redressOrientation: true,\n  // 压缩前回调\n  beforeCompress: function (result) {\n    console.log('压缩之前图片尺寸大小: ', result.size)\n    console.log('mime 类型: ', result.type)\n  },\n  // 压缩成功回调\n  success: function (result) {\n    console.log('压缩之后图片尺寸大小: ', result.size)\n    console.log('mime 类型: ', result.type)\n    console.log('实际压缩率： ', (((file.size - result.size) / file.size) * 100).toFixed(2) + '%')\n  },\n  // 发生错误\n  error: function (msg) {\n    console.error(msg)\n  }\n}\nnew ImageCompressor(options)\n```\n\n以上就是插件式的解决办法，更详细的文档，可以在 gitbhub 的官方文档上查看；插件式解决办法已经在项目中实践，推荐大家使用~~\n\n## 写在最后\n\n以上提供的插件式解决办法已经在项目中实践，但是存在的问题是，插件控制的压缩率和实际的压缩率有一定的出入(不同格式的图片出入有一定差异)，因此压缩率不好严格控制，有更好解决办法的朋友欢迎评论区交流；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/前端图片压缩解决办法.md","raw":"---\ntitle: 前端图片压缩解决办法\ndescription: 在某一h5的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在MB 级别，转base64 以后，图片的体积会增大30%以上，随着图片的体积增加，转换的base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；\nheadimg: /images/antd.jpeg\ncategories:\n  - AntDesign\ndate: 2021-05-21\ntags:\n  - antDesign\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n## 问题产生背景\n\n在某一 h5 的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在 MB 级别，转 base64 以后，图片的体积会增大 30%以上，随着图片的体积增加，转换的 base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；\n\n## 解决办法\n\n### 1、使用纯 js 解决\n\n解决思路：\n1、通过 input 文件选择框拿到要上传的图片文件 file\n2、FileReader.readAsDataURL() 读取 file 内容。完成后 result 属性中将包含一个 data: URL 格式的 Base64 字符串以表示所读取文件的内容。\n3、创建一个 img 标签，将 FileReader 对象返回的 base64 格式 url 给到一个 img 标签\n4、img.onload() 函数中获取图片的尺寸，再通过 canvas.drawImage() 绘制图像，设置尺寸或者图像的质量等\ncanvas.toDataURL(file.type, quality) 设置图像的质量，将 canvas 转换为图片 base64 格式\n代码如下所示：\n\n```javascript\ncompressImg(file) {\n    const reader = new FileReader();\n        // readAsDataURL 方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成DONE，并触发 loadend (en-US) 事件，\n        // 同时 result 属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          const img = new Image();\n          img.src = reader.result;\n          img.onload = () => {\n            // 图片的宽高\n            const w = img.width;\n            const h = img.height;\n            const canvas = document.createElement(\"canvas\");\n            // canvas对图片进行裁剪，这里设置为图片的原始尺寸\n            canvas.width = w;\n            canvas.height = h;\n            const ctx = canvas.getContext(\"2d\");\n            // canvas中，png转jpg会变黑底，所以先给canvas铺一张白底\n            ctx.fillStyle = \"#fff\";\n            // fillRect()方法绘制一个填充了内容的矩形，这个矩形的开始点（左上点）在\n            // (x, y) ，它的宽度和高度分别由width 和 height 确定，填充样式由当前的fillStyle 决定。\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            // 绘制图像\n            ctx.drawImage(img, 0, 0, w, h);\n            // canvas转图片达到图片压缩效果\n            // 返回一个包含图片展示的 data URI base64 在指定图片格式为 image/jpeg 或 image/webp的情况下，\n            // 可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92。其他参数会被忽略。\n            const dataUrl = canvas.toDataURL(\"image/jpeg\", 0.8);\n            // base64格式文件转成Blob文件格式\n            return blobFile = dataURLtoBlob(dataUrl);\n            // 拿到这个blobFile文件就可以上传给服务端\n            console.log(\"压缩后的file----------\", blobFile);\n          };\n        };\n}\n    // canvas生成的格式为base64，如果需要Blob格式可按如下进行转化\n    dataURLtoBlob(dataurl) {\n      const arr = dataurl.split(\",\"),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]);\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], { type: mime });\n    },\n```\n\n使用以上方法存在缺点：\n\n- 压缩后的格式只能是 jpeg 格式，如果需要其他格式的可能需要优化或者用别的方法\n\n### 2、插件 js-image-compressor\n\n在使用中，我们可以根据自身需求自定义配置压缩比（quality）、输出图片类型（mimeType）、宽（width）、高（height）、最大宽（maxWidth）、最大高（maxHeight）、最小宽（minWidth）、最大高（minHeight）、png 转 jpeg 阈值（convertSize）、是否矫正 jpeg 方向（redressOrientation）和是否宽松模式（loose）。\n● 是否矫正 jpeg 方向（redressOrientation），jpeg 格式图片在某些 iOS 浏览器会按其方向呈现图像，这个选项可以控制恢复初始方向，默认为 true；\n● 是否宽松模式（loose）、的意思是控制当压缩的图片 size 大于源图片，输出源图片，否则输出压缩后图片，默认是 true。\n以下是标准配置：\n\n```javascript\nvar options = {\n  file: file,\n  quality: 0.6,\n  mimeType: 'image/jpeg',\n  maxWidth: 2000,\n  maxHeight: 2000,\n  width: 1000,\n  height: 1000,\n  minWidth: 500,\n  minHeight: 500,\n  convertSize: Infinity,\n  loose: true,\n  redressOrientation: true,\n  // 压缩前回调\n  beforeCompress: function (result) {\n    console.log('压缩之前图片尺寸大小: ', result.size)\n    console.log('mime 类型: ', result.type)\n  },\n  // 压缩成功回调\n  success: function (result) {\n    console.log('压缩之后图片尺寸大小: ', result.size)\n    console.log('mime 类型: ', result.type)\n    console.log('实际压缩率： ', (((file.size - result.size) / file.size) * 100).toFixed(2) + '%')\n  },\n  // 发生错误\n  error: function (msg) {\n    console.error(msg)\n  }\n}\nnew ImageCompressor(options)\n```\n\n以上就是插件式的解决办法，更详细的文档，可以在 gitbhub 的官方文档上查看；插件式解决办法已经在项目中实践，推荐大家使用~~\n\n## 写在最后\n\n以上提供的插件式解决办法已经在项目中实践，但是存在的问题是，插件控制的压缩率和实际的压缩率有一定的出入(不同格式的图片出入有一定差异)，因此压缩率不好严格控制，有更好解决办法的朋友欢迎评论区交流；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"前端图片压缩解决办法","published":1,"updated":"2023-03-12T09:33:07.778Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfp002ip5o15okqe5e4","content":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>在某一 h5 的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在 MB 级别，转 base64 以后，图片的体积会增大 30%以上，随着图片的体积增加，转换的 base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；</p>\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><h3 id=\"1、使用纯-js-解决\"><a href=\"#1、使用纯-js-解决\" class=\"headerlink\" title=\"1、使用纯 js 解决\"></a>1、使用纯 js 解决</h3><p>解决思路：<br>1、通过 input 文件选择框拿到要上传的图片文件 file<br>2、FileReader.readAsDataURL() 读取 file 内容。完成后 result 属性中将包含一个 data: URL 格式的 Base64 字符串以表示所读取文件的内容。<br>3、创建一个 img 标签，将 FileReader 对象返回的 base64 格式 url 给到一个 img 标签<br>4、img.onload() 函数中获取图片的尺寸，再通过 canvas.drawImage() 绘制图像，设置尺寸或者图像的质量等<br>canvas.toDataURL(file.type, quality) 设置图像的质量，将 canvas 转换为图片 base64 格式<br>代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">compressImg</span>(<span class=\"params\">file</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> reader = <span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>();</span><br><span class=\"line\">        <span class=\"comment\">// readAsDataURL 方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成DONE，并触发 loadend (en-US) 事件，</span></span><br><span class=\"line\">        <span class=\"comment\">// 同时 result 属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。</span></span><br><span class=\"line\">        reader.<span class=\"title function_\">readAsDataURL</span>(file);</span><br><span class=\"line\">        reader.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> img = <span class=\"keyword\">new</span> <span class=\"title class_\">Image</span>();</span><br><span class=\"line\">          img.<span class=\"property\">src</span> = reader.<span class=\"property\">result</span>;</span><br><span class=\"line\">          img.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 图片的宽高</span></span><br><span class=\"line\">            <span class=\"keyword\">const</span> w = img.<span class=\"property\">width</span>;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> h = img.<span class=\"property\">height</span>;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> canvas = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;canvas&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// canvas对图片进行裁剪，这里设置为图片的原始尺寸</span></span><br><span class=\"line\">            canvas.<span class=\"property\">width</span> = w;</span><br><span class=\"line\">            canvas.<span class=\"property\">height</span> = h;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> ctx = canvas.<span class=\"title function_\">getContext</span>(<span class=\"string\">&quot;2d&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// canvas中，png转jpg会变黑底，所以先给canvas铺一张白底</span></span><br><span class=\"line\">            ctx.<span class=\"property\">fillStyle</span> = <span class=\"string\">&quot;#fff&quot;</span>;</span><br><span class=\"line\">            <span class=\"comment\">// fillRect()方法绘制一个填充了内容的矩形，这个矩形的开始点（左上点）在</span></span><br><span class=\"line\">            <span class=\"comment\">// (x, y) ，它的宽度和高度分别由width 和 height 确定，填充样式由当前的fillStyle 决定。</span></span><br><span class=\"line\">            ctx.<span class=\"title function_\">fillRect</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, canvas.<span class=\"property\">width</span>, canvas.<span class=\"property\">height</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 绘制图像</span></span><br><span class=\"line\">            ctx.<span class=\"title function_\">drawImage</span>(img, <span class=\"number\">0</span>, <span class=\"number\">0</span>, w, h);</span><br><span class=\"line\">            <span class=\"comment\">// canvas转图片达到图片压缩效果</span></span><br><span class=\"line\">            <span class=\"comment\">// 返回一个包含图片展示的 data URI base64 在指定图片格式为 image/jpeg 或 image/webp的情况下，</span></span><br><span class=\"line\">            <span class=\"comment\">// 可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92。其他参数会被忽略。</span></span><br><span class=\"line\">            <span class=\"keyword\">const</span> dataUrl = canvas.<span class=\"title function_\">toDataURL</span>(<span class=\"string\">&quot;image/jpeg&quot;</span>, <span class=\"number\">0.8</span>);</span><br><span class=\"line\">            <span class=\"comment\">// base64格式文件转成Blob文件格式</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> blobFile = <span class=\"title function_\">dataURLtoBlob</span>(dataUrl);</span><br><span class=\"line\">            <span class=\"comment\">// 拿到这个blobFile文件就可以上传给服务端</span></span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;压缩后的file----------&quot;</span>, blobFile);</span><br><span class=\"line\">          &#125;;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">    <span class=\"comment\">// canvas生成的格式为base64，如果需要Blob格式可按如下进行转化</span></span><br><span class=\"line\">    <span class=\"title function_\">dataURLtoBlob</span>(<span class=\"params\">dataurl</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> arr = dataurl.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;,&quot;</span>),</span><br><span class=\"line\">        mime = arr[<span class=\"number\">0</span>].<span class=\"title function_\">match</span>(<span class=\"regexp\">/:(.*?);/</span>)[<span class=\"number\">1</span>],</span><br><span class=\"line\">        bstr = <span class=\"title function_\">atob</span>(arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">      <span class=\"keyword\">let</span> n = bstr.<span class=\"property\">length</span>;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> u8arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Uint8Array</span>(n);</span><br><span class=\"line\">      <span class=\"keyword\">while</span> (n--) &#123;</span><br><span class=\"line\">        u8arr[n] = bstr.<span class=\"title function_\">charCodeAt</span>(n);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([u8arr], &#123; <span class=\"attr\">type</span>: mime &#125;);</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>使用以上方法存在缺点：</p>\n<ul>\n<li>压缩后的格式只能是 jpeg 格式，如果需要其他格式的可能需要优化或者用别的方法</li>\n</ul>\n<h3 id=\"2、插件-js-image-compressor\"><a href=\"#2、插件-js-image-compressor\" class=\"headerlink\" title=\"2、插件 js-image-compressor\"></a>2、插件 js-image-compressor</h3><p>在使用中，我们可以根据自身需求自定义配置压缩比（quality）、输出图片类型（mimeType）、宽（width）、高（height）、最大宽（maxWidth）、最大高（maxHeight）、最小宽（minWidth）、最大高（minHeight）、png 转 jpeg 阈值（convertSize）、是否矫正 jpeg 方向（redressOrientation）和是否宽松模式（loose）。<br>● 是否矫正 jpeg 方向（redressOrientation），jpeg 格式图片在某些 iOS 浏览器会按其方向呈现图像，这个选项可以控制恢复初始方向，默认为 true；<br>● 是否宽松模式（loose）、的意思是控制当压缩的图片 size 大于源图片，输出源图片，否则输出压缩后图片，默认是 true。<br>以下是标准配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">  <span class=\"attr\">file</span>: file,</span><br><span class=\"line\">  <span class=\"attr\">quality</span>: <span class=\"number\">0.6</span>,</span><br><span class=\"line\">  <span class=\"attr\">mimeType</span>: <span class=\"string\">&#x27;image/jpeg&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">maxWidth</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">  <span class=\"attr\">maxHeight</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">  <span class=\"attr\">width</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">height</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">minWidth</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">  <span class=\"attr\">minHeight</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">  <span class=\"attr\">convertSize</span>: <span class=\"title class_\">Infinity</span>,</span><br><span class=\"line\">  <span class=\"attr\">loose</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">redressOrientation</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 压缩前回调</span></span><br><span class=\"line\">  <span class=\"attr\">beforeCompress</span>: <span class=\"keyword\">function</span> (<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;压缩之前图片尺寸大小: &#x27;</span>, result.<span class=\"property\">size</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mime 类型: &#x27;</span>, result.<span class=\"property\">type</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 压缩成功回调</span></span><br><span class=\"line\">  <span class=\"attr\">success</span>: <span class=\"keyword\">function</span> (<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;压缩之后图片尺寸大小: &#x27;</span>, result.<span class=\"property\">size</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mime 类型: &#x27;</span>, result.<span class=\"property\">type</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;实际压缩率： &#x27;</span>, (((file.<span class=\"property\">size</span> - result.<span class=\"property\">size</span>) / file.<span class=\"property\">size</span>) * <span class=\"number\">100</span>).<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>) + <span class=\"string\">&#x27;%&#x27;</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 发生错误</span></span><br><span class=\"line\">  <span class=\"attr\">error</span>: <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(msg)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ImageCompressor</span>(options)</span><br></pre></td></tr></table></figure>\n\n<p>以上就是插件式的解决办法，更详细的文档，可以在 gitbhub 的官方文档上查看；插件式解决办法已经在项目中实践，推荐大家使用~~</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上提供的插件式解决办法已经在项目中实践，但是存在的问题是，插件控制的压缩率和实际的压缩率有一定的出入(不同格式的图片出入有一定差异)，因此压缩率不好严格控制，有更好解决办法的朋友欢迎评论区交流；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h2 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h2><p>在某一 h5 的项目，要求上传的图片格式为 base64 , 问题是用户上传的图片基本都在 MB 级别，转 base64 以后，图片的体积会增大 30%以上，随着图片的体积增加，转换的 base64 格式文件体积越大，如果此时前端不对用户上传的图片体积进行压缩，可能会导致服务器压力过大，从而崩溃；</p>\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><h3 id=\"1、使用纯-js-解决\"><a href=\"#1、使用纯-js-解决\" class=\"headerlink\" title=\"1、使用纯 js 解决\"></a>1、使用纯 js 解决</h3><p>解决思路：<br>1、通过 input 文件选择框拿到要上传的图片文件 file<br>2、FileReader.readAsDataURL() 读取 file 内容。完成后 result 属性中将包含一个 data: URL 格式的 Base64 字符串以表示所读取文件的内容。<br>3、创建一个 img 标签，将 FileReader 对象返回的 base64 格式 url 给到一个 img 标签<br>4、img.onload() 函数中获取图片的尺寸，再通过 canvas.drawImage() 绘制图像，设置尺寸或者图像的质量等<br>canvas.toDataURL(file.type, quality) 设置图像的质量，将 canvas 转换为图片 base64 格式<br>代码如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">compressImg</span>(<span class=\"params\">file</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> reader = <span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>();</span><br><span class=\"line\">        <span class=\"comment\">// readAsDataURL 方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成DONE，并触发 loadend (en-US) 事件，</span></span><br><span class=\"line\">        <span class=\"comment\">// 同时 result 属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。</span></span><br><span class=\"line\">        reader.<span class=\"title function_\">readAsDataURL</span>(file);</span><br><span class=\"line\">        reader.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> img = <span class=\"keyword\">new</span> <span class=\"title class_\">Image</span>();</span><br><span class=\"line\">          img.<span class=\"property\">src</span> = reader.<span class=\"property\">result</span>;</span><br><span class=\"line\">          img.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 图片的宽高</span></span><br><span class=\"line\">            <span class=\"keyword\">const</span> w = img.<span class=\"property\">width</span>;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> h = img.<span class=\"property\">height</span>;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> canvas = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;canvas&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// canvas对图片进行裁剪，这里设置为图片的原始尺寸</span></span><br><span class=\"line\">            canvas.<span class=\"property\">width</span> = w;</span><br><span class=\"line\">            canvas.<span class=\"property\">height</span> = h;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> ctx = canvas.<span class=\"title function_\">getContext</span>(<span class=\"string\">&quot;2d&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// canvas中，png转jpg会变黑底，所以先给canvas铺一张白底</span></span><br><span class=\"line\">            ctx.<span class=\"property\">fillStyle</span> = <span class=\"string\">&quot;#fff&quot;</span>;</span><br><span class=\"line\">            <span class=\"comment\">// fillRect()方法绘制一个填充了内容的矩形，这个矩形的开始点（左上点）在</span></span><br><span class=\"line\">            <span class=\"comment\">// (x, y) ，它的宽度和高度分别由width 和 height 确定，填充样式由当前的fillStyle 决定。</span></span><br><span class=\"line\">            ctx.<span class=\"title function_\">fillRect</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, canvas.<span class=\"property\">width</span>, canvas.<span class=\"property\">height</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 绘制图像</span></span><br><span class=\"line\">            ctx.<span class=\"title function_\">drawImage</span>(img, <span class=\"number\">0</span>, <span class=\"number\">0</span>, w, h);</span><br><span class=\"line\">            <span class=\"comment\">// canvas转图片达到图片压缩效果</span></span><br><span class=\"line\">            <span class=\"comment\">// 返回一个包含图片展示的 data URI base64 在指定图片格式为 image/jpeg 或 image/webp的情况下，</span></span><br><span class=\"line\">            <span class=\"comment\">// 可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92。其他参数会被忽略。</span></span><br><span class=\"line\">            <span class=\"keyword\">const</span> dataUrl = canvas.<span class=\"title function_\">toDataURL</span>(<span class=\"string\">&quot;image/jpeg&quot;</span>, <span class=\"number\">0.8</span>);</span><br><span class=\"line\">            <span class=\"comment\">// base64格式文件转成Blob文件格式</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> blobFile = <span class=\"title function_\">dataURLtoBlob</span>(dataUrl);</span><br><span class=\"line\">            <span class=\"comment\">// 拿到这个blobFile文件就可以上传给服务端</span></span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;压缩后的file----------&quot;</span>, blobFile);</span><br><span class=\"line\">          &#125;;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">    <span class=\"comment\">// canvas生成的格式为base64，如果需要Blob格式可按如下进行转化</span></span><br><span class=\"line\">    <span class=\"title function_\">dataURLtoBlob</span>(<span class=\"params\">dataurl</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> arr = dataurl.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;,&quot;</span>),</span><br><span class=\"line\">        mime = arr[<span class=\"number\">0</span>].<span class=\"title function_\">match</span>(<span class=\"regexp\">/:(.*?);/</span>)[<span class=\"number\">1</span>],</span><br><span class=\"line\">        bstr = <span class=\"title function_\">atob</span>(arr[<span class=\"number\">1</span>]);</span><br><span class=\"line\">      <span class=\"keyword\">let</span> n = bstr.<span class=\"property\">length</span>;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> u8arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Uint8Array</span>(n);</span><br><span class=\"line\">      <span class=\"keyword\">while</span> (n--) &#123;</span><br><span class=\"line\">        u8arr[n] = bstr.<span class=\"title function_\">charCodeAt</span>(n);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([u8arr], &#123; <span class=\"attr\">type</span>: mime &#125;);</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>使用以上方法存在缺点：</p>\n<ul>\n<li>压缩后的格式只能是 jpeg 格式，如果需要其他格式的可能需要优化或者用别的方法</li>\n</ul>\n<h3 id=\"2、插件-js-image-compressor\"><a href=\"#2、插件-js-image-compressor\" class=\"headerlink\" title=\"2、插件 js-image-compressor\"></a>2、插件 js-image-compressor</h3><p>在使用中，我们可以根据自身需求自定义配置压缩比（quality）、输出图片类型（mimeType）、宽（width）、高（height）、最大宽（maxWidth）、最大高（maxHeight）、最小宽（minWidth）、最大高（minHeight）、png 转 jpeg 阈值（convertSize）、是否矫正 jpeg 方向（redressOrientation）和是否宽松模式（loose）。<br>● 是否矫正 jpeg 方向（redressOrientation），jpeg 格式图片在某些 iOS 浏览器会按其方向呈现图像，这个选项可以控制恢复初始方向，默认为 true；<br>● 是否宽松模式（loose）、的意思是控制当压缩的图片 size 大于源图片，输出源图片，否则输出压缩后图片，默认是 true。<br>以下是标准配置：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">  <span class=\"attr\">file</span>: file,</span><br><span class=\"line\">  <span class=\"attr\">quality</span>: <span class=\"number\">0.6</span>,</span><br><span class=\"line\">  <span class=\"attr\">mimeType</span>: <span class=\"string\">&#x27;image/jpeg&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">maxWidth</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">  <span class=\"attr\">maxHeight</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">  <span class=\"attr\">width</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">height</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">  <span class=\"attr\">minWidth</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">  <span class=\"attr\">minHeight</span>: <span class=\"number\">500</span>,</span><br><span class=\"line\">  <span class=\"attr\">convertSize</span>: <span class=\"title class_\">Infinity</span>,</span><br><span class=\"line\">  <span class=\"attr\">loose</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">redressOrientation</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"comment\">// 压缩前回调</span></span><br><span class=\"line\">  <span class=\"attr\">beforeCompress</span>: <span class=\"keyword\">function</span> (<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;压缩之前图片尺寸大小: &#x27;</span>, result.<span class=\"property\">size</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mime 类型: &#x27;</span>, result.<span class=\"property\">type</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 压缩成功回调</span></span><br><span class=\"line\">  <span class=\"attr\">success</span>: <span class=\"keyword\">function</span> (<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;压缩之后图片尺寸大小: &#x27;</span>, result.<span class=\"property\">size</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;mime 类型: &#x27;</span>, result.<span class=\"property\">type</span>)</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;实际压缩率： &#x27;</span>, (((file.<span class=\"property\">size</span> - result.<span class=\"property\">size</span>) / file.<span class=\"property\">size</span>) * <span class=\"number\">100</span>).<span class=\"title function_\">toFixed</span>(<span class=\"number\">2</span>) + <span class=\"string\">&#x27;%&#x27;</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// 发生错误</span></span><br><span class=\"line\">  <span class=\"attr\">error</span>: <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">error</span>(msg)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">ImageCompressor</span>(options)</span><br></pre></td></tr></table></figure>\n\n<p>以上就是插件式的解决办法，更详细的文档，可以在 gitbhub 的官方文档上查看；插件式解决办法已经在项目中实践，推荐大家使用~~</p>\n<h2 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h2><p>以上提供的插件式解决办法已经在项目中实践，但是存在的问题是，插件控制的压缩率和实际的压缩率有一定的出入(不同格式的图片出入有一定差异)，因此压缩率不好严格控制，有更好解决办法的朋友欢迎评论区交流；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"},{"title":"如何使用 js 过滤文本框表情符号","description":"在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；","headimg":"/images/antd.jpeg","date":"2021-05-27T16:00:00.000Z","sidebar":["toc"],"_content":"\n# 问题产生背景\n\n在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；\n如下图所示：\n{% asset_img emo1.png %}\n\n# 解决办法\n\n由于产品要求项目中的所有文本框都需要进行 emoji 限制，因此我封装了一个工具函数，作为表单的自定义校验规则，封装的工具函数代码如下，大家可以直接使用：\n\n```javascript\n// 判断文本中是否有表情\nconst isEmojiCharacter = (substring: any) => {\n  if (substring?.length > 0) {\n    for (var i = 0; i < substring.length; i++) {\n      var hs = substring.charCodeAt(i)\n      if (0xd800 <= hs && hs <= 0xdbff) {\n        if (substring.length > 1) {\n          var ls = substring.charCodeAt(i + 1)\n          var uc = (hs - 0xd800) * 0x400 + (ls - 0xdc00) + 0x10000\n          if (0x1d000 <= uc && uc <= 0x1f77f) {\n            return true\n          }\n        }\n      } else if (substring.length > 1) {\n        var ls = substring.charCodeAt(i + 1)\n        if (ls == 0x20e3) {\n          return true\n        }\n      } else {\n        if (0x2100 <= hs && hs <= 0x27ff) {\n          return true\n        } else if (0x2b05 <= hs && hs <= 0x2b07) {\n          return true\n        } else if (0x2934 <= hs && hs <= 0x2935) {\n          return true\n        } else if (0x3297 <= hs && hs <= 0x3299) {\n          return true\n        } else if (\n          hs == 0xa9 ||\n          hs == 0xae ||\n          hs == 0x303d ||\n          hs == 0x3030 ||\n          hs == 0x2b55 ||\n          hs == 0x2b1c ||\n          hs == 0x2b1b ||\n          hs == 0x2b50\n        ) {\n          return true\n        }\n      }\n    }\n  }\n}\n```\n\n以上函数接收一个文本框的值，若文本框有表情就返回 true , 在实际项目中我们可以根据 Form.Item 的 rules 属性自定义校验规则，代码如下：\n\n```javascript\n<Form.Item\n  rules={[\n    {\n      validator: (_, value) => {\n        const isEmoji = isEmojiCharacter(value)\n        console.log('12123', isEmoji)\n        return !isEmoji ? Promise.resolve() : Promise.reject(new Error('不允许输入表情符号'))\n      },\n      validateTrigger: 'onChange'\n    }\n  ]}\n  label=\"接口名称\"\n  style={{marginLeft: 20}}\n  name=\"interName\">\n  <Input allowClear placeholder=\"请输入接口名称\" />\n</Form.Item>\n```\n\n至此便可以实现了前端文本框 emoji 的校验~~\n\n# 写在最后\n\n以上提供的方法，便是解决校验文本框表情符号的方法，但是仍然存在部分表情不能校验的问题，如若有完全的表情校验方法，欢迎评论区留言交流；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","source":"_posts/过滤文本框表情符号.md","raw":"---\ntitle: 如何使用 js 过滤文本框表情符号\ndescription: 在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；\nheadimg: /images/antd.jpeg\ncategories:\n  - AntDesign\ndate: 2021-05-28\ntags:\n  - antDesign\nsidebar: [toc] # 放置任何你想要显示的侧边栏部件\n---\n\n# 问题产生背景\n\n在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；\n如下图所示：\n{% asset_img emo1.png %}\n\n# 解决办法\n\n由于产品要求项目中的所有文本框都需要进行 emoji 限制，因此我封装了一个工具函数，作为表单的自定义校验规则，封装的工具函数代码如下，大家可以直接使用：\n\n```javascript\n// 判断文本中是否有表情\nconst isEmojiCharacter = (substring: any) => {\n  if (substring?.length > 0) {\n    for (var i = 0; i < substring.length; i++) {\n      var hs = substring.charCodeAt(i)\n      if (0xd800 <= hs && hs <= 0xdbff) {\n        if (substring.length > 1) {\n          var ls = substring.charCodeAt(i + 1)\n          var uc = (hs - 0xd800) * 0x400 + (ls - 0xdc00) + 0x10000\n          if (0x1d000 <= uc && uc <= 0x1f77f) {\n            return true\n          }\n        }\n      } else if (substring.length > 1) {\n        var ls = substring.charCodeAt(i + 1)\n        if (ls == 0x20e3) {\n          return true\n        }\n      } else {\n        if (0x2100 <= hs && hs <= 0x27ff) {\n          return true\n        } else if (0x2b05 <= hs && hs <= 0x2b07) {\n          return true\n        } else if (0x2934 <= hs && hs <= 0x2935) {\n          return true\n        } else if (0x3297 <= hs && hs <= 0x3299) {\n          return true\n        } else if (\n          hs == 0xa9 ||\n          hs == 0xae ||\n          hs == 0x303d ||\n          hs == 0x3030 ||\n          hs == 0x2b55 ||\n          hs == 0x2b1c ||\n          hs == 0x2b1b ||\n          hs == 0x2b50\n        ) {\n          return true\n        }\n      }\n    }\n  }\n}\n```\n\n以上函数接收一个文本框的值，若文本框有表情就返回 true , 在实际项目中我们可以根据 Form.Item 的 rules 属性自定义校验规则，代码如下：\n\n```javascript\n<Form.Item\n  rules={[\n    {\n      validator: (_, value) => {\n        const isEmoji = isEmojiCharacter(value)\n        console.log('12123', isEmoji)\n        return !isEmoji ? Promise.resolve() : Promise.reject(new Error('不允许输入表情符号'))\n      },\n      validateTrigger: 'onChange'\n    }\n  ]}\n  label=\"接口名称\"\n  style={{marginLeft: 20}}\n  name=\"interName\">\n  <Input allowClear placeholder=\"请输入接口名称\" />\n</Form.Item>\n```\n\n至此便可以实现了前端文本框 emoji 的校验~~\n\n# 写在最后\n\n以上提供的方法，便是解决校验文本框表情符号的方法，但是仍然存在部分表情不能校验的问题，如若有完全的表情校验方法，欢迎评论区留言交流；\n\n> 🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞\n","slug":"过滤文本框表情符号","published":1,"updated":"2023-03-12T09:37:30.374Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clj53hqfr002mp5o18bls9w8p","content":"<h1 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h1><p>在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；<br>如下图所示：</p>\n<img src=\"/2021/05/28/%E8%BF%87%E6%BB%A4%E6%96%87%E6%9C%AC%E6%A1%86%E8%A1%A8%E6%83%85%E7%AC%A6%E5%8F%B7/emo1.png\" class=\"lazyload\" data-srcset=\"/2021/05/28/%E8%BF%87%E6%BB%A4%E6%96%87%E6%9C%AC%E6%A1%86%E8%A1%A8%E6%83%85%E7%AC%A6%E5%8F%B7/emo1.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\" class=\" lazyload\">\n\n<h1 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h1><p>由于产品要求项目中的所有文本框都需要进行 emoji 限制，因此我封装了一个工具函数，作为表单的自定义校验规则，封装的工具函数代码如下，大家可以直接使用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 判断文本中是否有表情</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">isEmojiCharacter</span> = (<span class=\"params\">substring: any</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (substring?.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; substring.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> hs = substring.<span class=\"title function_\">charCodeAt</span>(i)</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"number\">0xd800</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0xdbff</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (substring.<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> ls = substring.<span class=\"title function_\">charCodeAt</span>(i + <span class=\"number\">1</span>)</span><br><span class=\"line\">          <span class=\"keyword\">var</span> uc = (hs - <span class=\"number\">0xd800</span>) * <span class=\"number\">0x400</span> + (ls - <span class=\"number\">0xdc00</span>) + <span class=\"number\">0x10000</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"number\">0x1d000</span> &lt;= uc &amp;&amp; uc &lt;= <span class=\"number\">0x1f77f</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (substring.<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> ls = substring.<span class=\"title function_\">charCodeAt</span>(i + <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ls == <span class=\"number\">0x20e3</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"number\">0x2100</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x27ff</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x2b05</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x2b07</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x2934</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x2935</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x3297</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x3299</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (</span><br><span class=\"line\">          hs == <span class=\"number\">0xa9</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0xae</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x303d</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x3030</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b55</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b1c</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b1b</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b50</span></span><br><span class=\"line\">        ) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上函数接收一个文本框的值，若文本框有表情就返回 true , 在实际项目中我们可以根据 Form.Item 的 rules 属性自定义校验规则，代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;<span class=\"title class_\">Form</span>.<span class=\"property\">Item</span></span><br><span class=\"line\">  rules=&#123;[</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">validator</span>: <span class=\"function\">(<span class=\"params\">_, value</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> isEmoji = <span class=\"title function_\">isEmojiCharacter</span>(value)</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;12123&#x27;</span>, isEmoji)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> !isEmoji ? <span class=\"title class_\">Promise</span>.<span class=\"title function_\">resolve</span>() : <span class=\"title class_\">Promise</span>.<span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;不允许输入表情符号&#x27;</span>))</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">validateTrigger</span>: <span class=\"string\">&#x27;onChange&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]&#125;</span><br><span class=\"line\">  label=<span class=\"string\">&quot;接口名称&quot;</span></span><br><span class=\"line\">  style=&#123;&#123;<span class=\"attr\">marginLeft</span>: <span class=\"number\">20</span>&#125;&#125;</span><br><span class=\"line\">  name=<span class=\"string\">&quot;interName&quot;</span>&gt;</span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">Input</span> <span class=\"attr\">allowClear</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;请输入接口名称&quot;</span> /&gt;</span></span></span><br><span class=\"line\">&lt;/<span class=\"title class_\">Form</span>.<span class=\"property\">Item</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<p>至此便可以实现了前端文本框 emoji 的校验~~</p>\n<h1 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h1><p>以上提供的方法，便是解决校验文本框表情符号的方法，但是仍然存在部分表情不能校验的问题，如若有完全的表情校验方法，欢迎评论区留言交流；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n","site":{"data":{"friends":[{"group":null,"description":null,"items":[{"title":123,"avatar":"images/ava.jpeg","url":null,"screenshot":null,"keywords":null,"description":null},{"title":null,"avatar":null,"url":null,"screenshot":null,"keywords":null,"description":null}]}]}},"excerpt":"","more":"<h1 id=\"问题产生背景\"><a href=\"#问题产生背景\" class=\"headerlink\" title=\"问题产生背景\"></a>问题产生背景</h1><p>在做某一后台管理项目时，由于发送请求时，若用户在文本框输入表情符号，提交的数据在插入数据库会报错，因此需要前后端对，用户输入的文本框的值进行校验；此篇文章只分享前端如何进行表单校验；<br>如下图所示：</p>\n<img src=\"/2021/05/28/%E8%BF%87%E6%BB%A4%E6%96%87%E6%9C%AC%E6%A1%86%E8%A1%A8%E6%83%85%E7%AC%A6%E5%8F%B7/emo1.png\" class=\"\">\n\n<h1 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h1><p>由于产品要求项目中的所有文本框都需要进行 emoji 限制，因此我封装了一个工具函数，作为表单的自定义校验规则，封装的工具函数代码如下，大家可以直接使用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 判断文本中是否有表情</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">isEmojiCharacter</span> = (<span class=\"params\">substring: any</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (substring?.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; substring.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> hs = substring.<span class=\"title function_\">charCodeAt</span>(i)</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"number\">0xd800</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0xdbff</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (substring.<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">var</span> ls = substring.<span class=\"title function_\">charCodeAt</span>(i + <span class=\"number\">1</span>)</span><br><span class=\"line\">          <span class=\"keyword\">var</span> uc = (hs - <span class=\"number\">0xd800</span>) * <span class=\"number\">0x400</span> + (ls - <span class=\"number\">0xdc00</span>) + <span class=\"number\">0x10000</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"number\">0x1d000</span> &lt;= uc &amp;&amp; uc &lt;= <span class=\"number\">0x1f77f</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (substring.<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> ls = substring.<span class=\"title function_\">charCodeAt</span>(i + <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ls == <span class=\"number\">0x20e3</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"number\">0x2100</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x27ff</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x2b05</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x2b07</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x2934</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x2935</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"number\">0x3297</span> &lt;= hs &amp;&amp; hs &lt;= <span class=\"number\">0x3299</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (</span><br><span class=\"line\">          hs == <span class=\"number\">0xa9</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0xae</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x303d</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x3030</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b55</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b1c</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b1b</span> ||</span><br><span class=\"line\">          hs == <span class=\"number\">0x2b50</span></span><br><span class=\"line\">        ) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>以上函数接收一个文本框的值，若文本框有表情就返回 true , 在实际项目中我们可以根据 Form.Item 的 rules 属性自定义校验规则，代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;<span class=\"title class_\">Form</span>.<span class=\"property\">Item</span></span><br><span class=\"line\">  rules=&#123;[</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">validator</span>: <span class=\"function\">(<span class=\"params\">_, value</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> isEmoji = <span class=\"title function_\">isEmojiCharacter</span>(value)</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;12123&#x27;</span>, isEmoji)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> !isEmoji ? <span class=\"title class_\">Promise</span>.<span class=\"title function_\">resolve</span>() : <span class=\"title class_\">Promise</span>.<span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;不允许输入表情符号&#x27;</span>))</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">validateTrigger</span>: <span class=\"string\">&#x27;onChange&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]&#125;</span><br><span class=\"line\">  label=<span class=\"string\">&quot;接口名称&quot;</span></span><br><span class=\"line\">  style=&#123;&#123;<span class=\"attr\">marginLeft</span>: <span class=\"number\">20</span>&#125;&#125;</span><br><span class=\"line\">  name=<span class=\"string\">&quot;interName&quot;</span>&gt;</span><br><span class=\"line\">  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">Input</span> <span class=\"attr\">allowClear</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;请输入接口名称&quot;</span> /&gt;</span></span></span><br><span class=\"line\">&lt;/<span class=\"title class_\">Form</span>.<span class=\"property\">Item</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<p>至此便可以实现了前端文本框 emoji 的校验~~</p>\n<h1 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h1><p>以上提供的方法，便是解决校验文本框表情符号的方法，但是仍然存在部分表情不能校验的问题，如若有完全的表情校验方法，欢迎评论区留言交流；</p>\n<blockquote>\n<p>🥂(❁´◡`❁)您的<font  color=red size=3>点赞</font>👍➕<font  color=red size=3>评论</font>📝➕<font  color=red size=3>收藏</font>⭐ 是作者创作的最大动力 🤞</p>\n</blockquote>\n"}],"PostAsset":[{"_id":"source/_posts/PromiseOne/promise1.png","slug":"promise1.png","post":"clj53hqe80001p5o13gip641w","modified":0,"renderable":0},{"_id":"source/_posts/PromiseOne/promise2.png","slug":"promise2.png","post":"clj53hqe80001p5o13gip641w","modified":0,"renderable":0},{"_id":"source/_posts/PromiseOne/promise3.png","slug":"promise3.png","post":"clj53hqe80001p5o13gip641w","modified":0,"renderable":0},{"_id":"source/_posts/PromiseOne/promise4.png","slug":"promise4.png","post":"clj53hqe80001p5o13gip641w","modified":0,"renderable":0},{"_id":"source/_posts/PromiseTo/promiseto1.png","slug":"promiseto1.png","post":"clj53hqed0003p5o107le0kck","modified":0,"renderable":0},{"_id":"source/_posts/PromiseTo/promiseto2.png","slug":"promiseto2.png","post":"clj53hqed0003p5o107le0kck","modified":0,"renderable":0},{"_id":"source/_posts/PromiseTo/promiseto3.png","slug":"promiseto3.png","post":"clj53hqed0003p5o107le0kck","modified":0,"renderable":0},{"_id":"source/_posts/React-redux/reduxdata1.gif","slug":"reduxdata1.gif","post":"clj53hqel0009p5o17a8u3oyc","modified":0,"renderable":0},{"_id":"source/_posts/React-redux/reduxdata2.gif","slug":"reduxdata2.gif","post":"clj53hqel0009p5o17a8u3oyc","modified":0,"renderable":0},{"_id":"source/_posts/React报错/reacterror1.png","slug":"reacterror1.png","post":"clj53hqem000bp5o186xcbpui","modified":0,"renderable":0},{"_id":"source/_posts/React报错/reacterror2.png","slug":"reacterror2.png","post":"clj53hqem000bp5o186xcbpui","modified":0,"renderable":0},{"_id":"source/_posts/dataPick组件日期在浏览器兼容性问题/datePick.png","slug":"datePick.png","post":"clj53hqer000gp5o1bj5o7ezo","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne1.gif","slug":"gitOne1.gif","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne10.png","slug":"gitOne10.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne11.png","slug":"gitOne11.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne12.png","slug":"gitOne12.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne13.png","slug":"gitOne13.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne14.png","slug":"gitOne14.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne15.png","slug":"gitOne15.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne16.png","slug":"gitOne16.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne17.png","slug":"gitOne17.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne18.png","slug":"gitOne18.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne19.png","slug":"gitOne19.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne2.png","slug":"gitOne2.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne20.png","slug":"gitOne20.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne21.png","slug":"gitOne21.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne22.png","slug":"gitOne22.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne23.png","slug":"gitOne23.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne24.png","slug":"gitOne24.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne3.png","slug":"gitOne3.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne4.gif","slug":"gitOne4.gif","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne5.gif","slug":"gitOne5.gif","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne6.png","slug":"gitOne6.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne7.png","slug":"gitOne7.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne8.png","slug":"gitOne8.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitOne/gitOne9.png","slug":"gitOne9.png","post":"clj53hqeu000lp5o149f3am8e","modified":0,"renderable":0},{"_id":"source/_posts/gitRebase/rebase1.png","slug":"rebase1.png","post":"clj53hqev000mp5o1f5k2cxl4","modified":0,"renderable":0},{"_id":"source/_posts/gitRebase/rebase2.png","slug":"rebase2.png","post":"clj53hqev000mp5o1f5k2cxl4","modified":0,"renderable":0},{"_id":"source/_posts/gitRebase/rebase3.png","slug":"rebase3.png","post":"clj53hqev000mp5o1f5k2cxl4","modified":0,"renderable":0},{"_id":"source/_posts/gitRebase/rebase4.png","slug":"rebase4.png","post":"clj53hqev000mp5o1f5k2cxl4","modified":0,"renderable":0},{"_id":"source/_posts/gitRebase/rebase5.png","slug":"rebase5.png","post":"clj53hqev000mp5o1f5k2cxl4","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to10.png","slug":"to10.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to11.png","slug":"to11.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to12.png","slug":"to12.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to13.png","slug":"to13.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to14.png","slug":"to14.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to15.png","slug":"to15.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to16.png","slug":"to16.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to17.png","slug":"to17.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to18.png","slug":"to18.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to19.png","slug":"to19.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to2.png","slug":"to2.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to20.png","slug":"to20.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to21.png","slug":"to21.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to23.png","slug":"to23.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to24.png","slug":"to24.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to25.png","slug":"to25.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to26.png","slug":"to26.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to27.png","slug":"to27.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to28.png","slug":"to28.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to29.png","slug":"to29.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to3.png","slug":"to3.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to30.png","slug":"to30.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to31.png","slug":"to31.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to32.png","slug":"to32.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to33.png","slug":"to33.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to34.png","slug":"to34.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to4.png","slug":"to4.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to5.png","slug":"to5.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to6.png","slug":"to6.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to7.png","slug":"to7.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to8.png","slug":"to8.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/gitTo/to9.png","slug":"to9.png","post":"clj53hqex000rp5o1al3de69y","modified":0,"renderable":0},{"_id":"source/_posts/nodebody/body1.png","slug":"body1.png","post":"clj53hqez000sp5o19icpfxtg","modified":0,"renderable":0},{"_id":"source/_posts/nodeheader/hea1.png","slug":"hea1.png","post":"clj53hqf1000wp5o1cwak7ba5","modified":0,"renderable":0},{"_id":"source/_posts/nodeheader/hea2.png","slug":"hea2.png","post":"clj53hqf1000wp5o1cwak7ba5","modified":0,"renderable":0},{"_id":"source/_posts/nodeheader/hea3.png","slug":"hea3.png","post":"clj53hqf1000wp5o1cwak7ba5","modified":0,"renderable":0},{"_id":"source/_posts/nodejoi/joi1.png","slug":"joi1.png","post":"clj53hqf1000yp5o1evi8bk48","modified":0,"renderable":0},{"_id":"source/_posts/nodenotfound/notfound1.png","slug":"notfound1.png","post":"clj53hqf30012p5o132px4sf2","modified":0,"renderable":0},{"_id":"source/_posts/nodenotfound/notfound2.png","slug":"notfound2.png","post":"clj53hqf30012p5o132px4sf2","modified":0,"renderable":0},{"_id":"source/_posts/nodenotfound/notfound3.png","slug":"notfound3.png","post":"clj53hqf30012p5o132px4sf2","modified":0,"renderable":0},{"_id":"source/_posts/nodenotfound/notfound4.png","slug":"notfound4.png","post":"clj53hqf30012p5o132px4sf2","modified":0,"renderable":0},{"_id":"source/_posts/noderes-cc/cc1.png","slug":"cc1.png","post":"clj53hqf30014p5o10k36bao5","modified":0,"renderable":0},{"_id":"source/_posts/noderes-cc/cc2.png","slug":"cc2.png","post":"clj53hqf30014p5o10k36bao5","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile1.png","slug":"profile1.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile2.png","slug":"profile2.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile3.png","slug":"profile3.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile4.png","slug":"profile4.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile5.png","slug":"profile5.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile6.png","slug":"profile6.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile7.png","slug":"profile7.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/profile/profile8.png","slug":"profile8.png","post":"clj53hqf6001ap5o10rxa6fzw","modified":0,"renderable":0},{"_id":"source/_posts/prop的单向数据流/data1.png","slug":"data1.png","post":"clj53hqf7001ep5o1g47o0br1","modified":0,"renderable":0},{"_id":"source/_posts/prop的单向数据流/data2.png","slug":"data2.png","post":"clj53hqf7001ep5o1g47o0br1","modified":0,"renderable":0},{"_id":"source/_posts/prop的单向数据流/data3.png","slug":"data3.png","post":"clj53hqf7001ep5o1g47o0br1","modified":0,"renderable":0},{"_id":"source/_posts/react-fiber/fiber1.png","slug":"fiber1.png","post":"clj53hqf8001gp5o1d4vneuqh","modified":0,"renderable":0},{"_id":"source/_posts/react-fiber/fiber2.png","slug":"fiber2.png","post":"clj53hqf8001gp5o1d4vneuqh","modified":0,"renderable":0},{"_id":"source/_posts/react-fiber/fiber3.png","slug":"fiber3.png","post":"clj53hqf8001gp5o1d4vneuqh","modified":0,"renderable":0},{"_id":"source/_posts/react-fiber/fiber4.png","slug":"fiber4.png","post":"clj53hqf8001gp5o1d4vneuqh","modified":0,"renderable":0},{"_id":"source/_posts/table-scroll/scroll1.png","slug":"scroll1.png","post":"clj53hqf9001ip5o10jgifak4","modified":0,"renderable":0},{"_id":"source/_posts/table-scroll/scroll2.png","slug":"scroll2.png","post":"clj53hqf9001ip5o10jgifak4","modified":0,"renderable":0},{"_id":"source/_posts/useMemo使用误区/memo1.png","slug":"memo1.png","post":"clj53hqfb001np5o1fxj29i8p","modified":0,"renderable":0},{"_id":"source/_posts/useMemo使用误区/memo2.png","slug":"memo2.png","post":"clj53hqfb001np5o1fxj29i8p","modified":0,"renderable":0},{"_id":"source/_posts/useMemo使用误区/memo3.png","slug":"memo3.png","post":"clj53hqfb001np5o1fxj29i8p","modified":0,"renderable":0},{"_id":"source/_posts/useMemo使用误区/memo4.png","slug":"memo4.png","post":"clj53hqfb001np5o1fxj29i8p","modified":0,"renderable":0},{"_id":"source/_posts/useMemo的使用/memoopt1.png","slug":"memoopt1.png","post":"clj53hqfc001pp5o1dupddq3l","modified":0,"renderable":0},{"_id":"source/_posts/useMemo的使用/memoopt2.png","slug":"memoopt2.png","post":"clj53hqfc001pp5o1dupddq3l","modified":0,"renderable":0},{"_id":"source/_posts/useMemo的使用/memoopt3.png","slug":"memoopt3.png","post":"clj53hqfc001pp5o1dupddq3l","modified":0,"renderable":0},{"_id":"source/_posts/useMemo的使用/memoopt4.png","slug":"memoopt4.png","post":"clj53hqfc001pp5o1dupddq3l","modified":0,"renderable":0},{"_id":"source/_posts/vue数据代理的原理/vueproxy1.jpeg","slug":"vueproxy1.jpeg","post":"clj53hqfj0022p5o199pj3md2","modified":0,"renderable":0},{"_id":"source/_posts/vue数据代理的原理/vueproxy2.png","slug":"vueproxy2.png","post":"clj53hqfj0022p5o199pj3md2","modified":0,"renderable":0},{"_id":"source/_posts/vue数据代理的原理/vueproxy3.png","slug":"vueproxy3.png","post":"clj53hqfj0022p5o199pj3md2","modified":0,"renderable":0},{"_id":"source/_posts/vue数据代理的原理/vueproxy4.png","slug":"vueproxy4.png","post":"clj53hqfj0022p5o199pj3md2","modified":0,"renderable":0},{"_id":"source/_posts/vux/vue2.png","slug":"vue2.png","post":"clj53hqfk0024p5o1f5flbdhk","modified":0,"renderable":0},{"_id":"source/_posts/vux/vuex1.png","slug":"vuex1.png","post":"clj53hqfk0024p5o1f5flbdhk","modified":0,"renderable":0},{"_id":"source/_posts/vux/vuex3.png","slug":"vuex3.png","post":"clj53hqfk0024p5o1f5flbdhk","modified":0,"renderable":0},{"_id":"source/_posts/过滤文本框表情符号/emo1.png","slug":"emo1.png","post":"clj53hqfr002mp5o18bls9w8p","modified":0,"renderable":0}],"PostCategory":[{"post_id":"clj53hqe80001p5o13gip641w","category_id":"clj53hqef0004p5o1epvkcsfm","_id":"clj53hqet000ip5o1b94je14f"},{"post_id":"clj53hqed0003p5o107le0kck","category_id":"clj53hqef0004p5o1epvkcsfm","_id":"clj53hqex000op5o129n199d8"},{"post_id":"clj53hqej0007p5o1dqi20ix6","category_id":"clj53hqef0004p5o1epvkcsfm","_id":"clj53hqf0000tp5o18ucgepxf"},{"post_id":"clj53hqel0009p5o17a8u3oyc","category_id":"clj53hqex000np5o1bife3chp","_id":"clj53hqf2000zp5o15t13c2cu"},{"post_id":"clj53hqem000bp5o186xcbpui","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqf40016p5o1a9ep408x"},{"post_id":"clj53hqeq000fp5o1b1a9aewm","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqf7001bp5o1bvxm3wvq"},{"post_id":"clj53hqer000gp5o1bj5o7ezo","category_id":"clj53hqf40015p5o19kabhbs5","_id":"clj53hqf9001hp5o11cb4ban7"},{"post_id":"clj53hqf6001ap5o10rxa6fzw","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqfb001lp5o1emdsbjwm"},{"post_id":"clj53hqf8001gp5o1d4vneuqh","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqfc001qp5o1d1rv5py9"},{"post_id":"clj53hqeu000lp5o149f3am8e","category_id":"clj53hqf7001cp5o1612wep7j","_id":"clj53hqfg001vp5o14ok4140i"},{"post_id":"clj53hqf9001ip5o10jgifak4","category_id":"clj53hqf40015p5o19kabhbs5","_id":"clj53hqfi001yp5o1e7e30snm"},{"post_id":"clj53hqfb001np5o1fxj29i8p","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqfj0023p5o1b30i860h"},{"post_id":"clj53hqev000mp5o1f5k2cxl4","category_id":"clj53hqf7001cp5o1612wep7j","_id":"clj53hqfk0025p5o1hqe29z3z"},{"post_id":"clj53hqfc001pp5o1dupddq3l","category_id":"clj53hqf0000up5o13y6l08vd","_id":"clj53hqfm0029p5o1axx2abmm"},{"post_id":"clj53hqex000rp5o1al3de69y","category_id":"clj53hqf7001cp5o1612wep7j","_id":"clj53hqfn002cp5o10m4s3pix"},{"post_id":"clj53hqez000sp5o19icpfxtg","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqfp002gp5o1g92v8t5q"},{"post_id":"clj53hqf1000wp5o1cwak7ba5","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqfq002kp5o1a4g8h6wo"},{"post_id":"clj53hqf1000yp5o1evi8bk48","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqft002qp5o11nmu59mv"},{"post_id":"clj53hqfp002ip5o15okqe5e4","category_id":"clj53hqf40015p5o19kabhbs5","_id":"clj53hqft002tp5o1gdokg54x"},{"post_id":"clj53hqfr002mp5o18bls9w8p","category_id":"clj53hqf40015p5o19kabhbs5","_id":"clj53hqfu002wp5o19hrrhfjg"},{"post_id":"clj53hqf30012p5o132px4sf2","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqfz002zp5o1cldk9yk4"},{"post_id":"clj53hqf30014p5o10k36bao5","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqfz0031p5o1bt4u6yj8"},{"post_id":"clj53hqf50018p5o11u3e07ph","category_id":"clj53hqfi001zp5o1f4w219ss","_id":"clj53hqfz0034p5o1d64k9c80"},{"post_id":"clj53hqf7001ep5o1g47o0br1","category_id":"clj53hqfz0030p5o19k9t17ea","_id":"clj53hqg00039p5o1bqtk4e36"},{"post_id":"clj53hqfe001up5o1dwnk640e","category_id":"clj53hqfz0030p5o19k9t17ea","_id":"clj53hqg1003dp5o15wc6dzhd"},{"post_id":"clj53hqfh001xp5o17c7x5eit","category_id":"clj53hqfz0030p5o19k9t17ea","_id":"clj53hqg2003hp5o112lffqbb"},{"post_id":"clj53hqfj0022p5o199pj3md2","category_id":"clj53hqfz0030p5o19k9t17ea","_id":"clj53hqg2003kp5o10g6t6ymv"},{"post_id":"clj53hqfk0024p5o1f5flbdhk","category_id":"clj53hqg2003gp5o1a5ot1m3q","_id":"clj53hqg3003pp5o1cr047kpi"},{"post_id":"clj53hqfl0028p5o185aafp6v","category_id":"clj53hqfz0030p5o19k9t17ea","_id":"clj53hqg4003sp5o1fjzo098g"},{"post_id":"clj53hqfm002bp5o1gnvnf5pl","category_id":"clj53hqg3003op5o11k8nd8vz","_id":"clj53hqg5003wp5o13vog2alk"},{"post_id":"clj53hqfo002fp5o14emk5gwg","category_id":"clj53hqg3003op5o11k8nd8vz","_id":"clj53hqg5003zp5o1hsnm3v7j"}],"PostTag":[{"post_id":"clj53hqe80001p5o13gip641w","tag_id":"clj53hqeh0005p5o1dqug8b0j","_id":"clj53hqeq000ep5o17oorfp9u"},{"post_id":"clj53hqed0003p5o107le0kck","tag_id":"clj53hqeh0005p5o1dqug8b0j","_id":"clj53hqeu000kp5o1fe7194q1"},{"post_id":"clj53hqej0007p5o1dqi20ix6","tag_id":"clj53hqeh0005p5o1dqug8b0j","_id":"clj53hqex000qp5o19w32b1ag"},{"post_id":"clj53hqel0009p5o17a8u3oyc","tag_id":"clj53hqex000pp5o1f8w7c8qn","_id":"clj53hqf1000xp5o10cnrezft"},{"post_id":"clj53hqem000bp5o186xcbpui","tag_id":"clj53hqf0000vp5o14lcx66sn","_id":"clj53hqf30013p5o14gb3bf4z"},{"post_id":"clj53hqeq000fp5o1b1a9aewm","tag_id":"clj53hqf0000vp5o14lcx66sn","_id":"clj53hqf60019p5o13fokdf8s"},{"post_id":"clj53hqer000gp5o1bj5o7ezo","tag_id":"clj53hqf40017p5o1g1nq7v7b","_id":"clj53hqf8001fp5o1ftdbfv6k"},{"post_id":"clj53hqeu000lp5o149f3am8e","tag_id":"clj53hqf7001dp5o1eok49mda","_id":"clj53hqfb001mp5o12hjk2unz"},{"post_id":"clj53hqf9001ip5o10jgifak4","tag_id":"clj53hqf40017p5o1g1nq7v7b","_id":"clj53hqfc001op5o1eml08q14"},{"post_id":"clj53hqev000mp5o1f5k2cxl4","tag_id":"clj53hqf7001dp5o1eok49mda","_id":"clj53hqfd001tp5o16kbke9eo"},{"post_id":"clj53hqfc001pp5o1dupddq3l","tag_id":"clj53hqf0000vp5o14lcx66sn","_id":"clj53hqfh001wp5o1eft2fwou"},{"post_id":"clj53hqex000rp5o1al3de69y","tag_id":"clj53hqf7001dp5o1eok49mda","_id":"clj53hqfi0021p5o1c9ku153n"},{"post_id":"clj53hqez000sp5o19icpfxtg","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfm002ap5o1hnu41sph"},{"post_id":"clj53hqf1000wp5o1cwak7ba5","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfp002hp5o1ewiib1te"},{"post_id":"clj53hqf1000yp5o1evi8bk48","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfr002np5o1cp2s4ih8"},{"post_id":"clj53hqfp002ip5o15okqe5e4","tag_id":"clj53hqf40017p5o1g1nq7v7b","_id":"clj53hqfs002op5o10vi9gmxa"},{"post_id":"clj53hqfr002mp5o18bls9w8p","tag_id":"clj53hqf40017p5o1g1nq7v7b","_id":"clj53hqft002sp5o1gvvibgp5"},{"post_id":"clj53hqf30012p5o132px4sf2","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfu002up5o1gy66b3e3"},{"post_id":"clj53hqf30014p5o10k36bao5","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfy002yp5o11n14dh8d"},{"post_id":"clj53hqf50018p5o11u3e07ph","tag_id":"clj53hqfi0020p5o16ck07a0c","_id":"clj53hqfz0033p5o1crqv5ubv"},{"post_id":"clj53hqf6001ap5o10rxa6fzw","tag_id":"clj53hqfz0032p5o177ywao47","_id":"clj53hqg00037p5o13xgu8ykn"},{"post_id":"clj53hqf7001ep5o1g47o0br1","tag_id":"clj53hqg00036p5o10w5m3dje","_id":"clj53hqg1003bp5o19eeu7u7w"},{"post_id":"clj53hqf8001gp5o1d4vneuqh","tag_id":"clj53hqg1003ap5o1agq08g28","_id":"clj53hqg2003fp5o17lxi0zw0"},{"post_id":"clj53hqfb001np5o1fxj29i8p","tag_id":"clj53hqg1003ep5o172u3dp50","_id":"clj53hqg2003jp5o13equdynd"},{"post_id":"clj53hqfe001up5o1dwnk640e","tag_id":"clj53hqg00036p5o10w5m3dje","_id":"clj53hqg3003np5o19vdp0h37"},{"post_id":"clj53hqfh001xp5o17c7x5eit","tag_id":"clj53hqg00036p5o10w5m3dje","_id":"clj53hqg4003rp5o1gbfqgl83"},{"post_id":"clj53hqfj0022p5o199pj3md2","tag_id":"clj53hqg00036p5o10w5m3dje","_id":"clj53hqg5003vp5o1huur5y8z"},{"post_id":"clj53hqfk0024p5o1f5flbdhk","tag_id":"clj53hqg4003up5o17ho521ys","_id":"clj53hqg5003yp5o1caa7c8rl"},{"post_id":"clj53hqfl0028p5o185aafp6v","tag_id":"clj53hqg00036p5o10w5m3dje","_id":"clj53hqg60041p5o1gxap5zm4"},{"post_id":"clj53hqfm002bp5o1gnvnf5pl","tag_id":"clj53hqg50040p5o1hxb52bra","_id":"clj53hqg60043p5o178sqh3iw"},{"post_id":"clj53hqfo002fp5o14emk5gwg","tag_id":"clj53hqg50040p5o1hxb52bra","_id":"clj53hqg60044p5o1emk8as8z"}],"Tag":[{"name":"Promise","_id":"clj53hqeh0005p5o1dqug8b0j"},{"name":"Redux","_id":"clj53hqex000pp5o1f8w7c8qn"},{"name":"React","_id":"clj53hqf0000vp5o14lcx66sn"},{"name":"antDesign","_id":"clj53hqf40017p5o1g1nq7v7b"},{"name":"Git","_id":"clj53hqf7001dp5o1eok49mda"},{"name":"Node","_id":"clj53hqfi0020p5o16ck07a0c"},{"name":"Profile","_id":"clj53hqfz0032p5o177ywao47"},{"name":"Vue","_id":"clj53hqg00036p5o10w5m3dje"},{"name":"fiber","_id":"clj53hqg1003ap5o1agq08g28"},{"name":"hooks","_id":"clj53hqg1003ep5o172u3dp50"},{"name":"Vuex","_id":"clj53hqg4003up5o17ho521ys"},{"name":"Webpack","_id":"clj53hqg50040p5o1hxb52bra"}]}}